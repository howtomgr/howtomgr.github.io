<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" data-next-head=""/><meta name="theme-color" content="#bd93f9" data-next-head=""/><link rel="icon" href="/favicon.ico" data-next-head=""/><link rel="preconnect" href="https://fonts.googleapis.com" data-next-head=""/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true" data-next-head=""/><title class="jsx-6ca0ba86c5b4bb40" data-next-head="">Communication Installation Guides - HowToMgr</title><meta name="description" content="1 communication installation guides. Communication tools and applications" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta name="keywords" content="installation guides, tutorials, linux, docker, kubernetes, mobile-first, responsive" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta property="og:title" content="Communication Installation Guides - HowToMgr" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta property="og:description" content="1 communication installation guides. Communication tools and applications" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta property="og:type" content="website" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta property="og:url" content="https://howtomgr.github.io" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta property="og:image" content="https://howtomgr.github.io/social-preview.png" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta property="twitter:card" content="summary_large_image" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta property="twitter:title" content="Communication Installation Guides - HowToMgr" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><meta property="twitter:description" content="1 communication installation guides. Communication tools and applications" class="jsx-6ca0ba86c5b4bb40" data-next-head=""/><link rel="dns-prefetch" href="//api.github.com"/><link rel="dns-prefetch" href="//github.com"/><link rel="preload" href="/favicon.ico" as="image"/><meta name="application-name" content="HowToMgr"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="default"/><meta name="apple-mobile-web-app-title" content="HowToMgr"/><meta name="format-detection" content="telephone=no"/><meta name="mobile-web-app-capable" content="yes"/><noscript><style>
            .requires-js { display: none !important; }
            .no-js-message { display: block !important; }
          </style></noscript><link rel="preload" href="/_next/static/css/8f63910774442189.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8f63910774442189.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-a6e0b7e30f98059a.js" defer=""></script><script src="/_next/static/chunks/main-453f16463ca269d8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2c7289aecf732a54.js" defer=""></script><script src="/_next/static/chunks/473-0e819be9d34ec59b.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcategory%5D-74bd91863765ea88.js" defer=""></script><script src="/_next/static/rp-9dFvAw_ZL8L4-4VvdV/_buildManifest.js" defer=""></script><script src="/_next/static/rp-9dFvAw_ZL8L4-4VvdV/_ssgManifest.js" defer=""></script><style id="__jsx-fba8d10132152d7">.search-box.jsx-fba8d10132152d7{position:relative;width:100%;max-width:500px}.search-input-container.jsx-fba8d10132152d7{position:relative;display:flex;align-items:center}.search-input.jsx-fba8d10132152d7{width:100%;padding:var(--space-3)var(--space-4);padding-right:80px;border:2px solid var(--bg-surface);border-radius:var(--border-radius-lg);background:var(--bg-primary);color:var(--text-primary);font-size:var(--font-base);transition:var(--transition);min-height:48px}.search-input.jsx-fba8d10132152d7:focus{border-color:var(--accent-primary);outline:none;box-shadow:0 0 0 3px rgba(189,147,249,.15)}.search-indicator.jsx-fba8d10132152d7{position:absolute;right:50px;color:var(--text-muted);pointer-events:none}.search-clear.jsx-fba8d10132152d7{position:absolute;right:var(--space-3);background:var(--bg-surface);border:none;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;color:var(--text-muted);font-size:var(--font-sm)}.search-clear.jsx-fba8d10132152d7:hover{background:var(--accent-error);color:var(--bg-primary)}.search-results.jsx-fba8d10132152d7{position:absolute;top:100%;left:0;right:0;background:var(--bg-secondary);border:1px solid var(--bg-surface);border-radius:var(--border-radius-lg);box-shadow:var(--box-shadow-lg);max-height:400px;overflow-y:auto;z-index:var(--z-dropdown);margin-top:var(--space-2)}.search-result-item.jsx-fba8d10132152d7{display:block;padding:var(--space-4);border-bottom:1px solid var(--bg-surface);cursor:pointer;transition:var(--transition);text-decoration:none;color:inherit}.search-result-item.jsx-fba8d10132152d7:last-child{border-bottom:none}.search-result-item.jsx-fba8d10132152d7:hover,.search-result-item.selected.jsx-fba8d10132152d7{background:var(--bg-surface);text-decoration:none;color:inherit}.result-header.jsx-fba8d10132152d7{display:flex;justify-content:space-between;align-items:flex-start;gap:var(--space-3);margin-bottom:var(--space-2)}.result-title.jsx-fba8d10132152d7{color:var(--accent-primary);font-size:var(--font-base);font-weight:600;margin:0}.result-badges.jsx-fba8d10132152d7{display:flex;gap:var(--space-1)}.result-category.jsx-fba8d10132152d7,.result-language.jsx-fba8d10132152d7{padding:var(--space-1)var(--space-2);border-radius:var(--border-radius-sm);font-size:var(--font-xs);font-weight:600;text-transform:uppercase}.result-category.jsx-fba8d10132152d7{background:var(--accent-primary);color:var(--bg-primary)}.result-language.jsx-fba8d10132152d7{background:var(--accent-secondary);color:var(--bg-primary)}.result-description.jsx-fba8d10132152d7{color:var(--text-secondary);font-size:var(--font-sm);margin:0 0 var(--space-2)0;line-height:1.4}.result-meta.jsx-fba8d10132152d7{display:flex;gap:var(--space-3);font-size:var(--font-xs);color:var(--text-muted)}.search-empty.jsx-fba8d10132152d7{padding:var(--space-6)var(--space-4);text-align:center;color:var(--text-secondary)}.empty-icon.jsx-fba8d10132152d7{font-size:var(--font-2xl);margin-bottom:var(--space-3);opacity:.5}.empty-text.jsx-fba8d10132152d7 strong.jsx-fba8d10132152d7{display:block;color:var(--text-primary);margin-bottom:var(--space-2)}.empty-text.jsx-fba8d10132152d7 p.jsx-fba8d10132152d7{margin:0;font-size:var(--font-sm)}@media(max-width:767px){.search-input.jsx-fba8d10132152d7{min-height:52px;font-size:var(--font-base)}.result-header.jsx-fba8d10132152d7{flex-direction:column;align-items:flex-start;gap:var(--space-2)}.result-badges.jsx-fba8d10132152d7{order:-1}}</style><style id="__jsx-6e7ce48e453c7e27">.breadcrumb.jsx-6e7ce48e453c7e27{display:flex;align-items:center;gap:var(--space-2);margin-bottom:var(--space-6);font-size:var(--font-sm);color:var(--text-secondary)}.breadcrumb.jsx-6e7ce48e453c7e27 a.jsx-6e7ce48e453c7e27{color:var(--accent-primary);text-decoration:none}.breadcrumb.jsx-6e7ce48e453c7e27 a.jsx-6e7ce48e453c7e27:hover{text-decoration:underline}.separator.jsx-6e7ce48e453c7e27{color:var(--text-muted)}.current.jsx-6e7ce48e453c7e27{color:var(--text-primary);font-weight:500}.category-header.jsx-6e7ce48e453c7e27{text-align:center;margin-bottom:var(--space-8);padding:var(--space-6)0;background:var(--bg-secondary);border-radius:var(--border-radius-lg)}.category-icon.jsx-6e7ce48e453c7e27{font-size:3rem;margin-bottom:var(--space-4)}.category-title.jsx-6e7ce48e453c7e27{color:var(--accent-primary);font-size:var(--font-3xl);margin-bottom:var(--space-4)}.category-description.jsx-6e7ce48e453c7e27{color:var(--text-secondary);font-size:var(--font-lg);margin-bottom:var(--space-4);max-width:600px;margin-left:auto;margin-right:auto}.category-stats.jsx-6e7ce48e453c7e27{margin-top:var(--space-4)}.category-search.jsx-6e7ce48e453c7e27{margin-bottom:var(--space-6);display:flex;justify-content:center}.controls-section.jsx-6e7ce48e453c7e27{margin-bottom:var(--space-6);display:flex;justify-content:center}.sort-select.jsx-6e7ce48e453c7e27{padding:var(--space-2)var(--space-4);border:1px solid var(--bg-surface);border-radius:var(--border-radius);background:var(--bg-primary);color:var(--text-primary);font-size:var(--font-sm)}.guides-section.jsx-6e7ce48e453c7e27{margin-bottom:var(--space-8)}.guide-card.jsx-6e7ce48e453c7e27:hover .mobile-card-title.jsx-6e7ce48e453c7e27{color:var(--accent-secondary)}.empty-state.jsx-6e7ce48e453c7e27{text-align:center;padding:var(--space-8);color:var(--text-secondary)}.empty-state.jsx-6e7ce48e453c7e27 h3.jsx-6e7ce48e453c7e27{color:var(--text-primary);margin-bottom:var(--space-4)}.loading-container.jsx-6e7ce48e453c7e27{text-align:center;padding:var(--space-8);color:var(--text-secondary)}.error-container.jsx-6e7ce48e453c7e27{text-align:center;padding:var(--space-8)}@media(max-width:767px){.category-header.jsx-6e7ce48e453c7e27{padding:var(--space-4);margin-bottom:var(--space-6)}.category-title.jsx-6e7ce48e453c7e27{font-size:var(--font-2xl)}.category-description.jsx-6e7ce48e453c7e27{font-size:var(--font-base)}.category-icon.jsx-6e7ce48e453c7e27{font-size:2.5rem}}</style><style id="__jsx-6ca0ba86c5b4bb40">.app-container.jsx-6ca0ba86c5b4bb40{min-height:100vh;display:flex;flex-direction:column;padding-top:56px}.main-content.jsx-6ca0ba86c5b4bb40{flex:1;padding:var(--space-6)0}.mobile-footer.jsx-6ca0ba86c5b4bb40{background:var(--bg-secondary);border-top:1px solid var(--bg-surface);padding:var(--space-6)0;margin-top:auto}.footer-content.jsx-6ca0ba86c5b4bb40{text-align:center}.footer-links.jsx-6ca0ba86c5b4bb40{display:flex;justify-content:center;gap:var(--space-6);margin-bottom:var(--space-4);flex-wrap:wrap}.footer-links.jsx-6ca0ba86c5b4bb40 a.jsx-6ca0ba86c5b4bb40{color:var(--accent-primary);text-decoration:none;font-size:var(--font-sm)}.footer-links.jsx-6ca0ba86c5b4bb40 a.jsx-6ca0ba86c5b4bb40:hover{color:var(--accent-secondary)}.footer-separator.jsx-6ca0ba86c5b4bb40{height:1px;background:var(--bg-surface);margin:var(--space-4)auto;width:200px}.footer-text.jsx-6ca0ba86c5b4bb40,.footer-tech.jsx-6ca0ba86c5b4bb40{color:var(--text-secondary);font-size:var(--font-sm);margin-bottom:var(--space-2)}.footer-disclaimer.jsx-6ca0ba86c5b4bb40{color:var(--text-muted);font-size:var(--font-xs)}.footer-updated.jsx-6ca0ba86c5b4bb40{color:var(--text-muted);font-size:var(--font-xs);margin-top:var(--space-2)}.nav-links.jsx-6ca0ba86c5b4bb40{display:flex;gap:var(--space-4)}.nav-link.jsx-6ca0ba86c5b4bb40{color:var(--text-primary);text-decoration:none;padding:var(--space-2)var(--space-3);border-radius:var(--border-radius);font-size:var(--font-sm);font-weight:500;transition:var(--transition);min-height:36px;display:flex;align-items:center}.nav-link.jsx-6ca0ba86c5b4bb40:hover{background:var(--bg-surface);color:var(--accent-primary);text-decoration:none}[data-theme="light"].jsx-6ca0ba86c5b4bb40 .theme-icon-dark.jsx-6ca0ba86c5b4bb40{display:none}[data-theme="light"].jsx-6ca0ba86c5b4bb40 .theme-icon-light.jsx-6ca0ba86c5b4bb40{display:inline!important}@media(max-width:767px){.main-content.jsx-6ca0ba86c5b4bb40{padding:var(--space-4)0}.footer-links.jsx-6ca0ba86c5b4bb40{gap:var(--space-4)}}</style></head><body><noscript><div class="no-js-message" style="padding:1rem;background:#ff5555;color:#f8f8f2;text-align:center;font-size:0.9rem">This site requires JavaScript to function properly. Please enable JavaScript in your browser.</div></noscript><div id="__next"><div class="jsx-6ca0ba86c5b4bb40 app-container"><a href="#main-content" class="jsx-6ca0ba86c5b4bb40 skip-link">Skip to main content</a><nav class="jsx-6ca0ba86c5b4bb40 mobile-nav"><div class="jsx-6ca0ba86c5b4bb40 mobile-nav-content"><a class="mobile-brand" href="/"><span role="img" aria-label="Books" class="jsx-6ca0ba86c5b4bb40">üìö</span>HowToMgr</a><div class="jsx-6ca0ba86c5b4bb40 nav-links"><a class="nav-link" href="/all/">All</a><a class="nav-link" href="/search/">Search</a></div><button aria-label="Toggle theme" title="Switch theme" class="jsx-6ca0ba86c5b4bb40 mobile-theme-toggle touch-target"><span class="jsx-6ca0ba86c5b4bb40 theme-icon-dark">üåô</span><span style="display:none" class="jsx-6ca0ba86c5b4bb40 theme-icon-light">‚òÄÔ∏è</span></button></div></nav><main id="main-content" tabindex="-1" class="jsx-6ca0ba86c5b4bb40 main-content"><div class="jsx-6ca0ba86c5b4bb40 container"><nav aria-label="Breadcrumb" class="jsx-6e7ce48e453c7e27 breadcrumb"><a href="/">Home</a><span class="jsx-6e7ce48e453c7e27 separator">‚Üí</span><span class="jsx-6e7ce48e453c7e27 current">Communication</span></nav><section class="jsx-6e7ce48e453c7e27 category-header"><div style="color:#f1fa8c" class="jsx-6e7ce48e453c7e27 category-icon">üí¨</div><h1 class="jsx-6e7ce48e453c7e27 category-title">Communication</h1><p class="jsx-6e7ce48e453c7e27 category-description">Communication tools and applications</p><div class="jsx-6e7ce48e453c7e27 category-stats"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-primary">1<!-- --> guides available</span></div></section><section class="jsx-6e7ce48e453c7e27 category-search"><div class="jsx-fba8d10132152d7 search-box"><div class="jsx-fba8d10132152d7 search-input-container"><input type="search" placeholder="Search communication..." autoComplete="off" aria-label="Search installation guides" class="jsx-fba8d10132152d7 search-input" value=""/><div class="jsx-fba8d10132152d7 search-indicator"><span class="jsx-fba8d10132152d7 search-icon">üîç</span></div></div></div></section><section class="jsx-6e7ce48e453c7e27 controls-section"><div class="jsx-6e7ce48e453c7e27 sort-controls"><label for="sort-select" class="jsx-6e7ce48e453c7e27 sr-only">Sort guides</label><select id="sort-select" class="jsx-6e7ce48e453c7e27 sort-select"><option value="name" class="jsx-6e7ce48e453c7e27" selected="">Name (A-Z)</option><option value="updated" class="jsx-6e7ce48e453c7e27">Recently Updated</option><option value="stars" class="jsx-6e7ce48e453c7e27">Most Popular</option></select></div></section><section class="jsx-6e7ce48e453c7e27 guides-section"><div class="jsx-6e7ce48e453c7e27 mobile-grid"><a class="mobile-card guide-card" href="/communication/mastodon/"><div class="jsx-6e7ce48e453c7e27 mobile-card-header"><h3 class="jsx-6e7ce48e453c7e27 mobile-card-title">Mastodon Installation Guide</h3><p class="jsx-6e7ce48e453c7e27 mobile-card-description">Mastodon is a free and open-source decentralized social media platform that serves as an alternative to proprietary platforms like Twitter/X. It&#x27;s part of the fediverse, uses the ActivityPub protocol for federation, and allows users to run their own social media instances with full control over their data and community.</p></div><div class="jsx-6e7ce48e453c7e27 mobile-card-meta"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-info">20 min</span></div></a></div></section></div></main><footer class="jsx-6ca0ba86c5b4bb40 mobile-footer"><div class="jsx-6ca0ba86c5b4bb40 container"><div class="jsx-6ca0ba86c5b4bb40 footer-content"><div class="jsx-6ca0ba86c5b4bb40 footer-links"><a href="/">Home</a><a href="https://github.com/howtomgr" target="_blank" rel="noopener" class="jsx-6ca0ba86c5b4bb40">GitHub</a><a href="https://github.com/howtomgr/howtomgr.github.io" target="_blank" rel="noopener" class="jsx-6ca0ba86c5b4bb40">Source</a></div><div class="jsx-6ca0ba86c5b4bb40 footer-separator"></div><p class="jsx-6ca0ba86c5b4bb40 footer-text">¬© <!-- -->2025<!-- --> HowToMgr Organization. Open source installation guides.</p><p class="jsx-6ca0ba86c5b4bb40 footer-tech">Built with ‚ù§Ô∏è using Next.js + GitHub Pages</p><p class="jsx-6ca0ba86c5b4bb40 footer-disclaimer"><small class="jsx-6ca0ba86c5b4bb40">All guides are provided as-is. Please review and test before production use.</small></p></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"category":{"key":"communication","name":"Communication","description":"Communication tools and applications","icon":"üí¨","color":"#f1fa8c"},"guides":[{"name":"mastodon","displayName":"Mastodon Installation Guide","slug":"mastodon","description":"Mastodon is a free and open-source decentralized social media platform that serves as an alternative to proprietary platforms like Twitter/X. It's part of the fediverse, uses the ActivityPub protocol for federation, and allows users to run their own social media instances with full control over their data and community.","category":"communication","subcategory":"communication","difficultyLevel":"advanced","estimatedSetupTime":"1-2 hours","supportedOS":["rhel","centos","rocky","almalinux","debian","ubuntu","arch","alpine","opensuse","sles"],"defaultPorts":[80,443,3000,4000],"installationMethods":["native-packages","source-installation"],"features":["multi-os-support","comprehensive-documentation","security-hardening","performance-optimization","backup-restore-procedures","troubleshooting-guides"],"tags":["social-media","fediverse","activitypub","decentralized","microblogging"],"maintenanceStatus":"active","specVersion":"2.0","version":"1.0.0","license":"AGPL-3.0","websiteUrl":"https://howtomgr.github.io/communication/mastodon","documentationUrl":"https://howtomgr.github.io/communication/mastodon","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/mastodon","updatedAt":"2025-09-16T17:29:29Z","createdAt":"2023-08-28T03:48:35Z","readmeRaw":"# Mastodon Installation Guide\n\nMastodon is a free, open-source federated social network server that provides a decentralized alternative to proprietary platforms like Twitter/X. Built on Ruby on Rails and using ActivityPub protocol, Mastodon allows users to run their own social media instance while connecting to the broader fediverse.\n\n## Prerequisites\n\n### Hardware Requirements\n- **CPU**: 2+ cores (4+ cores recommended for production)\n- **RAM**: 4GB minimum (8GB+ recommended for production)\n- **Storage**: 20GB minimum (SSD recommended, scale based on media storage needs)\n- **Network**: Reliable internet connection with public IP (for federation)\n\n### Software Dependencies\n- **Operating System**: Linux (RHEL-based, Debian-based, Arch Linux, Alpine Linux)\n- **Database**: PostgreSQL 12+ (PostgreSQL 15+ recommended)\n- **Cache/Queue**: Redis 6.0+\n- **Runtime**: Ruby 3.0+ (Ruby 3.2+ recommended)\n- **Web Server**: nginx or Apache (for reverse proxy)\n- **SSL Certificate**: Let's Encrypt or commercial certificate\n- **Node.js**: 16+ (for asset compilation)\n- **Yarn**: Package manager for Node.js dependencies\n\n### Network Requirements\n- **Ports**: \n  - 80/443 (HTTP/HTTPS)\n  - 25/587 (SMTP - for email delivery)\n  - 3000 (Mastodon web interface)\n  - 4000 (Mastodon streaming API)\n- **Domain**: Registered domain name with DNS control\n- **Email**: SMTP server for notifications and user registration\n\n### System Access\n- Root or sudo access required for installation\n- Dedicated user account for Mastodon service\n- Firewall configuration access\n\n## Supported Operating Systems\n\nThis guide supports installation on:\n- **RHEL-based**: RHEL 8/9, CentOS Stream 8/9, Rocky Linux 8/9, AlmaLinux 8/9, Fedora 37+\n- **Debian-based**: Debian 11/12, Ubuntu 20.04/22.04/24.04 LTS\n- **Arch Linux**: Arch Linux (rolling), Manjaro\n- **Alpine Linux**: 3.18+ (containerized deployments)\n- **macOS**: 12+ (development only)\n- **FreeBSD**: 13.0+ (experimental)\n\n## Installation\n\n### RHEL/CentOS/Rocky Linux/AlmaLinux\n\n```bash\n# Install EPEL and PowerTools repositories\nsudo dnf install -y epel-release\nsudo dnf config-manager --set-enabled powertools  # CentOS Stream 8\nsudo dnf config-manager --set-enabled crb         # CentOS Stream 9, Rocky, AlmaLinux\n\n# Install Node.js repository\ncurl -fsSL https://rpm.nodesource.com/setup_lts.x | sudo bash -\n\n# Install Yarn repository\ncurl -sL https://dl.yarnpkg.com/rpm/yarn.repo | sudo tee /etc/yum.repos.d/yarn.repo\n\n# Install PostgreSQL repository (for latest version)\nsudo dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-$(rpm -E %{rhel})-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n\n# Install required packages\nsudo dnf install -y \\\n    git curl wget gnupg2 \\\n    gcc gcc-c++ make automake autoconf libtool \\\n    postgresql15-server postgresql15-devel \\\n    redis \\\n    nodejs yarn \\\n    nginx \\\n    ImageMagick ImageMagick-devel \\\n    ffmpeg \\\n    libxml2-devel libxslt-devel \\\n    libidn-devel \\\n    openssl-devel \\\n    readline-devel \\\n    zlib-devel \\\n    libyaml-devel \\\n    gdbm-devel \\\n    ncurses-devel \\\n    libffi-devel\n\n# Initialize PostgreSQL\nsudo postgresql-15-setup initdb\nsudo systemctl enable --now postgresql-15 redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \"ALTER USER mastodon WITH ENCRYPTED PASSWORD 'secure_random_password_here';\"\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon nginx\n\n# Install Ruby (using rbenv for version management)\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' \u003e\u003e ~/.bashrc\necho 'eval \"$(rbenv init -)\"' \u003e\u003e ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v 'rc' | sort -V | tail -n 1)\n\n# Install Ruby dependencies\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle config deployment 'true'\nbundle config without 'development test'\nbundle install\nEOF\n\n# Install Node.js dependencies\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nyarn install --pure-lockfile\nEOF\n```\n\n### Debian/Ubuntu\n\n```bash\n# Update package list\nsudo apt update\n\n# Install curl and gnupg (if not already installed)\nsudo apt install -y curl gnupg\n\n# Add Node.js repository\ncurl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -\n\n# Add Yarn repository\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho \"deb https://dl.yarnpkg.com/debian/ stable main\" | sudo tee /etc/apt/sources.list.d/yarn.list\n\n# Add PostgreSQL repository (for latest version)\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\necho \"deb http://apt.postgresql.org/pub/repos/apt/ $(lsb_release -cs)-pgdg main\" | sudo tee /etc/apt/sources.list.d/pgdg.list\n\n# Update package list\nsudo apt update\n\n# Install required packages\nsudo apt install -y \\\n    git curl wget gnupg \\\n    build-essential \\\n    postgresql-15 postgresql-contrib-15 postgresql-server-dev-15 \\\n    redis-server \\\n    nodejs yarn \\\n    nginx \\\n    imagemagick ffmpeg \\\n    libxml2-dev libxslt1-dev \\\n    libidn11-dev \\\n    libssl-dev \\\n    libreadline-dev \\\n    zlib1g-dev \\\n    libyaml-dev \\\n    libgdbm-dev \\\n    libncurses5-dev \\\n    libffi-dev \\\n    libpq-dev\n\n# Start and enable services\nsudo systemctl enable --now postgresql redis-server\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \"ALTER USER mastodon WITH ENCRYPTED PASSWORD 'secure_random_password_here';\"\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon www-data\n\n# Install Ruby (using rbenv)\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' \u003e\u003e ~/.bashrc\necho 'eval \"$(rbenv init -)\"' \u003e\u003e ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v 'rc' | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle config deployment 'true'\nbundle config without 'development test'\nbundle install\nyarn install --pure-lockfile\nEOF\n```\n\n### Arch Linux\n\n```bash\n# Update system\nsudo pacman -Syu\n\n# Install required packages\nsudo pacman -S --needed \\\n    git curl wget gnupg \\\n    base-devel \\\n    postgresql redis \\\n    nodejs npm yarn \\\n    nginx \\\n    imagemagick ffmpeg \\\n    libxml2 libxslt \\\n    libidn \\\n    openssl \\\n    readline \\\n    zlib \\\n    libyaml \\\n    gdbm \\\n    ncurses \\\n    libffi\n\n# Initialize PostgreSQL\nsudo -u postgres initdb -D /var/lib/postgres/data\nsudo systemctl enable --now postgresql redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \"ALTER USER mastodon WITH ENCRYPTED PASSWORD 'secure_random_password_here';\"\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon http\n\n# Install Ruby using rbenv\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' \u003e\u003e ~/.bashrc\necho 'eval \"$(rbenv init -)\"' \u003e\u003e ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone and setup Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v 'rc' | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle config deployment 'true'\nbundle config without 'development test'\nbundle install\nyarn install --pure-lockfile\nEOF\n```\n\n### Alpine Linux\n\n```bash\n# Update package index\napk update\n\n# Install required packages\napk add --no-cache \\\n    git curl wget gnupg \\\n    build-base \\\n    postgresql15 postgresql15-dev postgresql15-contrib \\\n    redis \\\n    nodejs npm yarn \\\n    nginx \\\n    imagemagick imagemagick-dev ffmpeg \\\n    libxml2-dev libxslt-dev \\\n    libidn-dev \\\n    openssl-dev \\\n    readline-dev \\\n    zlib-dev \\\n    yaml-dev \\\n    gdbm-dev \\\n    ncurses-dev \\\n    libffi-dev\n\n# Initialize and start services\nrc-service postgresql setup\nrc-service postgresql start\nrc-service redis start\nrc-update add postgresql\nrc-update add redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \"ALTER USER mastodon WITH ENCRYPTED PASSWORD 'secure_random_password_here';\"\n\n# Create mastodon user\nadduser -D -s /bin/ash mastodon\naddgroup mastodon nginx\n\n# Install Ruby using rbenv\nsudo -u mastodon ash \u003c\u003c 'EOF'\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' \u003e\u003e ~/.profile\necho 'eval \"$(rbenv init -)\"' \u003e\u003e ~/.profile\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone and setup Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v 'rc' | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon ash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle config deployment 'true'\nbundle config without 'development test'\nbundle install\nyarn install --pure-lockfile\nEOF\n```\n\n## Configuration\n\n### Environment Configuration\n\n```bash\n# Switch to mastodon user\nsudo -u mastodon bash\n\n# Navigate to Mastodon directory\ncd /home/mastodon/live\n\n# Generate configuration\nRAILS_ENV=production bundle exec rake mastodon:setup\n```\n\nThis interactive setup will prompt for:\n- Domain name (e.g., mastodon.example.com)\n- Database configuration\n- Redis configuration\n- Email settings (SMTP)\n- File storage settings\n- Admin account creation\n\n### Manual Environment Configuration\n\nIf you prefer manual configuration, create `/home/mastodon/live/.env.production`:\n\n```bash\n# Create environment file\nsudo -u mastodon tee /home/mastodon/live/.env.production \u003c\u003c 'EOF'\n# Federation\nLOCAL_DOMAIN=mastodon.example.com\nWEB_DOMAIN=mastodon.example.com\n\n# Redis\nREDIS_HOST=127.0.0.1\nREDIS_PORT=6379\n\n# PostgreSQL\nDB_HOST=127.0.0.1\nDB_USER=mastodon\nDB_NAME=mastodon_production\nDB_PASS=secure_random_password_here\nDB_PORT=5432\n\n# ElasticSearch (optional, for full-text search)\n# ES_ENABLED=true\n# ES_HOST=localhost\n# ES_PORT=9200\n\n# Secrets\n# Generate with: bundle exec rake secret\nSECRET_KEY_BASE=generate_with_rake_secret\nOTP_SECRET=generate_with_rake_secret\n\n# VAPID keys (for push notifications)\n# Generate with: bundle exec rake mastodon:webpush:generate_vapid_key\nVAPID_PRIVATE_KEY=\nVAPID_PUBLIC_KEY=\n\n# Sending mail\nSMTP_SERVER=smtp.example.com\nSMTP_PORT=587\nSMTP_LOGIN=mastodon@example.com\nSMTP_PASSWORD=smtp_password\nSMTP_FROM_ADDRESS=mastodon@example.com\n\n# File storage (local)\nPAPERCLIP_ROOT_PATH=/home/mastodon/live/public/system\n\n# Optional S3/compatible storage\n# S3_ENABLED=true\n# S3_BUCKET=mastodon\n# AWS_ACCESS_KEY_ID=\n# AWS_SECRET_ACCESS_KEY=\n# S3_REGION=us-east-1\n# S3_HOSTNAME=s3.amazonaws.com\n\n# Optional CDN\n# CDN_HOST=assets.example.com\n\n# Streaming\nSTREAMING_CLUSTER_NUM=1\nSTREAMING_API_BASE_URL=wss://mastodon.example.com\n\n# Advanced settings\nMAX_TOOT_CHARS=500\nSINGLE_USER_MODE=false\nAUTHORIZED_FETCH=false\nLIMITED_FEDERATION_MODE=false\nEOF\n```\n\n### Database Setup\n\n```bash\n# Switch to mastodon user and setup database\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\n\n# Create database\nRAILS_ENV=production bundle exec rails db:create\nRAILS_ENV=production bundle exec rails db:schema:load\nRAILS_ENV=production bundle exec rails db:seed\n\n# Compile assets\nRAILS_ENV=production bundle exec rails assets:precompile\nEOF\n```\n\n## Service Management\n\n### Systemd Service Files (RHEL/Debian/Arch/SUSE)\n\nCreate the web service (`/etc/systemd/system/mastodon-web.service`):\n\n```ini\n[Unit]\nDescription=mastodon-web\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\"RAILS_ENV=production\"\nEnvironment=\"PORT=3000\"\nExecStart=/home/mastodon/.rbenv/shims/bundle exec puma -C config/puma.rb\nExecReload=/bin/kill -SIGUSR1 $MAINPID\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-web\n\n[Install]\nWantedBy=multi-user.target\n```\n\nCreate the background jobs service (`/etc/systemd/system/mastodon-sidekiq.service`):\n\n```ini\n[Unit]\nDescription=mastodon-sidekiq\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\"RAILS_ENV=production\"\nEnvironment=\"DB_POOL=25\"\nExecStart=/home/mastodon/.rbenv/shims/bundle exec sidekiq -c 25\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-sidekiq\n\n[Install]\nWantedBy=multi-user.target\n```\n\nCreate the streaming service (`/etc/systemd/system/mastodon-streaming.service`):\n\n```ini\n[Unit]\nDescription=mastodon-streaming\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\"NODE_ENV=production\"\nEnvironment=\"PORT=4000\"\nExecStart=/usr/bin/node streaming\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-streaming\n\n[Install]\nWantedBy=multi-user.target\n```\n\n### Enable and Start Services\n\n```bash\n# Reload systemd and enable services\nsudo systemctl daemon-reload\nsudo systemctl enable mastodon-web mastodon-sidekiq mastodon-streaming\nsudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Check status\nsudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming\n```\n\n### OpenRC Services (Alpine Linux)\n\nCreate `/etc/init.d/mastodon-web`:\n\n```bash\n#!/sbin/openrc-run\n\nname=\"mastodon-web\"\ndescription=\"Mastodon web service\"\n\nuser=\"mastodon\"\ngroup=\"mastodon\"\ndirectory=\"/home/mastodon/live\"\n\ncommand=\"/home/mastodon/.rbenv/shims/bundle\"\ncommand_args=\"exec puma -C config/puma.rb\"\ncommand_background=\"yes\"\n\npidfile=\"/run/${name}.pid\"\noutput_log=\"/var/log/${name}.log\"\nerror_log=\"/var/log/${name}.error.log\"\n\ndepend() {\n    need net postgresql redis\n}\n\nstart_pre() {\n    export RAILS_ENV=production\n    export PORT=3000\n}\n```\n\nCreate similar files for `mastodon-sidekiq` and `mastodon-streaming`, then:\n\n```bash\n# Make executable\nsudo chmod +x /etc/init.d/mastodon-*\n\n# Enable and start\nsudo rc-update add mastodon-web\nsudo rc-update add mastodon-sidekiq  \nsudo rc-update add mastodon-streaming\nsudo rc-service mastodon-web start\nsudo rc-service mastodon-sidekiq start\nsudo rc-service mastodon-streaming start\n```\n\n## Troubleshooting\n\n### Common Issues\n\n**Ruby/Bundle Issues:**\n```bash\n# Ensure proper rbenv setup\nsudo -u mastodon bash \u003c\u003c 'EOF'\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nwhich ruby\nruby --version\nEOF\n\n# Reinstall gems if needed\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle install --deployment --without development test\nEOF\n```\n\n**Database Connection Issues:**\n```bash\n# Test PostgreSQL connection\nsudo -u mastodon psql -h localhost -U mastodon mastodon_production\n\n# Check PostgreSQL logs\nsudo journalctl -u postgresql-15 -f\n\n# Verify database configuration\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nRAILS_ENV=production bundle exec rails console\n# In console: ActiveRecord::Base.connection\nEOF\n```\n\n**Asset Compilation Issues:**\n```bash\n# Clear and recompile assets\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nRAILS_ENV=production bundle exec rails assets:clobber\nRAILS_ENV=production bundle exec rails assets:precompile\nEOF\n```\n\n**Service Startup Issues:**\n```bash\n# Check service logs\nsudo journalctl -u mastodon-web -f\nsudo journalctl -u mastodon-sidekiq -f\nsudo journalctl -u mastodon-streaming -f\n\n# Check for port conflicts\nsudo netstat -tlnp | grep :3000\nsudo netstat -tlnp | grep :4000\n\n# Verify file permissions\nsudo ls -la /home/mastodon/live/\nsudo -u mastodon test -r /home/mastodon/live/.env.production \u0026\u0026 echo \"Can read env file\"\n```\n\n## Security Considerations\n\n### Firewall Configuration\n\n**firewalld (RHEL/CentOS/Fedora):**\n```bash\n# Open required ports\nsudo firewall-cmd --permanent --add-service=http\nsudo firewall-cmd --permanent --add-service=https\nsudo firewall-cmd --permanent --add-port=3000/tcp\nsudo firewall-cmd --permanent --add-port=4000/tcp\nsudo firewall-cmd --reload\n```\n\n**ufw (Ubuntu/Debian):**\n```bash\n# Configure firewall\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\nsudo ufw allow 3000/tcp\nsudo ufw allow 4000/tcp\nsudo ufw enable\n```\n\n**iptables (Generic):**\n```bash\n# Basic firewall rules\nsudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 3000 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 4000 -j ACCEPT\n```\n\n### SSL/TLS Configuration with nginx\n\nCreate `/etc/nginx/sites-available/mastodon` (Debian/Ubuntu) or `/etc/nginx/conf.d/mastodon.conf` (RHEL):\n\n```nginx\nmap $http_upgrade $connection_upgrade {\n  default upgrade;\n  ''      close;\n}\n\nupstream backend {\n    server 127.0.0.1:3000 fail_timeout=0;\n}\n\nupstream streaming {\n    server 127.0.0.1:4000 fail_timeout=0;\n}\n\nproxy_cache_path /var/cache/nginx/mastodon keys_zone=CACHE:10m levels=1:2 inactive=7d max_size=1g;\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name mastodon.example.com;\n    root /home/mastodon/live/public;\n    location /.well-known/acme-challenge/ { allow all; }\n    location / { return 301 https://$host$request_uri; }\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name mastodon.example.com;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;\n    ssl_prefer_server_ciphers off;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_tickets off;\n\n    ssl_certificate     /etc/letsencrypt/live/mastodon.example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/mastodon.example.com/privkey.pem;\n\n    keepalive_timeout    70;\n    sendfile             on;\n    client_max_body_size 80m;\n\n    root /home/mastodon/live/public;\n\n    gzip on;\n    gzip_disable \"msie6\";\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types\n        text/plain\n        text/css\n        text/xml\n        text/javascript\n        application/json\n        application/javascript\n        application/xml+rss\n        application/atom+xml\n        image/svg+xml;\n\n    add_header Strict-Transport-Security \"max-age=31536000\" always;\n\n    location / {\n        try_files $uri @proxy;\n    }\n\n    location ~ ^/(emoji|packs|system/accounts/avatars|system/media_attachments/files) {\n        add_header Cache-Control \"public, max-age=31536000, immutable\";\n        add_header Strict-Transport-Security \"max-age=31536000\" always;\n        try_files $uri @proxy;\n    }\n    \n    location /sw.js {\n        add_header Cache-Control \"public, max-age=604800, must-revalidate\";\n        add_header Strict-Transport-Security \"max-age=31536000\" always;\n        try_files $uri @proxy;\n    }\n\n    location @proxy {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Proxy \"\";\n        proxy_pass_header Server;\n\n        proxy_pass http://backend;\n        proxy_buffering on;\n        proxy_redirect off;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        proxy_cache CACHE;\n        proxy_cache_valid 200 7d;\n        proxy_cache_valid 410 24h;\n        proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;\n        proxy_cache_lock on;\n\n        tcp_nodelay on;\n    }\n\n    location /api/v1/streaming {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Proxy \"\";\n\n        proxy_pass http://streaming;\n        proxy_buffering off;\n        proxy_redirect off;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        tcp_nodelay on;\n    }\n\n    error_page 500 501 502 503 504 /500.html;\n}\n```\n\n### SSL Certificate Setup\n\n```bash\n# Install Certbot\n# RHEL/CentOS/Fedora\nsudo dnf install -y certbot python3-certbot-nginx\n\n# Debian/Ubuntu  \nsudo apt install -y certbot python3-certbot-nginx\n\n# Arch Linux\nsudo pacman -S certbot certbot-nginx\n\n# Obtain certificate\nsudo certbot --nginx -d mastodon.example.com\n\n# Auto-renewal\necho \"0 12 * * * /usr/bin/certbot renew --quiet\" | sudo crontab -\n```\n\n### SELinux Configuration (RHEL-based systems)\n\n```bash\n# Allow nginx to connect to Mastodon services\nsudo setsebool -P httpd_can_network_connect 1\n\n# Set SELinux contexts for Mastodon files\nsudo semanage fcontext -a -t httpd_exec_t \"/home/mastodon/live/public(/.*)?\"\nsudo restorecon -R /home/mastodon/live/public/\n\n# Allow Mastodon to bind to required ports\nsudo semanage port -a -t http_port_t -p tcp 3000\nsudo semanage port -a -t http_port_t -p tcp 4000\n```\n\n## Performance Tuning\n\n### PostgreSQL Optimization\n\nEdit `/var/lib/pgsql/15/data/postgresql.conf`:\n\n```ini\n# Memory settings (adjust based on available RAM)\nshared_buffers = 256MB                 # 1/4 of RAM\neffective_cache_size = 1GB            # 3/4 of RAM\nwork_mem = 4MB                        # RAM/max_connections/4\nmaintenance_work_mem = 64MB           # RAM/16\n\n# Connection settings\nmax_connections = 100\nsuperuser_reserved_connections = 3\n\n# WAL settings for better performance\nwal_buffers = 16MB\ncheckpoint_completion_target = 0.7\ncheckpoint_timeout = 5min\nmax_wal_size = 1GB\nmin_wal_size = 80MB\n\n# Query optimization\nrandom_page_cost = 1.1                # For SSD storage\neffective_io_concurrency = 200        # For SSD storage\n```\n\n### Redis Optimization\n\nEdit `/etc/redis/redis.conf` or `/etc/redis.conf`:\n\n```ini\n# Memory optimization\nmaxmemory 256mb\nmaxmemory-policy allkeys-lru\n\n# Persistence (adjust based on needs)\nsave 900 1\nsave 300 10\nsave 60 10000\n\n# Network optimization\ntcp-keepalive 300\ntimeout 0\n```\n\n### Ruby/Rails Optimization\n\nEdit `/home/mastodon/live/.env.production`:\n\n```bash\n# Database connection pooling\nDB_POOL=25\n\n# Sidekiq concurrency\nSIDEKIQ_CONCURRENCY=25\n\n# Puma workers (number of CPU cores)\nWEB_CONCURRENCY=4\nMAX_THREADS=5\n\n# Streaming cluster\nSTREAMING_CLUSTER_NUM=4\n```\n\n### System-level Optimization\n\n```bash\n# Increase file descriptors limit\necho \"mastodon soft nofile 65536\" | sudo tee -a /etc/security/limits.conf\necho \"mastodon hard nofile 65536\" | sudo tee -a /etc/security/limits.conf\n\n# Optimize kernel parameters\nsudo tee -a /etc/sysctl.conf \u003c\u003c 'EOF'\n# Network optimization\nnet.core.somaxconn = 1024\nnet.core.netdev_max_backlog = 5000\nnet.ipv4.tcp_max_syn_backlog = 1024\nnet.ipv4.tcp_keepalive_time = 120\nnet.ipv4.tcp_keepalive_intvl = 30\nnet.ipv4.tcp_keepalive_probes = 3\n\n# Memory optimization\nvm.swappiness = 10\nvm.dirty_ratio = 15\nvm.dirty_background_ratio = 5\nEOF\n\nsudo sysctl -p\n```\n\n## Backup and Restore\n\n### Database Backup\n\n```bash\n# Create backup script\nsudo tee /usr/local/bin/mastodon-backup.sh \u003c\u003c 'EOF'\n#!/bin/bash\n\nBACKUP_DIR=\"/backup/mastodon\"\nDATE=$(date +%Y%m%d_%H%M%S)\nDB_NAME=\"mastodon_production\"\nMEDIA_DIR=\"/home/mastodon/live/public/system\"\n\n# Create backup directory\nmkdir -p \"$BACKUP_DIR\"\n\n# Database backup\nsudo -u postgres pg_dump \"$DB_NAME\" | gzip \u003e \"$BACKUP_DIR/db_${DATE}.sql.gz\"\n\n# Media backup (if stored locally)\nif [ -d \"$MEDIA_DIR\" ]; then\n    tar -czf \"$BACKUP_DIR/media_${DATE}.tar.gz\" -C \"$(dirname \"$MEDIA_DIR\")\" \"$(basename \"$MEDIA_DIR\")\"\nfi\n\n# Configuration backup\ntar -czf \"$BACKUP_DIR/config_${DATE}.tar.gz\" /home/mastodon/live/.env.production\n\n# Remove backups older than 30 days\nfind \"$BACKUP_DIR\" -name \"*.gz\" -mtime +30 -delete\n\necho \"Backup completed: $DATE\"\nEOF\n\nsudo chmod +x /usr/local/bin/mastodon-backup.sh\n```\n\n### Automated Backups\n\n```bash\n# Add to crontab\necho \"0 2 * * * /usr/local/bin/mastodon-backup.sh\" | sudo crontab -\n```\n\n### Restore Procedure\n\n```bash\n# Stop Mastodon services\nsudo systemctl stop mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Restore database\nsudo -u postgres dropdb mastodon_production\nsudo -u postgres createdb mastodon_production\nsudo -u postgres psql -c \"GRANT ALL PRIVILEGES ON DATABASE mastodon_production TO mastodon;\"\ngunzip -c /backup/mastodon/db_YYYYMMDD_HHMMSS.sql.gz | sudo -u postgres psql mastodon_production\n\n# Restore media files (if needed)\nsudo rm -rf /home/mastodon/live/public/system\nsudo tar -xzf /backup/mastodon/media_YYYYMMDD_HHMMSS.tar.gz -C /home/mastodon/live/public/\nsudo chown -R mastodon:mastodon /home/mastodon/live/public/system\n\n# Restore configuration\nsudo tar -xzf /backup/mastodon/config_YYYYMMDD_HHMMSS.tar.gz -C /\n\n# Start services\nsudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming\n```\n\n## System Requirements\n\n### Minimum Requirements\n- **CPU**: 2 cores, 2.0 GHz\n- **RAM**: 4GB\n- **Storage**: 20GB SSD\n- **Network**: 100 Mbps\n- **OS**: Linux (64-bit)\n\n### Recommended Production Requirements\n- **CPU**: 4+ cores, 2.5+ GHz\n- **RAM**: 8GB+ (16GB for large instances)\n- **Storage**: 100GB+ SSD with good IOPS\n- **Network**: 1 Gbps with low latency\n- **OS**: Recent Linux distribution with long-term support\n\n### Scaling Considerations\n- **Small Instance**: \u003c1,000 users - 2 cores, 4GB RAM, 50GB storage\n- **Medium Instance**: 1,000-10,000 users - 4 cores, 8GB RAM, 200GB storage\n- **Large Instance**: 10,000+ users - 8+ cores, 16GB+ RAM, 500GB+ storage\n\n## Support\n\n### Official Resources\n- **Official Website**: [https://joinmastodon.org](https://joinmastodon.org)\n- **Documentation**: [https://docs.joinmastodon.org](https://docs.joinmastodon.org)\n- **GitHub Repository**: [https://github.com/mastodon/mastodon](https://github.com/mastodon/mastodon)\n- **Admin Documentation**: [https://docs.joinmastodon.org/admin/](https://docs.joinmastodon.org/admin/)\n\n### Community Support\n- **Mastodon Discord**: [https://discord.gg/mastodon](https://discord.gg/mastodon)\n- **GitHub Issues**: [https://github.com/mastodon/mastodon/issues](https://github.com/mastodon/mastodon/issues)\n- **Mastodon Community**: Follow @Mastodon@mastodon.social\n- **Admin Forums**: Various Mastodon admin communities on the fediverse\n\n### Commercial Support\n- Available from various consulting companies\n- Managed hosting providers offer Mastodon services\n- Professional services for large deployments\n\n## Contributing\n\n### How to Contribute\n1. **Report Bugs**: Submit issues to [GitHub](https://github.com/mastodon/mastodon/issues)\n2. **Translate**: Help with internationalization at [Crowdin](https://crowdin.com/project/mastodon)\n3. **Code Contributions**: Submit pull requests for bug fixes and features\n4. **Documentation**: Improve documentation and guides\n5. **Testing**: Test release candidates and provide feedback\n\n### Development Setup\n```bash\n# Clone repository\ngit clone https://github.com/mastodon/mastodon.git\ncd mastodon\n\n# Install dependencies\nbundle install\nyarn install\n\n# Setup development database\nrails db:setup\n\n# Run development server\nforeman start\n```\n\n### Contribution Guidelines\n- Follow Ruby and JavaScript style guides\n- Include tests for new features\n- Update documentation for changes\n- Use conventional commit messages\n- Sign commits with GPG key\n\n## License\n\nMastodon is licensed under the **GNU Affero General Public License v3.0 (AGPL-3.0)**.\n\n### Key License Points\n- **Free to Use**: Can be used for any purpose\n- **Source Available**: Source code must be provided to users\n- **Copyleft**: Derivative works must use same license\n- **Network Use**: AGPL applies to network/web services\n- **No Warranty**: Software provided \"as is\"\n\n### License Compliance\n- Keep license notices intact\n- Provide source code to users\n- Document any modifications\n- Use same license for derivatives\n- Consider legal requirements for your jurisdiction\n\nFull license text: [https://github.com/mastodon/mastodon/blob/main/LICENSE](https://github.com/mastodon/mastodon/blob/main/LICENSE)\n\n## Acknowledgments\n\n### Core Team\n- **Eugen Rochko** - Creator and lead developer\n- **Claire** - Core maintainer\n- **Renaud Chaput** - Core maintainer\n- **ThibG** - Significant contributor\n- And many other contributors\n\n### Technologies Used\n- **Ruby on Rails** - Web application framework\n- **PostgreSQL** - Primary database\n- **Redis** - Caching and job queue\n- **React.js** - Frontend user interface\n- **ActivityPub** - Federation protocol\n- **Sidekiq** - Background job processing\n\n### Community\n- **Translators** - Making Mastodon available in many languages\n- **Instance Administrators** - Running the fediverse\n- **Users** - Creating the vibrant community\n- **Contributors** - Improving the software\n\n## Version History\n\n### Major Releases\n- **v4.2** (September 2023) - Enhanced moderation tools, quote posts\n- **v4.1** (February 2023) - Improved federation, performance optimizations\n- **v4.0** (October 2022) - Major UI overhaul, new features\n- **v3.5** (May 2022) - Content warnings improvements, admin features\n- **v3.4** (October 2021) - Server rules, report improvements\n- **v3.3** (February 2021) - Profile directory, admin announcements\n- **v3.2** (July 2020) - Audio uploads, admin interface improvements\n- **v3.1** (February 2020) - Polls, improved federation\n- **v3.0** (October 2019) - Single column mode, admin dashboard\n\n### Current Stable Version\n- **v4.2.x** - Latest stable release\n- Check [GitHub releases](https://github.com/mastodon/mastodon/releases) for current version\n\n### Upgrade Path\n- Always backup before upgrading\n- Follow official upgrade guides\n- Test in staging environment first\n- Monitor for federation issues after upgrade\n\n## Appendices\n\n### Appendix A: Port Reference\n\n| Port | Service | Protocol | Description |\n|------|---------|----------|-------------|\n| 80 | HTTP | TCP | Web traffic (redirects to HTTPS) |\n| 443 | HTTPS | TCP | Secure web traffic |\n| 3000 | Mastodon Web | TCP | Internal web service |\n| 4000 | Mastodon Streaming | TCP | Real-time updates |\n| 5432 | PostgreSQL | TCP | Database (internal) |\n| 6379 | Redis | TCP | Cache and queues (internal) |\n| 25/587 | SMTP | TCP | Email delivery (outbound) |\n\n### Appendix B: File Locations\n\n| Path | Description |\n|------|-------------|\n| `/home/mastodon/live/` | Mastodon application directory |\n| `/home/mastodon/live/.env.production` | Main configuration file |\n| `/home/mastodon/live/public/system/` | Media files storage |\n| `/etc/systemd/system/mastodon-*.service` | Service definitions |\n| `/etc/nginx/sites-available/mastodon` | nginx configuration |\n| `/var/lib/postgresql/*/data/` | PostgreSQL data directory |\n| `/etc/redis/redis.conf` | Redis configuration |\n| `/var/log/nginx/` | nginx logs |\n\n### Appendix C: Common Commands\n\n```bash\n# Service management\nsudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming\nsudo systemctl restart mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Mastodon maintenance\nsudo -u mastodon bash -c 'cd /home/mastodon/live \u0026\u0026 RAILS_ENV=production bundle exec rails mastodon:maintenance'\n\n# Database management\nsudo -u postgres psql mastodon_production\n\n# Log monitoring\nsudo journalctl -u mastodon-web -f\nsudo tail -f /var/log/nginx/access.log\n```\n\n### Appendix D: Environment Variables Reference\n\n| Variable | Description | Required |\n|----------|-------------|----------|\n| `LOCAL_DOMAIN` | Your Mastodon domain | Yes |\n| `SECRET_KEY_BASE` | Rails secret key | Yes |\n| `OTP_SECRET` | Two-factor authentication secret | Yes |\n| `VAPID_PRIVATE_KEY` | Push notification private key | Yes |\n| `VAPID_PUBLIC_KEY` | Push notification public key | Yes |\n| `DB_HOST` | Database hostname | Yes |\n| `DB_USER` | Database username | Yes |\n| `DB_PASS` | Database password | Yes |\n| `DB_NAME` | Database name | Yes |\n| `REDIS_HOST` | Redis hostname | Yes |\n| `SMTP_SERVER` | SMTP server hostname | Recommended |\n| `SMTP_FROM_ADDRESS` | From email address | Recommended |\n| `S3_ENABLED` | Enable S3 storage | No |\n| `CDN_HOST` | CDN hostname for assets | No |\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection. Always refer to official Mastodon documentation for the most up-to-date information.","readmeHtml":"\u003cp class=\"mobile-paragraph\"\u003eMastodon is a free, open-source federated social network server that provides a decentralized alternative to proprietary platforms like Twitter/X. Built on Ruby on Rails and using ActivityPub protocol, Mastodon allows users to run their own social media instance while connecting to the broader fediverse.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003ch3 id=\"hardware-requirements\" class=\"mobile-header\"\u003eHardware Requirements\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCPU\u003c/strong\u003e: 2+ cores (4+ cores recommended for production)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRAM\u003c/strong\u003e: 4GB minimum (8GB+ recommended for production)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eStorage\u003c/strong\u003e: 20GB minimum (SSD recommended, scale based on media storage needs)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork\u003c/strong\u003e: Reliable internet connection with public IP (for federation)\u003c/li\u003e\n\u003ch3 id=\"software-dependencies\" class=\"mobile-header\"\u003eSoftware Dependencies\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOperating System\u003c/strong\u003e: Linux (RHEL-based, Debian-based, Arch Linux, Alpine Linux)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDatabase\u003c/strong\u003e: PostgreSQL 12+ (PostgreSQL 15+ recommended)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCache/Queue\u003c/strong\u003e: Redis 6.0+\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRuntime\u003c/strong\u003e: Ruby 3.0+ (Ruby 3.2+ recommended)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eWeb Server\u003c/strong\u003e: nginx or Apache (for reverse proxy)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSSL Certificate\u003c/strong\u003e: Let's Encrypt or commercial certificate\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNode.js\u003c/strong\u003e: 16+ (for asset compilation)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eYarn\u003c/strong\u003e: Package manager for Node.js dependencies\u003c/li\u003e\n\u003ch3 id=\"network-requirements\" class=\"mobile-header\"\u003eNetwork Requirements\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ePorts\u003c/strong\u003e: \u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e80/443 (HTTP/HTTPS)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e25/587 (SMTP - for email delivery)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e3000 (Mastodon web interface)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e4000 (Mastodon streaming API)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDomain\u003c/strong\u003e: Registered domain name with DNS control\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eEmail\u003c/strong\u003e: SMTP server for notifications and user registration\u003c/li\u003e\n\u003ch3 id=\"system-access\" class=\"mobile-header\"\u003eSystem Access\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot or sudo access required for installation\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eDedicated user account for Mastodon service\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFirewall configuration access\u003c/li\u003e\n\u003ch2 id=\"supported-operating-systems\" class=\"mobile-header\"\u003eSupported Operating Systems\u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eThis guide supports installation on:\u003c/p\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRHEL-based\u003c/strong\u003e: RHEL 8/9, CentOS Stream 8/9, Rocky Linux 8/9, AlmaLinux 8/9, Fedora 37+\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDebian-based\u003c/strong\u003e: Debian 11/12, Ubuntu 20.04/22.04/24.04 LTS\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eArch Linux\u003c/strong\u003e: Arch Linux (rolling), Manjaro\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eAlpine Linux\u003c/strong\u003e: 3.18+ (containerized deployments)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003emacOS\u003c/strong\u003e: 12+ (development only)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eFreeBSD\u003c/strong\u003e: 13.0+ (experimental)\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"rhelcentosrocky-linuxalmalinux\" class=\"mobile-header\"\u003eRHEL/CentOS/Rocky Linux/AlmaLinux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install EPEL and PowerTools repositories\nsudo dnf install -y epel-release\nsudo dnf config-manager --set-enabled powertools  # CentOS Stream 8\nsudo dnf config-manager --set-enabled crb         # CentOS Stream 9, Rocky, AlmaLinux\n\n# Install Node.js repository\ncurl -fsSL https://rpm.nodesource.com/setup_lts.x | sudo bash -\n\n# Install Yarn repository\ncurl -sL https://dl.yarnpkg.com/rpm/yarn.repo | sudo tee /etc/yum.repos.d/yarn.repo\n\n# Install PostgreSQL repository (for latest version)\nsudo dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-$(rpm -E %{rhel})-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n\n# Install required packages\nsudo dnf install -y \\\n    git curl wget gnupg2 \\\n    gcc gcc-c++ make automake autoconf libtool \\\n    postgresql15-server postgresql15-devel \\\n    redis \\\n    nodejs yarn \\\n    nginx \\\n    ImageMagick ImageMagick-devel \\\n    ffmpeg \\\n    libxml2-devel libxslt-devel \\\n    libidn-devel \\\n    openssl-devel \\\n    readline-devel \\\n    zlib-devel \\\n    libyaml-devel \\\n    gdbm-devel \\\n    ncurses-devel \\\n    libffi-devel\n\n# Initialize PostgreSQL\nsudo postgresql-15-setup initdb\nsudo systemctl enable --now postgresql-15 redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \u0026quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD \u0026#039;secure_random_password_here\u0026#039;;\u0026quot;\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon nginx\n\n# Install Ruby (using rbenv for version management)\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho \u0026#039;export PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\necho \u0026#039;eval \u0026quot;$(rbenv init -)\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v \u0026#039;rc\u0026#039; | sort -V | tail -n 1)\n\n# Install Ruby dependencies\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle config deployment \u0026#039;true\u0026#039;\nbundle config without \u0026#039;development test\u0026#039;\nbundle install\nEOF\n\n# Install Node.js dependencies\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nyarn install --pure-lockfile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"debianubuntu\" class=\"mobile-header\"\u003eDebian/Ubuntu\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update package list\nsudo apt update\n\n# Install curl and gnupg (if not already installed)\nsudo apt install -y curl gnupg\n\n# Add Node.js repository\ncurl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -\n\n# Add Yarn repository\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho \u0026quot;deb https://dl.yarnpkg.com/debian/ stable main\u0026quot; | sudo tee /etc/apt/sources.list.d/yarn.list\n\n# Add PostgreSQL repository (for latest version)\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\necho \u0026quot;deb http://apt.postgresql.org/pub/repos/apt/ $(lsb_release -cs)-pgdg main\u0026quot; | sudo tee /etc/apt/sources.list.d/pgdg.list\n\n# Update package list\nsudo apt update\n\n# Install required packages\nsudo apt install -y \\\n    git curl wget gnupg \\\n    build-essential \\\n    postgresql-15 postgresql-contrib-15 postgresql-server-dev-15 \\\n    redis-server \\\n    nodejs yarn \\\n    nginx \\\n    imagemagick ffmpeg \\\n    libxml2-dev libxslt1-dev \\\n    libidn11-dev \\\n    libssl-dev \\\n    libreadline-dev \\\n    zlib1g-dev \\\n    libyaml-dev \\\n    libgdbm-dev \\\n    libncurses5-dev \\\n    libffi-dev \\\n    libpq-dev\n\n# Start and enable services\nsudo systemctl enable --now postgresql redis-server\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \u0026quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD \u0026#039;secure_random_password_here\u0026#039;;\u0026quot;\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon www-data\n\n# Install Ruby (using rbenv)\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho \u0026#039;export PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\necho \u0026#039;eval \u0026quot;$(rbenv init -)\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v \u0026#039;rc\u0026#039; | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle config deployment \u0026#039;true\u0026#039;\nbundle config without \u0026#039;development test\u0026#039;\nbundle install\nyarn install --pure-lockfile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"arch-linux\" class=\"mobile-header\"\u003eArch Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update system\nsudo pacman -Syu\n\n# Install required packages\nsudo pacman -S --needed \\\n    git curl wget gnupg \\\n    base-devel \\\n    postgresql redis \\\n    nodejs npm yarn \\\n    nginx \\\n    imagemagick ffmpeg \\\n    libxml2 libxslt \\\n    libidn \\\n    openssl \\\n    readline \\\n    zlib \\\n    libyaml \\\n    gdbm \\\n    ncurses \\\n    libffi\n\n# Initialize PostgreSQL\nsudo -u postgres initdb -D /var/lib/postgres/data\nsudo systemctl enable --now postgresql redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \u0026quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD \u0026#039;secure_random_password_here\u0026#039;;\u0026quot;\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon http\n\n# Install Ruby using rbenv\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho \u0026#039;export PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\necho \u0026#039;eval \u0026quot;$(rbenv init -)\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone and setup Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v \u0026#039;rc\u0026#039; | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle config deployment \u0026#039;true\u0026#039;\nbundle config without \u0026#039;development test\u0026#039;\nbundle install\nyarn install --pure-lockfile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"alpine-linux\" class=\"mobile-header\"\u003eAlpine Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update package index\napk update\n\n# Install required packages\napk add --no-cache \\\n    git curl wget gnupg \\\n    build-base \\\n    postgresql15 postgresql15-dev postgresql15-contrib \\\n    redis \\\n    nodejs npm yarn \\\n    nginx \\\n    imagemagick imagemagick-dev ffmpeg \\\n    libxml2-dev libxslt-dev \\\n    libidn-dev \\\n    openssl-dev \\\n    readline-dev \\\n    zlib-dev \\\n    yaml-dev \\\n    gdbm-dev \\\n    ncurses-dev \\\n    libffi-dev\n\n# Initialize and start services\nrc-service postgresql setup\nrc-service postgresql start\nrc-service redis start\nrc-update add postgresql\nrc-update add redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \u0026quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD \u0026#039;secure_random_password_here\u0026#039;;\u0026quot;\n\n# Create mastodon user\nadduser -D -s /bin/ash mastodon\naddgroup mastodon nginx\n\n# Install Ruby using rbenv\nsudo -u mastodon ash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho \u0026#039;export PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.profile\necho \u0026#039;eval \u0026quot;$(rbenv init -)\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.profile\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone and setup Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v \u0026#039;rc\u0026#039; | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon ash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle config deployment \u0026#039;true\u0026#039;\nbundle config without \u0026#039;development test\u0026#039;\nbundle install\nyarn install --pure-lockfile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"configuration\" class=\"mobile-header\"\u003eConfiguration\u003c/h2\u003e\n\u003ch3 id=\"environment-configuration\" class=\"mobile-header\"\u003eEnvironment Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Switch to mastodon user\nsudo -u mastodon bash\n\n# Navigate to Mastodon directory\ncd /home/mastodon/live\n\n# Generate configuration\nRAILS_ENV=production bundle exec rake mastodon:setup\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003eThis interactive setup will prompt for:\u003c/p\u003e\n\u003cli class=\"mobile-list-item\"\u003eDomain name (e.g., mastodon.example.com)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eDatabase configuration\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRedis configuration\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eEmail settings (SMTP)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFile storage settings\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eAdmin account creation\u003c/li\u003e\n\u003ch3 id=\"manual-environment-configuration\" class=\"mobile-header\"\u003eManual Environment Configuration\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eIf you prefer manual configuration, create \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/.env.production\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create environment file\nsudo -u mastodon tee /home/mastodon/live/.env.production \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\n# Federation\nLOCAL_DOMAIN=mastodon.example.com\nWEB_DOMAIN=mastodon.example.com\n\n# Redis\nREDIS_HOST=127.0.0.1\nREDIS_PORT=6379\n\n# PostgreSQL\nDB_HOST=127.0.0.1\nDB_USER=mastodon\nDB_NAME=mastodon_production\nDB_PASS=secure_random_password_here\nDB_PORT=5432\n\n# ElasticSearch (optional, for full-text search)\n# ES_ENABLED=true\n# ES_HOST=localhost\n# ES_PORT=9200\n\n# Secrets\n# Generate with: bundle exec rake secret\nSECRET_KEY_BASE=generate_with_rake_secret\nOTP_SECRET=generate_with_rake_secret\n\n# VAPID keys (for push notifications)\n# Generate with: bundle exec rake mastodon:webpush:generate_vapid_key\nVAPID_PRIVATE_KEY=\nVAPID_PUBLIC_KEY=\n\n# Sending mail\nSMTP_SERVER=smtp.example.com\nSMTP_PORT=587\nSMTP_LOGIN=mastodon@example.com\nSMTP_PASSWORD=smtp_password\nSMTP_FROM_ADDRESS=mastodon@example.com\n\n# File storage (local)\nPAPERCLIP_ROOT_PATH=/home/mastodon/live/public/system\n\n# Optional S3/compatible storage\n# S3_ENABLED=true\n# S3_BUCKET=mastodon\n# AWS_ACCESS_KEY_ID=\n# AWS_SECRET_ACCESS_KEY=\n# S3_REGION=us-east-1\n# S3_HOSTNAME=s3.amazonaws.com\n\n# Optional CDN\n# CDN_HOST=assets.example.com\n\n# Streaming\nSTREAMING_CLUSTER_NUM=1\nSTREAMING_API_BASE_URL=wss://mastodon.example.com\n\n# Advanced settings\nMAX_TOOT_CHARS=500\nSINGLE_USER_MODE=false\nAUTHORIZED_FETCH=false\nLIMITED_FEDERATION_MODE=false\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"database-setup\" class=\"mobile-header\"\u003eDatabase Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Switch to mastodon user and setup database\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\n\n# Create database\nRAILS_ENV=production bundle exec rails db:create\nRAILS_ENV=production bundle exec rails db:schema:load\nRAILS_ENV=production bundle exec rails db:seed\n\n# Compile assets\nRAILS_ENV=production bundle exec rails assets:precompile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"service-management\" class=\"mobile-header\"\u003eService Management\u003c/h2\u003e\n\u003ch3 id=\"systemd-service-files-rheldebianarchsuse\" class=\"mobile-header\"\u003eSystemd Service Files (RHEL/Debian/Arch/SUSE)\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate the web service (\u003ccode class=\"mobile-inline-code\"\u003e/etc/systemd/system/mastodon-web.service\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e[Unit]\nDescription=mastodon-web\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\u0026quot;RAILS_ENV=production\u0026quot;\nEnvironment=\u0026quot;PORT=3000\u0026quot;\nExecStart=/home/mastodon/.rbenv/shims/bundle exec puma -C config/puma.rb\nExecReload=/bin/kill -SIGUSR1 $MAINPID\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-web\n\n[Install]\nWantedBy=multi-user.target\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate the background jobs service (\u003ccode class=\"mobile-inline-code\"\u003e/etc/systemd/system/mastodon-sidekiq.service\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e[Unit]\nDescription=mastodon-sidekiq\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\u0026quot;RAILS_ENV=production\u0026quot;\nEnvironment=\u0026quot;DB_POOL=25\u0026quot;\nExecStart=/home/mastodon/.rbenv/shims/bundle exec sidekiq -c 25\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-sidekiq\n\n[Install]\nWantedBy=multi-user.target\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate the streaming service (\u003ccode class=\"mobile-inline-code\"\u003e/etc/systemd/system/mastodon-streaming.service\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e[Unit]\nDescription=mastodon-streaming\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\u0026quot;NODE_ENV=production\u0026quot;\nEnvironment=\u0026quot;PORT=4000\u0026quot;\nExecStart=/usr/bin/node streaming\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-streaming\n\n[Install]\nWantedBy=multi-user.target\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"enable-and-start-services\" class=\"mobile-header\"\u003eEnable and Start Services\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Reload systemd and enable services\nsudo systemctl daemon-reload\nsudo systemctl enable mastodon-web mastodon-sidekiq mastodon-streaming\nsudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Check status\nsudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"openrc-services-alpine-linux\" class=\"mobile-header\"\u003eOpenRC Services (Alpine Linux)\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate \u003ccode class=\"mobile-inline-code\"\u003e/etc/init.d/mastodon-web\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/sbin/openrc-run\n\nname=\u0026quot;mastodon-web\u0026quot;\ndescription=\u0026quot;Mastodon web service\u0026quot;\n\nuser=\u0026quot;mastodon\u0026quot;\ngroup=\u0026quot;mastodon\u0026quot;\ndirectory=\u0026quot;/home/mastodon/live\u0026quot;\n\ncommand=\u0026quot;/home/mastodon/.rbenv/shims/bundle\u0026quot;\ncommand_args=\u0026quot;exec puma -C config/puma.rb\u0026quot;\ncommand_background=\u0026quot;yes\u0026quot;\n\npidfile=\u0026quot;/run/${name}.pid\u0026quot;\noutput_log=\u0026quot;/var/log/${name}.log\u0026quot;\nerror_log=\u0026quot;/var/log/${name}.error.log\u0026quot;\n\ndepend() {\n    need net postgresql redis\n}\n\nstart_pre() {\n    export RAILS_ENV=production\n    export PORT=3000\n}\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate similar files for \u003ccode class=\"mobile-inline-code\"\u003emastodon-sidekiq\u003c/code\u003e and \u003ccode class=\"mobile-inline-code\"\u003emastodon-streaming\u003c/code\u003e, then:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Make executable\nsudo chmod +x /etc/init.d/mastodon-*\n\n# Enable and start\nsudo rc-update add mastodon-web\nsudo rc-update add mastodon-sidekiq  \nsudo rc-update add mastodon-streaming\nsudo rc-service mastodon-web start\nsudo rc-service mastodon-sidekiq start\nsudo rc-service mastodon-streaming start\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting\" class=\"mobile-header\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues\" class=\"mobile-header\"\u003eCommon Issues\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eRuby/Bundle Issues:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Ensure proper rbenv setup\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nwhich ruby\nruby --version\nEOF\n\n# Reinstall gems if needed\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle install --deployment --without development test\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eDatabase Connection Issues:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Test PostgreSQL connection\nsudo -u mastodon psql -h localhost -U mastodon mastodon_production\n\n# Check PostgreSQL logs\nsudo journalctl -u postgresql-15 -f\n\n# Verify database configuration\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nRAILS_ENV=production bundle exec rails console\n# In console: ActiveRecord::Base.connection\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eAsset Compilation Issues:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Clear and recompile assets\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nRAILS_ENV=production bundle exec rails assets:clobber\nRAILS_ENV=production bundle exec rails assets:precompile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eService Startup Issues:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check service logs\nsudo journalctl -u mastodon-web -f\nsudo journalctl -u mastodon-sidekiq -f\nsudo journalctl -u mastodon-streaming -f\n\n# Check for port conflicts\nsudo netstat -tlnp | grep :3000\nsudo netstat -tlnp | grep :4000\n\n# Verify file permissions\nsudo ls -la /home/mastodon/live/\nsudo -u mastodon test -r /home/mastodon/live/.env.production \u0026amp;\u0026amp; echo \u0026quot;Can read env file\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"security-considerations\" class=\"mobile-header\"\u003eSecurity Considerations\u003c/h2\u003e\n\u003ch3 id=\"firewall-configuration\" class=\"mobile-header\"\u003eFirewall Configuration\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003efirewalld (RHEL/CentOS/Fedora):\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Open required ports\nsudo firewall-cmd --permanent --add-service=http\nsudo firewall-cmd --permanent --add-service=https\nsudo firewall-cmd --permanent --add-port=3000/tcp\nsudo firewall-cmd --permanent --add-port=4000/tcp\nsudo firewall-cmd --reload\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eufw (Ubuntu/Debian):\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure firewall\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\nsudo ufw allow 3000/tcp\nsudo ufw allow 4000/tcp\nsudo ufw enable\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eiptables (Generic):\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Basic firewall rules\nsudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 3000 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 4000 -j ACCEPT\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ssltls-configuration-with-nginx\" class=\"mobile-header\"\u003eSSL/TLS Configuration with nginx\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate \u003ccode class=\"mobile-inline-code\"\u003e/etc/nginx/sites-available/mastodon\u003c/code\u003e (Debian/Ubuntu) or \u003ccode class=\"mobile-inline-code\"\u003e/etc/nginx/conf.d/mastodon.conf\u003c/code\u003e (RHEL):\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"nginx\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003enginx\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-nginx\"\u003emap $http_upgrade $connection_upgrade {\n  default upgrade;\n  \u0026#039;\u0026#039;      close;\n}\n\nupstream backend {\n    server 127.0.0.1:3000 fail_timeout=0;\n}\n\nupstream streaming {\n    server 127.0.0.1:4000 fail_timeout=0;\n}\n\nproxy_cache_path /var/cache/nginx/mastodon keys_zone=CACHE:10m levels=1:2 inactive=7d max_size=1g;\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name mastodon.example.com;\n    root /home/mastodon/live/public;\n    location /.well-known/acme-challenge/ { allow all; }\n    location / { return 301 https://$host$request_uri; }\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name mastodon.example.com;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;\n    ssl_prefer_server_ciphers off;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_tickets off;\n\n    ssl_certificate     /etc/letsencrypt/live/mastodon.example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/mastodon.example.com/privkey.pem;\n\n    keepalive_timeout    70;\n    sendfile             on;\n    client_max_body_size 80m;\n\n    root /home/mastodon/live/public;\n\n    gzip on;\n    gzip_disable \u0026quot;msie6\u0026quot;;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types\n        text/plain\n        text/css\n        text/xml\n        text/javascript\n        application/json\n        application/javascript\n        application/xml+rss\n        application/atom+xml\n        image/svg+xml;\n\n    add_header Strict-Transport-Security \u0026quot;max-age=31536000\u0026quot; always;\n\n    location / {\n        try_files $uri @proxy;\n    }\n\n    location ~ ^/(emoji|packs|system/accounts/avatars|system/media_attachments/files) {\n        add_header Cache-Control \u0026quot;public, max-age=31536000, immutable\u0026quot;;\n        add_header Strict-Transport-Security \u0026quot;max-age=31536000\u0026quot; always;\n        try_files $uri @proxy;\n    }\n    \n    location /sw.js {\n        add_header Cache-Control \u0026quot;public, max-age=604800, must-revalidate\u0026quot;;\n        add_header Strict-Transport-Security \u0026quot;max-age=31536000\u0026quot; always;\n        try_files $uri @proxy;\n    }\n\n    location @proxy {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Proxy \u0026quot;\u0026quot;;\n        proxy_pass_header Server;\n\n        proxy_pass http://backend;\n        proxy_buffering on;\n        proxy_redirect off;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        proxy_cache CACHE;\n        proxy_cache_valid 200 7d;\n        proxy_cache_valid 410 24h;\n        proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;\n        proxy_cache_lock on;\n\n        tcp_nodelay on;\n    }\n\n    location /api/v1/streaming {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Proxy \u0026quot;\u0026quot;;\n\n        proxy_pass http://streaming;\n        proxy_buffering off;\n        proxy_redirect off;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        tcp_nodelay on;\n    }\n\n    error_page 500 501 502 503 504 /500.html;\n}\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ssl-certificate-setup\" class=\"mobile-header\"\u003eSSL Certificate Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Certbot\n# RHEL/CentOS/Fedora\nsudo dnf install -y certbot python3-certbot-nginx\n\n# Debian/Ubuntu  \nsudo apt install -y certbot python3-certbot-nginx\n\n# Arch Linux\nsudo pacman -S certbot certbot-nginx\n\n# Obtain certificate\nsudo certbot --nginx -d mastodon.example.com\n\n# Auto-renewal\necho \u0026quot;0 12 * * * /usr/bin/certbot renew --quiet\u0026quot; | sudo crontab -\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"selinux-configuration-rhel-based-systems\" class=\"mobile-header\"\u003eSELinux Configuration (RHEL-based systems)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Allow nginx to connect to Mastodon services\nsudo setsebool -P httpd_can_network_connect 1\n\n# Set SELinux contexts for Mastodon files\nsudo semanage fcontext -a -t httpd_exec_t \u0026quot;/home/mastodon/live/public(/.*)?\u0026quot;\nsudo restorecon -R /home/mastodon/live/public/\n\n# Allow Mastodon to bind to required ports\nsudo semanage port -a -t http_port_t -p tcp 3000\nsudo semanage port -a -t http_port_t -p tcp 4000\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"performance-tuning\" class=\"mobile-header\"\u003ePerformance Tuning\u003c/h2\u003e\n\u003ch3 id=\"postgresql-optimization\" class=\"mobile-header\"\u003ePostgreSQL Optimization\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eEdit \u003ccode class=\"mobile-inline-code\"\u003e/var/lib/pgsql/15/data/postgresql.conf\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e# Memory settings (adjust based on available RAM)\nshared_buffers = 256MB                 # 1/4 of RAM\neffective_cache_size = 1GB            # 3/4 of RAM\nwork_mem = 4MB                        # RAM/max_connections/4\nmaintenance_work_mem = 64MB           # RAM/16\n\n# Connection settings\nmax_connections = 100\nsuperuser_reserved_connections = 3\n\n# WAL settings for better performance\nwal_buffers = 16MB\ncheckpoint_completion_target = 0.7\ncheckpoint_timeout = 5min\nmax_wal_size = 1GB\nmin_wal_size = 80MB\n\n# Query optimization\nrandom_page_cost = 1.1                # For SSD storage\neffective_io_concurrency = 200        # For SSD storage\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"redis-optimization\" class=\"mobile-header\"\u003eRedis Optimization\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eEdit \u003ccode class=\"mobile-inline-code\"\u003e/etc/redis/redis.conf\u003c/code\u003e or \u003ccode class=\"mobile-inline-code\"\u003e/etc/redis.conf\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e# Memory optimization\nmaxmemory 256mb\nmaxmemory-policy allkeys-lru\n\n# Persistence (adjust based on needs)\nsave 900 1\nsave 300 10\nsave 60 10000\n\n# Network optimization\ntcp-keepalive 300\ntimeout 0\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"rubyrails-optimization\" class=\"mobile-header\"\u003eRuby/Rails Optimization\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eEdit \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/.env.production\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Database connection pooling\nDB_POOL=25\n\n# Sidekiq concurrency\nSIDEKIQ_CONCURRENCY=25\n\n# Puma workers (number of CPU cores)\nWEB_CONCURRENCY=4\nMAX_THREADS=5\n\n# Streaming cluster\nSTREAMING_CLUSTER_NUM=4\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"system-level-optimization\" class=\"mobile-header\"\u003eSystem-level Optimization\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Increase file descriptors limit\necho \u0026quot;mastodon soft nofile 65536\u0026quot; | sudo tee -a /etc/security/limits.conf\necho \u0026quot;mastodon hard nofile 65536\u0026quot; | sudo tee -a /etc/security/limits.conf\n\n# Optimize kernel parameters\nsudo tee -a /etc/sysctl.conf \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\n# Network optimization\nnet.core.somaxconn = 1024\nnet.core.netdev_max_backlog = 5000\nnet.ipv4.tcp_max_syn_backlog = 1024\nnet.ipv4.tcp_keepalive_time = 120\nnet.ipv4.tcp_keepalive_intvl = 30\nnet.ipv4.tcp_keepalive_probes = 3\n\n# Memory optimization\nvm.swappiness = 10\nvm.dirty_ratio = 15\nvm.dirty_background_ratio = 5\nEOF\n\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-and-restore\" class=\"mobile-header\"\u003eBackup and Restore\u003c/h2\u003e\n\u003ch3 id=\"database-backup\" class=\"mobile-header\"\u003eDatabase Backup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create backup script\nsudo tee /usr/local/bin/mastodon-backup.sh \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\n#!/bin/bash\n\nBACKUP_DIR=\u0026quot;/backup/mastodon\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\nDB_NAME=\u0026quot;mastodon_production\u0026quot;\nMEDIA_DIR=\u0026quot;/home/mastodon/live/public/system\u0026quot;\n\n# Create backup directory\nmkdir -p \u0026quot;$BACKUP_DIR\u0026quot;\n\n# Database backup\nsudo -u postgres pg_dump \u0026quot;$DB_NAME\u0026quot; | gzip \u0026gt; \u0026quot;$BACKUP_DIR/db_${DATE}.sql.gz\u0026quot;\n\n# Media backup (if stored locally)\nif [ -d \u0026quot;$MEDIA_DIR\u0026quot; ]; then\n    tar -czf \u0026quot;$BACKUP_DIR/media_${DATE}.tar.gz\u0026quot; -C \u0026quot;$(dirname \u0026quot;$MEDIA_DIR\u0026quot;)\u0026quot; \u0026quot;$(basename \u0026quot;$MEDIA_DIR\u0026quot;)\u0026quot;\nfi\n\n# Configuration backup\ntar -czf \u0026quot;$BACKUP_DIR/config_${DATE}.tar.gz\u0026quot; /home/mastodon/live/.env.production\n\n# Remove backups older than 30 days\nfind \u0026quot;$BACKUP_DIR\u0026quot; -name \u0026quot;*.gz\u0026quot; -mtime +30 -delete\n\necho \u0026quot;Backup completed: $DATE\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/mastodon-backup.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"automated-backups\" class=\"mobile-header\"\u003eAutomated Backups\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Add to crontab\necho \u0026quot;0 2 * * * /usr/local/bin/mastodon-backup.sh\u0026quot; | sudo crontab -\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"restore-procedure\" class=\"mobile-header\"\u003eRestore Procedure\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Stop Mastodon services\nsudo systemctl stop mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Restore database\nsudo -u postgres dropdb mastodon_production\nsudo -u postgres createdb mastodon_production\nsudo -u postgres psql -c \u0026quot;GRANT ALL PRIVILEGES ON DATABASE mastodon_production TO mastodon;\u0026quot;\ngunzip -c /backup/mastodon/db_YYYYMMDD_HHMMSS.sql.gz | sudo -u postgres psql mastodon_production\n\n# Restore media files (if needed)\nsudo rm -rf /home/mastodon/live/public/system\nsudo tar -xzf /backup/mastodon/media_YYYYMMDD_HHMMSS.tar.gz -C /home/mastodon/live/public/\nsudo chown -R mastodon:mastodon /home/mastodon/live/public/system\n\n# Restore configuration\nsudo tar -xzf /backup/mastodon/config_YYYYMMDD_HHMMSS.tar.gz -C /\n\n# Start services\nsudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"system-requirements\" class=\"mobile-header\"\u003eSystem Requirements\u003c/h2\u003e\n\u003ch3 id=\"minimum-requirements\" class=\"mobile-header\"\u003eMinimum Requirements\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCPU\u003c/strong\u003e: 2 cores, 2.0 GHz\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRAM\u003c/strong\u003e: 4GB\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eStorage\u003c/strong\u003e: 20GB SSD\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork\u003c/strong\u003e: 100 Mbps\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOS\u003c/strong\u003e: Linux (64-bit)\u003c/li\u003e\n\u003ch3 id=\"recommended-production-requirements\" class=\"mobile-header\"\u003eRecommended Production Requirements\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCPU\u003c/strong\u003e: 4+ cores, 2.5+ GHz\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRAM\u003c/strong\u003e: 8GB+ (16GB for large instances)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eStorage\u003c/strong\u003e: 100GB+ SSD with good IOPS\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork\u003c/strong\u003e: 1 Gbps with low latency\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOS\u003c/strong\u003e: Recent Linux distribution with long-term support\u003c/li\u003e\n\u003ch3 id=\"scaling-considerations\" class=\"mobile-header\"\u003eScaling Considerations\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSmall Instance\u003c/strong\u003e: \u003c1,000 users - 2 cores, 4GB RAM, 50GB storage\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eMedium Instance\u003c/strong\u003e: 1,000-10,000 users - 4 cores, 8GB RAM, 200GB storage\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eLarge Instance\u003c/strong\u003e: 10,000+ users - 8+ cores, 16GB+ RAM, 500GB+ storage\u003c/li\u003e\n\u003ch2 id=\"support\" class=\"mobile-header\"\u003eSupport\u003c/h2\u003e\n\u003ch3 id=\"official-resources\" class=\"mobile-header\"\u003eOfficial Resources\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOfficial Website\u003c/strong\u003e: \u003ca href=\"https://joinmastodon.org\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://joinmastodon.org\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDocumentation\u003c/strong\u003e: \u003ca href=\"https://docs.joinmastodon.org\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://docs.joinmastodon.org\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eGitHub Repository\u003c/strong\u003e: \u003ca href=\"https://github.com/mastodon/mastodon\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://github.com/mastodon/mastodon\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eAdmin Documentation\u003c/strong\u003e: \u003ca href=\"https://docs.joinmastodon.org/admin/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://docs.joinmastodon.org/admin/\u003c/a\u003e\u003c/li\u003e\n\u003ch3 id=\"community-support\" class=\"mobile-header\"\u003eCommunity Support\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eMastodon Discord\u003c/strong\u003e: \u003ca href=\"https://discord.gg/mastodon\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://discord.gg/mastodon\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eGitHub Issues\u003c/strong\u003e: \u003ca href=\"https://github.com/mastodon/mastodon/issues\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://github.com/mastodon/mastodon/issues\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eMastodon Community\u003c/strong\u003e: Follow @Mastodon@mastodon.social\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eAdmin Forums\u003c/strong\u003e: Various Mastodon admin communities on the fediverse\u003c/li\u003e\n\u003ch3 id=\"commercial-support\" class=\"mobile-header\"\u003eCommercial Support\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eAvailable from various consulting companies\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eManaged hosting providers offer Mastodon services\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eProfessional services for large deployments\u003c/li\u003e\n\u003ch2 id=\"contributing\" class=\"mobile-header\"\u003eContributing\u003c/h2\u003e\n\u003ch3 id=\"how-to-contribute\" class=\"mobile-header\"\u003eHow to Contribute\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e1. \u003cstrong\u003eReport Bugs\u003c/strong\u003e: Submit issues to \u003ca href=\"https://github.com/mastodon/mastodon/issues\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGitHub\u003c/a\u003e\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e2. \u003cstrong\u003eTranslate\u003c/strong\u003e: Help with internationalization at \u003ca href=\"https://crowdin.com/project/mastodon\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eCrowdin\u003c/a\u003e\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e3. \u003cstrong\u003eCode Contributions\u003c/strong\u003e: Submit pull requests for bug fixes and features\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e4. \u003cstrong\u003eDocumentation\u003c/strong\u003e: Improve documentation and guides\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e5. \u003cstrong\u003eTesting\u003c/strong\u003e: Test release candidates and provide feedback\u003c/p\u003e\n\u003ch3 id=\"development-setup\" class=\"mobile-header\"\u003eDevelopment Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Clone repository\ngit clone https://github.com/mastodon/mastodon.git\ncd mastodon\n\n# Install dependencies\nbundle install\nyarn install\n\n# Setup development database\nrails db:setup\n\n# Run development server\nforeman start\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"contribution-guidelines\" class=\"mobile-header\"\u003eContribution Guidelines\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eFollow Ruby and JavaScript style guides\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eInclude tests for new features\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eUpdate documentation for changes\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eUse conventional commit messages\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eSign commits with GPG key\u003c/li\u003e\n\u003ch2 id=\"license\" class=\"mobile-header\"\u003eLicense\u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eMastodon is licensed under the \u003cstrong\u003eGNU Affero General Public License v3.0 (AGPL-3.0)\u003c/strong\u003e.\u003c/p\u003e\n\u003ch3 id=\"key-license-points\" class=\"mobile-header\"\u003eKey License Points\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eFree to Use\u003c/strong\u003e: Can be used for any purpose\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSource Available\u003c/strong\u003e: Source code must be provided to users\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCopyleft\u003c/strong\u003e: Derivative works must use same license\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork Use\u003c/strong\u003e: AGPL applies to network/web services\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNo Warranty\u003c/strong\u003e: Software provided \"as is\"\u003c/li\u003e\n\u003ch3 id=\"license-compliance\" class=\"mobile-header\"\u003eLicense Compliance\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eKeep license notices intact\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eProvide source code to users\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eDocument any modifications\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eUse same license for derivatives\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eConsider legal requirements for your jurisdiction\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003eFull license text: \u003ca href=\"https://github.com/mastodon/mastodon/blob/main/LICENSE\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://github.com/mastodon/mastodon/blob/main/LICENSE\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"acknowledgments\" class=\"mobile-header\"\u003eAcknowledgments\u003c/h2\u003e\n\u003ch3 id=\"core-team\" class=\"mobile-header\"\u003eCore Team\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eEugen Rochko\u003c/strong\u003e - Creator and lead developer\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eClaire\u003c/strong\u003e - Core maintainer\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRenaud Chaput\u003c/strong\u003e - Core maintainer\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eThibG\u003c/strong\u003e - Significant contributor\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eAnd many other contributors\u003c/li\u003e\n\u003ch3 id=\"technologies-used\" class=\"mobile-header\"\u003eTechnologies Used\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRuby on Rails\u003c/strong\u003e - Web application framework\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ePostgreSQL\u003c/strong\u003e - Primary database\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRedis\u003c/strong\u003e - Caching and job queue\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eReact.js\u003c/strong\u003e - Frontend user interface\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eActivityPub\u003c/strong\u003e - Federation protocol\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSidekiq\u003c/strong\u003e - Background job processing\u003c/li\u003e\n\u003ch3 id=\"community\" class=\"mobile-header\"\u003eCommunity\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eTranslators\u003c/strong\u003e - Making Mastodon available in many languages\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eInstance Administrators\u003c/strong\u003e - Running the fediverse\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eUsers\u003c/strong\u003e - Creating the vibrant community\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eContributors\u003c/strong\u003e - Improving the software\u003c/li\u003e\n\u003ch2 id=\"version-history\" class=\"mobile-header\"\u003eVersion History\u003c/h2\u003e\n\u003ch3 id=\"major-releases\" class=\"mobile-header\"\u003eMajor Releases\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev4.2\u003c/strong\u003e (September 2023) - Enhanced moderation tools, quote posts\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev4.1\u003c/strong\u003e (February 2023) - Improved federation, performance optimizations\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev4.0\u003c/strong\u003e (October 2022) - Major UI overhaul, new features\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.5\u003c/strong\u003e (May 2022) - Content warnings improvements, admin features\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.4\u003c/strong\u003e (October 2021) - Server rules, report improvements\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.3\u003c/strong\u003e (February 2021) - Profile directory, admin announcements\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.2\u003c/strong\u003e (July 2020) - Audio uploads, admin interface improvements\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.1\u003c/strong\u003e (February 2020) - Polls, improved federation\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.0\u003c/strong\u003e (October 2019) - Single column mode, admin dashboard\u003c/li\u003e\n\u003ch3 id=\"current-stable-version\" class=\"mobile-header\"\u003eCurrent Stable Version\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev4.2.x\u003c/strong\u003e - Latest stable release\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eCheck \u003ca href=\"https://github.com/mastodon/mastodon/releases\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGitHub releases\u003c/a\u003e for current version\u003c/li\u003e\n\u003ch3 id=\"upgrade-path\" class=\"mobile-header\"\u003eUpgrade Path\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eAlways backup before upgrading\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFollow official upgrade guides\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eTest in staging environment first\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eMonitor for federation issues after upgrade\u003c/li\u003e\n\u003ch2 id=\"appendices\" class=\"mobile-header\"\u003eAppendices\u003c/h2\u003e\n\u003ch3 id=\"appendix-a-port-reference\" class=\"mobile-header\"\u003eAppendix A: Port Reference\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| Port | Service | Protocol | Description |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e|------|---------|----------|-------------|\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 80 | HTTP | TCP | Web traffic (redirects to HTTPS) |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 443 | HTTPS | TCP | Secure web traffic |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 3000 | Mastodon Web | TCP | Internal web service |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 4000 | Mastodon Streaming | TCP | Real-time updates |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 5432 | PostgreSQL | TCP | Database (internal) |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 6379 | Redis | TCP | Cache and queues (internal) |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 25/587 | SMTP | TCP | Email delivery (outbound) |\u003c/p\u003e\n\u003ch3 id=\"appendix-b-file-locations\" class=\"mobile-header\"\u003eAppendix B: File Locations\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| Path | Description |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e|------|-------------|\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/\u003c/code\u003e | Mastodon application directory |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/.env.production\u003c/code\u003e | Main configuration file |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/public/system/\u003c/code\u003e | Media files storage |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/etc/systemd/system/mastodon-*.service\u003c/code\u003e | Service definitions |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/etc/nginx/sites-available/mastodon\u003c/code\u003e | nginx configuration |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/var/lib/postgresql/*/data/\u003c/code\u003e | PostgreSQL data directory |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/etc/redis/redis.conf\u003c/code\u003e | Redis configuration |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/var/log/nginx/\u003c/code\u003e | nginx logs |\u003c/p\u003e\n\u003ch3 id=\"appendix-c-common-commands\" class=\"mobile-header\"\u003eAppendix C: Common Commands\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Service management\nsudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming\nsudo systemctl restart mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Mastodon maintenance\nsudo -u mastodon bash -c \u0026#039;cd /home/mastodon/live \u0026amp;\u0026amp; RAILS_ENV=production bundle exec rails mastodon:maintenance\u0026#039;\n\n# Database management\nsudo -u postgres psql mastodon_production\n\n# Log monitoring\nsudo journalctl -u mastodon-web -f\nsudo tail -f /var/log/nginx/access.log\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"appendix-d-environment-variables-reference\" class=\"mobile-header\"\u003eAppendix D: Environment Variables Reference\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| Variable | Description | Required |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e|----------|-------------|----------|\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eLOCAL_DOMAIN\u003c/code\u003e | Your Mastodon domain | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eSECRET_KEY_BASE\u003c/code\u003e | Rails secret key | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eOTP_SECRET\u003c/code\u003e | Two-factor authentication secret | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eVAPID_PRIVATE_KEY\u003c/code\u003e | Push notification private key | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eVAPID_PUBLIC_KEY\u003c/code\u003e | Push notification public key | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eDB_HOST\u003c/code\u003e | Database hostname | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eDB_USER\u003c/code\u003e | Database username | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eDB_PASS\u003c/code\u003e | Database password | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eDB_NAME\u003c/code\u003e | Database name | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eREDIS_HOST\u003c/code\u003e | Redis hostname | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eSMTP_SERVER\u003c/code\u003e | SMTP server hostname | Recommended |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eSMTP_FROM_ADDRESS\u003c/code\u003e | From email address | Recommended |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eS3_ENABLED\u003c/code\u003e | Enable S3 storage | No |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eCDN_HOST\u003c/code\u003e | CDN hostname for assets | No |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection. Always refer to official Mastodon documentation for the most up-to-date information.\u003c/p\u003e","readTime":"20 min","wordCount":3905,"tableOfContents":[{"level":2,"text":"Prerequisites","id":"prerequisites"},{"level":3,"text":"Hardware Requirements","id":"hardware-requirements"},{"level":3,"text":"Software Dependencies","id":"software-dependencies"},{"level":3,"text":"Network Requirements","id":"network-requirements"},{"level":3,"text":"System Access","id":"system-access"},{"level":2,"text":"Supported Operating Systems","id":"supported-operating-systems"},{"level":2,"text":"Installation","id":"installation"},{"level":3,"text":"RHEL/CentOS/Rocky Linux/AlmaLinux","id":"rhelcentosrocky-linuxalmalinux"},{"level":3,"text":"Debian/Ubuntu","id":"debianubuntu"},{"level":3,"text":"Arch Linux","id":"arch-linux"},{"level":3,"text":"Alpine Linux","id":"alpine-linux"},{"level":2,"text":"Configuration","id":"configuration"},{"level":3,"text":"Environment Configuration","id":"environment-configuration"},{"level":3,"text":"Manual Environment Configuration","id":"manual-environment-configuration"},{"level":3,"text":"Database Setup","id":"database-setup"},{"level":2,"text":"Service Management","id":"service-management"},{"level":3,"text":"Systemd Service Files (RHEL/Debian/Arch/SUSE)","id":"systemd-service-files-rheldebianarchsuse"},{"level":3,"text":"Enable and Start Services","id":"enable-and-start-services"},{"level":3,"text":"OpenRC Services (Alpine Linux)","id":"openrc-services-alpine-linux"},{"level":2,"text":"Troubleshooting","id":"troubleshooting"},{"level":3,"text":"Common Issues","id":"common-issues"},{"level":2,"text":"Security Considerations","id":"security-considerations"},{"level":3,"text":"Firewall Configuration","id":"firewall-configuration"},{"level":3,"text":"SSL/TLS Configuration with nginx","id":"ssltls-configuration-with-nginx"},{"level":3,"text":"SSL Certificate Setup","id":"ssl-certificate-setup"},{"level":3,"text":"SELinux Configuration (RHEL-based systems)","id":"selinux-configuration-rhel-based-systems"},{"level":2,"text":"Performance Tuning","id":"performance-tuning"},{"level":3,"text":"PostgreSQL Optimization","id":"postgresql-optimization"},{"level":3,"text":"Redis Optimization","id":"redis-optimization"},{"level":3,"text":"Ruby/Rails Optimization","id":"rubyrails-optimization"},{"level":3,"text":"System-level Optimization","id":"system-level-optimization"},{"level":2,"text":"Backup and Restore","id":"backup-and-restore"},{"level":3,"text":"Database Backup","id":"database-backup"},{"level":3,"text":"Automated Backups","id":"automated-backups"},{"level":3,"text":"Restore Procedure","id":"restore-procedure"},{"level":2,"text":"System Requirements","id":"system-requirements"},{"level":3,"text":"Minimum Requirements","id":"minimum-requirements"},{"level":3,"text":"Recommended Production Requirements","id":"recommended-production-requirements"},{"level":3,"text":"Scaling Considerations","id":"scaling-considerations"},{"level":2,"text":"Support","id":"support"},{"level":3,"text":"Official Resources","id":"official-resources"},{"level":3,"text":"Community Support","id":"community-support"},{"level":3,"text":"Commercial Support","id":"commercial-support"},{"level":2,"text":"Contributing","id":"contributing"},{"level":3,"text":"How to Contribute","id":"how-to-contribute"},{"level":3,"text":"Development Setup","id":"development-setup"},{"level":3,"text":"Contribution Guidelines","id":"contribution-guidelines"},{"level":2,"text":"License","id":"license"},{"level":3,"text":"Key License Points","id":"key-license-points"},{"level":3,"text":"License Compliance","id":"license-compliance"},{"level":2,"text":"Acknowledgments","id":"acknowledgments"},{"level":3,"text":"Core Team","id":"core-team"},{"level":3,"text":"Technologies Used","id":"technologies-used"},{"level":3,"text":"Community","id":"community"},{"level":2,"text":"Version History","id":"version-history"},{"level":3,"text":"Major Releases","id":"major-releases"},{"level":3,"text":"Current Stable Version","id":"current-stable-version"},{"level":3,"text":"Upgrade Path","id":"upgrade-path"},{"level":2,"text":"Appendices","id":"appendices"},{"level":3,"text":"Appendix A: Port Reference","id":"appendix-a-port-reference"},{"level":3,"text":"Appendix B: File Locations","id":"appendix-b-file-locations"},{"level":3,"text":"Appendix C: Common Commands","id":"appendix-c-common-commands"},{"level":3,"text":"Appendix D: Environment Variables Reference","id":"appendix-d-environment-variables-reference"}],"lastBuilt":"2025-09-24T06:17:16.301Z","metadataVersion":"2.0"}]},"__N_SSG":true},"page":"/[category]","query":{"category":"communication"},"buildId":"rp-9dFvAw_ZL8L4-4VvdV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
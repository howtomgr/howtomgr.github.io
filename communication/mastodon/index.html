<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/><meta name="theme-color" content="#bd93f9"/><link rel="icon" href="/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><title class="jsx-f92e766e9414ef16">Mastodon Installation Guide Installation Guide - HowToMgr</title><meta name="description" content="Mastodon is a free and open-source decentralized social media platform that serves as an alternative to proprietary platforms like Twitter/X. It&#x27;s part of the fediverse, uses the ActivityPub protocol for federation, and allows users to run their own social media instances with full control over their data and community." class="jsx-f92e766e9414ef16"/><meta name="keywords" content="installation guides, tutorials, linux, docker, kubernetes, mobile-first, responsive" class="jsx-f92e766e9414ef16"/><meta property="og:title" content="Mastodon Installation Guide Installation Guide - HowToMgr" class="jsx-f92e766e9414ef16"/><meta property="og:description" content="Mastodon is a free and open-source decentralized social media platform that serves as an alternative to proprietary platforms like Twitter/X. It&#x27;s part of the fediverse, uses the ActivityPub protocol for federation, and allows users to run their own social media instances with full control over their data and community." class="jsx-f92e766e9414ef16"/><meta property="og:type" content="website" class="jsx-f92e766e9414ef16"/><meta property="og:url" content="https://howtomgr.github.io" class="jsx-f92e766e9414ef16"/><meta property="og:image" content="https://howtomgr.github.io/social-preview.png" class="jsx-f92e766e9414ef16"/><meta property="twitter:card" content="summary_large_image" class="jsx-f92e766e9414ef16"/><meta property="twitter:title" content="Mastodon Installation Guide Installation Guide - HowToMgr" class="jsx-f92e766e9414ef16"/><meta property="twitter:description" content="Mastodon is a free and open-source decentralized social media platform that serves as an alternative to proprietary platforms like Twitter/X. It&#x27;s part of the fediverse, uses the ActivityPub protocol for federation, and allows users to run their own social media instances with full control over their data and community." class="jsx-f92e766e9414ef16"/><meta name="next-head-count" content="17"/><link rel="dns-prefetch" href="//api.github.com"/><link rel="dns-prefetch" href="//github.com"/><link rel="preload" href="/favicon.ico" as="image"/><meta name="application-name" content="HowToMgr"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="default"/><meta name="apple-mobile-web-app-title" content="HowToMgr"/><meta name="format-detection" content="telephone=no"/><meta name="mobile-web-app-capable" content="yes"/><noscript><style>
            .requires-js { display: none !important; }
            .no-js-message { display: block !important; }
          </style></noscript><link rel="preload" href="/_next/static/css/1bcdec54f53826ea.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1bcdec54f53826ea.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-2b1f7a23d657eae4.js" defer=""></script><script src="/_next/static/chunks/main-6ec3f7584970eebe.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f7367f88af207b64.js" defer=""></script><script src="/_next/static/chunks/119-abfbe7c9e22798da.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcategory%5D/%5Bguide%5D-6c4e1300d9466a25.js" defer=""></script><script src="/_next/static/B8uWwZRfnQ6JBvCxPs4zB/_buildManifest.js" defer=""></script><script src="/_next/static/B8uWwZRfnQ6JBvCxPs4zB/_ssgManifest.js" defer=""></script><style id="__jsx-64efd206b36bc2dd">.breadcrumb.jsx-64efd206b36bc2dd{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:var(--space-2);margin-bottom:var(--space-6);font-size:var(--font-sm);color:var(--text-secondary);overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch}.breadcrumb.jsx-64efd206b36bc2dd a.jsx-64efd206b36bc2dd{color:var(--accent-primary);text-decoration:none;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.breadcrumb.jsx-64efd206b36bc2dd a.jsx-64efd206b36bc2dd:hover{text-decoration:underline}.separator.jsx-64efd206b36bc2dd{color:var(--text-muted);-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.current.jsx-64efd206b36bc2dd{color:var(--text-primary);font-weight:500;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.guide-header.jsx-64efd206b36bc2dd{background:var(--bg-secondary);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg);padding:var(--space-6);margin-bottom:var(--space-8);border:1px solid var(--bg-surface)}.guide-title.jsx-64efd206b36bc2dd{color:var(--accent-primary);font-size:var(--font-3xl);margin-bottom:var(--space-4);line-height:1.2;word-break:break-word}.guide-description.jsx-64efd206b36bc2dd{color:var(--text-secondary);font-size:var(--font-lg);margin-bottom:var(--space-5);line-height:1.5}.guide-badges.jsx-64efd206b36bc2dd{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-3);margin-bottom:var(--space-5);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.guide-actions.jsx-64efd206b36bc2dd{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-3);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.difficulty-beginner.jsx-64efd206b36bc2dd{background:var(--accent-secondary);color:var(--bg-primary)}.difficulty-intermediate.jsx-64efd206b36bc2dd{background:var(--accent-warning);color:var(--bg-primary)}.difficulty-advanced.jsx-64efd206b36bc2dd{background:var(--accent-error);color:var(--bg-primary)}.guide-content.jsx-64efd206b36bc2dd{background:var(--bg-secondary);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg);padding:var(--space-6);margin-bottom:var(--space-8);border:1px solid var(--bg-surface);overflow-x:hidden}.related-section.jsx-64efd206b36bc2dd{margin-bottom:var(--space-8)}.section-title.jsx-64efd206b36bc2dd{color:var(--accent-primary);font-size:var(--font-2xl);text-align:center;margin-bottom:var(--space-6)}.guide-navigation.jsx-64efd206b36bc2dd{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4);-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-bottom:var(--space-8)}.loading-container.jsx-64efd206b36bc2dd,.error-container.jsx-64efd206b36bc2dd{text-align:center;padding:var(--space-8)}.error-actions.jsx-64efd206b36bc2dd{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4);-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:var(--space-6);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.toc-level-1.jsx-64efd206b36bc2dd{font-weight:600}.toc-level-2.jsx-64efd206b36bc2dd{margin-left:var(--space-4)}.toc-level-3.jsx-64efd206b36bc2dd{margin-left:var(--space-8);font-size:var(--font-xs)}@media(max-width:767px){.guide-header.jsx-64efd206b36bc2dd{padding:var(--space-4);margin-bottom:var(--space-6)}.guide-title.jsx-64efd206b36bc2dd{font-size:var(--font-2xl)}.guide-description.jsx-64efd206b36bc2dd{font-size:var(--font-base)}.guide-content.jsx-64efd206b36bc2dd{padding:var(--space-4);margin-bottom:var(--space-6)}.guide-badges.jsx-64efd206b36bc2dd{gap:var(--space-2)}.guide-actions.jsx-64efd206b36bc2dd{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.guide-navigation.jsx-64efd206b36bc2dd{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.breadcrumb.jsx-64efd206b36bc2dd{margin-bottom:var(--space-4)}}</style><style id="__jsx-f92e766e9414ef16">.app-container.jsx-f92e766e9414ef16{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding-top:56px}.main-content.jsx-f92e766e9414ef16{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:var(--space-6)0}.mobile-footer.jsx-f92e766e9414ef16{background:var(--bg-secondary);border-top:1px solid var(--bg-surface);padding:var(--space-6)0;margin-top:auto}.footer-content.jsx-f92e766e9414ef16{text-align:center}.footer-links.jsx-f92e766e9414ef16{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:var(--space-6);margin-bottom:var(--space-4);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.footer-links.jsx-f92e766e9414ef16 a.jsx-f92e766e9414ef16{color:var(--accent-primary);text-decoration:none;font-size:var(--font-sm)}.footer-links.jsx-f92e766e9414ef16 a.jsx-f92e766e9414ef16:hover{color:var(--accent-secondary)}.footer-separator.jsx-f92e766e9414ef16{height:1px;background:var(--bg-surface);margin:var(--space-4)auto;width:200px}.footer-text.jsx-f92e766e9414ef16,.footer-tech.jsx-f92e766e9414ef16{color:var(--text-secondary);font-size:var(--font-sm);margin-bottom:var(--space-2)}.footer-disclaimer.jsx-f92e766e9414ef16{color:var(--text-muted);font-size:var(--font-xs)}.nav-links.jsx-f92e766e9414ef16{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4)}.nav-link.jsx-f92e766e9414ef16{color:var(--text-primary);text-decoration:none;padding:var(--space-2)var(--space-3);-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);font-size:var(--font-sm);font-weight:500;-webkit-transition:var(--transition);-moz-transition:var(--transition);-o-transition:var(--transition);transition:var(--transition);min-height:36px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.nav-link.jsx-f92e766e9414ef16:hover{background:var(--bg-surface);color:var(--accent-primary);text-decoration:none}[data-theme="light"].jsx-f92e766e9414ef16 .theme-icon-dark.jsx-f92e766e9414ef16{display:none}[data-theme="light"].jsx-f92e766e9414ef16 .theme-icon-light.jsx-f92e766e9414ef16{display:inline!important}@media(max-width:767px){.main-content.jsx-f92e766e9414ef16{padding:var(--space-4)0}.footer-links.jsx-f92e766e9414ef16{gap:var(--space-4)}}</style></head><body><noscript><div class="no-js-message" style="padding:1rem;background:#ff5555;color:#f8f8f2;text-align:center;font-size:0.9rem">This site requires JavaScript to function properly. Please enable JavaScript in your browser.</div></noscript><div id="__next"><div class="jsx-f92e766e9414ef16 app-container"><a href="#main-content" class="jsx-f92e766e9414ef16 skip-link">Skip to main content</a><nav class="jsx-f92e766e9414ef16 mobile-nav"><div class="jsx-f92e766e9414ef16 mobile-nav-content"><a class="mobile-brand" href="/"><span role="img" aria-label="Books" class="jsx-f92e766e9414ef16">üìö</span>HowToMgr</a><div class="jsx-f92e766e9414ef16 nav-links"><a class="nav-link" href="/all/">All</a><a class="nav-link" href="/search/">Search</a></div><button aria-label="Toggle theme" title="Switch theme" class="jsx-f92e766e9414ef16 mobile-theme-toggle touch-target"><span class="jsx-f92e766e9414ef16 theme-icon-dark">üåô</span><span style="display:none" class="jsx-f92e766e9414ef16 theme-icon-light">‚òÄÔ∏è</span></button></div></nav><main id="main-content" tabindex="-1" class="jsx-f92e766e9414ef16 main-content"><div class="jsx-f92e766e9414ef16 container"><nav aria-label="Breadcrumb" class="jsx-64efd206b36bc2dd breadcrumb"><a href="/">Home</a><span class="jsx-64efd206b36bc2dd separator">‚Üí</span><a href="/communication/">Communication</a><span class="jsx-64efd206b36bc2dd separator">‚Üí</span><span class="jsx-64efd206b36bc2dd current">Mastodon Installation Guide</span></nav><header class="jsx-64efd206b36bc2dd guide-header"><div class="jsx-64efd206b36bc2dd guide-meta-top"><h1 class="jsx-64efd206b36bc2dd guide-title">Mastodon Installation Guide</h1><p class="jsx-64efd206b36bc2dd guide-description">Mastodon is a free and open-source decentralized social media platform that serves as an alternative to proprietary platforms like Twitter/X. It&#x27;s part of the fediverse, uses the ActivityPub protocol for federation, and allows users to run their own social media instances with full control over their data and community.</p><div class="jsx-64efd206b36bc2dd guide-badges"><span class="jsx-64efd206b36bc2dd mobile-badge mobile-badge-primary">Communication</span><span class="jsx-64efd206b36bc2dd mobile-badge difficulty-advanced">üî¥<!-- --> <!-- -->advanced</span><span class="jsx-64efd206b36bc2dd mobile-badge mobile-badge-info">20 min</span><span class="jsx-64efd206b36bc2dd mobile-badge mobile-badge-secondary">‚è±Ô∏è <!-- -->1-2 hours</span></div><div class="jsx-64efd206b36bc2dd guide-actions"><a href="https://github.com/howtomgr/mastodon" target="_blank" rel="noopener" class="jsx-64efd206b36bc2dd btn btn-secondary">View on GitHub</a></div></div></header><article class="jsx-64efd206b36bc2dd guide-content"><nav class="jsx-64efd206b36bc2dd toc"><h4 class="jsx-64efd206b36bc2dd">Table of Contents</h4><ul class="jsx-64efd206b36bc2dd"><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#prerequisites" class="jsx-64efd206b36bc2dd">Prerequisites</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#hardware-requirements" class="jsx-64efd206b36bc2dd">Hardware Requirements</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#software-dependencies" class="jsx-64efd206b36bc2dd">Software Dependencies</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#network-requirements" class="jsx-64efd206b36bc2dd">Network Requirements</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#system-access" class="jsx-64efd206b36bc2dd">System Access</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#supported-operating-systems" class="jsx-64efd206b36bc2dd">Supported Operating Systems</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#installation" class="jsx-64efd206b36bc2dd">Installation</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#rhelcentosrocky-linuxalmalinux" class="jsx-64efd206b36bc2dd">RHEL/CentOS/Rocky Linux/AlmaLinux</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-epel-and-powertools-repositories" class="jsx-64efd206b36bc2dd">Install EPEL and PowerTools repositories</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-nodejs-repository" class="jsx-64efd206b36bc2dd">Install Node.js repository</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-yarn-repository" class="jsx-64efd206b36bc2dd">Install Yarn repository</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-postgresql-repository-for-latest-version" class="jsx-64efd206b36bc2dd">Install PostgreSQL repository (for latest version)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-required-packages" class="jsx-64efd206b36bc2dd">Install required packages</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#initialize-postgresql" class="jsx-64efd206b36bc2dd">Initialize PostgreSQL</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#configure-postgresql" class="jsx-64efd206b36bc2dd">Configure PostgreSQL</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#create-mastodon-user" class="jsx-64efd206b36bc2dd">Create mastodon user</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-ruby-using-rbenv-for-version-management" class="jsx-64efd206b36bc2dd">Install Ruby (using rbenv for version management)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#clone-mastodon" class="jsx-64efd206b36bc2dd">Clone Mastodon</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-ruby-dependencies" class="jsx-64efd206b36bc2dd">Install Ruby dependencies</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-nodejs-dependencies" class="jsx-64efd206b36bc2dd">Install Node.js dependencies</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#debianubuntu" class="jsx-64efd206b36bc2dd">Debian/Ubuntu</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#update-package-list" class="jsx-64efd206b36bc2dd">Update package list</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-curl-and-gnupg-if-not-already-installed" class="jsx-64efd206b36bc2dd">Install curl and gnupg (if not already installed)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#add-nodejs-repository" class="jsx-64efd206b36bc2dd">Add Node.js repository</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#add-yarn-repository" class="jsx-64efd206b36bc2dd">Add Yarn repository</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#add-postgresql-repository-for-latest-version" class="jsx-64efd206b36bc2dd">Add PostgreSQL repository (for latest version)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#update-package-list" class="jsx-64efd206b36bc2dd">Update package list</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-required-packages" class="jsx-64efd206b36bc2dd">Install required packages</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#start-and-enable-services" class="jsx-64efd206b36bc2dd">Start and enable services</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#configure-postgresql" class="jsx-64efd206b36bc2dd">Configure PostgreSQL</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#create-mastodon-user" class="jsx-64efd206b36bc2dd">Create mastodon user</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-ruby-using-rbenv" class="jsx-64efd206b36bc2dd">Install Ruby (using rbenv)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#clone-mastodon" class="jsx-64efd206b36bc2dd">Clone Mastodon</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-dependencies" class="jsx-64efd206b36bc2dd">Install dependencies</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#arch-linux" class="jsx-64efd206b36bc2dd">Arch Linux</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#update-system" class="jsx-64efd206b36bc2dd">Update system</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-required-packages" class="jsx-64efd206b36bc2dd">Install required packages</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#initialize-postgresql" class="jsx-64efd206b36bc2dd">Initialize PostgreSQL</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#configure-postgresql" class="jsx-64efd206b36bc2dd">Configure PostgreSQL</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#create-mastodon-user" class="jsx-64efd206b36bc2dd">Create mastodon user</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-ruby-using-rbenv" class="jsx-64efd206b36bc2dd">Install Ruby using rbenv</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#clone-and-setup-mastodon" class="jsx-64efd206b36bc2dd">Clone and setup Mastodon</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-dependencies" class="jsx-64efd206b36bc2dd">Install dependencies</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#alpine-linux" class="jsx-64efd206b36bc2dd">Alpine Linux</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#update-package-index" class="jsx-64efd206b36bc2dd">Update package index</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-required-packages" class="jsx-64efd206b36bc2dd">Install required packages</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#initialize-and-start-services" class="jsx-64efd206b36bc2dd">Initialize and start services</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#configure-postgresql" class="jsx-64efd206b36bc2dd">Configure PostgreSQL</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#create-mastodon-user" class="jsx-64efd206b36bc2dd">Create mastodon user</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-ruby-using-rbenv" class="jsx-64efd206b36bc2dd">Install Ruby using rbenv</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#clone-and-setup-mastodon" class="jsx-64efd206b36bc2dd">Clone and setup Mastodon</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-dependencies" class="jsx-64efd206b36bc2dd">Install dependencies</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#configuration" class="jsx-64efd206b36bc2dd">Configuration</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#environment-configuration" class="jsx-64efd206b36bc2dd">Environment Configuration</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#switch-to-mastodon-user" class="jsx-64efd206b36bc2dd">Switch to mastodon user</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#navigate-to-mastodon-directory" class="jsx-64efd206b36bc2dd">Navigate to Mastodon directory</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#generate-configuration" class="jsx-64efd206b36bc2dd">Generate configuration</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#manual-environment-configuration" class="jsx-64efd206b36bc2dd">Manual Environment Configuration</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#create-environment-file" class="jsx-64efd206b36bc2dd">Create environment file</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#federation" class="jsx-64efd206b36bc2dd">Federation</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#redis" class="jsx-64efd206b36bc2dd">Redis</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#postgresql" class="jsx-64efd206b36bc2dd">PostgreSQL</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#elasticsearch-optional-for-full-text-search" class="jsx-64efd206b36bc2dd">ElasticSearch (optional, for full-text search)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#es_enabledtrue" class="jsx-64efd206b36bc2dd">ES_ENABLED=true</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#es_hostlocalhost" class="jsx-64efd206b36bc2dd">ES_HOST=localhost</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#es_port9200" class="jsx-64efd206b36bc2dd">ES_PORT=9200</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#secrets" class="jsx-64efd206b36bc2dd">Secrets</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#generate-with-bundle-exec-rake-secret" class="jsx-64efd206b36bc2dd">Generate with: bundle exec rake secret</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#vapid-keys-for-push-notifications" class="jsx-64efd206b36bc2dd">VAPID keys (for push notifications)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#generate-with-bundle-exec-rake-mastodonwebpushgenerate_vapid_key" class="jsx-64efd206b36bc2dd">Generate with: bundle exec rake mastodon:webpush:generate_vapid_key</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#sending-mail" class="jsx-64efd206b36bc2dd">Sending mail</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#file-storage-local" class="jsx-64efd206b36bc2dd">File storage (local)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#optional-s3compatible-storage" class="jsx-64efd206b36bc2dd">Optional S3/compatible storage</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#s3_enabledtrue" class="jsx-64efd206b36bc2dd">S3_ENABLED=true</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#s3_bucketmastodon" class="jsx-64efd206b36bc2dd">S3_BUCKET=mastodon</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#aws_access_key_id" class="jsx-64efd206b36bc2dd">AWS_ACCESS_KEY_ID=</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#aws_secret_access_key" class="jsx-64efd206b36bc2dd">AWS_SECRET_ACCESS_KEY=</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#s3_regionus-east-1" class="jsx-64efd206b36bc2dd">S3_REGION=us-east-1</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#s3_hostnames3amazonawscom" class="jsx-64efd206b36bc2dd">S3_HOSTNAME=s3.amazonaws.com</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#optional-cdn" class="jsx-64efd206b36bc2dd">Optional CDN</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#cdn_hostassetsexamplecom" class="jsx-64efd206b36bc2dd">CDN_HOST=assets.example.com</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#streaming" class="jsx-64efd206b36bc2dd">Streaming</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#advanced-settings" class="jsx-64efd206b36bc2dd">Advanced settings</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#database-setup" class="jsx-64efd206b36bc2dd">Database Setup</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#switch-to-mastodon-user-and-setup-database" class="jsx-64efd206b36bc2dd">Switch to mastodon user and setup database</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#create-database" class="jsx-64efd206b36bc2dd">Create database</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#compile-assets" class="jsx-64efd206b36bc2dd">Compile assets</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#service-management" class="jsx-64efd206b36bc2dd">Service Management</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#systemd-service-files-rheldebianarchsuse" class="jsx-64efd206b36bc2dd">Systemd Service Files (RHEL/Debian/Arch/SUSE)</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#enable-and-start-services" class="jsx-64efd206b36bc2dd">Enable and Start Services</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#reload-systemd-and-enable-services" class="jsx-64efd206b36bc2dd">Reload systemd and enable services</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#check-status" class="jsx-64efd206b36bc2dd">Check status</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#openrc-services-alpine-linux" class="jsx-64efd206b36bc2dd">OpenRC Services (Alpine Linux)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#make-executable" class="jsx-64efd206b36bc2dd">Make executable</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#enable-and-start" class="jsx-64efd206b36bc2dd">Enable and start</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#troubleshooting" class="jsx-64efd206b36bc2dd">Troubleshooting</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#common-issues" class="jsx-64efd206b36bc2dd">Common Issues</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#ensure-proper-rbenv-setup" class="jsx-64efd206b36bc2dd">Ensure proper rbenv setup</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#reinstall-gems-if-needed" class="jsx-64efd206b36bc2dd">Reinstall gems if needed</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#test-postgresql-connection" class="jsx-64efd206b36bc2dd">Test PostgreSQL connection</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#check-postgresql-logs" class="jsx-64efd206b36bc2dd">Check PostgreSQL logs</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#verify-database-configuration" class="jsx-64efd206b36bc2dd">Verify database configuration</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#in-console-activerecordbaseconnection" class="jsx-64efd206b36bc2dd">In console: ActiveRecord::Base.connection</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#clear-and-recompile-assets" class="jsx-64efd206b36bc2dd">Clear and recompile assets</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#check-service-logs" class="jsx-64efd206b36bc2dd">Check service logs</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#check-for-port-conflicts" class="jsx-64efd206b36bc2dd">Check for port conflicts</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#verify-file-permissions" class="jsx-64efd206b36bc2dd">Verify file permissions</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#security-considerations" class="jsx-64efd206b36bc2dd">Security Considerations</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#firewall-configuration" class="jsx-64efd206b36bc2dd">Firewall Configuration</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#open-required-ports" class="jsx-64efd206b36bc2dd">Open required ports</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#configure-firewall" class="jsx-64efd206b36bc2dd">Configure firewall</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#basic-firewall-rules" class="jsx-64efd206b36bc2dd">Basic firewall rules</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#ssltls-configuration-with-nginx" class="jsx-64efd206b36bc2dd">SSL/TLS Configuration with nginx</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#ssl-certificate-setup" class="jsx-64efd206b36bc2dd">SSL Certificate Setup</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-certbot" class="jsx-64efd206b36bc2dd">Install Certbot</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#rhelcentosfedora" class="jsx-64efd206b36bc2dd">RHEL/CentOS/Fedora</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#debianubuntu" class="jsx-64efd206b36bc2dd">Debian/Ubuntu</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#arch-linux" class="jsx-64efd206b36bc2dd">Arch Linux</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#obtain-certificate" class="jsx-64efd206b36bc2dd">Obtain certificate</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#auto-renewal" class="jsx-64efd206b36bc2dd">Auto-renewal</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#selinux-configuration-rhel-based-systems" class="jsx-64efd206b36bc2dd">SELinux Configuration (RHEL-based systems)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#allow-nginx-to-connect-to-mastodon-services" class="jsx-64efd206b36bc2dd">Allow nginx to connect to Mastodon services</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#set-selinux-contexts-for-mastodon-files" class="jsx-64efd206b36bc2dd">Set SELinux contexts for Mastodon files</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#allow-mastodon-to-bind-to-required-ports" class="jsx-64efd206b36bc2dd">Allow Mastodon to bind to required ports</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#performance-tuning" class="jsx-64efd206b36bc2dd">Performance Tuning</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#postgresql-optimization" class="jsx-64efd206b36bc2dd">PostgreSQL Optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#memory-settings-adjust-based-on-available-ram" class="jsx-64efd206b36bc2dd">Memory settings (adjust based on available RAM)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#connection-settings" class="jsx-64efd206b36bc2dd">Connection settings</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#wal-settings-for-better-performance" class="jsx-64efd206b36bc2dd">WAL settings for better performance</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#query-optimization" class="jsx-64efd206b36bc2dd">Query optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#redis-optimization" class="jsx-64efd206b36bc2dd">Redis Optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#memory-optimization" class="jsx-64efd206b36bc2dd">Memory optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#persistence-adjust-based-on-needs" class="jsx-64efd206b36bc2dd">Persistence (adjust based on needs)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#network-optimization" class="jsx-64efd206b36bc2dd">Network optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#rubyrails-optimization" class="jsx-64efd206b36bc2dd">Ruby/Rails Optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#database-connection-pooling" class="jsx-64efd206b36bc2dd">Database connection pooling</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#sidekiq-concurrency" class="jsx-64efd206b36bc2dd">Sidekiq concurrency</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#puma-workers-number-of-cpu-cores" class="jsx-64efd206b36bc2dd">Puma workers (number of CPU cores)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#streaming-cluster" class="jsx-64efd206b36bc2dd">Streaming cluster</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#system-level-optimization" class="jsx-64efd206b36bc2dd">System-level Optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#increase-file-descriptors-limit" class="jsx-64efd206b36bc2dd">Increase file descriptors limit</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#optimize-kernel-parameters" class="jsx-64efd206b36bc2dd">Optimize kernel parameters</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#network-optimization" class="jsx-64efd206b36bc2dd">Network optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#memory-optimization" class="jsx-64efd206b36bc2dd">Memory optimization</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#backup-and-restore" class="jsx-64efd206b36bc2dd">Backup and Restore</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#database-backup" class="jsx-64efd206b36bc2dd">Database Backup</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#create-backup-script" class="jsx-64efd206b36bc2dd">Create backup script</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#create-backup-directory" class="jsx-64efd206b36bc2dd">Create backup directory</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#database-backup" class="jsx-64efd206b36bc2dd">Database backup</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#media-backup-if-stored-locally" class="jsx-64efd206b36bc2dd">Media backup (if stored locally)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#configuration-backup" class="jsx-64efd206b36bc2dd">Configuration backup</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#remove-backups-older-than-30-days" class="jsx-64efd206b36bc2dd">Remove backups older than 30 days</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#automated-backups" class="jsx-64efd206b36bc2dd">Automated Backups</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#add-to-crontab" class="jsx-64efd206b36bc2dd">Add to crontab</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#restore-procedure" class="jsx-64efd206b36bc2dd">Restore Procedure</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#stop-mastodon-services" class="jsx-64efd206b36bc2dd">Stop Mastodon services</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#restore-database" class="jsx-64efd206b36bc2dd">Restore database</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#restore-media-files-if-needed" class="jsx-64efd206b36bc2dd">Restore media files (if needed)</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#restore-configuration" class="jsx-64efd206b36bc2dd">Restore configuration</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#start-services" class="jsx-64efd206b36bc2dd">Start services</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#system-requirements" class="jsx-64efd206b36bc2dd">System Requirements</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#minimum-requirements" class="jsx-64efd206b36bc2dd">Minimum Requirements</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#recommended-production-requirements" class="jsx-64efd206b36bc2dd">Recommended Production Requirements</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#scaling-considerations" class="jsx-64efd206b36bc2dd">Scaling Considerations</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#support" class="jsx-64efd206b36bc2dd">Support</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#official-resources" class="jsx-64efd206b36bc2dd">Official Resources</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#community-support" class="jsx-64efd206b36bc2dd">Community Support</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#commercial-support" class="jsx-64efd206b36bc2dd">Commercial Support</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#contributing" class="jsx-64efd206b36bc2dd">Contributing</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#how-to-contribute" class="jsx-64efd206b36bc2dd">How to Contribute</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#development-setup" class="jsx-64efd206b36bc2dd">Development Setup</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#clone-repository" class="jsx-64efd206b36bc2dd">Clone repository</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#install-dependencies" class="jsx-64efd206b36bc2dd">Install dependencies</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#setup-development-database" class="jsx-64efd206b36bc2dd">Setup development database</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#run-development-server" class="jsx-64efd206b36bc2dd">Run development server</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#contribution-guidelines" class="jsx-64efd206b36bc2dd">Contribution Guidelines</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#license" class="jsx-64efd206b36bc2dd">License</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#key-license-points" class="jsx-64efd206b36bc2dd">Key License Points</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#license-compliance" class="jsx-64efd206b36bc2dd">License Compliance</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#acknowledgments" class="jsx-64efd206b36bc2dd">Acknowledgments</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#core-team" class="jsx-64efd206b36bc2dd">Core Team</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#technologies-used" class="jsx-64efd206b36bc2dd">Technologies Used</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#community" class="jsx-64efd206b36bc2dd">Community</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#version-history" class="jsx-64efd206b36bc2dd">Version History</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#major-releases" class="jsx-64efd206b36bc2dd">Major Releases</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#current-stable-version" class="jsx-64efd206b36bc2dd">Current Stable Version</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#upgrade-path" class="jsx-64efd206b36bc2dd">Upgrade Path</a></li><li class="jsx-64efd206b36bc2dd toc-level-2"><a href="#appendices" class="jsx-64efd206b36bc2dd">Appendices</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#appendix-a-port-reference" class="jsx-64efd206b36bc2dd">Appendix A: Port Reference</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#appendix-b-file-locations" class="jsx-64efd206b36bc2dd">Appendix B: File Locations</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#appendix-c-common-commands" class="jsx-64efd206b36bc2dd">Appendix C: Common Commands</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#service-management" class="jsx-64efd206b36bc2dd">Service management</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#mastodon-maintenance" class="jsx-64efd206b36bc2dd">Mastodon maintenance</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#database-management" class="jsx-64efd206b36bc2dd">Database management</a></li><li class="jsx-64efd206b36bc2dd toc-level-1"><a href="#log-monitoring" class="jsx-64efd206b36bc2dd">Log monitoring</a></li><li class="jsx-64efd206b36bc2dd toc-level-3"><a href="#appendix-d-environment-variables-reference" class="jsx-64efd206b36bc2dd">Appendix D: Environment Variables Reference</a></li></ul></nav><div class="jsx-64efd206b36bc2dd readme-content"><p class="mobile-paragraph">Mastodon is a free, open-source federated social network server that provides a decentralized alternative to proprietary platforms like Twitter/X. Built on Ruby on Rails and using ActivityPub protocol, Mastodon allows users to run their own social media instance while connecting to the broader fediverse.</p>
<h2 id="prerequisites" class="mobile-header">Prerequisites</h2>
<h3 id="hardware-requirements" class="mobile-header">Hardware Requirements</h3>
<li class="mobile-list-item"><strong>CPU</strong>: 2+ cores (4+ cores recommended for production)</li>
<li class="mobile-list-item"><strong>RAM</strong>: 4GB minimum (8GB+ recommended for production)</li>
<li class="mobile-list-item"><strong>Storage</strong>: 20GB minimum (SSD recommended, scale based on media storage needs)</li>
<li class="mobile-list-item"><strong>Network</strong>: Reliable internet connection with public IP (for federation)</li>
<h3 id="software-dependencies" class="mobile-header">Software Dependencies</h3>
<li class="mobile-list-item"><strong>Operating System</strong>: Linux (RHEL-based, Debian-based, Arch Linux, Alpine Linux)</li>
<li class="mobile-list-item"><strong>Database</strong>: PostgreSQL 12+ (PostgreSQL 15+ recommended)</li>
<li class="mobile-list-item"><strong>Cache/Queue</strong>: Redis 6.0+</li>
<li class="mobile-list-item"><strong>Runtime</strong>: Ruby 3.0+ (Ruby 3.2+ recommended)</li>
<li class="mobile-list-item"><strong>Web Server</strong>: nginx or Apache (for reverse proxy)</li>
<li class="mobile-list-item"><strong>SSL Certificate</strong>: Let's Encrypt or commercial certificate</li>
<li class="mobile-list-item"><strong>Node.js</strong>: 16+ (for asset compilation)</li>
<li class="mobile-list-item"><strong>Yarn</strong>: Package manager for Node.js dependencies</li>
<h3 id="network-requirements" class="mobile-header">Network Requirements</h3>
<li class="mobile-list-item"><strong>Ports</strong>: </li>
<li class="mobile-list-item">80/443 (HTTP/HTTPS)</li>
<li class="mobile-list-item">25/587 (SMTP - for email delivery)</li>
<li class="mobile-list-item">3000 (Mastodon web interface)</li>
<li class="mobile-list-item">4000 (Mastodon streaming API)</li>
<li class="mobile-list-item"><strong>Domain</strong>: Registered domain name with DNS control</li>
<li class="mobile-list-item"><strong>Email</strong>: SMTP server for notifications and user registration</li>
<h3 id="system-access" class="mobile-header">System Access</h3>
<li class="mobile-list-item">Root or sudo access required for installation</li>
<li class="mobile-list-item">Dedicated user account for Mastodon service</li>
<li class="mobile-list-item">Firewall configuration access</li>
<h2 id="supported-operating-systems" class="mobile-header">Supported Operating Systems</h2>
<p class="mobile-paragraph">This guide supports installation on:</p>
<li class="mobile-list-item"><strong>RHEL-based</strong>: RHEL 8/9, CentOS Stream 8/9, Rocky Linux 8/9, AlmaLinux 8/9, Fedora 37+</li>
<li class="mobile-list-item"><strong>Debian-based</strong>: Debian 11/12, Ubuntu 20.04/22.04/24.04 LTS</li>
<li class="mobile-list-item"><strong>Arch Linux</strong>: Arch Linux (rolling), Manjaro</li>
<li class="mobile-list-item"><strong>Alpine Linux</strong>: 3.18+ (containerized deployments)</li>
<li class="mobile-list-item"><strong>macOS</strong>: 12+ (development only)</li>
<li class="mobile-list-item"><strong>FreeBSD</strong>: 13.0+ (experimental)</li>
<h2 id="installation" class="mobile-header">Installation</h2>
<h3 id="rhelcentosrocky-linuxalmalinux" class="mobile-header">RHEL/CentOS/Rocky Linux/AlmaLinux</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install EPEL and PowerTools repositories
sudo dnf install -y epel-release
sudo dnf config-manager --set-enabled powertools  # CentOS Stream 8
sudo dnf config-manager --set-enabled crb         # CentOS Stream 9, Rocky, AlmaLinux

# Install Node.js repository
curl -fsSL https://rpm.nodesource.com/setup_lts.x | sudo bash -

# Install Yarn repository
curl -sL https://dl.yarnpkg.com/rpm/yarn.repo | sudo tee /etc/yum.repos.d/yarn.repo

# Install PostgreSQL repository (for latest version)
sudo dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-$(rpm -E %{rhel})-x86_64/pgdg-redhat-repo-latest.noarch.rpm

# Install required packages
sudo dnf install -y \
    git curl wget gnupg2 \
    gcc gcc-c++ make automake autoconf libtool \
    postgresql15-server postgresql15-devel \
    redis \
    nodejs yarn \
    nginx \
    ImageMagick ImageMagick-devel \
    ffmpeg \
    libxml2-devel libxslt-devel \
    libidn-devel \
    openssl-devel \
    readline-devel \
    zlib-devel \
    libyaml-devel \
    gdbm-devel \
    ncurses-devel \
    libffi-devel

# Initialize PostgreSQL
sudo postgresql-15-setup initdb
sudo systemctl enable --now postgresql-15 redis

# Configure PostgreSQL
sudo -u postgres createuser mastodon --createdb
sudo -u postgres psql -c &quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD &#039;secure_random_password_here&#039;;&quot;

# Create mastodon user
sudo useradd -m -s /bin/bash mastodon
sudo usermod -a -G mastodon nginx

# Install Ruby (using rbenv for version management)
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon
git clone https://github.com/rbenv/rbenv.git ~/.rbenv
echo &#039;export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;&#039; &gt;&gt; ~/.bashrc
echo &#039;eval &quot;$(rbenv init -)&quot;&#039; &gt;&gt; ~/.bashrc
git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
rbenv install 3.2.2
rbenv global 3.2.2
gem install bundler
EOF

# Clone Mastodon
sudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live
cd /home/mastodon/live
sudo -u mastodon git checkout $(git tag -l | grep -v &#039;rc&#039; | sort -V | tail -n 1)

# Install Ruby dependencies
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
bundle config deployment &#039;true&#039;
bundle config without &#039;development test&#039;
bundle install
EOF

# Install Node.js dependencies
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
yarn install --pure-lockfile
EOF</code></pre>
      </div>
    </div>
<h3 id="debianubuntu" class="mobile-header">Debian/Ubuntu</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Update package list
sudo apt update

# Install curl and gnupg (if not already installed)
sudo apt install -y curl gnupg

# Add Node.js repository
curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -

# Add Yarn repository
curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
echo &quot;deb https://dl.yarnpkg.com/debian/ stable main&quot; | sudo tee /etc/apt/sources.list.d/yarn.list

# Add PostgreSQL repository (for latest version)
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -
echo &quot;deb http://apt.postgresql.org/pub/repos/apt/ $(lsb_release -cs)-pgdg main&quot; | sudo tee /etc/apt/sources.list.d/pgdg.list

# Update package list
sudo apt update

# Install required packages
sudo apt install -y \
    git curl wget gnupg \
    build-essential \
    postgresql-15 postgresql-contrib-15 postgresql-server-dev-15 \
    redis-server \
    nodejs yarn \
    nginx \
    imagemagick ffmpeg \
    libxml2-dev libxslt1-dev \
    libidn11-dev \
    libssl-dev \
    libreadline-dev \
    zlib1g-dev \
    libyaml-dev \
    libgdbm-dev \
    libncurses5-dev \
    libffi-dev \
    libpq-dev

# Start and enable services
sudo systemctl enable --now postgresql redis-server

# Configure PostgreSQL
sudo -u postgres createuser mastodon --createdb
sudo -u postgres psql -c &quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD &#039;secure_random_password_here&#039;;&quot;

# Create mastodon user
sudo useradd -m -s /bin/bash mastodon
sudo usermod -a -G mastodon www-data

# Install Ruby (using rbenv)
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon
git clone https://github.com/rbenv/rbenv.git ~/.rbenv
echo &#039;export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;&#039; &gt;&gt; ~/.bashrc
echo &#039;eval &quot;$(rbenv init -)&quot;&#039; &gt;&gt; ~/.bashrc
git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
rbenv install 3.2.2
rbenv global 3.2.2
gem install bundler
EOF

# Clone Mastodon
sudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live
cd /home/mastodon/live
sudo -u mastodon git checkout $(git tag -l | grep -v &#039;rc&#039; | sort -V | tail -n 1)

# Install dependencies
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
bundle config deployment &#039;true&#039;
bundle config without &#039;development test&#039;
bundle install
yarn install --pure-lockfile
EOF</code></pre>
      </div>
    </div>
<h3 id="arch-linux" class="mobile-header">Arch Linux</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Update system
sudo pacman -Syu

# Install required packages
sudo pacman -S --needed \
    git curl wget gnupg \
    base-devel \
    postgresql redis \
    nodejs npm yarn \
    nginx \
    imagemagick ffmpeg \
    libxml2 libxslt \
    libidn \
    openssl \
    readline \
    zlib \
    libyaml \
    gdbm \
    ncurses \
    libffi

# Initialize PostgreSQL
sudo -u postgres initdb -D /var/lib/postgres/data
sudo systemctl enable --now postgresql redis

# Configure PostgreSQL
sudo -u postgres createuser mastodon --createdb
sudo -u postgres psql -c &quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD &#039;secure_random_password_here&#039;;&quot;

# Create mastodon user
sudo useradd -m -s /bin/bash mastodon
sudo usermod -a -G mastodon http

# Install Ruby using rbenv
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon
git clone https://github.com/rbenv/rbenv.git ~/.rbenv
echo &#039;export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;&#039; &gt;&gt; ~/.bashrc
echo &#039;eval &quot;$(rbenv init -)&quot;&#039; &gt;&gt; ~/.bashrc
git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
rbenv install 3.2.2
rbenv global 3.2.2
gem install bundler
EOF

# Clone and setup Mastodon
sudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live
cd /home/mastodon/live
sudo -u mastodon git checkout $(git tag -l | grep -v &#039;rc&#039; | sort -V | tail -n 1)

# Install dependencies
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
bundle config deployment &#039;true&#039;
bundle config without &#039;development test&#039;
bundle install
yarn install --pure-lockfile
EOF</code></pre>
      </div>
    </div>
<h3 id="alpine-linux" class="mobile-header">Alpine Linux</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Update package index
apk update

# Install required packages
apk add --no-cache \
    git curl wget gnupg \
    build-base \
    postgresql15 postgresql15-dev postgresql15-contrib \
    redis \
    nodejs npm yarn \
    nginx \
    imagemagick imagemagick-dev ffmpeg \
    libxml2-dev libxslt-dev \
    libidn-dev \
    openssl-dev \
    readline-dev \
    zlib-dev \
    yaml-dev \
    gdbm-dev \
    ncurses-dev \
    libffi-dev

# Initialize and start services
rc-service postgresql setup
rc-service postgresql start
rc-service redis start
rc-update add postgresql
rc-update add redis

# Configure PostgreSQL
sudo -u postgres createuser mastodon --createdb
sudo -u postgres psql -c &quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD &#039;secure_random_password_here&#039;;&quot;

# Create mastodon user
adduser -D -s /bin/ash mastodon
addgroup mastodon nginx

# Install Ruby using rbenv
sudo -u mastodon ash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon
git clone https://github.com/rbenv/rbenv.git ~/.rbenv
echo &#039;export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;&#039; &gt;&gt; ~/.profile
echo &#039;eval &quot;$(rbenv init -)&quot;&#039; &gt;&gt; ~/.profile
git clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
rbenv install 3.2.2
rbenv global 3.2.2
gem install bundler
EOF

# Clone and setup Mastodon
sudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live
cd /home/mastodon/live
sudo -u mastodon git checkout $(git tag -l | grep -v &#039;rc&#039; | sort -V | tail -n 1)

# Install dependencies
sudo -u mastodon ash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
bundle config deployment &#039;true&#039;
bundle config without &#039;development test&#039;
bundle install
yarn install --pure-lockfile
EOF</code></pre>
      </div>
    </div>
<h2 id="configuration" class="mobile-header">Configuration</h2>
<h3 id="environment-configuration" class="mobile-header">Environment Configuration</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Switch to mastodon user
sudo -u mastodon bash

# Navigate to Mastodon directory
cd /home/mastodon/live

# Generate configuration
RAILS_ENV=production bundle exec rake mastodon:setup</code></pre>
      </div>
    </div>
<p class="mobile-paragraph">This interactive setup will prompt for:</p>
<li class="mobile-list-item">Domain name (e.g., mastodon.example.com)</li>
<li class="mobile-list-item">Database configuration</li>
<li class="mobile-list-item">Redis configuration</li>
<li class="mobile-list-item">Email settings (SMTP)</li>
<li class="mobile-list-item">File storage settings</li>
<li class="mobile-list-item">Admin account creation</li>
<h3 id="manual-environment-configuration" class="mobile-header">Manual Environment Configuration</h3>
<p class="mobile-paragraph">If you prefer manual configuration, create <code class="mobile-inline-code">/home/mastodon/live/.env.production</code>:</p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create environment file
sudo -u mastodon tee /home/mastodon/live/.env.production &lt;&lt; &#039;EOF&#039;
# Federation
LOCAL_DOMAIN=mastodon.example.com
WEB_DOMAIN=mastodon.example.com

# Redis
REDIS_HOST=127.0.0.1
REDIS_PORT=6379

# PostgreSQL
DB_HOST=127.0.0.1
DB_USER=mastodon
DB_NAME=mastodon_production
DB_PASS=secure_random_password_here
DB_PORT=5432

# ElasticSearch (optional, for full-text search)
# ES_ENABLED=true
# ES_HOST=localhost
# ES_PORT=9200

# Secrets
# Generate with: bundle exec rake secret
SECRET_KEY_BASE=generate_with_rake_secret
OTP_SECRET=generate_with_rake_secret

# VAPID keys (for push notifications)
# Generate with: bundle exec rake mastodon:webpush:generate_vapid_key
VAPID_PRIVATE_KEY=
VAPID_PUBLIC_KEY=

# Sending mail
SMTP_SERVER=smtp.example.com
SMTP_PORT=587
SMTP_LOGIN=mastodon@example.com
SMTP_PASSWORD=smtp_password
SMTP_FROM_ADDRESS=mastodon@example.com

# File storage (local)
PAPERCLIP_ROOT_PATH=/home/mastodon/live/public/system

# Optional S3/compatible storage
# S3_ENABLED=true
# S3_BUCKET=mastodon
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# S3_REGION=us-east-1
# S3_HOSTNAME=s3.amazonaws.com

# Optional CDN
# CDN_HOST=assets.example.com

# Streaming
STREAMING_CLUSTER_NUM=1
STREAMING_API_BASE_URL=wss://mastodon.example.com

# Advanced settings
MAX_TOOT_CHARS=500
SINGLE_USER_MODE=false
AUTHORIZED_FETCH=false
LIMITED_FEDERATION_MODE=false
EOF</code></pre>
      </div>
    </div>
<h3 id="database-setup" class="mobile-header">Database Setup</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Switch to mastodon user and setup database
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;

# Create database
RAILS_ENV=production bundle exec rails db:create
RAILS_ENV=production bundle exec rails db:schema:load
RAILS_ENV=production bundle exec rails db:seed

# Compile assets
RAILS_ENV=production bundle exec rails assets:precompile
EOF</code></pre>
      </div>
    </div>
<h2 id="service-management" class="mobile-header">Service Management</h2>
<h3 id="systemd-service-files-rheldebianarchsuse" class="mobile-header">Systemd Service Files (RHEL/Debian/Arch/SUSE)</h3>
<p class="mobile-paragraph">Create the web service (<code class="mobile-inline-code">/etc/systemd/system/mastodon-web.service</code>):</p>
<div class="mobile-code-block" data-language="ini">
      <div class="mobile-code-header">
        <span class="mobile-code-language">ini</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-ini">[Unit]
Description=mastodon-web
After=network.target

[Service]
Type=simple
User=mastodon
WorkingDirectory=/home/mastodon/live
Environment=&quot;RAILS_ENV=production&quot;
Environment=&quot;PORT=3000&quot;
ExecStart=/home/mastodon/.rbenv/shims/bundle exec puma -C config/puma.rb
ExecReload=/bin/kill -SIGUSR1 $MAINPID
TimeoutSec=15
Restart=always
RestartSec=10
SyslogIdentifier=mastodon-web

[Install]
WantedBy=multi-user.target</code></pre>
      </div>
    </div>
<p class="mobile-paragraph">Create the background jobs service (<code class="mobile-inline-code">/etc/systemd/system/mastodon-sidekiq.service</code>):</p>
<div class="mobile-code-block" data-language="ini">
      <div class="mobile-code-header">
        <span class="mobile-code-language">ini</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-ini">[Unit]
Description=mastodon-sidekiq
After=network.target

[Service]
Type=simple
User=mastodon
WorkingDirectory=/home/mastodon/live
Environment=&quot;RAILS_ENV=production&quot;
Environment=&quot;DB_POOL=25&quot;
ExecStart=/home/mastodon/.rbenv/shims/bundle exec sidekiq -c 25
TimeoutSec=15
Restart=always
RestartSec=10
SyslogIdentifier=mastodon-sidekiq

[Install]
WantedBy=multi-user.target</code></pre>
      </div>
    </div>
<p class="mobile-paragraph">Create the streaming service (<code class="mobile-inline-code">/etc/systemd/system/mastodon-streaming.service</code>):</p>
<div class="mobile-code-block" data-language="ini">
      <div class="mobile-code-header">
        <span class="mobile-code-language">ini</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-ini">[Unit]
Description=mastodon-streaming
After=network.target

[Service]
Type=simple
User=mastodon
WorkingDirectory=/home/mastodon/live
Environment=&quot;NODE_ENV=production&quot;
Environment=&quot;PORT=4000&quot;
ExecStart=/usr/bin/node streaming
TimeoutSec=15
Restart=always
RestartSec=10
SyslogIdentifier=mastodon-streaming

[Install]
WantedBy=multi-user.target</code></pre>
      </div>
    </div>
<h3 id="enable-and-start-services" class="mobile-header">Enable and Start Services</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Reload systemd and enable services
sudo systemctl daemon-reload
sudo systemctl enable mastodon-web mastodon-sidekiq mastodon-streaming
sudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming

# Check status
sudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming</code></pre>
      </div>
    </div>
<h3 id="openrc-services-alpine-linux" class="mobile-header">OpenRC Services (Alpine Linux)</h3>
<p class="mobile-paragraph">Create <code class="mobile-inline-code">/etc/init.d/mastodon-web</code>:</p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash">#!/sbin/openrc-run

name=&quot;mastodon-web&quot;
description=&quot;Mastodon web service&quot;

user=&quot;mastodon&quot;
group=&quot;mastodon&quot;
directory=&quot;/home/mastodon/live&quot;

command=&quot;/home/mastodon/.rbenv/shims/bundle&quot;
command_args=&quot;exec puma -C config/puma.rb&quot;
command_background=&quot;yes&quot;

pidfile=&quot;/run/${name}.pid&quot;
output_log=&quot;/var/log/${name}.log&quot;
error_log=&quot;/var/log/${name}.error.log&quot;

depend() {
    need net postgresql redis
}

start_pre() {
    export RAILS_ENV=production
    export PORT=3000
}</code></pre>
      </div>
    </div>
<p class="mobile-paragraph">Create similar files for <code class="mobile-inline-code">mastodon-sidekiq</code> and <code class="mobile-inline-code">mastodon-streaming</code>, then:</p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Make executable
sudo chmod +x /etc/init.d/mastodon-*

# Enable and start
sudo rc-update add mastodon-web
sudo rc-update add mastodon-sidekiq  
sudo rc-update add mastodon-streaming
sudo rc-service mastodon-web start
sudo rc-service mastodon-sidekiq start
sudo rc-service mastodon-streaming start</code></pre>
      </div>
    </div>
<h2 id="troubleshooting" class="mobile-header">Troubleshooting</h2>
<h3 id="common-issues" class="mobile-header">Common Issues</h3>
<p class="mobile-paragraph"><strong>Ruby/Bundle Issues:</strong></p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Ensure proper rbenv setup
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
which ruby
ruby --version
EOF

# Reinstall gems if needed
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
bundle install --deployment --without development test
EOF</code></pre>
      </div>
    </div>
<p class="mobile-paragraph"><strong>Database Connection Issues:</strong></p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Test PostgreSQL connection
sudo -u mastodon psql -h localhost -U mastodon mastodon_production

# Check PostgreSQL logs
sudo journalctl -u postgresql-15 -f

# Verify database configuration
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
RAILS_ENV=production bundle exec rails console
# In console: ActiveRecord::Base.connection
EOF</code></pre>
      </div>
    </div>
<p class="mobile-paragraph"><strong>Asset Compilation Issues:</strong></p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Clear and recompile assets
sudo -u mastodon bash &lt;&lt; &#039;EOF&#039;
cd /home/mastodon/live
export PATH=&quot;$HOME/.rbenv/bin:$PATH&quot;
eval &quot;$(rbenv init -)&quot;
RAILS_ENV=production bundle exec rails assets:clobber
RAILS_ENV=production bundle exec rails assets:precompile
EOF</code></pre>
      </div>
    </div>
<p class="mobile-paragraph"><strong>Service Startup Issues:</strong></p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Check service logs
sudo journalctl -u mastodon-web -f
sudo journalctl -u mastodon-sidekiq -f
sudo journalctl -u mastodon-streaming -f

# Check for port conflicts
sudo netstat -tlnp | grep :3000
sudo netstat -tlnp | grep :4000

# Verify file permissions
sudo ls -la /home/mastodon/live/
sudo -u mastodon test -r /home/mastodon/live/.env.production &amp;&amp; echo &quot;Can read env file&quot;</code></pre>
      </div>
    </div>
<h2 id="security-considerations" class="mobile-header">Security Considerations</h2>
<h3 id="firewall-configuration" class="mobile-header">Firewall Configuration</h3>
<p class="mobile-paragraph"><strong>firewalld (RHEL/CentOS/Fedora):</strong></p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Open required ports
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --permanent --add-port=3000/tcp
sudo firewall-cmd --permanent --add-port=4000/tcp
sudo firewall-cmd --reload</code></pre>
      </div>
    </div>
<p class="mobile-paragraph"><strong>ufw (Ubuntu/Debian):</strong></p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Configure firewall
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 3000/tcp
sudo ufw allow 4000/tcp
sudo ufw enable</code></pre>
      </div>
    </div>
<p class="mobile-paragraph"><strong>iptables (Generic):</strong></p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Basic firewall rules
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 3000 -j ACCEPT
sudo iptables -A INPUT -p tcp --dport 4000 -j ACCEPT</code></pre>
      </div>
    </div>
<h3 id="ssltls-configuration-with-nginx" class="mobile-header">SSL/TLS Configuration with nginx</h3>
<p class="mobile-paragraph">Create <code class="mobile-inline-code">/etc/nginx/sites-available/mastodon</code> (Debian/Ubuntu) or <code class="mobile-inline-code">/etc/nginx/conf.d/mastodon.conf</code> (RHEL):</p>
<div class="mobile-code-block" data-language="nginx">
      <div class="mobile-code-header">
        <span class="mobile-code-language">nginx</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-nginx">map $http_upgrade $connection_upgrade {
  default upgrade;
  &#039;&#039;      close;
}

upstream backend {
    server 127.0.0.1:3000 fail_timeout=0;
}

upstream streaming {
    server 127.0.0.1:4000 fail_timeout=0;
}

proxy_cache_path /var/cache/nginx/mastodon keys_zone=CACHE:10m levels=1:2 inactive=7d max_size=1g;

server {
    listen 80;
    listen [::]:80;
    server_name mastodon.example.com;
    root /home/mastodon/live/public;
    location /.well-known/acme-challenge/ { allow all; }
    location / { return 301 https://$host$request_uri; }
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    server_name mastodon.example.com;

    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;
    ssl_prefer_server_ciphers off;
    ssl_session_cache shared:SSL:10m;
    ssl_session_tickets off;

    ssl_certificate     /etc/letsencrypt/live/mastodon.example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/mastodon.example.com/privkey.pem;

    keepalive_timeout    70;
    sendfile             on;
    client_max_body_size 80m;

    root /home/mastodon/live/public;

    gzip on;
    gzip_disable &quot;msie6&quot;;
    gzip_vary on;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/json
        application/javascript
        application/xml+rss
        application/atom+xml
        image/svg+xml;

    add_header Strict-Transport-Security &quot;max-age=31536000&quot; always;

    location / {
        try_files $uri @proxy;
    }

    location ~ ^/(emoji|packs|system/accounts/avatars|system/media_attachments/files) {
        add_header Cache-Control &quot;public, max-age=31536000, immutable&quot;;
        add_header Strict-Transport-Security &quot;max-age=31536000&quot; always;
        try_files $uri @proxy;
    }
    
    location /sw.js {
        add_header Cache-Control &quot;public, max-age=604800, must-revalidate&quot;;
        add_header Strict-Transport-Security &quot;max-age=31536000&quot; always;
        try_files $uri @proxy;
    }

    location @proxy {
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Proxy &quot;&quot;;
        proxy_pass_header Server;

        proxy_pass http://backend;
        proxy_buffering on;
        proxy_redirect off;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection $connection_upgrade;

        proxy_cache CACHE;
        proxy_cache_valid 200 7d;
        proxy_cache_valid 410 24h;
        proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;
        proxy_cache_lock on;

        tcp_nodelay on;
    }

    location /api/v1/streaming {
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header Proxy &quot;&quot;;

        proxy_pass http://streaming;
        proxy_buffering off;
        proxy_redirect off;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection $connection_upgrade;

        tcp_nodelay on;
    }

    error_page 500 501 502 503 504 /500.html;
}</code></pre>
      </div>
    </div>
<h3 id="ssl-certificate-setup" class="mobile-header">SSL Certificate Setup</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install Certbot
# RHEL/CentOS/Fedora
sudo dnf install -y certbot python3-certbot-nginx

# Debian/Ubuntu  
sudo apt install -y certbot python3-certbot-nginx

# Arch Linux
sudo pacman -S certbot certbot-nginx

# Obtain certificate
sudo certbot --nginx -d mastodon.example.com

# Auto-renewal
echo &quot;0 12 * * * /usr/bin/certbot renew --quiet&quot; | sudo crontab -</code></pre>
      </div>
    </div>
<h3 id="selinux-configuration-rhel-based-systems" class="mobile-header">SELinux Configuration (RHEL-based systems)</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Allow nginx to connect to Mastodon services
sudo setsebool -P httpd_can_network_connect 1

# Set SELinux contexts for Mastodon files
sudo semanage fcontext -a -t httpd_exec_t &quot;/home/mastodon/live/public(/.*)?&quot;
sudo restorecon -R /home/mastodon/live/public/

# Allow Mastodon to bind to required ports
sudo semanage port -a -t http_port_t -p tcp 3000
sudo semanage port -a -t http_port_t -p tcp 4000</code></pre>
      </div>
    </div>
<h2 id="performance-tuning" class="mobile-header">Performance Tuning</h2>
<h3 id="postgresql-optimization" class="mobile-header">PostgreSQL Optimization</h3>
<p class="mobile-paragraph">Edit <code class="mobile-inline-code">/var/lib/pgsql/15/data/postgresql.conf</code>:</p>
<div class="mobile-code-block" data-language="ini">
      <div class="mobile-code-header">
        <span class="mobile-code-language">ini</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-ini"># Memory settings (adjust based on available RAM)
shared_buffers = 256MB                 # 1/4 of RAM
effective_cache_size = 1GB            # 3/4 of RAM
work_mem = 4MB                        # RAM/max_connections/4
maintenance_work_mem = 64MB           # RAM/16

# Connection settings
max_connections = 100
superuser_reserved_connections = 3

# WAL settings for better performance
wal_buffers = 16MB
checkpoint_completion_target = 0.7
checkpoint_timeout = 5min
max_wal_size = 1GB
min_wal_size = 80MB

# Query optimization
random_page_cost = 1.1                # For SSD storage
effective_io_concurrency = 200        # For SSD storage</code></pre>
      </div>
    </div>
<h3 id="redis-optimization" class="mobile-header">Redis Optimization</h3>
<p class="mobile-paragraph">Edit <code class="mobile-inline-code">/etc/redis/redis.conf</code> or <code class="mobile-inline-code">/etc/redis.conf</code>:</p>
<div class="mobile-code-block" data-language="ini">
      <div class="mobile-code-header">
        <span class="mobile-code-language">ini</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-ini"># Memory optimization
maxmemory 256mb
maxmemory-policy allkeys-lru

# Persistence (adjust based on needs)
save 900 1
save 300 10
save 60 10000

# Network optimization
tcp-keepalive 300
timeout 0</code></pre>
      </div>
    </div>
<h3 id="rubyrails-optimization" class="mobile-header">Ruby/Rails Optimization</h3>
<p class="mobile-paragraph">Edit <code class="mobile-inline-code">/home/mastodon/live/.env.production</code>:</p>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Database connection pooling
DB_POOL=25

# Sidekiq concurrency
SIDEKIQ_CONCURRENCY=25

# Puma workers (number of CPU cores)
WEB_CONCURRENCY=4
MAX_THREADS=5

# Streaming cluster
STREAMING_CLUSTER_NUM=4</code></pre>
      </div>
    </div>
<h3 id="system-level-optimization" class="mobile-header">System-level Optimization</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Increase file descriptors limit
echo &quot;mastodon soft nofile 65536&quot; | sudo tee -a /etc/security/limits.conf
echo &quot;mastodon hard nofile 65536&quot; | sudo tee -a /etc/security/limits.conf

# Optimize kernel parameters
sudo tee -a /etc/sysctl.conf &lt;&lt; &#039;EOF&#039;
# Network optimization
net.core.somaxconn = 1024
net.core.netdev_max_backlog = 5000
net.ipv4.tcp_max_syn_backlog = 1024
net.ipv4.tcp_keepalive_time = 120
net.ipv4.tcp_keepalive_intvl = 30
net.ipv4.tcp_keepalive_probes = 3

# Memory optimization
vm.swappiness = 10
vm.dirty_ratio = 15
vm.dirty_background_ratio = 5
EOF

sudo sysctl -p</code></pre>
      </div>
    </div>
<h2 id="backup-and-restore" class="mobile-header">Backup and Restore</h2>
<h3 id="database-backup" class="mobile-header">Database Backup</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create backup script
sudo tee /usr/local/bin/mastodon-backup.sh &lt;&lt; &#039;EOF&#039;
#!/bin/bash

BACKUP_DIR=&quot;/backup/mastodon&quot;
DATE=$(date +%Y%m%d_%H%M%S)
DB_NAME=&quot;mastodon_production&quot;
MEDIA_DIR=&quot;/home/mastodon/live/public/system&quot;

# Create backup directory
mkdir -p &quot;$BACKUP_DIR&quot;

# Database backup
sudo -u postgres pg_dump &quot;$DB_NAME&quot; | gzip &gt; &quot;$BACKUP_DIR/db_${DATE}.sql.gz&quot;

# Media backup (if stored locally)
if [ -d &quot;$MEDIA_DIR&quot; ]; then
    tar -czf &quot;$BACKUP_DIR/media_${DATE}.tar.gz&quot; -C &quot;$(dirname &quot;$MEDIA_DIR&quot;)&quot; &quot;$(basename &quot;$MEDIA_DIR&quot;)&quot;
fi

# Configuration backup
tar -czf &quot;$BACKUP_DIR/config_${DATE}.tar.gz&quot; /home/mastodon/live/.env.production

# Remove backups older than 30 days
find &quot;$BACKUP_DIR&quot; -name &quot;*.gz&quot; -mtime +30 -delete

echo &quot;Backup completed: $DATE&quot;
EOF

sudo chmod +x /usr/local/bin/mastodon-backup.sh</code></pre>
      </div>
    </div>
<h3 id="automated-backups" class="mobile-header">Automated Backups</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Add to crontab
echo &quot;0 2 * * * /usr/local/bin/mastodon-backup.sh&quot; | sudo crontab -</code></pre>
      </div>
    </div>
<h3 id="restore-procedure" class="mobile-header">Restore Procedure</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Stop Mastodon services
sudo systemctl stop mastodon-web mastodon-sidekiq mastodon-streaming

# Restore database
sudo -u postgres dropdb mastodon_production
sudo -u postgres createdb mastodon_production
sudo -u postgres psql -c &quot;GRANT ALL PRIVILEGES ON DATABASE mastodon_production TO mastodon;&quot;
gunzip -c /backup/mastodon/db_YYYYMMDD_HHMMSS.sql.gz | sudo -u postgres psql mastodon_production

# Restore media files (if needed)
sudo rm -rf /home/mastodon/live/public/system
sudo tar -xzf /backup/mastodon/media_YYYYMMDD_HHMMSS.tar.gz -C /home/mastodon/live/public/
sudo chown -R mastodon:mastodon /home/mastodon/live/public/system

# Restore configuration
sudo tar -xzf /backup/mastodon/config_YYYYMMDD_HHMMSS.tar.gz -C /

# Start services
sudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming</code></pre>
      </div>
    </div>
<h2 id="system-requirements" class="mobile-header">System Requirements</h2>
<h3 id="minimum-requirements" class="mobile-header">Minimum Requirements</h3>
<li class="mobile-list-item"><strong>CPU</strong>: 2 cores, 2.0 GHz</li>
<li class="mobile-list-item"><strong>RAM</strong>: 4GB</li>
<li class="mobile-list-item"><strong>Storage</strong>: 20GB SSD</li>
<li class="mobile-list-item"><strong>Network</strong>: 100 Mbps</li>
<li class="mobile-list-item"><strong>OS</strong>: Linux (64-bit)</li>
<h3 id="recommended-production-requirements" class="mobile-header">Recommended Production Requirements</h3>
<li class="mobile-list-item"><strong>CPU</strong>: 4+ cores, 2.5+ GHz</li>
<li class="mobile-list-item"><strong>RAM</strong>: 8GB+ (16GB for large instances)</li>
<li class="mobile-list-item"><strong>Storage</strong>: 100GB+ SSD with good IOPS</li>
<li class="mobile-list-item"><strong>Network</strong>: 1 Gbps with low latency</li>
<li class="mobile-list-item"><strong>OS</strong>: Recent Linux distribution with long-term support</li>
<h3 id="scaling-considerations" class="mobile-header">Scaling Considerations</h3>
<li class="mobile-list-item"><strong>Small Instance</strong>: <1,000 users - 2 cores, 4GB RAM, 50GB storage</li>
<li class="mobile-list-item"><strong>Medium Instance</strong>: 1,000-10,000 users - 4 cores, 8GB RAM, 200GB storage</li>
<li class="mobile-list-item"><strong>Large Instance</strong>: 10,000+ users - 8+ cores, 16GB+ RAM, 500GB+ storage</li>
<h2 id="support" class="mobile-header">Support</h2>
<h3 id="official-resources" class="mobile-header">Official Resources</h3>
<li class="mobile-list-item"><strong>Official Website</strong>: <a href="https://joinmastodon.org" target="_blank" rel="noopener" class="mobile-link">https://joinmastodon.org</a></li>
<li class="mobile-list-item"><strong>Documentation</strong>: <a href="https://docs.joinmastodon.org" target="_blank" rel="noopener" class="mobile-link">https://docs.joinmastodon.org</a></li>
<li class="mobile-list-item"><strong>GitHub Repository</strong>: <a href="https://github.com/mastodon/mastodon" target="_blank" rel="noopener" class="mobile-link">https://github.com/mastodon/mastodon</a></li>
<li class="mobile-list-item"><strong>Admin Documentation</strong>: <a href="https://docs.joinmastodon.org/admin/" target="_blank" rel="noopener" class="mobile-link">https://docs.joinmastodon.org/admin/</a></li>
<h3 id="community-support" class="mobile-header">Community Support</h3>
<li class="mobile-list-item"><strong>Mastodon Discord</strong>: <a href="https://discord.gg/mastodon" target="_blank" rel="noopener" class="mobile-link">https://discord.gg/mastodon</a></li>
<li class="mobile-list-item"><strong>GitHub Issues</strong>: <a href="https://github.com/mastodon/mastodon/issues" target="_blank" rel="noopener" class="mobile-link">https://github.com/mastodon/mastodon/issues</a></li>
<li class="mobile-list-item"><strong>Mastodon Community</strong>: Follow @Mastodon@mastodon.social</li>
<li class="mobile-list-item"><strong>Admin Forums</strong>: Various Mastodon admin communities on the fediverse</li>
<h3 id="commercial-support" class="mobile-header">Commercial Support</h3>
<li class="mobile-list-item">Available from various consulting companies</li>
<li class="mobile-list-item">Managed hosting providers offer Mastodon services</li>
<li class="mobile-list-item">Professional services for large deployments</li>
<h2 id="contributing" class="mobile-header">Contributing</h2>
<h3 id="how-to-contribute" class="mobile-header">How to Contribute</h3>
<p class="mobile-paragraph">1. <strong>Report Bugs</strong>: Submit issues to <a href="https://github.com/mastodon/mastodon/issues" target="_blank" rel="noopener" class="mobile-link">GitHub</a></p>
<p class="mobile-paragraph">2. <strong>Translate</strong>: Help with internationalization at <a href="https://crowdin.com/project/mastodon" target="_blank" rel="noopener" class="mobile-link">Crowdin</a></p>
<p class="mobile-paragraph">3. <strong>Code Contributions</strong>: Submit pull requests for bug fixes and features</p>
<p class="mobile-paragraph">4. <strong>Documentation</strong>: Improve documentation and guides</p>
<p class="mobile-paragraph">5. <strong>Testing</strong>: Test release candidates and provide feedback</p>
<h3 id="development-setup" class="mobile-header">Development Setup</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Clone repository
git clone https://github.com/mastodon/mastodon.git
cd mastodon

# Install dependencies
bundle install
yarn install

# Setup development database
rails db:setup

# Run development server
foreman start</code></pre>
      </div>
    </div>
<h3 id="contribution-guidelines" class="mobile-header">Contribution Guidelines</h3>
<li class="mobile-list-item">Follow Ruby and JavaScript style guides</li>
<li class="mobile-list-item">Include tests for new features</li>
<li class="mobile-list-item">Update documentation for changes</li>
<li class="mobile-list-item">Use conventional commit messages</li>
<li class="mobile-list-item">Sign commits with GPG key</li>
<h2 id="license" class="mobile-header">License</h2>
<p class="mobile-paragraph">Mastodon is licensed under the <strong>GNU Affero General Public License v3.0 (AGPL-3.0)</strong>.</p>
<h3 id="key-license-points" class="mobile-header">Key License Points</h3>
<li class="mobile-list-item"><strong>Free to Use</strong>: Can be used for any purpose</li>
<li class="mobile-list-item"><strong>Source Available</strong>: Source code must be provided to users</li>
<li class="mobile-list-item"><strong>Copyleft</strong>: Derivative works must use same license</li>
<li class="mobile-list-item"><strong>Network Use</strong>: AGPL applies to network/web services</li>
<li class="mobile-list-item"><strong>No Warranty</strong>: Software provided "as is"</li>
<h3 id="license-compliance" class="mobile-header">License Compliance</h3>
<li class="mobile-list-item">Keep license notices intact</li>
<li class="mobile-list-item">Provide source code to users</li>
<li class="mobile-list-item">Document any modifications</li>
<li class="mobile-list-item">Use same license for derivatives</li>
<li class="mobile-list-item">Consider legal requirements for your jurisdiction</li>
<p class="mobile-paragraph">Full license text: <a href="https://github.com/mastodon/mastodon/blob/main/LICENSE" target="_blank" rel="noopener" class="mobile-link">https://github.com/mastodon/mastodon/blob/main/LICENSE</a></p>
<h2 id="acknowledgments" class="mobile-header">Acknowledgments</h2>
<h3 id="core-team" class="mobile-header">Core Team</h3>
<li class="mobile-list-item"><strong>Eugen Rochko</strong> - Creator and lead developer</li>
<li class="mobile-list-item"><strong>Claire</strong> - Core maintainer</li>
<li class="mobile-list-item"><strong>Renaud Chaput</strong> - Core maintainer</li>
<li class="mobile-list-item"><strong>ThibG</strong> - Significant contributor</li>
<li class="mobile-list-item">And many other contributors</li>
<h3 id="technologies-used" class="mobile-header">Technologies Used</h3>
<li class="mobile-list-item"><strong>Ruby on Rails</strong> - Web application framework</li>
<li class="mobile-list-item"><strong>PostgreSQL</strong> - Primary database</li>
<li class="mobile-list-item"><strong>Redis</strong> - Caching and job queue</li>
<li class="mobile-list-item"><strong>React.js</strong> - Frontend user interface</li>
<li class="mobile-list-item"><strong>ActivityPub</strong> - Federation protocol</li>
<li class="mobile-list-item"><strong>Sidekiq</strong> - Background job processing</li>
<h3 id="community" class="mobile-header">Community</h3>
<li class="mobile-list-item"><strong>Translators</strong> - Making Mastodon available in many languages</li>
<li class="mobile-list-item"><strong>Instance Administrators</strong> - Running the fediverse</li>
<li class="mobile-list-item"><strong>Users</strong> - Creating the vibrant community</li>
<li class="mobile-list-item"><strong>Contributors</strong> - Improving the software</li>
<h2 id="version-history" class="mobile-header">Version History</h2>
<h3 id="major-releases" class="mobile-header">Major Releases</h3>
<li class="mobile-list-item"><strong>v4.2</strong> (September 2023) - Enhanced moderation tools, quote posts</li>
<li class="mobile-list-item"><strong>v4.1</strong> (February 2023) - Improved federation, performance optimizations</li>
<li class="mobile-list-item"><strong>v4.0</strong> (October 2022) - Major UI overhaul, new features</li>
<li class="mobile-list-item"><strong>v3.5</strong> (May 2022) - Content warnings improvements, admin features</li>
<li class="mobile-list-item"><strong>v3.4</strong> (October 2021) - Server rules, report improvements</li>
<li class="mobile-list-item"><strong>v3.3</strong> (February 2021) - Profile directory, admin announcements</li>
<li class="mobile-list-item"><strong>v3.2</strong> (July 2020) - Audio uploads, admin interface improvements</li>
<li class="mobile-list-item"><strong>v3.1</strong> (February 2020) - Polls, improved federation</li>
<li class="mobile-list-item"><strong>v3.0</strong> (October 2019) - Single column mode, admin dashboard</li>
<h3 id="current-stable-version" class="mobile-header">Current Stable Version</h3>
<li class="mobile-list-item"><strong>v4.2.x</strong> - Latest stable release</li>
<li class="mobile-list-item">Check <a href="https://github.com/mastodon/mastodon/releases" target="_blank" rel="noopener" class="mobile-link">GitHub releases</a> for current version</li>
<h3 id="upgrade-path" class="mobile-header">Upgrade Path</h3>
<li class="mobile-list-item">Always backup before upgrading</li>
<li class="mobile-list-item">Follow official upgrade guides</li>
<li class="mobile-list-item">Test in staging environment first</li>
<li class="mobile-list-item">Monitor for federation issues after upgrade</li>
<h2 id="appendices" class="mobile-header">Appendices</h2>
<h3 id="appendix-a-port-reference" class="mobile-header">Appendix A: Port Reference</h3>
<p class="mobile-paragraph">| Port | Service | Protocol | Description |</p>
<p class="mobile-paragraph">|------|---------|----------|-------------|</p>
<p class="mobile-paragraph">| 80 | HTTP | TCP | Web traffic (redirects to HTTPS) |</p>
<p class="mobile-paragraph">| 443 | HTTPS | TCP | Secure web traffic |</p>
<p class="mobile-paragraph">| 3000 | Mastodon Web | TCP | Internal web service |</p>
<p class="mobile-paragraph">| 4000 | Mastodon Streaming | TCP | Real-time updates |</p>
<p class="mobile-paragraph">| 5432 | PostgreSQL | TCP | Database (internal) |</p>
<p class="mobile-paragraph">| 6379 | Redis | TCP | Cache and queues (internal) |</p>
<p class="mobile-paragraph">| 25/587 | SMTP | TCP | Email delivery (outbound) |</p>
<h3 id="appendix-b-file-locations" class="mobile-header">Appendix B: File Locations</h3>
<p class="mobile-paragraph">| Path | Description |</p>
<p class="mobile-paragraph">|------|-------------|</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">/home/mastodon/live/</code> | Mastodon application directory |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">/home/mastodon/live/.env.production</code> | Main configuration file |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">/home/mastodon/live/public/system/</code> | Media files storage |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">/etc/systemd/system/mastodon-*.service</code> | Service definitions |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">/etc/nginx/sites-available/mastodon</code> | nginx configuration |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">/var/lib/postgresql/*/data/</code> | PostgreSQL data directory |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">/etc/redis/redis.conf</code> | Redis configuration |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">/var/log/nginx/</code> | nginx logs |</p>
<h3 id="appendix-c-common-commands" class="mobile-header">Appendix C: Common Commands</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Service management
sudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming
sudo systemctl restart mastodon-web mastodon-sidekiq mastodon-streaming

# Mastodon maintenance
sudo -u mastodon bash -c &#039;cd /home/mastodon/live &amp;&amp; RAILS_ENV=production bundle exec rails mastodon:maintenance&#039;

# Database management
sudo -u postgres psql mastodon_production

# Log monitoring
sudo journalctl -u mastodon-web -f
sudo tail -f /var/log/nginx/access.log</code></pre>
      </div>
    </div>
<h3 id="appendix-d-environment-variables-reference" class="mobile-header">Appendix D: Environment Variables Reference</h3>
<p class="mobile-paragraph">| Variable | Description | Required |</p>
<p class="mobile-paragraph">|----------|-------------|----------|</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">LOCAL_DOMAIN</code> | Your Mastodon domain | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">SECRET_KEY_BASE</code> | Rails secret key | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">OTP_SECRET</code> | Two-factor authentication secret | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">VAPID_PRIVATE_KEY</code> | Push notification private key | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">VAPID_PUBLIC_KEY</code> | Push notification public key | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">DB_HOST</code> | Database hostname | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">DB_USER</code> | Database username | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">DB_PASS</code> | Database password | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">DB_NAME</code> | Database name | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">REDIS_HOST</code> | Redis hostname | Yes |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">SMTP_SERVER</code> | SMTP server hostname | Recommended |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">SMTP_FROM_ADDRESS</code> | From email address | Recommended |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">S3_ENABLED</code> | Enable S3 storage | No |</p>
<p class="mobile-paragraph">| <code class="mobile-inline-code">CDN_HOST</code> | CDN hostname for assets | No |</p>
<p class="mobile-paragraph">---</p>
<p class="mobile-paragraph"><strong>Note:</strong> This guide is part of the <a href="https://howtomgr.github.io" target="_blank" rel="noopener" class="mobile-link">HowToMgr</a> collection. Always refer to official Mastodon documentation for the most up-to-date information.</p></div></article><nav class="jsx-64efd206b36bc2dd guide-navigation"><a class="btn btn-secondary" href="/communication/">‚Üê All <!-- -->Communication</a><a class="btn btn-secondary" href="/">All Categories</a></nav></div></main><footer class="jsx-f92e766e9414ef16 mobile-footer"><div class="jsx-f92e766e9414ef16 container"><div class="jsx-f92e766e9414ef16 footer-content"><div class="jsx-f92e766e9414ef16 footer-links"><a href="/">Home</a><a href="https://github.com/howtomgr" target="_blank" rel="noopener" class="jsx-f92e766e9414ef16">GitHub</a><a href="https://github.com/howtomgr/howtomgr.github.io" target="_blank" rel="noopener" class="jsx-f92e766e9414ef16">Source</a></div><div class="jsx-f92e766e9414ef16 footer-separator"></div><p class="jsx-f92e766e9414ef16 footer-text">¬© <!-- -->2025<!-- --> HowToMgr Organization. Open source installation guides.</p><p class="jsx-f92e766e9414ef16 footer-tech">Built with ‚ù§Ô∏è using Next.js + GitHub Pages</p><p class="jsx-f92e766e9414ef16 footer-disclaimer"><small class="jsx-f92e766e9414ef16">All guides are provided as-is. Please review and test before production use.</small></p></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"guide":{"name":"mastodon","displayName":"Mastodon Installation Guide","slug":"mastodon","description":"Mastodon is a free and open-source decentralized social media platform that serves as an alternative to proprietary platforms like Twitter/X. It's part of the fediverse, uses the ActivityPub protocol for federation, and allows users to run their own social media instances with full control over their data and community.","category":"communication","subcategory":"communication","difficultyLevel":"advanced","estimatedSetupTime":"1-2 hours","supportedOS":["rhel","centos","rocky","almalinux","debian","ubuntu","arch","alpine","opensuse","sles"],"defaultPorts":[80,443,3000,4000],"installationMethods":["native-packages","source-installation"],"features":["multi-os-support","comprehensive-documentation","security-hardening","performance-optimization","backup-restore-procedures","troubleshooting-guides"],"tags":["social-media","fediverse","activitypub","decentralized","microblogging"],"maintenanceStatus":"active","specVersion":"2.0","version":"1.0.0","license":"AGPL-3.0","websiteUrl":"https://howtomgr.github.io/communication/mastodon","documentationUrl":"https://howtomgr.github.io/communication/mastodon","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/mastodon","updatedAt":"2025-09-16T17:29:29Z","createdAt":"2023-08-28T03:48:35Z","readmeRaw":"# Mastodon Installation Guide\n\nMastodon is a free, open-source federated social network server that provides a decentralized alternative to proprietary platforms like Twitter/X. Built on Ruby on Rails and using ActivityPub protocol, Mastodon allows users to run their own social media instance while connecting to the broader fediverse.\n\n## Prerequisites\n\n### Hardware Requirements\n- **CPU**: 2+ cores (4+ cores recommended for production)\n- **RAM**: 4GB minimum (8GB+ recommended for production)\n- **Storage**: 20GB minimum (SSD recommended, scale based on media storage needs)\n- **Network**: Reliable internet connection with public IP (for federation)\n\n### Software Dependencies\n- **Operating System**: Linux (RHEL-based, Debian-based, Arch Linux, Alpine Linux)\n- **Database**: PostgreSQL 12+ (PostgreSQL 15+ recommended)\n- **Cache/Queue**: Redis 6.0+\n- **Runtime**: Ruby 3.0+ (Ruby 3.2+ recommended)\n- **Web Server**: nginx or Apache (for reverse proxy)\n- **SSL Certificate**: Let's Encrypt or commercial certificate\n- **Node.js**: 16+ (for asset compilation)\n- **Yarn**: Package manager for Node.js dependencies\n\n### Network Requirements\n- **Ports**: \n  - 80/443 (HTTP/HTTPS)\n  - 25/587 (SMTP - for email delivery)\n  - 3000 (Mastodon web interface)\n  - 4000 (Mastodon streaming API)\n- **Domain**: Registered domain name with DNS control\n- **Email**: SMTP server for notifications and user registration\n\n### System Access\n- Root or sudo access required for installation\n- Dedicated user account for Mastodon service\n- Firewall configuration access\n\n## Supported Operating Systems\n\nThis guide supports installation on:\n- **RHEL-based**: RHEL 8/9, CentOS Stream 8/9, Rocky Linux 8/9, AlmaLinux 8/9, Fedora 37+\n- **Debian-based**: Debian 11/12, Ubuntu 20.04/22.04/24.04 LTS\n- **Arch Linux**: Arch Linux (rolling), Manjaro\n- **Alpine Linux**: 3.18+ (containerized deployments)\n- **macOS**: 12+ (development only)\n- **FreeBSD**: 13.0+ (experimental)\n\n## Installation\n\n### RHEL/CentOS/Rocky Linux/AlmaLinux\n\n```bash\n# Install EPEL and PowerTools repositories\nsudo dnf install -y epel-release\nsudo dnf config-manager --set-enabled powertools  # CentOS Stream 8\nsudo dnf config-manager --set-enabled crb         # CentOS Stream 9, Rocky, AlmaLinux\n\n# Install Node.js repository\ncurl -fsSL https://rpm.nodesource.com/setup_lts.x | sudo bash -\n\n# Install Yarn repository\ncurl -sL https://dl.yarnpkg.com/rpm/yarn.repo | sudo tee /etc/yum.repos.d/yarn.repo\n\n# Install PostgreSQL repository (for latest version)\nsudo dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-$(rpm -E %{rhel})-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n\n# Install required packages\nsudo dnf install -y \\\n    git curl wget gnupg2 \\\n    gcc gcc-c++ make automake autoconf libtool \\\n    postgresql15-server postgresql15-devel \\\n    redis \\\n    nodejs yarn \\\n    nginx \\\n    ImageMagick ImageMagick-devel \\\n    ffmpeg \\\n    libxml2-devel libxslt-devel \\\n    libidn-devel \\\n    openssl-devel \\\n    readline-devel \\\n    zlib-devel \\\n    libyaml-devel \\\n    gdbm-devel \\\n    ncurses-devel \\\n    libffi-devel\n\n# Initialize PostgreSQL\nsudo postgresql-15-setup initdb\nsudo systemctl enable --now postgresql-15 redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \"ALTER USER mastodon WITH ENCRYPTED PASSWORD 'secure_random_password_here';\"\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon nginx\n\n# Install Ruby (using rbenv for version management)\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' \u003e\u003e ~/.bashrc\necho 'eval \"$(rbenv init -)\"' \u003e\u003e ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v 'rc' | sort -V | tail -n 1)\n\n# Install Ruby dependencies\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle config deployment 'true'\nbundle config without 'development test'\nbundle install\nEOF\n\n# Install Node.js dependencies\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nyarn install --pure-lockfile\nEOF\n```\n\n### Debian/Ubuntu\n\n```bash\n# Update package list\nsudo apt update\n\n# Install curl and gnupg (if not already installed)\nsudo apt install -y curl gnupg\n\n# Add Node.js repository\ncurl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -\n\n# Add Yarn repository\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho \"deb https://dl.yarnpkg.com/debian/ stable main\" | sudo tee /etc/apt/sources.list.d/yarn.list\n\n# Add PostgreSQL repository (for latest version)\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\necho \"deb http://apt.postgresql.org/pub/repos/apt/ $(lsb_release -cs)-pgdg main\" | sudo tee /etc/apt/sources.list.d/pgdg.list\n\n# Update package list\nsudo apt update\n\n# Install required packages\nsudo apt install -y \\\n    git curl wget gnupg \\\n    build-essential \\\n    postgresql-15 postgresql-contrib-15 postgresql-server-dev-15 \\\n    redis-server \\\n    nodejs yarn \\\n    nginx \\\n    imagemagick ffmpeg \\\n    libxml2-dev libxslt1-dev \\\n    libidn11-dev \\\n    libssl-dev \\\n    libreadline-dev \\\n    zlib1g-dev \\\n    libyaml-dev \\\n    libgdbm-dev \\\n    libncurses5-dev \\\n    libffi-dev \\\n    libpq-dev\n\n# Start and enable services\nsudo systemctl enable --now postgresql redis-server\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \"ALTER USER mastodon WITH ENCRYPTED PASSWORD 'secure_random_password_here';\"\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon www-data\n\n# Install Ruby (using rbenv)\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' \u003e\u003e ~/.bashrc\necho 'eval \"$(rbenv init -)\"' \u003e\u003e ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v 'rc' | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle config deployment 'true'\nbundle config without 'development test'\nbundle install\nyarn install --pure-lockfile\nEOF\n```\n\n### Arch Linux\n\n```bash\n# Update system\nsudo pacman -Syu\n\n# Install required packages\nsudo pacman -S --needed \\\n    git curl wget gnupg \\\n    base-devel \\\n    postgresql redis \\\n    nodejs npm yarn \\\n    nginx \\\n    imagemagick ffmpeg \\\n    libxml2 libxslt \\\n    libidn \\\n    openssl \\\n    readline \\\n    zlib \\\n    libyaml \\\n    gdbm \\\n    ncurses \\\n    libffi\n\n# Initialize PostgreSQL\nsudo -u postgres initdb -D /var/lib/postgres/data\nsudo systemctl enable --now postgresql redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \"ALTER USER mastodon WITH ENCRYPTED PASSWORD 'secure_random_password_here';\"\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon http\n\n# Install Ruby using rbenv\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' \u003e\u003e ~/.bashrc\necho 'eval \"$(rbenv init -)\"' \u003e\u003e ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone and setup Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v 'rc' | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle config deployment 'true'\nbundle config without 'development test'\nbundle install\nyarn install --pure-lockfile\nEOF\n```\n\n### Alpine Linux\n\n```bash\n# Update package index\napk update\n\n# Install required packages\napk add --no-cache \\\n    git curl wget gnupg \\\n    build-base \\\n    postgresql15 postgresql15-dev postgresql15-contrib \\\n    redis \\\n    nodejs npm yarn \\\n    nginx \\\n    imagemagick imagemagick-dev ffmpeg \\\n    libxml2-dev libxslt-dev \\\n    libidn-dev \\\n    openssl-dev \\\n    readline-dev \\\n    zlib-dev \\\n    yaml-dev \\\n    gdbm-dev \\\n    ncurses-dev \\\n    libffi-dev\n\n# Initialize and start services\nrc-service postgresql setup\nrc-service postgresql start\nrc-service redis start\nrc-update add postgresql\nrc-update add redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \"ALTER USER mastodon WITH ENCRYPTED PASSWORD 'secure_random_password_here';\"\n\n# Create mastodon user\nadduser -D -s /bin/ash mastodon\naddgroup mastodon nginx\n\n# Install Ruby using rbenv\nsudo -u mastodon ash \u003c\u003c 'EOF'\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho 'export PATH=\"$HOME/.rbenv/bin:$PATH\"' \u003e\u003e ~/.profile\necho 'eval \"$(rbenv init -)\"' \u003e\u003e ~/.profile\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone and setup Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v 'rc' | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon ash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle config deployment 'true'\nbundle config without 'development test'\nbundle install\nyarn install --pure-lockfile\nEOF\n```\n\n## Configuration\n\n### Environment Configuration\n\n```bash\n# Switch to mastodon user\nsudo -u mastodon bash\n\n# Navigate to Mastodon directory\ncd /home/mastodon/live\n\n# Generate configuration\nRAILS_ENV=production bundle exec rake mastodon:setup\n```\n\nThis interactive setup will prompt for:\n- Domain name (e.g., mastodon.example.com)\n- Database configuration\n- Redis configuration\n- Email settings (SMTP)\n- File storage settings\n- Admin account creation\n\n### Manual Environment Configuration\n\nIf you prefer manual configuration, create `/home/mastodon/live/.env.production`:\n\n```bash\n# Create environment file\nsudo -u mastodon tee /home/mastodon/live/.env.production \u003c\u003c 'EOF'\n# Federation\nLOCAL_DOMAIN=mastodon.example.com\nWEB_DOMAIN=mastodon.example.com\n\n# Redis\nREDIS_HOST=127.0.0.1\nREDIS_PORT=6379\n\n# PostgreSQL\nDB_HOST=127.0.0.1\nDB_USER=mastodon\nDB_NAME=mastodon_production\nDB_PASS=secure_random_password_here\nDB_PORT=5432\n\n# ElasticSearch (optional, for full-text search)\n# ES_ENABLED=true\n# ES_HOST=localhost\n# ES_PORT=9200\n\n# Secrets\n# Generate with: bundle exec rake secret\nSECRET_KEY_BASE=generate_with_rake_secret\nOTP_SECRET=generate_with_rake_secret\n\n# VAPID keys (for push notifications)\n# Generate with: bundle exec rake mastodon:webpush:generate_vapid_key\nVAPID_PRIVATE_KEY=\nVAPID_PUBLIC_KEY=\n\n# Sending mail\nSMTP_SERVER=smtp.example.com\nSMTP_PORT=587\nSMTP_LOGIN=mastodon@example.com\nSMTP_PASSWORD=smtp_password\nSMTP_FROM_ADDRESS=mastodon@example.com\n\n# File storage (local)\nPAPERCLIP_ROOT_PATH=/home/mastodon/live/public/system\n\n# Optional S3/compatible storage\n# S3_ENABLED=true\n# S3_BUCKET=mastodon\n# AWS_ACCESS_KEY_ID=\n# AWS_SECRET_ACCESS_KEY=\n# S3_REGION=us-east-1\n# S3_HOSTNAME=s3.amazonaws.com\n\n# Optional CDN\n# CDN_HOST=assets.example.com\n\n# Streaming\nSTREAMING_CLUSTER_NUM=1\nSTREAMING_API_BASE_URL=wss://mastodon.example.com\n\n# Advanced settings\nMAX_TOOT_CHARS=500\nSINGLE_USER_MODE=false\nAUTHORIZED_FETCH=false\nLIMITED_FEDERATION_MODE=false\nEOF\n```\n\n### Database Setup\n\n```bash\n# Switch to mastodon user and setup database\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\n\n# Create database\nRAILS_ENV=production bundle exec rails db:create\nRAILS_ENV=production bundle exec rails db:schema:load\nRAILS_ENV=production bundle exec rails db:seed\n\n# Compile assets\nRAILS_ENV=production bundle exec rails assets:precompile\nEOF\n```\n\n## Service Management\n\n### Systemd Service Files (RHEL/Debian/Arch/SUSE)\n\nCreate the web service (`/etc/systemd/system/mastodon-web.service`):\n\n```ini\n[Unit]\nDescription=mastodon-web\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\"RAILS_ENV=production\"\nEnvironment=\"PORT=3000\"\nExecStart=/home/mastodon/.rbenv/shims/bundle exec puma -C config/puma.rb\nExecReload=/bin/kill -SIGUSR1 $MAINPID\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-web\n\n[Install]\nWantedBy=multi-user.target\n```\n\nCreate the background jobs service (`/etc/systemd/system/mastodon-sidekiq.service`):\n\n```ini\n[Unit]\nDescription=mastodon-sidekiq\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\"RAILS_ENV=production\"\nEnvironment=\"DB_POOL=25\"\nExecStart=/home/mastodon/.rbenv/shims/bundle exec sidekiq -c 25\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-sidekiq\n\n[Install]\nWantedBy=multi-user.target\n```\n\nCreate the streaming service (`/etc/systemd/system/mastodon-streaming.service`):\n\n```ini\n[Unit]\nDescription=mastodon-streaming\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\"NODE_ENV=production\"\nEnvironment=\"PORT=4000\"\nExecStart=/usr/bin/node streaming\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-streaming\n\n[Install]\nWantedBy=multi-user.target\n```\n\n### Enable and Start Services\n\n```bash\n# Reload systemd and enable services\nsudo systemctl daemon-reload\nsudo systemctl enable mastodon-web mastodon-sidekiq mastodon-streaming\nsudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Check status\nsudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming\n```\n\n### OpenRC Services (Alpine Linux)\n\nCreate `/etc/init.d/mastodon-web`:\n\n```bash\n#!/sbin/openrc-run\n\nname=\"mastodon-web\"\ndescription=\"Mastodon web service\"\n\nuser=\"mastodon\"\ngroup=\"mastodon\"\ndirectory=\"/home/mastodon/live\"\n\ncommand=\"/home/mastodon/.rbenv/shims/bundle\"\ncommand_args=\"exec puma -C config/puma.rb\"\ncommand_background=\"yes\"\n\npidfile=\"/run/${name}.pid\"\noutput_log=\"/var/log/${name}.log\"\nerror_log=\"/var/log/${name}.error.log\"\n\ndepend() {\n    need net postgresql redis\n}\n\nstart_pre() {\n    export RAILS_ENV=production\n    export PORT=3000\n}\n```\n\nCreate similar files for `mastodon-sidekiq` and `mastodon-streaming`, then:\n\n```bash\n# Make executable\nsudo chmod +x /etc/init.d/mastodon-*\n\n# Enable and start\nsudo rc-update add mastodon-web\nsudo rc-update add mastodon-sidekiq  \nsudo rc-update add mastodon-streaming\nsudo rc-service mastodon-web start\nsudo rc-service mastodon-sidekiq start\nsudo rc-service mastodon-streaming start\n```\n\n## Troubleshooting\n\n### Common Issues\n\n**Ruby/Bundle Issues:**\n```bash\n# Ensure proper rbenv setup\nsudo -u mastodon bash \u003c\u003c 'EOF'\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nwhich ruby\nruby --version\nEOF\n\n# Reinstall gems if needed\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nbundle install --deployment --without development test\nEOF\n```\n\n**Database Connection Issues:**\n```bash\n# Test PostgreSQL connection\nsudo -u mastodon psql -h localhost -U mastodon mastodon_production\n\n# Check PostgreSQL logs\nsudo journalctl -u postgresql-15 -f\n\n# Verify database configuration\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nRAILS_ENV=production bundle exec rails console\n# In console: ActiveRecord::Base.connection\nEOF\n```\n\n**Asset Compilation Issues:**\n```bash\n# Clear and recompile assets\nsudo -u mastodon bash \u003c\u003c 'EOF'\ncd /home/mastodon/live\nexport PATH=\"$HOME/.rbenv/bin:$PATH\"\neval \"$(rbenv init -)\"\nRAILS_ENV=production bundle exec rails assets:clobber\nRAILS_ENV=production bundle exec rails assets:precompile\nEOF\n```\n\n**Service Startup Issues:**\n```bash\n# Check service logs\nsudo journalctl -u mastodon-web -f\nsudo journalctl -u mastodon-sidekiq -f\nsudo journalctl -u mastodon-streaming -f\n\n# Check for port conflicts\nsudo netstat -tlnp | grep :3000\nsudo netstat -tlnp | grep :4000\n\n# Verify file permissions\nsudo ls -la /home/mastodon/live/\nsudo -u mastodon test -r /home/mastodon/live/.env.production \u0026\u0026 echo \"Can read env file\"\n```\n\n## Security Considerations\n\n### Firewall Configuration\n\n**firewalld (RHEL/CentOS/Fedora):**\n```bash\n# Open required ports\nsudo firewall-cmd --permanent --add-service=http\nsudo firewall-cmd --permanent --add-service=https\nsudo firewall-cmd --permanent --add-port=3000/tcp\nsudo firewall-cmd --permanent --add-port=4000/tcp\nsudo firewall-cmd --reload\n```\n\n**ufw (Ubuntu/Debian):**\n```bash\n# Configure firewall\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\nsudo ufw allow 3000/tcp\nsudo ufw allow 4000/tcp\nsudo ufw enable\n```\n\n**iptables (Generic):**\n```bash\n# Basic firewall rules\nsudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 3000 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 4000 -j ACCEPT\n```\n\n### SSL/TLS Configuration with nginx\n\nCreate `/etc/nginx/sites-available/mastodon` (Debian/Ubuntu) or `/etc/nginx/conf.d/mastodon.conf` (RHEL):\n\n```nginx\nmap $http_upgrade $connection_upgrade {\n  default upgrade;\n  ''      close;\n}\n\nupstream backend {\n    server 127.0.0.1:3000 fail_timeout=0;\n}\n\nupstream streaming {\n    server 127.0.0.1:4000 fail_timeout=0;\n}\n\nproxy_cache_path /var/cache/nginx/mastodon keys_zone=CACHE:10m levels=1:2 inactive=7d max_size=1g;\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name mastodon.example.com;\n    root /home/mastodon/live/public;\n    location /.well-known/acme-challenge/ { allow all; }\n    location / { return 301 https://$host$request_uri; }\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name mastodon.example.com;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;\n    ssl_prefer_server_ciphers off;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_tickets off;\n\n    ssl_certificate     /etc/letsencrypt/live/mastodon.example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/mastodon.example.com/privkey.pem;\n\n    keepalive_timeout    70;\n    sendfile             on;\n    client_max_body_size 80m;\n\n    root /home/mastodon/live/public;\n\n    gzip on;\n    gzip_disable \"msie6\";\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types\n        text/plain\n        text/css\n        text/xml\n        text/javascript\n        application/json\n        application/javascript\n        application/xml+rss\n        application/atom+xml\n        image/svg+xml;\n\n    add_header Strict-Transport-Security \"max-age=31536000\" always;\n\n    location / {\n        try_files $uri @proxy;\n    }\n\n    location ~ ^/(emoji|packs|system/accounts/avatars|system/media_attachments/files) {\n        add_header Cache-Control \"public, max-age=31536000, immutable\";\n        add_header Strict-Transport-Security \"max-age=31536000\" always;\n        try_files $uri @proxy;\n    }\n    \n    location /sw.js {\n        add_header Cache-Control \"public, max-age=604800, must-revalidate\";\n        add_header Strict-Transport-Security \"max-age=31536000\" always;\n        try_files $uri @proxy;\n    }\n\n    location @proxy {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Proxy \"\";\n        proxy_pass_header Server;\n\n        proxy_pass http://backend;\n        proxy_buffering on;\n        proxy_redirect off;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        proxy_cache CACHE;\n        proxy_cache_valid 200 7d;\n        proxy_cache_valid 410 24h;\n        proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;\n        proxy_cache_lock on;\n\n        tcp_nodelay on;\n    }\n\n    location /api/v1/streaming {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Proxy \"\";\n\n        proxy_pass http://streaming;\n        proxy_buffering off;\n        proxy_redirect off;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        tcp_nodelay on;\n    }\n\n    error_page 500 501 502 503 504 /500.html;\n}\n```\n\n### SSL Certificate Setup\n\n```bash\n# Install Certbot\n# RHEL/CentOS/Fedora\nsudo dnf install -y certbot python3-certbot-nginx\n\n# Debian/Ubuntu  \nsudo apt install -y certbot python3-certbot-nginx\n\n# Arch Linux\nsudo pacman -S certbot certbot-nginx\n\n# Obtain certificate\nsudo certbot --nginx -d mastodon.example.com\n\n# Auto-renewal\necho \"0 12 * * * /usr/bin/certbot renew --quiet\" | sudo crontab -\n```\n\n### SELinux Configuration (RHEL-based systems)\n\n```bash\n# Allow nginx to connect to Mastodon services\nsudo setsebool -P httpd_can_network_connect 1\n\n# Set SELinux contexts for Mastodon files\nsudo semanage fcontext -a -t httpd_exec_t \"/home/mastodon/live/public(/.*)?\"\nsudo restorecon -R /home/mastodon/live/public/\n\n# Allow Mastodon to bind to required ports\nsudo semanage port -a -t http_port_t -p tcp 3000\nsudo semanage port -a -t http_port_t -p tcp 4000\n```\n\n## Performance Tuning\n\n### PostgreSQL Optimization\n\nEdit `/var/lib/pgsql/15/data/postgresql.conf`:\n\n```ini\n# Memory settings (adjust based on available RAM)\nshared_buffers = 256MB                 # 1/4 of RAM\neffective_cache_size = 1GB            # 3/4 of RAM\nwork_mem = 4MB                        # RAM/max_connections/4\nmaintenance_work_mem = 64MB           # RAM/16\n\n# Connection settings\nmax_connections = 100\nsuperuser_reserved_connections = 3\n\n# WAL settings for better performance\nwal_buffers = 16MB\ncheckpoint_completion_target = 0.7\ncheckpoint_timeout = 5min\nmax_wal_size = 1GB\nmin_wal_size = 80MB\n\n# Query optimization\nrandom_page_cost = 1.1                # For SSD storage\neffective_io_concurrency = 200        # For SSD storage\n```\n\n### Redis Optimization\n\nEdit `/etc/redis/redis.conf` or `/etc/redis.conf`:\n\n```ini\n# Memory optimization\nmaxmemory 256mb\nmaxmemory-policy allkeys-lru\n\n# Persistence (adjust based on needs)\nsave 900 1\nsave 300 10\nsave 60 10000\n\n# Network optimization\ntcp-keepalive 300\ntimeout 0\n```\n\n### Ruby/Rails Optimization\n\nEdit `/home/mastodon/live/.env.production`:\n\n```bash\n# Database connection pooling\nDB_POOL=25\n\n# Sidekiq concurrency\nSIDEKIQ_CONCURRENCY=25\n\n# Puma workers (number of CPU cores)\nWEB_CONCURRENCY=4\nMAX_THREADS=5\n\n# Streaming cluster\nSTREAMING_CLUSTER_NUM=4\n```\n\n### System-level Optimization\n\n```bash\n# Increase file descriptors limit\necho \"mastodon soft nofile 65536\" | sudo tee -a /etc/security/limits.conf\necho \"mastodon hard nofile 65536\" | sudo tee -a /etc/security/limits.conf\n\n# Optimize kernel parameters\nsudo tee -a /etc/sysctl.conf \u003c\u003c 'EOF'\n# Network optimization\nnet.core.somaxconn = 1024\nnet.core.netdev_max_backlog = 5000\nnet.ipv4.tcp_max_syn_backlog = 1024\nnet.ipv4.tcp_keepalive_time = 120\nnet.ipv4.tcp_keepalive_intvl = 30\nnet.ipv4.tcp_keepalive_probes = 3\n\n# Memory optimization\nvm.swappiness = 10\nvm.dirty_ratio = 15\nvm.dirty_background_ratio = 5\nEOF\n\nsudo sysctl -p\n```\n\n## Backup and Restore\n\n### Database Backup\n\n```bash\n# Create backup script\nsudo tee /usr/local/bin/mastodon-backup.sh \u003c\u003c 'EOF'\n#!/bin/bash\n\nBACKUP_DIR=\"/backup/mastodon\"\nDATE=$(date +%Y%m%d_%H%M%S)\nDB_NAME=\"mastodon_production\"\nMEDIA_DIR=\"/home/mastodon/live/public/system\"\n\n# Create backup directory\nmkdir -p \"$BACKUP_DIR\"\n\n# Database backup\nsudo -u postgres pg_dump \"$DB_NAME\" | gzip \u003e \"$BACKUP_DIR/db_${DATE}.sql.gz\"\n\n# Media backup (if stored locally)\nif [ -d \"$MEDIA_DIR\" ]; then\n    tar -czf \"$BACKUP_DIR/media_${DATE}.tar.gz\" -C \"$(dirname \"$MEDIA_DIR\")\" \"$(basename \"$MEDIA_DIR\")\"\nfi\n\n# Configuration backup\ntar -czf \"$BACKUP_DIR/config_${DATE}.tar.gz\" /home/mastodon/live/.env.production\n\n# Remove backups older than 30 days\nfind \"$BACKUP_DIR\" -name \"*.gz\" -mtime +30 -delete\n\necho \"Backup completed: $DATE\"\nEOF\n\nsudo chmod +x /usr/local/bin/mastodon-backup.sh\n```\n\n### Automated Backups\n\n```bash\n# Add to crontab\necho \"0 2 * * * /usr/local/bin/mastodon-backup.sh\" | sudo crontab -\n```\n\n### Restore Procedure\n\n```bash\n# Stop Mastodon services\nsudo systemctl stop mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Restore database\nsudo -u postgres dropdb mastodon_production\nsudo -u postgres createdb mastodon_production\nsudo -u postgres psql -c \"GRANT ALL PRIVILEGES ON DATABASE mastodon_production TO mastodon;\"\ngunzip -c /backup/mastodon/db_YYYYMMDD_HHMMSS.sql.gz | sudo -u postgres psql mastodon_production\n\n# Restore media files (if needed)\nsudo rm -rf /home/mastodon/live/public/system\nsudo tar -xzf /backup/mastodon/media_YYYYMMDD_HHMMSS.tar.gz -C /home/mastodon/live/public/\nsudo chown -R mastodon:mastodon /home/mastodon/live/public/system\n\n# Restore configuration\nsudo tar -xzf /backup/mastodon/config_YYYYMMDD_HHMMSS.tar.gz -C /\n\n# Start services\nsudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming\n```\n\n## System Requirements\n\n### Minimum Requirements\n- **CPU**: 2 cores, 2.0 GHz\n- **RAM**: 4GB\n- **Storage**: 20GB SSD\n- **Network**: 100 Mbps\n- **OS**: Linux (64-bit)\n\n### Recommended Production Requirements\n- **CPU**: 4+ cores, 2.5+ GHz\n- **RAM**: 8GB+ (16GB for large instances)\n- **Storage**: 100GB+ SSD with good IOPS\n- **Network**: 1 Gbps with low latency\n- **OS**: Recent Linux distribution with long-term support\n\n### Scaling Considerations\n- **Small Instance**: \u003c1,000 users - 2 cores, 4GB RAM, 50GB storage\n- **Medium Instance**: 1,000-10,000 users - 4 cores, 8GB RAM, 200GB storage\n- **Large Instance**: 10,000+ users - 8+ cores, 16GB+ RAM, 500GB+ storage\n\n## Support\n\n### Official Resources\n- **Official Website**: [https://joinmastodon.org](https://joinmastodon.org)\n- **Documentation**: [https://docs.joinmastodon.org](https://docs.joinmastodon.org)\n- **GitHub Repository**: [https://github.com/mastodon/mastodon](https://github.com/mastodon/mastodon)\n- **Admin Documentation**: [https://docs.joinmastodon.org/admin/](https://docs.joinmastodon.org/admin/)\n\n### Community Support\n- **Mastodon Discord**: [https://discord.gg/mastodon](https://discord.gg/mastodon)\n- **GitHub Issues**: [https://github.com/mastodon/mastodon/issues](https://github.com/mastodon/mastodon/issues)\n- **Mastodon Community**: Follow @Mastodon@mastodon.social\n- **Admin Forums**: Various Mastodon admin communities on the fediverse\n\n### Commercial Support\n- Available from various consulting companies\n- Managed hosting providers offer Mastodon services\n- Professional services for large deployments\n\n## Contributing\n\n### How to Contribute\n1. **Report Bugs**: Submit issues to [GitHub](https://github.com/mastodon/mastodon/issues)\n2. **Translate**: Help with internationalization at [Crowdin](https://crowdin.com/project/mastodon)\n3. **Code Contributions**: Submit pull requests for bug fixes and features\n4. **Documentation**: Improve documentation and guides\n5. **Testing**: Test release candidates and provide feedback\n\n### Development Setup\n```bash\n# Clone repository\ngit clone https://github.com/mastodon/mastodon.git\ncd mastodon\n\n# Install dependencies\nbundle install\nyarn install\n\n# Setup development database\nrails db:setup\n\n# Run development server\nforeman start\n```\n\n### Contribution Guidelines\n- Follow Ruby and JavaScript style guides\n- Include tests for new features\n- Update documentation for changes\n- Use conventional commit messages\n- Sign commits with GPG key\n\n## License\n\nMastodon is licensed under the **GNU Affero General Public License v3.0 (AGPL-3.0)**.\n\n### Key License Points\n- **Free to Use**: Can be used for any purpose\n- **Source Available**: Source code must be provided to users\n- **Copyleft**: Derivative works must use same license\n- **Network Use**: AGPL applies to network/web services\n- **No Warranty**: Software provided \"as is\"\n\n### License Compliance\n- Keep license notices intact\n- Provide source code to users\n- Document any modifications\n- Use same license for derivatives\n- Consider legal requirements for your jurisdiction\n\nFull license text: [https://github.com/mastodon/mastodon/blob/main/LICENSE](https://github.com/mastodon/mastodon/blob/main/LICENSE)\n\n## Acknowledgments\n\n### Core Team\n- **Eugen Rochko** - Creator and lead developer\n- **Claire** - Core maintainer\n- **Renaud Chaput** - Core maintainer\n- **ThibG** - Significant contributor\n- And many other contributors\n\n### Technologies Used\n- **Ruby on Rails** - Web application framework\n- **PostgreSQL** - Primary database\n- **Redis** - Caching and job queue\n- **React.js** - Frontend user interface\n- **ActivityPub** - Federation protocol\n- **Sidekiq** - Background job processing\n\n### Community\n- **Translators** - Making Mastodon available in many languages\n- **Instance Administrators** - Running the fediverse\n- **Users** - Creating the vibrant community\n- **Contributors** - Improving the software\n\n## Version History\n\n### Major Releases\n- **v4.2** (September 2023) - Enhanced moderation tools, quote posts\n- **v4.1** (February 2023) - Improved federation, performance optimizations\n- **v4.0** (October 2022) - Major UI overhaul, new features\n- **v3.5** (May 2022) - Content warnings improvements, admin features\n- **v3.4** (October 2021) - Server rules, report improvements\n- **v3.3** (February 2021) - Profile directory, admin announcements\n- **v3.2** (July 2020) - Audio uploads, admin interface improvements\n- **v3.1** (February 2020) - Polls, improved federation\n- **v3.0** (October 2019) - Single column mode, admin dashboard\n\n### Current Stable Version\n- **v4.2.x** - Latest stable release\n- Check [GitHub releases](https://github.com/mastodon/mastodon/releases) for current version\n\n### Upgrade Path\n- Always backup before upgrading\n- Follow official upgrade guides\n- Test in staging environment first\n- Monitor for federation issues after upgrade\n\n## Appendices\n\n### Appendix A: Port Reference\n\n| Port | Service | Protocol | Description |\n|------|---------|----------|-------------|\n| 80 | HTTP | TCP | Web traffic (redirects to HTTPS) |\n| 443 | HTTPS | TCP | Secure web traffic |\n| 3000 | Mastodon Web | TCP | Internal web service |\n| 4000 | Mastodon Streaming | TCP | Real-time updates |\n| 5432 | PostgreSQL | TCP | Database (internal) |\n| 6379 | Redis | TCP | Cache and queues (internal) |\n| 25/587 | SMTP | TCP | Email delivery (outbound) |\n\n### Appendix B: File Locations\n\n| Path | Description |\n|------|-------------|\n| `/home/mastodon/live/` | Mastodon application directory |\n| `/home/mastodon/live/.env.production` | Main configuration file |\n| `/home/mastodon/live/public/system/` | Media files storage |\n| `/etc/systemd/system/mastodon-*.service` | Service definitions |\n| `/etc/nginx/sites-available/mastodon` | nginx configuration |\n| `/var/lib/postgresql/*/data/` | PostgreSQL data directory |\n| `/etc/redis/redis.conf` | Redis configuration |\n| `/var/log/nginx/` | nginx logs |\n\n### Appendix C: Common Commands\n\n```bash\n# Service management\nsudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming\nsudo systemctl restart mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Mastodon maintenance\nsudo -u mastodon bash -c 'cd /home/mastodon/live \u0026\u0026 RAILS_ENV=production bundle exec rails mastodon:maintenance'\n\n# Database management\nsudo -u postgres psql mastodon_production\n\n# Log monitoring\nsudo journalctl -u mastodon-web -f\nsudo tail -f /var/log/nginx/access.log\n```\n\n### Appendix D: Environment Variables Reference\n\n| Variable | Description | Required |\n|----------|-------------|----------|\n| `LOCAL_DOMAIN` | Your Mastodon domain | Yes |\n| `SECRET_KEY_BASE` | Rails secret key | Yes |\n| `OTP_SECRET` | Two-factor authentication secret | Yes |\n| `VAPID_PRIVATE_KEY` | Push notification private key | Yes |\n| `VAPID_PUBLIC_KEY` | Push notification public key | Yes |\n| `DB_HOST` | Database hostname | Yes |\n| `DB_USER` | Database username | Yes |\n| `DB_PASS` | Database password | Yes |\n| `DB_NAME` | Database name | Yes |\n| `REDIS_HOST` | Redis hostname | Yes |\n| `SMTP_SERVER` | SMTP server hostname | Recommended |\n| `SMTP_FROM_ADDRESS` | From email address | Recommended |\n| `S3_ENABLED` | Enable S3 storage | No |\n| `CDN_HOST` | CDN hostname for assets | No |\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection. Always refer to official Mastodon documentation for the most up-to-date information.","readmeHtml":"\u003cp class=\"mobile-paragraph\"\u003eMastodon is a free, open-source federated social network server that provides a decentralized alternative to proprietary platforms like Twitter/X. Built on Ruby on Rails and using ActivityPub protocol, Mastodon allows users to run their own social media instance while connecting to the broader fediverse.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003ch3 id=\"hardware-requirements\" class=\"mobile-header\"\u003eHardware Requirements\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCPU\u003c/strong\u003e: 2+ cores (4+ cores recommended for production)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRAM\u003c/strong\u003e: 4GB minimum (8GB+ recommended for production)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eStorage\u003c/strong\u003e: 20GB minimum (SSD recommended, scale based on media storage needs)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork\u003c/strong\u003e: Reliable internet connection with public IP (for federation)\u003c/li\u003e\n\u003ch3 id=\"software-dependencies\" class=\"mobile-header\"\u003eSoftware Dependencies\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOperating System\u003c/strong\u003e: Linux (RHEL-based, Debian-based, Arch Linux, Alpine Linux)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDatabase\u003c/strong\u003e: PostgreSQL 12+ (PostgreSQL 15+ recommended)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCache/Queue\u003c/strong\u003e: Redis 6.0+\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRuntime\u003c/strong\u003e: Ruby 3.0+ (Ruby 3.2+ recommended)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eWeb Server\u003c/strong\u003e: nginx or Apache (for reverse proxy)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSSL Certificate\u003c/strong\u003e: Let's Encrypt or commercial certificate\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNode.js\u003c/strong\u003e: 16+ (for asset compilation)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eYarn\u003c/strong\u003e: Package manager for Node.js dependencies\u003c/li\u003e\n\u003ch3 id=\"network-requirements\" class=\"mobile-header\"\u003eNetwork Requirements\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ePorts\u003c/strong\u003e: \u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e80/443 (HTTP/HTTPS)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e25/587 (SMTP - for email delivery)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e3000 (Mastodon web interface)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e4000 (Mastodon streaming API)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDomain\u003c/strong\u003e: Registered domain name with DNS control\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eEmail\u003c/strong\u003e: SMTP server for notifications and user registration\u003c/li\u003e\n\u003ch3 id=\"system-access\" class=\"mobile-header\"\u003eSystem Access\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot or sudo access required for installation\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eDedicated user account for Mastodon service\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFirewall configuration access\u003c/li\u003e\n\u003ch2 id=\"supported-operating-systems\" class=\"mobile-header\"\u003eSupported Operating Systems\u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eThis guide supports installation on:\u003c/p\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRHEL-based\u003c/strong\u003e: RHEL 8/9, CentOS Stream 8/9, Rocky Linux 8/9, AlmaLinux 8/9, Fedora 37+\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDebian-based\u003c/strong\u003e: Debian 11/12, Ubuntu 20.04/22.04/24.04 LTS\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eArch Linux\u003c/strong\u003e: Arch Linux (rolling), Manjaro\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eAlpine Linux\u003c/strong\u003e: 3.18+ (containerized deployments)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003emacOS\u003c/strong\u003e: 12+ (development only)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eFreeBSD\u003c/strong\u003e: 13.0+ (experimental)\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"rhelcentosrocky-linuxalmalinux\" class=\"mobile-header\"\u003eRHEL/CentOS/Rocky Linux/AlmaLinux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install EPEL and PowerTools repositories\nsudo dnf install -y epel-release\nsudo dnf config-manager --set-enabled powertools  # CentOS Stream 8\nsudo dnf config-manager --set-enabled crb         # CentOS Stream 9, Rocky, AlmaLinux\n\n# Install Node.js repository\ncurl -fsSL https://rpm.nodesource.com/setup_lts.x | sudo bash -\n\n# Install Yarn repository\ncurl -sL https://dl.yarnpkg.com/rpm/yarn.repo | sudo tee /etc/yum.repos.d/yarn.repo\n\n# Install PostgreSQL repository (for latest version)\nsudo dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-$(rpm -E %{rhel})-x86_64/pgdg-redhat-repo-latest.noarch.rpm\n\n# Install required packages\nsudo dnf install -y \\\n    git curl wget gnupg2 \\\n    gcc gcc-c++ make automake autoconf libtool \\\n    postgresql15-server postgresql15-devel \\\n    redis \\\n    nodejs yarn \\\n    nginx \\\n    ImageMagick ImageMagick-devel \\\n    ffmpeg \\\n    libxml2-devel libxslt-devel \\\n    libidn-devel \\\n    openssl-devel \\\n    readline-devel \\\n    zlib-devel \\\n    libyaml-devel \\\n    gdbm-devel \\\n    ncurses-devel \\\n    libffi-devel\n\n# Initialize PostgreSQL\nsudo postgresql-15-setup initdb\nsudo systemctl enable --now postgresql-15 redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \u0026quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD \u0026#039;secure_random_password_here\u0026#039;;\u0026quot;\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon nginx\n\n# Install Ruby (using rbenv for version management)\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho \u0026#039;export PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\necho \u0026#039;eval \u0026quot;$(rbenv init -)\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v \u0026#039;rc\u0026#039; | sort -V | tail -n 1)\n\n# Install Ruby dependencies\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle config deployment \u0026#039;true\u0026#039;\nbundle config without \u0026#039;development test\u0026#039;\nbundle install\nEOF\n\n# Install Node.js dependencies\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nyarn install --pure-lockfile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"debianubuntu\" class=\"mobile-header\"\u003eDebian/Ubuntu\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update package list\nsudo apt update\n\n# Install curl and gnupg (if not already installed)\nsudo apt install -y curl gnupg\n\n# Add Node.js repository\ncurl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -\n\n# Add Yarn repository\ncurl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -\necho \u0026quot;deb https://dl.yarnpkg.com/debian/ stable main\u0026quot; | sudo tee /etc/apt/sources.list.d/yarn.list\n\n# Add PostgreSQL repository (for latest version)\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\necho \u0026quot;deb http://apt.postgresql.org/pub/repos/apt/ $(lsb_release -cs)-pgdg main\u0026quot; | sudo tee /etc/apt/sources.list.d/pgdg.list\n\n# Update package list\nsudo apt update\n\n# Install required packages\nsudo apt install -y \\\n    git curl wget gnupg \\\n    build-essential \\\n    postgresql-15 postgresql-contrib-15 postgresql-server-dev-15 \\\n    redis-server \\\n    nodejs yarn \\\n    nginx \\\n    imagemagick ffmpeg \\\n    libxml2-dev libxslt1-dev \\\n    libidn11-dev \\\n    libssl-dev \\\n    libreadline-dev \\\n    zlib1g-dev \\\n    libyaml-dev \\\n    libgdbm-dev \\\n    libncurses5-dev \\\n    libffi-dev \\\n    libpq-dev\n\n# Start and enable services\nsudo systemctl enable --now postgresql redis-server\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \u0026quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD \u0026#039;secure_random_password_here\u0026#039;;\u0026quot;\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon www-data\n\n# Install Ruby (using rbenv)\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho \u0026#039;export PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\necho \u0026#039;eval \u0026quot;$(rbenv init -)\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v \u0026#039;rc\u0026#039; | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle config deployment \u0026#039;true\u0026#039;\nbundle config without \u0026#039;development test\u0026#039;\nbundle install\nyarn install --pure-lockfile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"arch-linux\" class=\"mobile-header\"\u003eArch Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update system\nsudo pacman -Syu\n\n# Install required packages\nsudo pacman -S --needed \\\n    git curl wget gnupg \\\n    base-devel \\\n    postgresql redis \\\n    nodejs npm yarn \\\n    nginx \\\n    imagemagick ffmpeg \\\n    libxml2 libxslt \\\n    libidn \\\n    openssl \\\n    readline \\\n    zlib \\\n    libyaml \\\n    gdbm \\\n    ncurses \\\n    libffi\n\n# Initialize PostgreSQL\nsudo -u postgres initdb -D /var/lib/postgres/data\nsudo systemctl enable --now postgresql redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \u0026quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD \u0026#039;secure_random_password_here\u0026#039;;\u0026quot;\n\n# Create mastodon user\nsudo useradd -m -s /bin/bash mastodon\nsudo usermod -a -G mastodon http\n\n# Install Ruby using rbenv\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho \u0026#039;export PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\necho \u0026#039;eval \u0026quot;$(rbenv init -)\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone and setup Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v \u0026#039;rc\u0026#039; | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle config deployment \u0026#039;true\u0026#039;\nbundle config without \u0026#039;development test\u0026#039;\nbundle install\nyarn install --pure-lockfile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"alpine-linux\" class=\"mobile-header\"\u003eAlpine Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update package index\napk update\n\n# Install required packages\napk add --no-cache \\\n    git curl wget gnupg \\\n    build-base \\\n    postgresql15 postgresql15-dev postgresql15-contrib \\\n    redis \\\n    nodejs npm yarn \\\n    nginx \\\n    imagemagick imagemagick-dev ffmpeg \\\n    libxml2-dev libxslt-dev \\\n    libidn-dev \\\n    openssl-dev \\\n    readline-dev \\\n    zlib-dev \\\n    yaml-dev \\\n    gdbm-dev \\\n    ncurses-dev \\\n    libffi-dev\n\n# Initialize and start services\nrc-service postgresql setup\nrc-service postgresql start\nrc-service redis start\nrc-update add postgresql\nrc-update add redis\n\n# Configure PostgreSQL\nsudo -u postgres createuser mastodon --createdb\nsudo -u postgres psql -c \u0026quot;ALTER USER mastodon WITH ENCRYPTED PASSWORD \u0026#039;secure_random_password_here\u0026#039;;\u0026quot;\n\n# Create mastodon user\nadduser -D -s /bin/ash mastodon\naddgroup mastodon nginx\n\n# Install Ruby using rbenv\nsudo -u mastodon ash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon\ngit clone https://github.com/rbenv/rbenv.git ~/.rbenv\necho \u0026#039;export PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.profile\necho \u0026#039;eval \u0026quot;$(rbenv init -)\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.profile\ngit clone https://github.com/rbenv/ruby-build.git ~/.rbenv/plugins/ruby-build\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nrbenv install 3.2.2\nrbenv global 3.2.2\ngem install bundler\nEOF\n\n# Clone and setup Mastodon\nsudo -u mastodon git clone https://github.com/mastodon/mastodon.git /home/mastodon/live\ncd /home/mastodon/live\nsudo -u mastodon git checkout $(git tag -l | grep -v \u0026#039;rc\u0026#039; | sort -V | tail -n 1)\n\n# Install dependencies\nsudo -u mastodon ash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle config deployment \u0026#039;true\u0026#039;\nbundle config without \u0026#039;development test\u0026#039;\nbundle install\nyarn install --pure-lockfile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"configuration\" class=\"mobile-header\"\u003eConfiguration\u003c/h2\u003e\n\u003ch3 id=\"environment-configuration\" class=\"mobile-header\"\u003eEnvironment Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Switch to mastodon user\nsudo -u mastodon bash\n\n# Navigate to Mastodon directory\ncd /home/mastodon/live\n\n# Generate configuration\nRAILS_ENV=production bundle exec rake mastodon:setup\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003eThis interactive setup will prompt for:\u003c/p\u003e\n\u003cli class=\"mobile-list-item\"\u003eDomain name (e.g., mastodon.example.com)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eDatabase configuration\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRedis configuration\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eEmail settings (SMTP)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFile storage settings\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eAdmin account creation\u003c/li\u003e\n\u003ch3 id=\"manual-environment-configuration\" class=\"mobile-header\"\u003eManual Environment Configuration\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eIf you prefer manual configuration, create \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/.env.production\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create environment file\nsudo -u mastodon tee /home/mastodon/live/.env.production \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\n# Federation\nLOCAL_DOMAIN=mastodon.example.com\nWEB_DOMAIN=mastodon.example.com\n\n# Redis\nREDIS_HOST=127.0.0.1\nREDIS_PORT=6379\n\n# PostgreSQL\nDB_HOST=127.0.0.1\nDB_USER=mastodon\nDB_NAME=mastodon_production\nDB_PASS=secure_random_password_here\nDB_PORT=5432\n\n# ElasticSearch (optional, for full-text search)\n# ES_ENABLED=true\n# ES_HOST=localhost\n# ES_PORT=9200\n\n# Secrets\n# Generate with: bundle exec rake secret\nSECRET_KEY_BASE=generate_with_rake_secret\nOTP_SECRET=generate_with_rake_secret\n\n# VAPID keys (for push notifications)\n# Generate with: bundle exec rake mastodon:webpush:generate_vapid_key\nVAPID_PRIVATE_KEY=\nVAPID_PUBLIC_KEY=\n\n# Sending mail\nSMTP_SERVER=smtp.example.com\nSMTP_PORT=587\nSMTP_LOGIN=mastodon@example.com\nSMTP_PASSWORD=smtp_password\nSMTP_FROM_ADDRESS=mastodon@example.com\n\n# File storage (local)\nPAPERCLIP_ROOT_PATH=/home/mastodon/live/public/system\n\n# Optional S3/compatible storage\n# S3_ENABLED=true\n# S3_BUCKET=mastodon\n# AWS_ACCESS_KEY_ID=\n# AWS_SECRET_ACCESS_KEY=\n# S3_REGION=us-east-1\n# S3_HOSTNAME=s3.amazonaws.com\n\n# Optional CDN\n# CDN_HOST=assets.example.com\n\n# Streaming\nSTREAMING_CLUSTER_NUM=1\nSTREAMING_API_BASE_URL=wss://mastodon.example.com\n\n# Advanced settings\nMAX_TOOT_CHARS=500\nSINGLE_USER_MODE=false\nAUTHORIZED_FETCH=false\nLIMITED_FEDERATION_MODE=false\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"database-setup\" class=\"mobile-header\"\u003eDatabase Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Switch to mastodon user and setup database\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\n\n# Create database\nRAILS_ENV=production bundle exec rails db:create\nRAILS_ENV=production bundle exec rails db:schema:load\nRAILS_ENV=production bundle exec rails db:seed\n\n# Compile assets\nRAILS_ENV=production bundle exec rails assets:precompile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"service-management\" class=\"mobile-header\"\u003eService Management\u003c/h2\u003e\n\u003ch3 id=\"systemd-service-files-rheldebianarchsuse\" class=\"mobile-header\"\u003eSystemd Service Files (RHEL/Debian/Arch/SUSE)\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate the web service (\u003ccode class=\"mobile-inline-code\"\u003e/etc/systemd/system/mastodon-web.service\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e[Unit]\nDescription=mastodon-web\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\u0026quot;RAILS_ENV=production\u0026quot;\nEnvironment=\u0026quot;PORT=3000\u0026quot;\nExecStart=/home/mastodon/.rbenv/shims/bundle exec puma -C config/puma.rb\nExecReload=/bin/kill -SIGUSR1 $MAINPID\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-web\n\n[Install]\nWantedBy=multi-user.target\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate the background jobs service (\u003ccode class=\"mobile-inline-code\"\u003e/etc/systemd/system/mastodon-sidekiq.service\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e[Unit]\nDescription=mastodon-sidekiq\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\u0026quot;RAILS_ENV=production\u0026quot;\nEnvironment=\u0026quot;DB_POOL=25\u0026quot;\nExecStart=/home/mastodon/.rbenv/shims/bundle exec sidekiq -c 25\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-sidekiq\n\n[Install]\nWantedBy=multi-user.target\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate the streaming service (\u003ccode class=\"mobile-inline-code\"\u003e/etc/systemd/system/mastodon-streaming.service\u003c/code\u003e):\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e[Unit]\nDescription=mastodon-streaming\nAfter=network.target\n\n[Service]\nType=simple\nUser=mastodon\nWorkingDirectory=/home/mastodon/live\nEnvironment=\u0026quot;NODE_ENV=production\u0026quot;\nEnvironment=\u0026quot;PORT=4000\u0026quot;\nExecStart=/usr/bin/node streaming\nTimeoutSec=15\nRestart=always\nRestartSec=10\nSyslogIdentifier=mastodon-streaming\n\n[Install]\nWantedBy=multi-user.target\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"enable-and-start-services\" class=\"mobile-header\"\u003eEnable and Start Services\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Reload systemd and enable services\nsudo systemctl daemon-reload\nsudo systemctl enable mastodon-web mastodon-sidekiq mastodon-streaming\nsudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Check status\nsudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"openrc-services-alpine-linux\" class=\"mobile-header\"\u003eOpenRC Services (Alpine Linux)\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate \u003ccode class=\"mobile-inline-code\"\u003e/etc/init.d/mastodon-web\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/sbin/openrc-run\n\nname=\u0026quot;mastodon-web\u0026quot;\ndescription=\u0026quot;Mastodon web service\u0026quot;\n\nuser=\u0026quot;mastodon\u0026quot;\ngroup=\u0026quot;mastodon\u0026quot;\ndirectory=\u0026quot;/home/mastodon/live\u0026quot;\n\ncommand=\u0026quot;/home/mastodon/.rbenv/shims/bundle\u0026quot;\ncommand_args=\u0026quot;exec puma -C config/puma.rb\u0026quot;\ncommand_background=\u0026quot;yes\u0026quot;\n\npidfile=\u0026quot;/run/${name}.pid\u0026quot;\noutput_log=\u0026quot;/var/log/${name}.log\u0026quot;\nerror_log=\u0026quot;/var/log/${name}.error.log\u0026quot;\n\ndepend() {\n    need net postgresql redis\n}\n\nstart_pre() {\n    export RAILS_ENV=production\n    export PORT=3000\n}\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate similar files for \u003ccode class=\"mobile-inline-code\"\u003emastodon-sidekiq\u003c/code\u003e and \u003ccode class=\"mobile-inline-code\"\u003emastodon-streaming\u003c/code\u003e, then:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Make executable\nsudo chmod +x /etc/init.d/mastodon-*\n\n# Enable and start\nsudo rc-update add mastodon-web\nsudo rc-update add mastodon-sidekiq  \nsudo rc-update add mastodon-streaming\nsudo rc-service mastodon-web start\nsudo rc-service mastodon-sidekiq start\nsudo rc-service mastodon-streaming start\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting\" class=\"mobile-header\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues\" class=\"mobile-header\"\u003eCommon Issues\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eRuby/Bundle Issues:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Ensure proper rbenv setup\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nwhich ruby\nruby --version\nEOF\n\n# Reinstall gems if needed\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nbundle install --deployment --without development test\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eDatabase Connection Issues:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Test PostgreSQL connection\nsudo -u mastodon psql -h localhost -U mastodon mastodon_production\n\n# Check PostgreSQL logs\nsudo journalctl -u postgresql-15 -f\n\n# Verify database configuration\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nRAILS_ENV=production bundle exec rails console\n# In console: ActiveRecord::Base.connection\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eAsset Compilation Issues:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Clear and recompile assets\nsudo -u mastodon bash \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\ncd /home/mastodon/live\nexport PATH=\u0026quot;$HOME/.rbenv/bin:$PATH\u0026quot;\neval \u0026quot;$(rbenv init -)\u0026quot;\nRAILS_ENV=production bundle exec rails assets:clobber\nRAILS_ENV=production bundle exec rails assets:precompile\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eService Startup Issues:\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check service logs\nsudo journalctl -u mastodon-web -f\nsudo journalctl -u mastodon-sidekiq -f\nsudo journalctl -u mastodon-streaming -f\n\n# Check for port conflicts\nsudo netstat -tlnp | grep :3000\nsudo netstat -tlnp | grep :4000\n\n# Verify file permissions\nsudo ls -la /home/mastodon/live/\nsudo -u mastodon test -r /home/mastodon/live/.env.production \u0026amp;\u0026amp; echo \u0026quot;Can read env file\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"security-considerations\" class=\"mobile-header\"\u003eSecurity Considerations\u003c/h2\u003e\n\u003ch3 id=\"firewall-configuration\" class=\"mobile-header\"\u003eFirewall Configuration\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003efirewalld (RHEL/CentOS/Fedora):\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Open required ports\nsudo firewall-cmd --permanent --add-service=http\nsudo firewall-cmd --permanent --add-service=https\nsudo firewall-cmd --permanent --add-port=3000/tcp\nsudo firewall-cmd --permanent --add-port=4000/tcp\nsudo firewall-cmd --reload\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eufw (Ubuntu/Debian):\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure firewall\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\nsudo ufw allow 3000/tcp\nsudo ufw allow 4000/tcp\nsudo ufw enable\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eiptables (Generic):\u003c/strong\u003e\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Basic firewall rules\nsudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 3000 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 4000 -j ACCEPT\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ssltls-configuration-with-nginx\" class=\"mobile-header\"\u003eSSL/TLS Configuration with nginx\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eCreate \u003ccode class=\"mobile-inline-code\"\u003e/etc/nginx/sites-available/mastodon\u003c/code\u003e (Debian/Ubuntu) or \u003ccode class=\"mobile-inline-code\"\u003e/etc/nginx/conf.d/mastodon.conf\u003c/code\u003e (RHEL):\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"nginx\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003enginx\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-nginx\"\u003emap $http_upgrade $connection_upgrade {\n  default upgrade;\n  \u0026#039;\u0026#039;      close;\n}\n\nupstream backend {\n    server 127.0.0.1:3000 fail_timeout=0;\n}\n\nupstream streaming {\n    server 127.0.0.1:4000 fail_timeout=0;\n}\n\nproxy_cache_path /var/cache/nginx/mastodon keys_zone=CACHE:10m levels=1:2 inactive=7d max_size=1g;\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name mastodon.example.com;\n    root /home/mastodon/live/public;\n    location /.well-known/acme-challenge/ { allow all; }\n    location / { return 301 https://$host$request_uri; }\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name mastodon.example.com;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-CHACHA20-POLY1305:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384;\n    ssl_prefer_server_ciphers off;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_tickets off;\n\n    ssl_certificate     /etc/letsencrypt/live/mastodon.example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/mastodon.example.com/privkey.pem;\n\n    keepalive_timeout    70;\n    sendfile             on;\n    client_max_body_size 80m;\n\n    root /home/mastodon/live/public;\n\n    gzip on;\n    gzip_disable \u0026quot;msie6\u0026quot;;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types\n        text/plain\n        text/css\n        text/xml\n        text/javascript\n        application/json\n        application/javascript\n        application/xml+rss\n        application/atom+xml\n        image/svg+xml;\n\n    add_header Strict-Transport-Security \u0026quot;max-age=31536000\u0026quot; always;\n\n    location / {\n        try_files $uri @proxy;\n    }\n\n    location ~ ^/(emoji|packs|system/accounts/avatars|system/media_attachments/files) {\n        add_header Cache-Control \u0026quot;public, max-age=31536000, immutable\u0026quot;;\n        add_header Strict-Transport-Security \u0026quot;max-age=31536000\u0026quot; always;\n        try_files $uri @proxy;\n    }\n    \n    location /sw.js {\n        add_header Cache-Control \u0026quot;public, max-age=604800, must-revalidate\u0026quot;;\n        add_header Strict-Transport-Security \u0026quot;max-age=31536000\u0026quot; always;\n        try_files $uri @proxy;\n    }\n\n    location @proxy {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Proxy \u0026quot;\u0026quot;;\n        proxy_pass_header Server;\n\n        proxy_pass http://backend;\n        proxy_buffering on;\n        proxy_redirect off;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        proxy_cache CACHE;\n        proxy_cache_valid 200 7d;\n        proxy_cache_valid 410 24h;\n        proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;\n        proxy_cache_lock on;\n\n        tcp_nodelay on;\n    }\n\n    location /api/v1/streaming {\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Proxy \u0026quot;\u0026quot;;\n\n        proxy_pass http://streaming;\n        proxy_buffering off;\n        proxy_redirect off;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n\n        tcp_nodelay on;\n    }\n\n    error_page 500 501 502 503 504 /500.html;\n}\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ssl-certificate-setup\" class=\"mobile-header\"\u003eSSL Certificate Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Certbot\n# RHEL/CentOS/Fedora\nsudo dnf install -y certbot python3-certbot-nginx\n\n# Debian/Ubuntu  \nsudo apt install -y certbot python3-certbot-nginx\n\n# Arch Linux\nsudo pacman -S certbot certbot-nginx\n\n# Obtain certificate\nsudo certbot --nginx -d mastodon.example.com\n\n# Auto-renewal\necho \u0026quot;0 12 * * * /usr/bin/certbot renew --quiet\u0026quot; | sudo crontab -\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"selinux-configuration-rhel-based-systems\" class=\"mobile-header\"\u003eSELinux Configuration (RHEL-based systems)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Allow nginx to connect to Mastodon services\nsudo setsebool -P httpd_can_network_connect 1\n\n# Set SELinux contexts for Mastodon files\nsudo semanage fcontext -a -t httpd_exec_t \u0026quot;/home/mastodon/live/public(/.*)?\u0026quot;\nsudo restorecon -R /home/mastodon/live/public/\n\n# Allow Mastodon to bind to required ports\nsudo semanage port -a -t http_port_t -p tcp 3000\nsudo semanage port -a -t http_port_t -p tcp 4000\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"performance-tuning\" class=\"mobile-header\"\u003ePerformance Tuning\u003c/h2\u003e\n\u003ch3 id=\"postgresql-optimization\" class=\"mobile-header\"\u003ePostgreSQL Optimization\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eEdit \u003ccode class=\"mobile-inline-code\"\u003e/var/lib/pgsql/15/data/postgresql.conf\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e# Memory settings (adjust based on available RAM)\nshared_buffers = 256MB                 # 1/4 of RAM\neffective_cache_size = 1GB            # 3/4 of RAM\nwork_mem = 4MB                        # RAM/max_connections/4\nmaintenance_work_mem = 64MB           # RAM/16\n\n# Connection settings\nmax_connections = 100\nsuperuser_reserved_connections = 3\n\n# WAL settings for better performance\nwal_buffers = 16MB\ncheckpoint_completion_target = 0.7\ncheckpoint_timeout = 5min\nmax_wal_size = 1GB\nmin_wal_size = 80MB\n\n# Query optimization\nrandom_page_cost = 1.1                # For SSD storage\neffective_io_concurrency = 200        # For SSD storage\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"redis-optimization\" class=\"mobile-header\"\u003eRedis Optimization\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eEdit \u003ccode class=\"mobile-inline-code\"\u003e/etc/redis/redis.conf\u003c/code\u003e or \u003ccode class=\"mobile-inline-code\"\u003e/etc/redis.conf\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"ini\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eini\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-ini\"\u003e# Memory optimization\nmaxmemory 256mb\nmaxmemory-policy allkeys-lru\n\n# Persistence (adjust based on needs)\nsave 900 1\nsave 300 10\nsave 60 10000\n\n# Network optimization\ntcp-keepalive 300\ntimeout 0\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"rubyrails-optimization\" class=\"mobile-header\"\u003eRuby/Rails Optimization\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003eEdit \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/.env.production\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Database connection pooling\nDB_POOL=25\n\n# Sidekiq concurrency\nSIDEKIQ_CONCURRENCY=25\n\n# Puma workers (number of CPU cores)\nWEB_CONCURRENCY=4\nMAX_THREADS=5\n\n# Streaming cluster\nSTREAMING_CLUSTER_NUM=4\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"system-level-optimization\" class=\"mobile-header\"\u003eSystem-level Optimization\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Increase file descriptors limit\necho \u0026quot;mastodon soft nofile 65536\u0026quot; | sudo tee -a /etc/security/limits.conf\necho \u0026quot;mastodon hard nofile 65536\u0026quot; | sudo tee -a /etc/security/limits.conf\n\n# Optimize kernel parameters\nsudo tee -a /etc/sysctl.conf \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\n# Network optimization\nnet.core.somaxconn = 1024\nnet.core.netdev_max_backlog = 5000\nnet.ipv4.tcp_max_syn_backlog = 1024\nnet.ipv4.tcp_keepalive_time = 120\nnet.ipv4.tcp_keepalive_intvl = 30\nnet.ipv4.tcp_keepalive_probes = 3\n\n# Memory optimization\nvm.swappiness = 10\nvm.dirty_ratio = 15\nvm.dirty_background_ratio = 5\nEOF\n\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-and-restore\" class=\"mobile-header\"\u003eBackup and Restore\u003c/h2\u003e\n\u003ch3 id=\"database-backup\" class=\"mobile-header\"\u003eDatabase Backup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create backup script\nsudo tee /usr/local/bin/mastodon-backup.sh \u0026lt;\u0026lt; \u0026#039;EOF\u0026#039;\n#!/bin/bash\n\nBACKUP_DIR=\u0026quot;/backup/mastodon\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\nDB_NAME=\u0026quot;mastodon_production\u0026quot;\nMEDIA_DIR=\u0026quot;/home/mastodon/live/public/system\u0026quot;\n\n# Create backup directory\nmkdir -p \u0026quot;$BACKUP_DIR\u0026quot;\n\n# Database backup\nsudo -u postgres pg_dump \u0026quot;$DB_NAME\u0026quot; | gzip \u0026gt; \u0026quot;$BACKUP_DIR/db_${DATE}.sql.gz\u0026quot;\n\n# Media backup (if stored locally)\nif [ -d \u0026quot;$MEDIA_DIR\u0026quot; ]; then\n    tar -czf \u0026quot;$BACKUP_DIR/media_${DATE}.tar.gz\u0026quot; -C \u0026quot;$(dirname \u0026quot;$MEDIA_DIR\u0026quot;)\u0026quot; \u0026quot;$(basename \u0026quot;$MEDIA_DIR\u0026quot;)\u0026quot;\nfi\n\n# Configuration backup\ntar -czf \u0026quot;$BACKUP_DIR/config_${DATE}.tar.gz\u0026quot; /home/mastodon/live/.env.production\n\n# Remove backups older than 30 days\nfind \u0026quot;$BACKUP_DIR\u0026quot; -name \u0026quot;*.gz\u0026quot; -mtime +30 -delete\n\necho \u0026quot;Backup completed: $DATE\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/mastodon-backup.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"automated-backups\" class=\"mobile-header\"\u003eAutomated Backups\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Add to crontab\necho \u0026quot;0 2 * * * /usr/local/bin/mastodon-backup.sh\u0026quot; | sudo crontab -\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"restore-procedure\" class=\"mobile-header\"\u003eRestore Procedure\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Stop Mastodon services\nsudo systemctl stop mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Restore database\nsudo -u postgres dropdb mastodon_production\nsudo -u postgres createdb mastodon_production\nsudo -u postgres psql -c \u0026quot;GRANT ALL PRIVILEGES ON DATABASE mastodon_production TO mastodon;\u0026quot;\ngunzip -c /backup/mastodon/db_YYYYMMDD_HHMMSS.sql.gz | sudo -u postgres psql mastodon_production\n\n# Restore media files (if needed)\nsudo rm -rf /home/mastodon/live/public/system\nsudo tar -xzf /backup/mastodon/media_YYYYMMDD_HHMMSS.tar.gz -C /home/mastodon/live/public/\nsudo chown -R mastodon:mastodon /home/mastodon/live/public/system\n\n# Restore configuration\nsudo tar -xzf /backup/mastodon/config_YYYYMMDD_HHMMSS.tar.gz -C /\n\n# Start services\nsudo systemctl start mastodon-web mastodon-sidekiq mastodon-streaming\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"system-requirements\" class=\"mobile-header\"\u003eSystem Requirements\u003c/h2\u003e\n\u003ch3 id=\"minimum-requirements\" class=\"mobile-header\"\u003eMinimum Requirements\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCPU\u003c/strong\u003e: 2 cores, 2.0 GHz\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRAM\u003c/strong\u003e: 4GB\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eStorage\u003c/strong\u003e: 20GB SSD\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork\u003c/strong\u003e: 100 Mbps\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOS\u003c/strong\u003e: Linux (64-bit)\u003c/li\u003e\n\u003ch3 id=\"recommended-production-requirements\" class=\"mobile-header\"\u003eRecommended Production Requirements\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCPU\u003c/strong\u003e: 4+ cores, 2.5+ GHz\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRAM\u003c/strong\u003e: 8GB+ (16GB for large instances)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eStorage\u003c/strong\u003e: 100GB+ SSD with good IOPS\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork\u003c/strong\u003e: 1 Gbps with low latency\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOS\u003c/strong\u003e: Recent Linux distribution with long-term support\u003c/li\u003e\n\u003ch3 id=\"scaling-considerations\" class=\"mobile-header\"\u003eScaling Considerations\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSmall Instance\u003c/strong\u003e: \u003c1,000 users - 2 cores, 4GB RAM, 50GB storage\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eMedium Instance\u003c/strong\u003e: 1,000-10,000 users - 4 cores, 8GB RAM, 200GB storage\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eLarge Instance\u003c/strong\u003e: 10,000+ users - 8+ cores, 16GB+ RAM, 500GB+ storage\u003c/li\u003e\n\u003ch2 id=\"support\" class=\"mobile-header\"\u003eSupport\u003c/h2\u003e\n\u003ch3 id=\"official-resources\" class=\"mobile-header\"\u003eOfficial Resources\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOfficial Website\u003c/strong\u003e: \u003ca href=\"https://joinmastodon.org\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://joinmastodon.org\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDocumentation\u003c/strong\u003e: \u003ca href=\"https://docs.joinmastodon.org\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://docs.joinmastodon.org\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eGitHub Repository\u003c/strong\u003e: \u003ca href=\"https://github.com/mastodon/mastodon\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://github.com/mastodon/mastodon\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eAdmin Documentation\u003c/strong\u003e: \u003ca href=\"https://docs.joinmastodon.org/admin/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://docs.joinmastodon.org/admin/\u003c/a\u003e\u003c/li\u003e\n\u003ch3 id=\"community-support\" class=\"mobile-header\"\u003eCommunity Support\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eMastodon Discord\u003c/strong\u003e: \u003ca href=\"https://discord.gg/mastodon\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://discord.gg/mastodon\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eGitHub Issues\u003c/strong\u003e: \u003ca href=\"https://github.com/mastodon/mastodon/issues\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://github.com/mastodon/mastodon/issues\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eMastodon Community\u003c/strong\u003e: Follow @Mastodon@mastodon.social\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eAdmin Forums\u003c/strong\u003e: Various Mastodon admin communities on the fediverse\u003c/li\u003e\n\u003ch3 id=\"commercial-support\" class=\"mobile-header\"\u003eCommercial Support\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eAvailable from various consulting companies\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eManaged hosting providers offer Mastodon services\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eProfessional services for large deployments\u003c/li\u003e\n\u003ch2 id=\"contributing\" class=\"mobile-header\"\u003eContributing\u003c/h2\u003e\n\u003ch3 id=\"how-to-contribute\" class=\"mobile-header\"\u003eHow to Contribute\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e1. \u003cstrong\u003eReport Bugs\u003c/strong\u003e: Submit issues to \u003ca href=\"https://github.com/mastodon/mastodon/issues\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGitHub\u003c/a\u003e\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e2. \u003cstrong\u003eTranslate\u003c/strong\u003e: Help with internationalization at \u003ca href=\"https://crowdin.com/project/mastodon\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eCrowdin\u003c/a\u003e\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e3. \u003cstrong\u003eCode Contributions\u003c/strong\u003e: Submit pull requests for bug fixes and features\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e4. \u003cstrong\u003eDocumentation\u003c/strong\u003e: Improve documentation and guides\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e5. \u003cstrong\u003eTesting\u003c/strong\u003e: Test release candidates and provide feedback\u003c/p\u003e\n\u003ch3 id=\"development-setup\" class=\"mobile-header\"\u003eDevelopment Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Clone repository\ngit clone https://github.com/mastodon/mastodon.git\ncd mastodon\n\n# Install dependencies\nbundle install\nyarn install\n\n# Setup development database\nrails db:setup\n\n# Run development server\nforeman start\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"contribution-guidelines\" class=\"mobile-header\"\u003eContribution Guidelines\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eFollow Ruby and JavaScript style guides\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eInclude tests for new features\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eUpdate documentation for changes\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eUse conventional commit messages\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eSign commits with GPG key\u003c/li\u003e\n\u003ch2 id=\"license\" class=\"mobile-header\"\u003eLicense\u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eMastodon is licensed under the \u003cstrong\u003eGNU Affero General Public License v3.0 (AGPL-3.0)\u003c/strong\u003e.\u003c/p\u003e\n\u003ch3 id=\"key-license-points\" class=\"mobile-header\"\u003eKey License Points\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eFree to Use\u003c/strong\u003e: Can be used for any purpose\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSource Available\u003c/strong\u003e: Source code must be provided to users\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eCopyleft\u003c/strong\u003e: Derivative works must use same license\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork Use\u003c/strong\u003e: AGPL applies to network/web services\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNo Warranty\u003c/strong\u003e: Software provided \"as is\"\u003c/li\u003e\n\u003ch3 id=\"license-compliance\" class=\"mobile-header\"\u003eLicense Compliance\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eKeep license notices intact\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eProvide source code to users\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eDocument any modifications\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eUse same license for derivatives\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eConsider legal requirements for your jurisdiction\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003eFull license text: \u003ca href=\"https://github.com/mastodon/mastodon/blob/main/LICENSE\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ehttps://github.com/mastodon/mastodon/blob/main/LICENSE\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"acknowledgments\" class=\"mobile-header\"\u003eAcknowledgments\u003c/h2\u003e\n\u003ch3 id=\"core-team\" class=\"mobile-header\"\u003eCore Team\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eEugen Rochko\u003c/strong\u003e - Creator and lead developer\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eClaire\u003c/strong\u003e - Core maintainer\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRenaud Chaput\u003c/strong\u003e - Core maintainer\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eThibG\u003c/strong\u003e - Significant contributor\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eAnd many other contributors\u003c/li\u003e\n\u003ch3 id=\"technologies-used\" class=\"mobile-header\"\u003eTechnologies Used\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRuby on Rails\u003c/strong\u003e - Web application framework\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ePostgreSQL\u003c/strong\u003e - Primary database\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eRedis\u003c/strong\u003e - Caching and job queue\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eReact.js\u003c/strong\u003e - Frontend user interface\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eActivityPub\u003c/strong\u003e - Federation protocol\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSidekiq\u003c/strong\u003e - Background job processing\u003c/li\u003e\n\u003ch3 id=\"community\" class=\"mobile-header\"\u003eCommunity\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eTranslators\u003c/strong\u003e - Making Mastodon available in many languages\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eInstance Administrators\u003c/strong\u003e - Running the fediverse\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eUsers\u003c/strong\u003e - Creating the vibrant community\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eContributors\u003c/strong\u003e - Improving the software\u003c/li\u003e\n\u003ch2 id=\"version-history\" class=\"mobile-header\"\u003eVersion History\u003c/h2\u003e\n\u003ch3 id=\"major-releases\" class=\"mobile-header\"\u003eMajor Releases\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev4.2\u003c/strong\u003e (September 2023) - Enhanced moderation tools, quote posts\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev4.1\u003c/strong\u003e (February 2023) - Improved federation, performance optimizations\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev4.0\u003c/strong\u003e (October 2022) - Major UI overhaul, new features\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.5\u003c/strong\u003e (May 2022) - Content warnings improvements, admin features\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.4\u003c/strong\u003e (October 2021) - Server rules, report improvements\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.3\u003c/strong\u003e (February 2021) - Profile directory, admin announcements\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.2\u003c/strong\u003e (July 2020) - Audio uploads, admin interface improvements\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.1\u003c/strong\u003e (February 2020) - Polls, improved federation\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev3.0\u003c/strong\u003e (October 2019) - Single column mode, admin dashboard\u003c/li\u003e\n\u003ch3 id=\"current-stable-version\" class=\"mobile-header\"\u003eCurrent Stable Version\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003ev4.2.x\u003c/strong\u003e - Latest stable release\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eCheck \u003ca href=\"https://github.com/mastodon/mastodon/releases\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGitHub releases\u003c/a\u003e for current version\u003c/li\u003e\n\u003ch3 id=\"upgrade-path\" class=\"mobile-header\"\u003eUpgrade Path\u003c/h3\u003e\n\u003cli class=\"mobile-list-item\"\u003eAlways backup before upgrading\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFollow official upgrade guides\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eTest in staging environment first\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eMonitor for federation issues after upgrade\u003c/li\u003e\n\u003ch2 id=\"appendices\" class=\"mobile-header\"\u003eAppendices\u003c/h2\u003e\n\u003ch3 id=\"appendix-a-port-reference\" class=\"mobile-header\"\u003eAppendix A: Port Reference\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| Port | Service | Protocol | Description |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e|------|---------|----------|-------------|\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 80 | HTTP | TCP | Web traffic (redirects to HTTPS) |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 443 | HTTPS | TCP | Secure web traffic |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 3000 | Mastodon Web | TCP | Internal web service |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 4000 | Mastodon Streaming | TCP | Real-time updates |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 5432 | PostgreSQL | TCP | Database (internal) |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 6379 | Redis | TCP | Cache and queues (internal) |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| 25/587 | SMTP | TCP | Email delivery (outbound) |\u003c/p\u003e\n\u003ch3 id=\"appendix-b-file-locations\" class=\"mobile-header\"\u003eAppendix B: File Locations\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| Path | Description |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e|------|-------------|\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/\u003c/code\u003e | Mastodon application directory |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/.env.production\u003c/code\u003e | Main configuration file |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/home/mastodon/live/public/system/\u003c/code\u003e | Media files storage |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/etc/systemd/system/mastodon-*.service\u003c/code\u003e | Service definitions |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/etc/nginx/sites-available/mastodon\u003c/code\u003e | nginx configuration |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/var/lib/postgresql/*/data/\u003c/code\u003e | PostgreSQL data directory |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/etc/redis/redis.conf\u003c/code\u003e | Redis configuration |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003e/var/log/nginx/\u003c/code\u003e | nginx logs |\u003c/p\u003e\n\u003ch3 id=\"appendix-c-common-commands\" class=\"mobile-header\"\u003eAppendix C: Common Commands\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Service management\nsudo systemctl status mastodon-web mastodon-sidekiq mastodon-streaming\nsudo systemctl restart mastodon-web mastodon-sidekiq mastodon-streaming\n\n# Mastodon maintenance\nsudo -u mastodon bash -c \u0026#039;cd /home/mastodon/live \u0026amp;\u0026amp; RAILS_ENV=production bundle exec rails mastodon:maintenance\u0026#039;\n\n# Database management\nsudo -u postgres psql mastodon_production\n\n# Log monitoring\nsudo journalctl -u mastodon-web -f\nsudo tail -f /var/log/nginx/access.log\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"appendix-d-environment-variables-reference\" class=\"mobile-header\"\u003eAppendix D: Environment Variables Reference\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| Variable | Description | Required |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e|----------|-------------|----------|\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eLOCAL_DOMAIN\u003c/code\u003e | Your Mastodon domain | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eSECRET_KEY_BASE\u003c/code\u003e | Rails secret key | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eOTP_SECRET\u003c/code\u003e | Two-factor authentication secret | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eVAPID_PRIVATE_KEY\u003c/code\u003e | Push notification private key | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eVAPID_PUBLIC_KEY\u003c/code\u003e | Push notification public key | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eDB_HOST\u003c/code\u003e | Database hostname | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eDB_USER\u003c/code\u003e | Database username | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eDB_PASS\u003c/code\u003e | Database password | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eDB_NAME\u003c/code\u003e | Database name | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eREDIS_HOST\u003c/code\u003e | Redis hostname | Yes |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eSMTP_SERVER\u003c/code\u003e | SMTP server hostname | Recommended |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eSMTP_FROM_ADDRESS\u003c/code\u003e | From email address | Recommended |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eS3_ENABLED\u003c/code\u003e | Enable S3 storage | No |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e| \u003ccode class=\"mobile-inline-code\"\u003eCDN_HOST\u003c/code\u003e | CDN hostname for assets | No |\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection. Always refer to official Mastodon documentation for the most up-to-date information.\u003c/p\u003e","readTime":"20 min","wordCount":3905,"tableOfContents":[{"level":2,"text":"Prerequisites","id":"prerequisites"},{"level":3,"text":"Hardware Requirements","id":"hardware-requirements"},{"level":3,"text":"Software Dependencies","id":"software-dependencies"},{"level":3,"text":"Network Requirements","id":"network-requirements"},{"level":3,"text":"System Access","id":"system-access"},{"level":2,"text":"Supported Operating Systems","id":"supported-operating-systems"},{"level":2,"text":"Installation","id":"installation"},{"level":3,"text":"RHEL/CentOS/Rocky Linux/AlmaLinux","id":"rhelcentosrocky-linuxalmalinux"},{"level":1,"text":"Install EPEL and PowerTools repositories","id":"install-epel-and-powertools-repositories"},{"level":1,"text":"Install Node.js repository","id":"install-nodejs-repository"},{"level":1,"text":"Install Yarn repository","id":"install-yarn-repository"},{"level":1,"text":"Install PostgreSQL repository (for latest version)","id":"install-postgresql-repository-for-latest-version"},{"level":1,"text":"Install required packages","id":"install-required-packages"},{"level":1,"text":"Initialize PostgreSQL","id":"initialize-postgresql"},{"level":1,"text":"Configure PostgreSQL","id":"configure-postgresql"},{"level":1,"text":"Create mastodon user","id":"create-mastodon-user"},{"level":1,"text":"Install Ruby (using rbenv for version management)","id":"install-ruby-using-rbenv-for-version-management"},{"level":1,"text":"Clone Mastodon","id":"clone-mastodon"},{"level":1,"text":"Install Ruby dependencies","id":"install-ruby-dependencies"},{"level":1,"text":"Install Node.js dependencies","id":"install-nodejs-dependencies"},{"level":3,"text":"Debian/Ubuntu","id":"debianubuntu"},{"level":1,"text":"Update package list","id":"update-package-list"},{"level":1,"text":"Install curl and gnupg (if not already installed)","id":"install-curl-and-gnupg-if-not-already-installed"},{"level":1,"text":"Add Node.js repository","id":"add-nodejs-repository"},{"level":1,"text":"Add Yarn repository","id":"add-yarn-repository"},{"level":1,"text":"Add PostgreSQL repository (for latest version)","id":"add-postgresql-repository-for-latest-version"},{"level":1,"text":"Update package list","id":"update-package-list"},{"level":1,"text":"Install required packages","id":"install-required-packages"},{"level":1,"text":"Start and enable services","id":"start-and-enable-services"},{"level":1,"text":"Configure PostgreSQL","id":"configure-postgresql"},{"level":1,"text":"Create mastodon user","id":"create-mastodon-user"},{"level":1,"text":"Install Ruby (using rbenv)","id":"install-ruby-using-rbenv"},{"level":1,"text":"Clone Mastodon","id":"clone-mastodon"},{"level":1,"text":"Install dependencies","id":"install-dependencies"},{"level":3,"text":"Arch Linux","id":"arch-linux"},{"level":1,"text":"Update system","id":"update-system"},{"level":1,"text":"Install required packages","id":"install-required-packages"},{"level":1,"text":"Initialize PostgreSQL","id":"initialize-postgresql"},{"level":1,"text":"Configure PostgreSQL","id":"configure-postgresql"},{"level":1,"text":"Create mastodon user","id":"create-mastodon-user"},{"level":1,"text":"Install Ruby using rbenv","id":"install-ruby-using-rbenv"},{"level":1,"text":"Clone and setup Mastodon","id":"clone-and-setup-mastodon"},{"level":1,"text":"Install dependencies","id":"install-dependencies"},{"level":3,"text":"Alpine Linux","id":"alpine-linux"},{"level":1,"text":"Update package index","id":"update-package-index"},{"level":1,"text":"Install required packages","id":"install-required-packages"},{"level":1,"text":"Initialize and start services","id":"initialize-and-start-services"},{"level":1,"text":"Configure PostgreSQL","id":"configure-postgresql"},{"level":1,"text":"Create mastodon user","id":"create-mastodon-user"},{"level":1,"text":"Install Ruby using rbenv","id":"install-ruby-using-rbenv"},{"level":1,"text":"Clone and setup Mastodon","id":"clone-and-setup-mastodon"},{"level":1,"text":"Install dependencies","id":"install-dependencies"},{"level":2,"text":"Configuration","id":"configuration"},{"level":3,"text":"Environment Configuration","id":"environment-configuration"},{"level":1,"text":"Switch to mastodon user","id":"switch-to-mastodon-user"},{"level":1,"text":"Navigate to Mastodon directory","id":"navigate-to-mastodon-directory"},{"level":1,"text":"Generate configuration","id":"generate-configuration"},{"level":3,"text":"Manual Environment Configuration","id":"manual-environment-configuration"},{"level":1,"text":"Create environment file","id":"create-environment-file"},{"level":1,"text":"Federation","id":"federation"},{"level":1,"text":"Redis","id":"redis"},{"level":1,"text":"PostgreSQL","id":"postgresql"},{"level":1,"text":"ElasticSearch (optional, for full-text search)","id":"elasticsearch-optional-for-full-text-search"},{"level":1,"text":"ES_ENABLED=true","id":"es_enabledtrue"},{"level":1,"text":"ES_HOST=localhost","id":"es_hostlocalhost"},{"level":1,"text":"ES_PORT=9200","id":"es_port9200"},{"level":1,"text":"Secrets","id":"secrets"},{"level":1,"text":"Generate with: bundle exec rake secret","id":"generate-with-bundle-exec-rake-secret"},{"level":1,"text":"VAPID keys (for push notifications)","id":"vapid-keys-for-push-notifications"},{"level":1,"text":"Generate with: bundle exec rake mastodon:webpush:generate_vapid_key","id":"generate-with-bundle-exec-rake-mastodonwebpushgenerate_vapid_key"},{"level":1,"text":"Sending mail","id":"sending-mail"},{"level":1,"text":"File storage (local)","id":"file-storage-local"},{"level":1,"text":"Optional S3/compatible storage","id":"optional-s3compatible-storage"},{"level":1,"text":"S3_ENABLED=true","id":"s3_enabledtrue"},{"level":1,"text":"S3_BUCKET=mastodon","id":"s3_bucketmastodon"},{"level":1,"text":"AWS_ACCESS_KEY_ID=","id":"aws_access_key_id"},{"level":1,"text":"AWS_SECRET_ACCESS_KEY=","id":"aws_secret_access_key"},{"level":1,"text":"S3_REGION=us-east-1","id":"s3_regionus-east-1"},{"level":1,"text":"S3_HOSTNAME=s3.amazonaws.com","id":"s3_hostnames3amazonawscom"},{"level":1,"text":"Optional CDN","id":"optional-cdn"},{"level":1,"text":"CDN_HOST=assets.example.com","id":"cdn_hostassetsexamplecom"},{"level":1,"text":"Streaming","id":"streaming"},{"level":1,"text":"Advanced settings","id":"advanced-settings"},{"level":3,"text":"Database Setup","id":"database-setup"},{"level":1,"text":"Switch to mastodon user and setup database","id":"switch-to-mastodon-user-and-setup-database"},{"level":1,"text":"Create database","id":"create-database"},{"level":1,"text":"Compile assets","id":"compile-assets"},{"level":2,"text":"Service Management","id":"service-management"},{"level":3,"text":"Systemd Service Files (RHEL/Debian/Arch/SUSE)","id":"systemd-service-files-rheldebianarchsuse"},{"level":3,"text":"Enable and Start Services","id":"enable-and-start-services"},{"level":1,"text":"Reload systemd and enable services","id":"reload-systemd-and-enable-services"},{"level":1,"text":"Check status","id":"check-status"},{"level":3,"text":"OpenRC Services (Alpine Linux)","id":"openrc-services-alpine-linux"},{"level":1,"text":"Make executable","id":"make-executable"},{"level":1,"text":"Enable and start","id":"enable-and-start"},{"level":2,"text":"Troubleshooting","id":"troubleshooting"},{"level":3,"text":"Common Issues","id":"common-issues"},{"level":1,"text":"Ensure proper rbenv setup","id":"ensure-proper-rbenv-setup"},{"level":1,"text":"Reinstall gems if needed","id":"reinstall-gems-if-needed"},{"level":1,"text":"Test PostgreSQL connection","id":"test-postgresql-connection"},{"level":1,"text":"Check PostgreSQL logs","id":"check-postgresql-logs"},{"level":1,"text":"Verify database configuration","id":"verify-database-configuration"},{"level":1,"text":"In console: ActiveRecord::Base.connection","id":"in-console-activerecordbaseconnection"},{"level":1,"text":"Clear and recompile assets","id":"clear-and-recompile-assets"},{"level":1,"text":"Check service logs","id":"check-service-logs"},{"level":1,"text":"Check for port conflicts","id":"check-for-port-conflicts"},{"level":1,"text":"Verify file permissions","id":"verify-file-permissions"},{"level":2,"text":"Security Considerations","id":"security-considerations"},{"level":3,"text":"Firewall Configuration","id":"firewall-configuration"},{"level":1,"text":"Open required ports","id":"open-required-ports"},{"level":1,"text":"Configure firewall","id":"configure-firewall"},{"level":1,"text":"Basic firewall rules","id":"basic-firewall-rules"},{"level":3,"text":"SSL/TLS Configuration with nginx","id":"ssltls-configuration-with-nginx"},{"level":3,"text":"SSL Certificate Setup","id":"ssl-certificate-setup"},{"level":1,"text":"Install Certbot","id":"install-certbot"},{"level":1,"text":"RHEL/CentOS/Fedora","id":"rhelcentosfedora"},{"level":1,"text":"Debian/Ubuntu","id":"debianubuntu"},{"level":1,"text":"Arch Linux","id":"arch-linux"},{"level":1,"text":"Obtain certificate","id":"obtain-certificate"},{"level":1,"text":"Auto-renewal","id":"auto-renewal"},{"level":3,"text":"SELinux Configuration (RHEL-based systems)","id":"selinux-configuration-rhel-based-systems"},{"level":1,"text":"Allow nginx to connect to Mastodon services","id":"allow-nginx-to-connect-to-mastodon-services"},{"level":1,"text":"Set SELinux contexts for Mastodon files","id":"set-selinux-contexts-for-mastodon-files"},{"level":1,"text":"Allow Mastodon to bind to required ports","id":"allow-mastodon-to-bind-to-required-ports"},{"level":2,"text":"Performance Tuning","id":"performance-tuning"},{"level":3,"text":"PostgreSQL Optimization","id":"postgresql-optimization"},{"level":1,"text":"Memory settings (adjust based on available RAM)","id":"memory-settings-adjust-based-on-available-ram"},{"level":1,"text":"Connection settings","id":"connection-settings"},{"level":1,"text":"WAL settings for better performance","id":"wal-settings-for-better-performance"},{"level":1,"text":"Query optimization","id":"query-optimization"},{"level":3,"text":"Redis Optimization","id":"redis-optimization"},{"level":1,"text":"Memory optimization","id":"memory-optimization"},{"level":1,"text":"Persistence (adjust based on needs)","id":"persistence-adjust-based-on-needs"},{"level":1,"text":"Network optimization","id":"network-optimization"},{"level":3,"text":"Ruby/Rails Optimization","id":"rubyrails-optimization"},{"level":1,"text":"Database connection pooling","id":"database-connection-pooling"},{"level":1,"text":"Sidekiq concurrency","id":"sidekiq-concurrency"},{"level":1,"text":"Puma workers (number of CPU cores)","id":"puma-workers-number-of-cpu-cores"},{"level":1,"text":"Streaming cluster","id":"streaming-cluster"},{"level":3,"text":"System-level Optimization","id":"system-level-optimization"},{"level":1,"text":"Increase file descriptors limit","id":"increase-file-descriptors-limit"},{"level":1,"text":"Optimize kernel parameters","id":"optimize-kernel-parameters"},{"level":1,"text":"Network optimization","id":"network-optimization"},{"level":1,"text":"Memory optimization","id":"memory-optimization"},{"level":2,"text":"Backup and Restore","id":"backup-and-restore"},{"level":3,"text":"Database Backup","id":"database-backup"},{"level":1,"text":"Create backup script","id":"create-backup-script"},{"level":1,"text":"Create backup directory","id":"create-backup-directory"},{"level":1,"text":"Database backup","id":"database-backup"},{"level":1,"text":"Media backup (if stored locally)","id":"media-backup-if-stored-locally"},{"level":1,"text":"Configuration backup","id":"configuration-backup"},{"level":1,"text":"Remove backups older than 30 days","id":"remove-backups-older-than-30-days"},{"level":3,"text":"Automated Backups","id":"automated-backups"},{"level":1,"text":"Add to crontab","id":"add-to-crontab"},{"level":3,"text":"Restore Procedure","id":"restore-procedure"},{"level":1,"text":"Stop Mastodon services","id":"stop-mastodon-services"},{"level":1,"text":"Restore database","id":"restore-database"},{"level":1,"text":"Restore media files (if needed)","id":"restore-media-files-if-needed"},{"level":1,"text":"Restore configuration","id":"restore-configuration"},{"level":1,"text":"Start services","id":"start-services"},{"level":2,"text":"System Requirements","id":"system-requirements"},{"level":3,"text":"Minimum Requirements","id":"minimum-requirements"},{"level":3,"text":"Recommended Production Requirements","id":"recommended-production-requirements"},{"level":3,"text":"Scaling Considerations","id":"scaling-considerations"},{"level":2,"text":"Support","id":"support"},{"level":3,"text":"Official Resources","id":"official-resources"},{"level":3,"text":"Community Support","id":"community-support"},{"level":3,"text":"Commercial Support","id":"commercial-support"},{"level":2,"text":"Contributing","id":"contributing"},{"level":3,"text":"How to Contribute","id":"how-to-contribute"},{"level":3,"text":"Development Setup","id":"development-setup"},{"level":1,"text":"Clone repository","id":"clone-repository"},{"level":1,"text":"Install dependencies","id":"install-dependencies"},{"level":1,"text":"Setup development database","id":"setup-development-database"},{"level":1,"text":"Run development server","id":"run-development-server"},{"level":3,"text":"Contribution Guidelines","id":"contribution-guidelines"},{"level":2,"text":"License","id":"license"},{"level":3,"text":"Key License Points","id":"key-license-points"},{"level":3,"text":"License Compliance","id":"license-compliance"},{"level":2,"text":"Acknowledgments","id":"acknowledgments"},{"level":3,"text":"Core Team","id":"core-team"},{"level":3,"text":"Technologies Used","id":"technologies-used"},{"level":3,"text":"Community","id":"community"},{"level":2,"text":"Version History","id":"version-history"},{"level":3,"text":"Major Releases","id":"major-releases"},{"level":3,"text":"Current Stable Version","id":"current-stable-version"},{"level":3,"text":"Upgrade Path","id":"upgrade-path"},{"level":2,"text":"Appendices","id":"appendices"},{"level":3,"text":"Appendix A: Port Reference","id":"appendix-a-port-reference"},{"level":3,"text":"Appendix B: File Locations","id":"appendix-b-file-locations"},{"level":3,"text":"Appendix C: Common Commands","id":"appendix-c-common-commands"},{"level":1,"text":"Service management","id":"service-management"},{"level":1,"text":"Mastodon maintenance","id":"mastodon-maintenance"},{"level":1,"text":"Database management","id":"database-management"},{"level":1,"text":"Log monitoring","id":"log-monitoring"},{"level":3,"text":"Appendix D: Environment Variables Reference","id":"appendix-d-environment-variables-reference"}],"lastBuilt":"2025-09-20T18:15:20.226Z","metadataVersion":"2.0"},"category":{"key":"communication","name":"Communication","description":"Communication tools and applications","icon":"üí¨","color":"#f1fa8c"},"relatedGuides":[]},"__N_SSG":true},"page":"/[category]/[guide]","query":{"category":"communication","guide":"mastodon"},"buildId":"B8uWwZRfnQ6JBvCxPs4zB","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
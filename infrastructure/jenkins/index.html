<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/><meta name="theme-color" content="#bd93f9"/><link rel="icon" href="/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><title class="jsx-745d6189719dfe72">Jenkins Installation Guide - HowToMgr</title><meta name="description" content="Repo for jenkins" class="jsx-745d6189719dfe72"/><meta name="keywords" content="installation guides, tutorials, linux, docker, kubernetes, mobile-first, responsive" class="jsx-745d6189719dfe72"/><meta property="og:title" content="Jenkins Installation Guide - HowToMgr" class="jsx-745d6189719dfe72"/><meta property="og:description" content="Repo for jenkins" class="jsx-745d6189719dfe72"/><meta property="og:type" content="website" class="jsx-745d6189719dfe72"/><meta property="og:url" content="https://howtomgr.github.io" class="jsx-745d6189719dfe72"/><meta property="og:image" content="https://howtomgr.github.io/social-preview.png" class="jsx-745d6189719dfe72"/><meta property="twitter:card" content="summary_large_image" class="jsx-745d6189719dfe72"/><meta property="twitter:title" content="Jenkins Installation Guide - HowToMgr" class="jsx-745d6189719dfe72"/><meta property="twitter:description" content="Repo for jenkins" class="jsx-745d6189719dfe72"/><meta name="next-head-count" content="17"/><link rel="dns-prefetch" href="//api.github.com"/><link rel="dns-prefetch" href="//github.com"/><link rel="preload" href="/favicon.ico" as="image"/><meta name="application-name" content="HowToMgr"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="default"/><meta name="apple-mobile-web-app-title" content="HowToMgr"/><meta name="format-detection" content="telephone=no"/><meta name="mobile-web-app-capable" content="yes"/><noscript><style>
            .requires-js { display: none !important; }
            .no-js-message { display: block !important; }
          </style></noscript><link rel="preload" href="/_next/static/css/eec6c1c201affe77.css" as="style"/><link rel="stylesheet" href="/_next/static/css/eec6c1c201affe77.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-2b1f7a23d657eae4.js" defer=""></script><script src="/_next/static/chunks/main-6ec3f7584970eebe.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d149ee305b4f74bb.js" defer=""></script><script src="/_next/static/chunks/409-41afef934247f89e.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcategory%5D/%5Bguide%5D-38cc5ea2e41d9e97.js" defer=""></script><script src="/_next/static/Bpk6_onWDzX5EeMLHWxll/_buildManifest.js" defer=""></script><script src="/_next/static/Bpk6_onWDzX5EeMLHWxll/_ssgManifest.js" defer=""></script><style id="__jsx-8a7f0cdcf94f52ce">.breadcrumb.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:var(--space-2);margin-bottom:var(--space-6);font-size:var(--font-sm);color:var(--text-secondary);overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch}.breadcrumb.jsx-8a7f0cdcf94f52ce a.jsx-8a7f0cdcf94f52ce{color:var(--accent-primary);text-decoration:none;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.breadcrumb.jsx-8a7f0cdcf94f52ce a.jsx-8a7f0cdcf94f52ce:hover{text-decoration:underline}.separator.jsx-8a7f0cdcf94f52ce{color:var(--text-muted);-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.current.jsx-8a7f0cdcf94f52ce{color:var(--text-primary);font-weight:500;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.guide-header.jsx-8a7f0cdcf94f52ce{background:var(--bg-secondary);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg);padding:var(--space-6);margin-bottom:var(--space-8);border:1px solid var(--bg-surface)}.guide-title.jsx-8a7f0cdcf94f52ce{color:var(--accent-primary);font-size:var(--font-3xl);margin-bottom:var(--space-4);line-height:1.2;word-break:break-word}.guide-description.jsx-8a7f0cdcf94f52ce{color:var(--text-secondary);font-size:var(--font-lg);margin-bottom:var(--space-5);line-height:1.5}.guide-badges.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-3);margin-bottom:var(--space-5);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.guide-actions.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-3);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.guide-content.jsx-8a7f0cdcf94f52ce{background:var(--bg-secondary);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg);padding:var(--space-6);margin-bottom:var(--space-8);border:1px solid var(--bg-surface);overflow-x:hidden}.related-section.jsx-8a7f0cdcf94f52ce{margin-bottom:var(--space-8)}.section-title.jsx-8a7f0cdcf94f52ce{color:var(--accent-primary);font-size:var(--font-2xl);text-align:center;margin-bottom:var(--space-6)}.guide-navigation.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4);-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-bottom:var(--space-8)}.loading-container.jsx-8a7f0cdcf94f52ce,.error-container.jsx-8a7f0cdcf94f52ce{text-align:center;padding:var(--space-8)}.error-actions.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4);-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:var(--space-6);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}@media(max-width:767px){.guide-header.jsx-8a7f0cdcf94f52ce{padding:var(--space-4);margin-bottom:var(--space-6)}.guide-title.jsx-8a7f0cdcf94f52ce{font-size:var(--font-2xl)}.guide-description.jsx-8a7f0cdcf94f52ce{font-size:var(--font-base)}.guide-content.jsx-8a7f0cdcf94f52ce{padding:var(--space-4);margin-bottom:var(--space-6)}.guide-badges.jsx-8a7f0cdcf94f52ce{gap:var(--space-2)}.guide-actions.jsx-8a7f0cdcf94f52ce{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.guide-navigation.jsx-8a7f0cdcf94f52ce{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.breadcrumb.jsx-8a7f0cdcf94f52ce{margin-bottom:var(--space-4)}}</style><style id="__jsx-745d6189719dfe72">.app-container.jsx-745d6189719dfe72{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding-top:56px}.main-content.jsx-745d6189719dfe72{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:var(--space-6)0}.mobile-footer.jsx-745d6189719dfe72{background:var(--bg-secondary);border-top:1px solid var(--bg-surface);padding:var(--space-6)0;margin-top:auto}.footer-content.jsx-745d6189719dfe72{text-align:center}.footer-links.jsx-745d6189719dfe72{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:var(--space-6);margin-bottom:var(--space-4);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.footer-links.jsx-745d6189719dfe72 a.jsx-745d6189719dfe72{color:var(--accent-primary);text-decoration:none;font-size:var(--font-sm)}.footer-links.jsx-745d6189719dfe72 a.jsx-745d6189719dfe72:hover{color:var(--accent-secondary)}.footer-separator.jsx-745d6189719dfe72{height:1px;background:var(--bg-surface);margin:var(--space-4)auto;width:200px}.footer-text.jsx-745d6189719dfe72,.footer-tech.jsx-745d6189719dfe72{color:var(--text-secondary);font-size:var(--font-sm);margin-bottom:var(--space-2)}.footer-disclaimer.jsx-745d6189719dfe72{color:var(--text-muted);font-size:var(--font-xs)}[data-theme="light"].jsx-745d6189719dfe72 .theme-icon-dark.jsx-745d6189719dfe72{display:none}[data-theme="light"].jsx-745d6189719dfe72 .theme-icon-light.jsx-745d6189719dfe72{display:inline!important}@media(max-width:767px){.main-content.jsx-745d6189719dfe72{padding:var(--space-4)0}.footer-links.jsx-745d6189719dfe72{gap:var(--space-4)}}</style></head><body><noscript><div class="no-js-message" style="padding:1rem;background:#ff5555;color:#f8f8f2;text-align:center;font-size:0.9rem">This site requires JavaScript to function properly. Please enable JavaScript in your browser.</div></noscript><div id="__next"><div class="jsx-745d6189719dfe72 app-container"><a href="#main-content" class="jsx-745d6189719dfe72 skip-link">Skip to main content</a><nav class="jsx-745d6189719dfe72 mobile-nav"><div class="jsx-745d6189719dfe72 mobile-nav-content"><a class="mobile-brand" href="/"><span role="img" aria-label="Books" class="jsx-745d6189719dfe72">üìö</span>HowToMgr</a><button aria-label="Toggle theme" title="Switch theme" class="jsx-745d6189719dfe72 mobile-theme-toggle touch-target"><span class="jsx-745d6189719dfe72 theme-icon-dark">üåô</span><span style="display:none" class="jsx-745d6189719dfe72 theme-icon-light">‚òÄÔ∏è</span></button></div></nav><main id="main-content" tabindex="-1" class="jsx-745d6189719dfe72 main-content"><div class="jsx-745d6189719dfe72 container"><nav aria-label="Breadcrumb" class="jsx-8a7f0cdcf94f52ce breadcrumb"><a href="/">Home</a><span class="jsx-8a7f0cdcf94f52ce separator">‚Üí</span><a href="/infrastructure/">Infrastructure</a><span class="jsx-8a7f0cdcf94f52ce separator">‚Üí</span><span class="jsx-8a7f0cdcf94f52ce current">Jenkins</span></nav><header class="jsx-8a7f0cdcf94f52ce guide-header"><div class="jsx-8a7f0cdcf94f52ce guide-meta-top"><h1 class="jsx-8a7f0cdcf94f52ce guide-title">Jenkins</h1><p class="jsx-8a7f0cdcf94f52ce guide-description">Repo for jenkins</p><div class="jsx-8a7f0cdcf94f52ce guide-badges"><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-primary">Infrastructure</span><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-info">16 min</span></div><div class="jsx-8a7f0cdcf94f52ce guide-actions"><a href="https://github.com/howtomgr/jenkins" target="_blank" rel="noopener" class="jsx-8a7f0cdcf94f52ce btn btn-secondary">View on GitHub</a></div></div></header><article class="jsx-8a7f0cdcf94f52ce guide-content"><div class="jsx-8a7f0cdcf94f52ce readme-content"><h1 id="jenkins-installation-guide" class="mobile-header">Jenkins Installation Guide</h1>
<p class="mobile-paragraph">Open-source automation server for building, testing, and deploying applications. Industry-leading CI/CD platform with extensive plugin ecosystem and enterprise-grade security features.</p>
<h2 id="prerequisites" class="mobile-header">Prerequisites</h2>
<li class="mobile-list-item">Linux system (any modern distribution)</li>
<li class="mobile-list-item">Root or sudo access</li>
<li class="mobile-list-item">Java 11 or 17 (LTS versions recommended)</li>
<li class="mobile-list-item">4GB RAM minimum, 8GB+ recommended for production</li>
<li class="mobile-list-item">50GB+ disk space for builds and artifacts</li>
<li class="mobile-list-item">Network connectivity for external integrations</li>
<h2 id="installation" class="mobile-header">Installation</h2>
<h3 id="ubuntudebian" class="mobile-header">Ubuntu/Debian</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Update system packages
sudo apt update &amp;&amp; sudo apt upgrade -y

# Install Java 17 (LTS)
sudo apt install -y openjdk-17-jdk openjdk-17-jre

# Add Jenkins repository and key
wget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key | sudo apt-key add -
echo &quot;deb https://pkg.jenkins.io/debian-stable binary/&quot; | sudo tee /etc/apt/sources.list.d/jenkins.list

# Update package list
sudo apt update

# Install Jenkins
sudo apt install -y jenkins

# Enable and start service
sudo systemctl enable --now jenkins

# Configure firewall
sudo ufw allow 8080/tcp comment &#039;Jenkins HTTP&#039;
sudo ufw allow OpenSSH

# Verify installation
sudo systemctl status jenkins
java -version
jenkins --version</code></pre>
      </div>
    </div>
<h3 id="rhelcentosrocky-linuxalmalinux" class="mobile-header">RHEL/CentOS/Rocky Linux/AlmaLinux</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install Java 17
sudo yum install -y java-17-openjdk java-17-openjdk-devel

# Add Jenkins repository
sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key

# Install Jenkins
sudo yum install -y jenkins

# Configure firewall
sudo firewall-cmd --permanent --add-port=8080/tcp
sudo firewall-cmd --permanent --add-port=50000/tcp  # Agent communication
sudo firewall-cmd --reload

# Enable and start service
sudo systemctl enable --now jenkins

# Verify installation
sudo systemctl status jenkins</code></pre>
      </div>
    </div>
<h3 id="fedora" class="mobile-header">Fedora</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install Java 17
sudo dnf install -y java-17-openjdk java-17-openjdk-devel

# Add Jenkins repository
sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo
sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key

# Install Jenkins
sudo dnf install -y jenkins

# Configure firewall
sudo firewall-cmd --permanent --add-port=8080/tcp
sudo firewall-cmd --reload

# Enable and start service
sudo systemctl enable --now jenkins</code></pre>
      </div>
    </div>
<h3 id="arch-linux" class="mobile-header">Arch Linux</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install Java
sudo pacman -Syu jdk17-openjdk

# Install Jenkins from AUR
yay -S jenkins

# Enable and start service
sudo systemctl enable --now jenkins

# Verify installation
sudo systemctl status jenkins</code></pre>
      </div>
    </div>
<h3 id="docker-installation-recommended-for-development" class="mobile-header">Docker Installation (Recommended for Development)</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create Jenkins directories
mkdir -p ~/jenkins/{jenkins_home,docker_certs,docker_sock}

# Run Jenkins container with Docker support
docker run -d \
  --name jenkins \
  --restart unless-stopped \
  -p 8080:8080 \
  -p 50000:50000 \
  -v ~/jenkins/jenkins_home:/var/jenkins_home \
  -v ~/jenkins/docker_certs:/certs/client:ro \
  -v ~/jenkins/docker_sock:/var/run/docker.sock \
  --group-add $(getent group docker | cut -d: -f3) \
  --security-opt no-new-privileges:true \
  jenkins/jenkins:lts-jdk17

# Get initial admin password
docker exec jenkins cat /var/jenkins_home/secrets/initialAdminPassword</code></pre>
      </div>
    </div>
<h2 id="security-hardening-2024-best-practices" class="mobile-header">Security Hardening (2024 Best Practices)</h2>
<h3 id="initial-security-setup" class="mobile-header">Initial Security Setup</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Get initial admin password
sudo cat /var/lib/jenkins/secrets/initialAdminPassword

# Complete setup via web interface: http://your-server:8080
# 1. Enter admin password
# 2. Install suggested plugins
# 3. Create first admin user
# 4. Configure Jenkins URL

# Advanced security configuration via Jenkins CLI
# Download Jenkins CLI
wget http://localhost:8080/jnlpJars/jenkins-cli.jar

# Create CLI configuration script
cat &gt; jenkins-security-config.sh &lt;&lt;&#039;EOF&#039;
#!/bin/bash
JENKINS_URL=&quot;http://localhost:8080&quot;
ADMIN_USER=&quot;admin&quot;
ADMIN_PASS=&quot;secure_admin_password_2024&quot;

# Function to run Jenkins CLI commands
run_jenkins_cli() {
    java -jar jenkins-cli.jar -s ${JENKINS_URL} -auth ${ADMIN_USER}:${ADMIN_PASS} &quot;$@&quot;
}

# Install essential security plugins
run_jenkins_cli install-plugin \
    authorize-project \
    build-timeout \
    credentials-binding \
    workflow-aggregator \
    matrix-auth \
    pam-auth \
    ldap \
    role-strategy \
    audit-trail \
    job-dsl \
    pipeline-stage-view \
    blueocean

# Configure global security
run_jenkins_cli groovy = &lt;&lt;GROOVY
import jenkins.model.*
import hudson.security.*
import hudson.security.csrf.DefaultCrumbIssuer

def instance = Jenkins.getInstance()

// Enable CSRF protection
instance.setCrumbIssuer(new DefaultCrumbIssuer(true))

// Configure security realm (local users)
def hudsonRealm = new HudsonPrivateSecurityRealm(false)
instance.setSecurityRealm(hudsonRealm)

// Create admin user
def adminUser = hudsonRealm.createAccount(&quot;admin&quot;, &quot;secure_admin_password_2024&quot;)

// Configure authorization strategy
def strategy = new FullControlOnceLoggedInAuthorizationStrategy()
strategy.setDenyAnonymousReadAccess(true)
instance.setAuthorizationStrategy(strategy)

// Disable CLI over remoting
instance.getDescriptor(&quot;jenkins.CLI&quot;).get().setEnabled(false)

// Disable agent-to-master access control for security
instance.getExtensionList(jenkins.security.s2m.AdminWhitelistRule.class)
    .get(jenkins.security.s2m.AdminWhitelistRule.class)
    .setMasterKillSwitch(false)

// Enable slave-to-master access control
instance.injector.getInstance(AdminWhitelistRule.class).setMasterKillSwitch(false)

// Save configuration
instance.save()

println &quot;Security configuration applied&quot;
GROOVY

echo &quot;Jenkins security configuration completed&quot;
EOF

chmod +x jenkins-security-config.sh
./jenkins-security-config.sh</code></pre>
      </div>
    </div>
<h3 id="advanced-authentication-setup" class="mobile-header">Advanced Authentication Setup</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Configure LDAP authentication
cat &gt; ldap-config.groovy &lt;&lt;&#039;EOF&#039;
import jenkins.model.*
import hudson.security.*
import hudson.security.LDAPSecurityRealm

def instance = Jenkins.getInstance()

// LDAP configuration
def ldapRealm = new LDAPSecurityRealm(
    &quot;ldaps://ldap.example.com:636&quot;,  // LDAP server
    &quot;DC=example,DC=com&quot;,             // Root DN
    &quot;(&amp;(objectCategory=Person)(objectClass=user)(sAMAccountName={0}))&quot;, // User search filter
    &quot;CN=jenkins,OU=Service Accounts,DC=example,DC=com&quot;, // Manager DN
    &quot;ldap_service_password&quot;,         // Manager password
    false,                          // Inhibit infer root DN
    false,                          // Disable email resolution
    null,                           // Cache configuration
    null,                           // Environment properties
    &quot;displayName&quot;,                  // Display name LDAP attribute
    &quot;mail&quot;,                         // Email LDAP attribute
    null,                           // Id strategy
    &quot;(&amp;(objectClass=group)(cn={0}))&quot; // Group search filter
)

// Set LDAP as security realm
instance.setSecurityRealm(ldapRealm)

// Configure matrix-based authorization
def authStrategy = new ProjectMatrixAuthorizationStrategy()

// Admin permissions
authStrategy.add(Jenkins.ADMINISTER, &quot;admin&quot;)
authStrategy.add(Jenkins.ADMINISTER, &quot;jenkins-admins&quot;)

// Developer permissions
authStrategy.add(Jenkins.READ, &quot;authenticated&quot;)
authStrategy.add(Item.BUILD, &quot;developers&quot;)
authStrategy.add(Item.READ, &quot;developers&quot;)
authStrategy.add(Item.WORKSPACE, &quot;developers&quot;)

instance.setAuthorizationStrategy(authStrategy)
instance.save()

println &quot;LDAP authentication configured&quot;
EOF

java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 groovy = &lt; ldap-config.groovy</code></pre>
      </div>
    </div>
<h3 id="plugin-security-and-management" class="mobile-header">Plugin Security and Management</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create plugin security script
sudo tee /usr/local/bin/jenkins-plugin-security.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash
JENKINS_CLI=&quot;/var/lib/jenkins/jenkins-cli.jar&quot;
JENKINS_URL=&quot;http://localhost:8080&quot;
ADMIN_USER=&quot;admin&quot;
ADMIN_PASS=&quot;secure_admin_password_2024&quot;

# Function to run Jenkins CLI
jenkins_cli() {
    java -jar ${JENKINS_CLI} -s ${JENKINS_URL} -auth ${ADMIN_USER}:${ADMIN_PASS} &quot;$@&quot;
}

# Check for plugin updates
echo &quot;Checking for plugin security updates...&quot;
jenkins_cli list-plugins | grep -E &quot;\)$&quot; &gt; /tmp/outdated-plugins.txt

if [ -s /tmp/outdated-plugins.txt ]; then
    echo &quot;Outdated plugins found:&quot;
    cat /tmp/outdated-plugins.txt
    
    # Update all plugins
    jenkins_cli install-plugin $(awk &#039;{print $1}&#039; /tmp/outdated-plugins.txt | tr &#039;\n&#039; &#039; &#039;)
    
    echo &quot;Restarting Jenkins to apply plugin updates...&quot;
    jenkins_cli safe-restart
fi

# Install essential security plugins
SECURITY_PLUGINS=(
    &quot;authorize-project&quot;
    &quot;build-timeout&quot;
    &quot;credentials-binding&quot;
    &quot;matrix-auth&quot;
    &quot;role-strategy&quot;
    &quot;audit-trail&quot;
    &quot;configuration-as-code&quot;
    &quot;job-dsl&quot;
    &quot;pipeline-stage-view&quot;
    &quot;workflow-aggregator&quot;
    &quot;blueocean&quot;
    &quot;pipeline-utility-steps&quot;
    &quot;timestamper&quot;
    &quot;ws-cleanup&quot;
    &quot;build-name-setter&quot;
    &quot;description-setter&quot;
)

for plugin in &quot;${SECURITY_PLUGINS[@]}&quot;; do
    if ! jenkins_cli list-plugins | grep -q &quot;^$plugin &quot;; then
        echo &quot;Installing security plugin: $plugin&quot;
        jenkins_cli install-plugin &quot;$plugin&quot;
    fi
done

echo &quot;Plugin security check completed&quot;
EOF

sudo chmod +x /usr/local/bin/jenkins-plugin-security.sh</code></pre>
      </div>
    </div>
<h2 id="advanced-configuration" class="mobile-header">Advanced Configuration</h2>
<h3 id="jenkins-configuration-as-code-jcasc" class="mobile-header">Jenkins Configuration as Code (JCasC)</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create Jenkins Configuration as Code setup
sudo mkdir -p /var/lib/jenkins/casc_configs

sudo tee /var/lib/jenkins/casc_configs/jenkins.yaml &gt; /dev/null &lt;&lt;EOF
# Jenkins Configuration as Code (JCasC)
jenkins:
  systemMessage: &quot;Jenkins managed by Configuration as Code&quot;
  numExecutors: 0  # Don&#039;t run builds on master
  mode: EXCLUSIVE
  scmCheckoutRetryCount: 3
  
  securityRealm:
    ldap:
      configurations:
        - server: &quot;ldaps://ldap.example.com:636&quot;
          rootDN: &quot;DC=example,DC=com&quot;
          inhibitInferRootDN: false
          userSearchBase: &quot;OU=Users&quot;
          userSearch: &quot;(&amp;(objectCategory=Person)(objectClass=user)(sAMAccountName={0}))&quot;
          groupSearchBase: &quot;OU=Groups&quot;
          groupSearchFilter: &quot;(&amp;(objectClass=group)(cn={0}))&quot;
          managerDN: &quot;CN=jenkins,OU=Service Accounts,DC=example,DC=com&quot;
          managerPasswordSecret: &quot;ldap-password&quot;
          displayNameAttributeName: &quot;displayName&quot;
          mailAddressAttributeName: &quot;mail&quot;

  authorizationStrategy:
    roleBased:
      roles:
        global:
          - name: &quot;admin&quot;
            description: &quot;Jenkins administrators&quot;
            permissions:
              - &quot;Overall/Administer&quot;
            assignments:
              - &quot;jenkins-admins&quot;
          - name: &quot;developer&quot;
            description: &quot;Developers&quot;
            permissions:
              - &quot;Overall/Read&quot;
              - &quot;Job/Build&quot;
              - &quot;Job/Cancel&quot;
              - &quot;Job/Read&quot;
              - &quot;Job/Workspace&quot;
            assignments:
              - &quot;developers&quot;
              - &quot;authenticated&quot;

  remotingSecurity:
    enabled: true

  nodes:
    - permanent:
        name: &quot;agent-1&quot;
        remoteFS: &quot;/var/lib/jenkins&quot;
        launcher:
          ssh:
            host: &quot;jenkins-agent-1.example.com&quot;
            credentialsId: &quot;ssh-agent-key&quot;
            sshHostKeyVerificationStrategy: &quot;manuallyTrustedKeyVerificationStrategy&quot;

unclassified:
  globalLibraries:
    libraries:
      - name: &quot;shared-pipeline-library&quot;
        defaultVersion: &quot;main&quot;
        retriever:
          modernSCM:
            scm:
              git:
                remote: &quot;https://github.com/example/jenkins-shared-library.git&quot;
                credentialsId: &quot;github-token&quot;

  location:
    adminAddress: &quot;jenkins@example.com&quot;
    url: &quot;https://jenkins.example.com/&quot;

security:
  globalJobDslSecurityConfiguration:
    useScriptSecurity: true
  
  scriptApproval:
    approvedSignatures:
      - &quot;method java.lang.String trim&quot;
      - &quot;method java.util.Properties getProperty java.lang.String&quot;

credentials:
  system:
    domainCredentials:
      - credentials:
          - usernamePassword:
              scope: GLOBAL
              id: &quot;github-user&quot;
              username: &quot;jenkins-bot&quot;
              password: &quot;{AQAAABAAAAAQhudQr8JjwNNI9pj8oI3L2gE=}&quot;
              description: &quot;GitHub service account&quot;
          - basicSSHUserPrivateKey:
              scope: GLOBAL
              id: &quot;ssh-agent-key&quot;
              username: &quot;jenkins&quot;
              description: &quot;SSH key for Jenkins agents&quot;
              privateKeySource:
                directEntry:
                  privateKey: &quot;{AQAAABAAAAAQhudQr8JjwNNI9pj8oI3L2gE=}&quot;

tool:
  git:
    installations:
      - name: &quot;Default&quot;
        home: &quot;/usr/bin/git&quot;
  
  maven:
    installations:
      - name: &quot;Maven 3.9&quot;
        properties:
          - installSource:
              installers:
                - maven:
                    id: &quot;3.9.6&quot;

  jdk:
    installations:
      - name: &quot;OpenJDK 17&quot;
        home: &quot;/usr/lib/jvm/java-17-openjdk&quot;
      - name: &quot;OpenJDK 11&quot;
        home: &quot;/usr/lib/jvm/java-11-openjdk&quot;
EOF

# Set environment variable for JCasC
sudo tee /etc/systemd/system/jenkins.service.d/override.conf &gt; /dev/null &lt;&lt;EOF
[Service]
Environment=&quot;CASC_JENKINS_CONFIG=/var/lib/jenkins/casc_configs&quot;
Environment=&quot;JAVA_OPTS=-Djava.awt.headless=true -Xmx2g -Xms1g -XX:+UseG1GC&quot;
EOF

sudo systemctl daemon-reload
sudo systemctl restart jenkins</code></pre>
      </div>
    </div>
<h3 id="secure-agent-configuration" class="mobile-header">Secure Agent Configuration</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create Jenkins agent setup script
sudo tee /usr/local/bin/jenkins-agent-setup.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash
AGENT_NAME=&quot;${1:-agent-1}&quot;
AGENT_HOST=&quot;${2:-jenkins-agent-1.example.com}&quot;

# Create agent working directory
ssh $AGENT_HOST &quot;sudo mkdir -p /var/lib/jenkins &amp;&amp; sudo useradd -r -d /var/lib/jenkins jenkins&quot;

# Generate SSH key for agent communication
if [ ! -f ~/.ssh/jenkins_agent_rsa ]; then
    ssh-keygen -t rsa -b 4096 -f ~/.ssh/jenkins_agent_rsa -N &quot;&quot; -C &quot;jenkins-agent-key&quot;
fi

# Copy public key to agent
ssh-copy-id -i ~/.ssh/jenkins_agent_rsa.pub jenkins@$AGENT_HOST

# Install Java on agent
ssh $AGENT_HOST &quot;sudo apt update &amp;&amp; sudo apt install -y openjdk-17-jre&quot;

# Create agent via Jenkins CLI
java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \
  create-node $AGENT_NAME &lt;&lt;XML
&lt;slave&gt;
  &lt;name&gt;$AGENT_NAME&lt;/name&gt;
  &lt;description&gt;Secure Jenkins Agent&lt;/description&gt;
  &lt;remoteFS&gt;/var/lib/jenkins&lt;/remoteFS&gt;
  &lt;numExecutors&gt;2&lt;/numExecutors&gt;
  &lt;mode&gt;NORMAL&lt;/mode&gt;
  &lt;retentionStrategy class=&quot;hudson.slaves.RetentionStrategy\$Always&quot;/&gt;
  &lt;launcher class=&quot;hudson.plugins.sshslaves.SSHLauncher&quot;&gt;
    &lt;host&gt;$AGENT_HOST&lt;/host&gt;
    &lt;port&gt;22&lt;/port&gt;
    &lt;credentialsId&gt;ssh-agent-key&lt;/credentialsId&gt;
    &lt;launchTimeoutSeconds&gt;60&lt;/launchTimeoutSeconds&gt;
    &lt;maxNumRetries&gt;3&lt;/maxNumRetries&gt;
    &lt;retryWaitTime&gt;15&lt;/retryWaitTime&gt;
    &lt;sshHostKeyVerificationStrategy class=&quot;hudson.plugins.sshslaves.verifiers.ManuallyTrustedKeyVerificationStrategy&quot;/&gt;
  &lt;/launcher&gt;
  &lt;label&gt;linux docker&lt;/label&gt;
  &lt;nodeProperties&gt;
    &lt;hudson.slaves.EnvironmentVariablesNodeProperty&gt;
      &lt;envVars serialization=&quot;custom&quot;&gt;
        &lt;unserializable-parents/&gt;
        &lt;tree-map&gt;
          &lt;default&gt;
            &lt;comparator class=&quot;hudson.util.CaseInsensitiveComparator&quot;/&gt;
          &lt;/default&gt;
          &lt;int&gt;1&lt;/int&gt;
          &lt;string&gt;JAVA_HOME&lt;/string&gt;
          &lt;string&gt;/usr/lib/jvm/java-17-openjdk&lt;/string&gt;
        &lt;/tree-map&gt;
      &lt;/envVars&gt;
    &lt;/hudson.slaves.EnvironmentVariablesNodeProperty&gt;
  &lt;/nodeProperties&gt;
&lt;/slave&gt;
XML

echo &quot;Jenkins agent $AGENT_NAME configured for host $AGENT_HOST&quot;
EOF

sudo chmod +x /usr/local/bin/jenkins-agent-setup.sh</code></pre>
      </div>
    </div>
<h3 id="pipeline-security-best-practices" class="mobile-header">Pipeline Security Best Practices</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create secure pipeline templates
sudo mkdir -p /var/lib/jenkins/pipeline-templates

sudo tee /var/lib/jenkins/pipeline-templates/secure-pipeline.groovy &gt; /dev/null &lt;&lt;&#039;EOF&#039;
// Secure Jenkins Pipeline Template
@Library(&#039;shared-pipeline-library&#039;) _

pipeline {
    agent {
        label &#039;docker &amp;&amp; linux&#039;
    }
    
    options {
        buildDiscarder(logRotator(numToKeepStr: &#039;10&#039;, artifactNumToKeepStr: &#039;5&#039;))
        timeout(time: 60, unit: &#039;MINUTES&#039;)
        timestamps()
        skipDefaultCheckout(true)
        disableConcurrentBuilds()
        ansiColor(&#039;xterm&#039;)
    }
    
    environment {
        // Use Jenkins credentials securely
        DOCKER_REGISTRY = credentials(&#039;docker-registry-url&#039;)
        SONAR_TOKEN = credentials(&#039;sonarqube-token&#039;)
        
        // Security scanning tools
        TRIVY_VERSION = &#039;0.47.0&#039;
        CLAIR_VERSION = &#039;4.7.1&#039;
    }
    
    stages {
        stage(&#039;Checkout&#039;) {
            steps {
                checkout scm
                script {
                    env.GIT_COMMIT_SHORT = env.GIT_COMMIT.take(8)
                    env.BUILD_VERSION = &quot;${env.BUILD_NUMBER}-${env.GIT_COMMIT_SHORT}&quot;
                }
            }
        }
        
        stage(&#039;Security Scan - Code&#039;) {
            parallel {
                stage(&#039;SAST&#039;) {
                    steps {
                        script {
                            try {
                                sh &#039;&#039;&#039;
                                    # Static Application Security Testing
                                    docker run --rm -v $(pwd):/app \
                                        -w /app \
                                        securecodewarrior/semgrep:latest \
                                        --config=auto --json --output=sast-results.json
                                &#039;&#039;&#039;
                                
                                publishHTML([
                                    allowMissing: false,
                                    alwaysLinkToLastBuild: true,
                                    keepAll: true,
                                    reportDir: &#039;.&#039;,
                                    reportFiles: &#039;sast-results.json&#039;,
                                    reportName: &#039;SAST Report&#039;
                                ])
                            } catch (Exception e) {
                                echo &quot;SAST scan failed: ${e.getMessage()}&quot;
                                currentBuild.result = &#039;UNSTABLE&#039;
                            }
                        }
                    }
                }
                
                stage(&#039;Secrets Scan&#039;) {
                    steps {
                        script {
                            try {
                                sh &#039;&#039;&#039;
                                    # Secret scanning with TruffleHog
                                    docker run --rm -v $(pwd):/repo \
                                        trufflesecurity/trufflehog:latest \
                                        git file:///repo --json &gt; secrets-scan.json
                                    
                                    # Fail if secrets found
                                    if [ -s secrets-scan.json ]; then
                                        echo &quot;Secrets detected in code!&quot;
                                        cat secrets-scan.json
                                        exit 1
                                    fi
                                &#039;&#039;&#039;
                            } catch (Exception e) {
                                error &quot;Secrets detected in repository!&quot;
                            }
                        }
                    }
                }
                
                stage(&#039;Dependency Check&#039;) {
                    steps {
                        dependencyCheck additionalArguments: &#039;&#039;&#039;
                            --enableRetired
                            --enableExperimental
                            --scan ./
                            --format JSON
                            --format HTML
                        &#039;&#039;&#039;, odcInstallation: &#039;dependency-check&#039;
                        
                        dependencyCheckPublisher pattern: &#039;**/dependency-check-report.xml&#039;
                    }
                }
            }
        }
        
        stage(&#039;Build&#039;) {
            steps {
                script {
                    try {
                        sh &#039;&#039;&#039;
                            # Secure Docker build
                            docker build \
                                --no-cache \
                                --pull \
                                --tag ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION} \
                                --tag ${DOCKER_REGISTRY}/${JOB_NAME}:latest \
                                --build-arg BUILD_VERSION=${BUILD_VERSION} \
                                --build-arg BUILD_DATE=$(date -u +&quot;%Y-%m-%dT%H:%M:%SZ&quot;) \
                                --build-arg VCS_REF=${GIT_COMMIT} \
                                .
                        &#039;&#039;&#039;
                    } catch (Exception e) {
                        error &quot;Docker build failed: ${e.getMessage()}&quot;
                    }
                }
            }
        }
        
        stage(&#039;Security Scan - Container&#039;) {
            steps {
                script {
                    try {
                        sh &#039;&#039;&#039;
                            # Container vulnerability scanning with Trivy
                            docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \
                                aquasec/trivy:latest image \
                                --format table \
                                --severity HIGH,CRITICAL \
                                --exit-code 1 \
                                ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}
                        &#039;&#039;&#039;
                    } catch (Exception e) {
                        echo &quot;Container vulnerabilities found: ${e.getMessage()}&quot;
                        currentBuild.result = &#039;UNSTABLE&#039;
                    }
                }
            }
        }
        
        stage(&#039;Test&#039;) {
            parallel {
                stage(&#039;Unit Tests&#039;) {
                    steps {
                        sh &#039;&#039;&#039;
                            # Run unit tests
                            docker run --rm \
                                -v $(pwd):/workspace \
                                -w /workspace \
                                ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION} \
                                npm test
                        &#039;&#039;&#039;
                        
                        publishTestResults testResultsPattern: &#039;test-results.xml&#039;
                        publishCoverage adapters: [jacocoAdapter(&#039;coverage.xml&#039;)], sourceFileResolver: sourceFiles(&#039;STORE_LAST_BUILD&#039;)
                    }
                }
                
                stage(&#039;Integration Tests&#039;) {
                    steps {
                        sh &#039;&#039;&#039;
                            # Run integration tests in isolated environment
                            docker-compose -f docker-compose.test.yml up --build --abort-on-container-exit
                            docker-compose -f docker-compose.test.yml down -v
                        &#039;&#039;&#039;
                    }
                }
            }
        }
        
        stage(&#039;Deploy&#039;) {
            when {
                anyOf {
                    branch &#039;main&#039;
                    branch &#039;release/*&#039;
                }
            }
            steps {
                script {
                    try {
                        sh &#039;&#039;&#039;
                            # Secure deployment with credential binding
                            echo &quot;Deploying ${BUILD_VERSION} to production&quot;
                            
                            # Push to registry
                            docker push ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}
                            docker push ${DOCKER_REGISTRY}/${JOB_NAME}:latest
                            
                            # Deploy via secure method (kubectl, ansible, etc.)
                            kubectl set image deployment/${JOB_NAME} \
                                ${JOB_NAME}=${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}
                        &#039;&#039;&#039;
                    } catch (Exception e) {
                        error &quot;Deployment failed: ${e.getMessage()}&quot;
                    }
                }
            }
        }
    }
    
    post {
        always {
            // Clean workspace
            cleanWs()
            
            // Archive artifacts securely
            archiveArtifacts artifacts: &#039;target/*.jar,**/test-reports/**&#039;, allowEmptyArchive: true
            
            // Send notifications
            emailext(
                subject: &quot;Build ${currentBuild.result}: ${env.JOB_NAME} - ${env.BUILD_NUMBER}&quot;,
                body: &quot;Build ${currentBuild.result} for ${env.JOB_NAME} build number ${env.BUILD_NUMBER}&quot;,
                to: &quot;${env.CHANGE_AUTHOR_EMAIL ?: &#039;jenkins@example.com&#039;}&quot;
            )
        }
        
        failure {
            // Alert on build failures
            slackSend(
                channel: &#039;#ci-cd-alerts&#039;,
                color: &#039;danger&#039;,
                message: &quot;Build Failed: ${env.JOB_NAME} - ${env.BUILD_NUMBER} (&lt;${env.BUILD_URL}|Open&gt;)&quot;
            )
        }
        
        success {
            // Success notifications
            slackSend(
                channel: &#039;#deployments&#039;,
                color: &#039;good&#039;,
                message: &quot;Deployment Successful: ${env.JOB_NAME} - ${env.BUILD_NUMBER}&quot;
            )
        }
    }
}
EOF

sudo chown jenkins:jenkins /var/lib/jenkins/casc_configs/jenkins.yaml</code></pre>
      </div>
    </div>
<h3 id="ssltls-configuration" class="mobile-header">SSL/TLS Configuration</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Configure NGINX reverse proxy for Jenkins with SSL
sudo tee /etc/nginx/sites-available/jenkins &gt; /dev/null &lt;&lt;EOF
# Jenkins NGINX Configuration with Security Headers

upstream jenkins {
    server 127.0.0.1:8080 fail_timeout=0;
    keepalive 32;
}

# HTTP to HTTPS redirect
server {
    listen 80;
    server_name jenkins.example.com;
    return 301 https://\$server_name\$request_uri;
}

# HTTPS server
server {
    listen 443 ssl http2;
    server_name jenkins.example.com;

    # SSL configuration
    ssl_certificate /etc/letsencrypt/live/jenkins.example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/jenkins.example.com/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
    ssl_prefer_server_ciphers off;
    ssl_session_cache shared:SSL:10m;
    ssl_session_timeout 10m;

    # Security headers
    add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains&quot; always;
    add_header X-Content-Type-Options nosniff always;
    add_header X-Frame-Options DENY always;
    add_header X-XSS-Protection &quot;1; mode=block&quot; always;
    add_header Referrer-Policy &quot;strict-origin-when-cross-origin&quot; always;

    # Jenkins-specific settings
    client_max_body_size 50M;
    
    location / {
        proxy_pass http://jenkins;
        proxy_redirect default;
        proxy_http_version 1.1;

        # Required headers for Jenkins
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto \$scheme;
        proxy_max_temp_file_size 0;

        # Jenkins WebSocket support
        proxy_set_header Upgrade \$http_upgrade;
        proxy_set_header Connection &quot;upgrade&quot;;
        
        # Timeout settings
        proxy_connect_timeout 90;
        proxy_send_timeout 90;
        proxy_read_timeout 90;
        proxy_buffering off;
        proxy_request_buffering off;
    }
}
EOF

# Install SSL certificate
sudo certbot --nginx -d jenkins.example.com

sudo ln -s /etc/nginx/sites-available/jenkins /etc/nginx/sites-enabled/
sudo nginx -t &amp;&amp; sudo systemctl reload nginx</code></pre>
      </div>
    </div>
<h2 id="backup-and-disaster-recovery" class="mobile-header">Backup and Disaster Recovery</h2>
<h3 id="comprehensive-backup-strategy" class="mobile-header">Comprehensive Backup Strategy</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash">sudo tee /usr/local/bin/jenkins-backup.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash
BACKUP_DIR=&quot;/backup/jenkins&quot;
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p ${BACKUP_DIR}/{config,jobs,plugins,secrets}

echo &quot;Starting Jenkins backup...&quot;

# Gracefully shutdown Jenkins
java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 quiet-down

# Wait for running builds to complete (max 10 minutes)
for i in {1..60}; do
    RUNNING_BUILDS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 list-builds | grep -c &quot;RUNNING&quot; || echo &quot;0&quot;)
    if [ &quot;$RUNNING_BUILDS&quot; -eq 0 ]; then
        echo &quot;All builds completed, proceeding with backup...&quot;
        break
    fi
    echo &quot;Waiting for $RUNNING_BUILDS running builds to complete...&quot;
    sleep 10
done

# Stop Jenkins service
systemctl stop jenkins

# Backup Jenkins home directory
tar --exclude=&#039;/var/lib/jenkins/workspace/*&#039; \
    --exclude=&#039;/var/lib/jenkins/builds/*/archive&#039; \
    --exclude=&#039;/var/lib/jenkins/.m2/repository&#039; \
    --exclude=&#039;/var/lib/jenkins/logs/*&#039; \
    -czf ${BACKUP_DIR}/config/jenkins-home-${DATE}.tar.gz \
    -C /var/lib/jenkins .

# Backup individual job configurations
mkdir -p ${BACKUP_DIR}/jobs
for job in /var/lib/jenkins/jobs/*/config.xml; do
    if [ -f &quot;$job&quot; ]; then
        job_name=$(basename $(dirname &quot;$job&quot;))
        cp &quot;$job&quot; ${BACKUP_DIR}/jobs/${job_name}-config-${DATE}.xml
    fi
done

# Backup plugin list
java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \
    list-plugins &gt; ${BACKUP_DIR}/plugins/plugin-list-${DATE}.txt

# Backup secrets and credentials
if [ -d &quot;/var/lib/jenkins/secrets&quot; ]; then
    tar -czf ${BACKUP_DIR}/secrets/jenkins-secrets-${DATE}.tar.gz \
        -C /var/lib/jenkins secrets/
fi

# Start Jenkins
systemctl start jenkins

# Wait for Jenkins to be ready
echo &quot;Waiting for Jenkins to start...&quot;
for i in {1..30}; do
    if curl -f http://localhost:8080/login &gt;/dev/null 2&gt;&amp;1; then
        echo &quot;Jenkins is ready&quot;
        break
    fi
    sleep 10
done

# Cancel quiet mode
java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 cancel-quiet-down

# Upload to cloud storage
aws s3 cp ${BACKUP_DIR}/ s3://jenkins-backups/ --recursive --sse AES256
az storage blob upload-batch --source ${BACKUP_DIR} --destination jenkins-backups
gsutil cp -r ${BACKUP_DIR}/* gs://jenkins-backups/

# Test backup integrity
LATEST_BACKUP=$(ls -t ${BACKUP_DIR}/config/jenkins-home-*.tar.gz | head -1)
if tar -tzf &quot;$LATEST_BACKUP&quot; &gt;/dev/null 2&gt;&amp;1; then
    echo &quot;‚úì Backup integrity verified&quot;
else
    echo &quot;‚úó Backup integrity check failed&quot;
fi

# Keep only last 14 days of backups
find ${BACKUP_DIR} -name &quot;jenkins-*&quot; -type f -mtime +14 -delete

echo &quot;Jenkins backup completed: ${DATE}&quot;
EOF

sudo chmod +x /usr/local/bin/jenkins-backup.sh

# Schedule daily backups
echo &quot;0 1 * * * root /usr/local/bin/jenkins-backup.sh&quot; | sudo tee -a /etc/crontab</code></pre>
      </div>
    </div>
<h3 id="jenkins-disaster-recovery" class="mobile-header">Jenkins Disaster Recovery</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash">sudo tee /usr/local/bin/jenkins-restore.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash
BACKUP_FILE=&quot;${1}&quot;

if [ -z &quot;$BACKUP_FILE&quot; ]; then
    echo &quot;Usage: $0 &lt;backup_file&gt;&quot;
    echo &quot;Available backups:&quot;
    ls -la /backup/jenkins/config/jenkins-home-*.tar.gz
    exit 1
fi

echo &quot;Restoring Jenkins from backup: $BACKUP_FILE&quot;

# Stop Jenkins
systemctl stop jenkins

# Backup current installation
mv /var/lib/jenkins /var/lib/jenkins.backup.$(date +%s)

# Create new Jenkins directory
mkdir -p /var/lib/jenkins
chown jenkins:jenkins /var/lib/jenkins

# Restore from backup
tar -xzf &quot;$BACKUP_FILE&quot; -C /var/lib/jenkins

# Set proper ownership
chown -R jenkins:jenkins /var/lib/jenkins

# Start Jenkins
systemctl start jenkins

# Wait for Jenkins to start
echo &quot;Waiting for Jenkins to start...&quot;
for i in {1..60}; do
    if curl -f http://localhost:8080/login &gt;/dev/null 2&gt;&amp;1; then
        echo &quot;Jenkins restored successfully&quot;
        break
    fi
    sleep 10
done

echo &quot;Jenkins restore completed&quot;
echo &quot;Please verify configuration and rebuild any workspace dependencies&quot;
EOF

sudo chmod +x /usr/local/bin/jenkins-restore.sh</code></pre>
      </div>
    </div>
<h2 id="monitoring-and-health-checks" class="mobile-header">Monitoring and Health Checks</h2>
<h3 id="comprehensive-monitoring" class="mobile-header">Comprehensive Monitoring</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash">sudo tee /usr/local/bin/jenkins-health-check.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash
HEALTH_LOG=&quot;/var/log/jenkins-health.log&quot;

log_message() {
    echo &quot;$(date &#039;+%Y-%m-%d %H:%M:%S&#039;) - $1&quot; | tee -a ${HEALTH_LOG}
}

# Check service status
if systemctl is-active jenkins &gt;/dev/null 2&gt;&amp;1; then
    log_message &quot;‚úì Jenkins service is running&quot;
else
    log_message &quot;‚úó Jenkins service is not running&quot;
    exit 1
fi

# Check web interface
HTTP_STATUS=$(curl -s -o /dev/null -w &quot;%{http_code}&quot; http://localhost:8080/login)
if [ &quot;${HTTP_STATUS}&quot; = &quot;200&quot; ]; then
    log_message &quot;‚úì Jenkins web interface is responding&quot;
else
    log_message &quot;‚úó Jenkins web interface issues (HTTP ${HTTP_STATUS})&quot;
fi

# Check agent connectivity
AGENT_COUNT=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \
    list-computers | grep -c &quot;^agent&quot; || echo &quot;0&quot;)
ONLINE_AGENTS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \
    list-computers | grep -c &quot;online&quot; || echo &quot;0&quot;)

log_message &quot;‚Ñπ Jenkins agents: ${ONLINE_AGENTS}/${AGENT_COUNT} online&quot;

# Check disk space
DISK_USAGE=$(df /var/lib/jenkins | awk &#039;NR==2 {print $5}&#039; | sed &#039;s/%//&#039;)
if [ ${DISK_USAGE} -gt 85 ]; then
    log_message &quot;‚ö† High disk usage: ${DISK_USAGE}%&quot;
else
    log_message &quot;‚úì Disk usage: ${DISK_USAGE}%&quot;
fi

# Check for failed builds
FAILED_JOBS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \
    list-jobs | xargs -I {} java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \
    get-job {} | grep -c &quot;FAILURE&quot; || echo &quot;0&quot;)

if [ ${FAILED_JOBS} -gt 0 ]; then
    log_message &quot;‚ö† ${FAILED_JOBS} jobs with recent failures&quot;
fi

# Check Java memory usage
JAVA_MEMORY=$(ps -o pid,vsz,rss,comm -C java | grep jenkins | awk &#039;{print $3/1024}&#039; | head -1)
log_message &quot;‚Ñπ Jenkins memory usage: ${JAVA_MEMORY}MB&quot;

log_message &quot;Jenkins health check completed&quot;
EOF

sudo chmod +x /usr/local/bin/jenkins-health-check.sh

# Schedule health checks every 15 minutes
echo &quot;*/15 * * * * root /usr/local/bin/jenkins-health-check.sh&quot; | sudo tee -a /etc/crontab</code></pre>
      </div>
    </div>
<h2 id="troubleshooting" class="mobile-header">Troubleshooting</h2>
<h3 id="common-issues-and-solutions" class="mobile-header">Common Issues and Solutions</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Check Jenkins service status
sudo systemctl status jenkins
sudo journalctl -u jenkins -f

# Check Jenkins logs
sudo tail -f /var/log/jenkins/jenkins.log

# Check Java process
ps aux | grep jenkins
jps -v  # Show Java processes

# Memory issues
sudo systemctl edit jenkins
# Add:
[Service]
Environment=&quot;JAVA_OPTS=-Djava.awt.headless=true -Xmx4g -Xms2g&quot;

sudo systemctl daemon-reload
sudo systemctl restart jenkins

# Plugin issues
# Access Jenkins web interface
# Go to Manage Jenkins &gt; Manage Plugins &gt; Advanced
# Check for plugin conflicts or updates

# Agent connectivity issues
# Check SSH connectivity
ssh jenkins@agent-host

# Check agent logs
java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \
    connect-node agent-name

# Build failures
# Check workspace permissions
sudo chown -R jenkins:jenkins /var/lib/jenkins/workspace

# Clear old builds
java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \
    delete-builds job-name 1-10

# Performance issues
# Check system resources
top -p $(pgrep java)
htop -p $(pgrep java)

# Database cleanup (if using H2)
java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \
    groovy = &lt;&lt;GROOVY
import jenkins.model.Jenkins
Jenkins.instance.cleanUp()
GROOVY

# Reset Jenkins configuration (emergency)
sudo systemctl stop jenkins
sudo rm /var/lib/jenkins/config.xml
sudo systemctl start jenkins
# Reconfigure via setup wizard</code></pre>
      </div>
    </div>
<h2 id="additional-resources" class="mobile-header">Additional Resources</h2>
<li class="mobile-list-item"><a href="https://www.jenkins.io/doc/" target="_blank" rel="noopener" class="mobile-link">Jenkins Documentation</a></li>
<li class="mobile-list-item"><a href="https://www.jenkins.io/doc/book/security/" target="_blank" rel="noopener" class="mobile-link">Jenkins Security Guide</a></li>
<li class="mobile-list-item"><a href="https://www.jenkins.io/doc/book/pipeline/pipeline-best-practices/" target="_blank" rel="noopener" class="mobile-link">Pipeline Best Practices</a></li>
<li class="mobile-list-item"><a href="https://jenkins.io/projects/jcasc/" target="_blank" rel="noopener" class="mobile-link">Jenkins Configuration as Code</a></li>
<li class="mobile-list-item"><a href="https://www.jenkins.io/community/" target="_blank" rel="noopener" class="mobile-link">Jenkins Community</a></li>
<p class="mobile-paragraph">---</p>
<p class="mobile-paragraph"><strong>Note:</strong> This guide is part of the <a href="https://howtomgr.github.io" target="_blank" rel="noopener" class="mobile-link">HowToMgr</a> collection.</p></div></article><section class="jsx-8a7f0cdcf94f52ce related-section"><h2 class="jsx-8a7f0cdcf94f52ce section-title">Related <!-- -->Infrastructure<!-- --> Guides</h2><div class="jsx-8a7f0cdcf94f52ce mobile-grid"><a class="mobile-card" href="/infrastructure/adguard-home/"><div class="jsx-8a7f0cdcf94f52ce mobile-card-header"><h3 class="jsx-8a7f0cdcf94f52ce mobile-card-title">Adguard Home</h3><p class="jsx-8a7f0cdcf94f52ce mobile-card-description">Repo for adguard-home</p></div><div class="jsx-8a7f0cdcf94f52ce mobile-card-meta"><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-info">1 min</span></div></a><a class="mobile-card" href="/infrastructure/adminer/"><div class="jsx-8a7f0cdcf94f52ce mobile-card-header"><h3 class="jsx-8a7f0cdcf94f52ce mobile-card-title">Adminer</h3><p class="jsx-8a7f0cdcf94f52ce mobile-card-description">Repo for adminer</p></div><div class="jsx-8a7f0cdcf94f52ce mobile-card-meta"><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-info">1 min</span></div></a><a class="mobile-card" href="/infrastructure/ansible/"><div class="jsx-8a7f0cdcf94f52ce mobile-card-header"><h3 class="jsx-8a7f0cdcf94f52ce mobile-card-title">Ansible</h3><p class="jsx-8a7f0cdcf94f52ce mobile-card-description">Repo for ansible</p></div><div class="jsx-8a7f0cdcf94f52ce mobile-card-meta"><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-info">31 min</span></div></a></div></section><nav class="jsx-8a7f0cdcf94f52ce guide-navigation"><a class="btn btn-secondary" href="/infrastructure/">‚Üê All <!-- -->Infrastructure</a><a class="btn btn-secondary" href="/">All Categories</a></nav></div></main><footer class="jsx-745d6189719dfe72 mobile-footer"><div class="jsx-745d6189719dfe72 container"><div class="jsx-745d6189719dfe72 footer-content"><div class="jsx-745d6189719dfe72 footer-links"><a href="/">Home</a><a href="https://github.com/howtomgr" target="_blank" rel="noopener" class="jsx-745d6189719dfe72">GitHub</a><a href="https://github.com/howtomgr/howtomgr.github.io" target="_blank" rel="noopener" class="jsx-745d6189719dfe72">Source</a></div><div class="jsx-745d6189719dfe72 footer-separator"></div><p class="jsx-745d6189719dfe72 footer-text">¬© <!-- -->2025<!-- --> HowToMgr Organization. Open source installation guides.</p><p class="jsx-745d6189719dfe72 footer-tech">Built with ‚ù§Ô∏è using Next.js + GitHub Pages</p><p class="jsx-745d6189719dfe72 footer-disclaimer"><small class="jsx-745d6189719dfe72">All guides are provided as-is. Please review and test before production use.</small></p></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"guide":{"name":"jenkins","displayName":"Jenkins","slug":"jenkins","description":"Repo for jenkins","category":"infrastructure","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/jenkins","updatedAt":"2025-09-14T01:30:16Z","createdAt":"2023-08-28T03:48:15Z","readmeRaw":"# Jenkins Installation Guide\n\nOpen-source automation server for building, testing, and deploying applications. Industry-leading CI/CD platform with extensive plugin ecosystem and enterprise-grade security features.\n\n## Prerequisites\n\n- Linux system (any modern distribution)\n- Root or sudo access\n- Java 11 or 17 (LTS versions recommended)\n- 4GB RAM minimum, 8GB+ recommended for production\n- 50GB+ disk space for builds and artifacts\n- Network connectivity for external integrations\n\n## Installation\n\n### Ubuntu/Debian\n```bash\n# Update system packages\nsudo apt update \u0026\u0026 sudo apt upgrade -y\n\n# Install Java 17 (LTS)\nsudo apt install -y openjdk-17-jdk openjdk-17-jre\n\n# Add Jenkins repository and key\nwget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key | sudo apt-key add -\necho \"deb https://pkg.jenkins.io/debian-stable binary/\" | sudo tee /etc/apt/sources.list.d/jenkins.list\n\n# Update package list\nsudo apt update\n\n# Install Jenkins\nsudo apt install -y jenkins\n\n# Enable and start service\nsudo systemctl enable --now jenkins\n\n# Configure firewall\nsudo ufw allow 8080/tcp comment 'Jenkins HTTP'\nsudo ufw allow OpenSSH\n\n# Verify installation\nsudo systemctl status jenkins\njava -version\njenkins --version\n```\n\n### RHEL/CentOS/Rocky Linux/AlmaLinux\n```bash\n# Install Java 17\nsudo yum install -y java-17-openjdk java-17-openjdk-devel\n\n# Add Jenkins repository\nsudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo\nsudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key\n\n# Install Jenkins\nsudo yum install -y jenkins\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=8080/tcp\nsudo firewall-cmd --permanent --add-port=50000/tcp  # Agent communication\nsudo firewall-cmd --reload\n\n# Enable and start service\nsudo systemctl enable --now jenkins\n\n# Verify installation\nsudo systemctl status jenkins\n```\n\n### Fedora\n```bash\n# Install Java 17\nsudo dnf install -y java-17-openjdk java-17-openjdk-devel\n\n# Add Jenkins repository\nsudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo\nsudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key\n\n# Install Jenkins\nsudo dnf install -y jenkins\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=8080/tcp\nsudo firewall-cmd --reload\n\n# Enable and start service\nsudo systemctl enable --now jenkins\n```\n\n### Arch Linux\n```bash\n# Install Java\nsudo pacman -Syu jdk17-openjdk\n\n# Install Jenkins from AUR\nyay -S jenkins\n\n# Enable and start service\nsudo systemctl enable --now jenkins\n\n# Verify installation\nsudo systemctl status jenkins\n```\n\n### Docker Installation (Recommended for Development)\n```bash\n# Create Jenkins directories\nmkdir -p ~/jenkins/{jenkins_home,docker_certs,docker_sock}\n\n# Run Jenkins container with Docker support\ndocker run -d \\\n  --name jenkins \\\n  --restart unless-stopped \\\n  -p 8080:8080 \\\n  -p 50000:50000 \\\n  -v ~/jenkins/jenkins_home:/var/jenkins_home \\\n  -v ~/jenkins/docker_certs:/certs/client:ro \\\n  -v ~/jenkins/docker_sock:/var/run/docker.sock \\\n  --group-add $(getent group docker | cut -d: -f3) \\\n  --security-opt no-new-privileges:true \\\n  jenkins/jenkins:lts-jdk17\n\n# Get initial admin password\ndocker exec jenkins cat /var/jenkins_home/secrets/initialAdminPassword\n```\n\n## Security Hardening (2024 Best Practices)\n\n### Initial Security Setup\n```bash\n# Get initial admin password\nsudo cat /var/lib/jenkins/secrets/initialAdminPassword\n\n# Complete setup via web interface: http://your-server:8080\n# 1. Enter admin password\n# 2. Install suggested plugins\n# 3. Create first admin user\n# 4. Configure Jenkins URL\n\n# Advanced security configuration via Jenkins CLI\n# Download Jenkins CLI\nwget http://localhost:8080/jnlpJars/jenkins-cli.jar\n\n# Create CLI configuration script\ncat \u003e jenkins-security-config.sh \u003c\u003c'EOF'\n#!/bin/bash\nJENKINS_URL=\"http://localhost:8080\"\nADMIN_USER=\"admin\"\nADMIN_PASS=\"secure_admin_password_2024\"\n\n# Function to run Jenkins CLI commands\nrun_jenkins_cli() {\n    java -jar jenkins-cli.jar -s ${JENKINS_URL} -auth ${ADMIN_USER}:${ADMIN_PASS} \"$@\"\n}\n\n# Install essential security plugins\nrun_jenkins_cli install-plugin \\\n    authorize-project \\\n    build-timeout \\\n    credentials-binding \\\n    workflow-aggregator \\\n    matrix-auth \\\n    pam-auth \\\n    ldap \\\n    role-strategy \\\n    audit-trail \\\n    job-dsl \\\n    pipeline-stage-view \\\n    blueocean\n\n# Configure global security\nrun_jenkins_cli groovy = \u003c\u003cGROOVY\nimport jenkins.model.*\nimport hudson.security.*\nimport hudson.security.csrf.DefaultCrumbIssuer\n\ndef instance = Jenkins.getInstance()\n\n// Enable CSRF protection\ninstance.setCrumbIssuer(new DefaultCrumbIssuer(true))\n\n// Configure security realm (local users)\ndef hudsonRealm = new HudsonPrivateSecurityRealm(false)\ninstance.setSecurityRealm(hudsonRealm)\n\n// Create admin user\ndef adminUser = hudsonRealm.createAccount(\"admin\", \"secure_admin_password_2024\")\n\n// Configure authorization strategy\ndef strategy = new FullControlOnceLoggedInAuthorizationStrategy()\nstrategy.setDenyAnonymousReadAccess(true)\ninstance.setAuthorizationStrategy(strategy)\n\n// Disable CLI over remoting\ninstance.getDescriptor(\"jenkins.CLI\").get().setEnabled(false)\n\n// Disable agent-to-master access control for security\ninstance.getExtensionList(jenkins.security.s2m.AdminWhitelistRule.class)\n    .get(jenkins.security.s2m.AdminWhitelistRule.class)\n    .setMasterKillSwitch(false)\n\n// Enable slave-to-master access control\ninstance.injector.getInstance(AdminWhitelistRule.class).setMasterKillSwitch(false)\n\n// Save configuration\ninstance.save()\n\nprintln \"Security configuration applied\"\nGROOVY\n\necho \"Jenkins security configuration completed\"\nEOF\n\nchmod +x jenkins-security-config.sh\n./jenkins-security-config.sh\n```\n\n### Advanced Authentication Setup\n```bash\n# Configure LDAP authentication\ncat \u003e ldap-config.groovy \u003c\u003c'EOF'\nimport jenkins.model.*\nimport hudson.security.*\nimport hudson.security.LDAPSecurityRealm\n\ndef instance = Jenkins.getInstance()\n\n// LDAP configuration\ndef ldapRealm = new LDAPSecurityRealm(\n    \"ldaps://ldap.example.com:636\",  // LDAP server\n    \"DC=example,DC=com\",             // Root DN\n    \"(\u0026(objectCategory=Person)(objectClass=user)(sAMAccountName={0}))\", // User search filter\n    \"CN=jenkins,OU=Service Accounts,DC=example,DC=com\", // Manager DN\n    \"ldap_service_password\",         // Manager password\n    false,                          // Inhibit infer root DN\n    false,                          // Disable email resolution\n    null,                           // Cache configuration\n    null,                           // Environment properties\n    \"displayName\",                  // Display name LDAP attribute\n    \"mail\",                         // Email LDAP attribute\n    null,                           // Id strategy\n    \"(\u0026(objectClass=group)(cn={0}))\" // Group search filter\n)\n\n// Set LDAP as security realm\ninstance.setSecurityRealm(ldapRealm)\n\n// Configure matrix-based authorization\ndef authStrategy = new ProjectMatrixAuthorizationStrategy()\n\n// Admin permissions\nauthStrategy.add(Jenkins.ADMINISTER, \"admin\")\nauthStrategy.add(Jenkins.ADMINISTER, \"jenkins-admins\")\n\n// Developer permissions\nauthStrategy.add(Jenkins.READ, \"authenticated\")\nauthStrategy.add(Item.BUILD, \"developers\")\nauthStrategy.add(Item.READ, \"developers\")\nauthStrategy.add(Item.WORKSPACE, \"developers\")\n\ninstance.setAuthorizationStrategy(authStrategy)\ninstance.save()\n\nprintln \"LDAP authentication configured\"\nEOF\n\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 groovy = \u003c ldap-config.groovy\n```\n\n### Plugin Security and Management\n```bash\n# Create plugin security script\nsudo tee /usr/local/bin/jenkins-plugin-security.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nJENKINS_CLI=\"/var/lib/jenkins/jenkins-cli.jar\"\nJENKINS_URL=\"http://localhost:8080\"\nADMIN_USER=\"admin\"\nADMIN_PASS=\"secure_admin_password_2024\"\n\n# Function to run Jenkins CLI\njenkins_cli() {\n    java -jar ${JENKINS_CLI} -s ${JENKINS_URL} -auth ${ADMIN_USER}:${ADMIN_PASS} \"$@\"\n}\n\n# Check for plugin updates\necho \"Checking for plugin security updates...\"\njenkins_cli list-plugins | grep -E \"\\)$\" \u003e /tmp/outdated-plugins.txt\n\nif [ -s /tmp/outdated-plugins.txt ]; then\n    echo \"Outdated plugins found:\"\n    cat /tmp/outdated-plugins.txt\n    \n    # Update all plugins\n    jenkins_cli install-plugin $(awk '{print $1}' /tmp/outdated-plugins.txt | tr '\\n' ' ')\n    \n    echo \"Restarting Jenkins to apply plugin updates...\"\n    jenkins_cli safe-restart\nfi\n\n# Install essential security plugins\nSECURITY_PLUGINS=(\n    \"authorize-project\"\n    \"build-timeout\"\n    \"credentials-binding\"\n    \"matrix-auth\"\n    \"role-strategy\"\n    \"audit-trail\"\n    \"configuration-as-code\"\n    \"job-dsl\"\n    \"pipeline-stage-view\"\n    \"workflow-aggregator\"\n    \"blueocean\"\n    \"pipeline-utility-steps\"\n    \"timestamper\"\n    \"ws-cleanup\"\n    \"build-name-setter\"\n    \"description-setter\"\n)\n\nfor plugin in \"${SECURITY_PLUGINS[@]}\"; do\n    if ! jenkins_cli list-plugins | grep -q \"^$plugin \"; then\n        echo \"Installing security plugin: $plugin\"\n        jenkins_cli install-plugin \"$plugin\"\n    fi\ndone\n\necho \"Plugin security check completed\"\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-plugin-security.sh\n```\n\n## Advanced Configuration\n\n### Jenkins Configuration as Code (JCasC)\n```bash\n# Create Jenkins Configuration as Code setup\nsudo mkdir -p /var/lib/jenkins/casc_configs\n\nsudo tee /var/lib/jenkins/casc_configs/jenkins.yaml \u003e /dev/null \u003c\u003cEOF\n# Jenkins Configuration as Code (JCasC)\njenkins:\n  systemMessage: \"Jenkins managed by Configuration as Code\"\n  numExecutors: 0  # Don't run builds on master\n  mode: EXCLUSIVE\n  scmCheckoutRetryCount: 3\n  \n  securityRealm:\n    ldap:\n      configurations:\n        - server: \"ldaps://ldap.example.com:636\"\n          rootDN: \"DC=example,DC=com\"\n          inhibitInferRootDN: false\n          userSearchBase: \"OU=Users\"\n          userSearch: \"(\u0026(objectCategory=Person)(objectClass=user)(sAMAccountName={0}))\"\n          groupSearchBase: \"OU=Groups\"\n          groupSearchFilter: \"(\u0026(objectClass=group)(cn={0}))\"\n          managerDN: \"CN=jenkins,OU=Service Accounts,DC=example,DC=com\"\n          managerPasswordSecret: \"ldap-password\"\n          displayNameAttributeName: \"displayName\"\n          mailAddressAttributeName: \"mail\"\n\n  authorizationStrategy:\n    roleBased:\n      roles:\n        global:\n          - name: \"admin\"\n            description: \"Jenkins administrators\"\n            permissions:\n              - \"Overall/Administer\"\n            assignments:\n              - \"jenkins-admins\"\n          - name: \"developer\"\n            description: \"Developers\"\n            permissions:\n              - \"Overall/Read\"\n              - \"Job/Build\"\n              - \"Job/Cancel\"\n              - \"Job/Read\"\n              - \"Job/Workspace\"\n            assignments:\n              - \"developers\"\n              - \"authenticated\"\n\n  remotingSecurity:\n    enabled: true\n\n  nodes:\n    - permanent:\n        name: \"agent-1\"\n        remoteFS: \"/var/lib/jenkins\"\n        launcher:\n          ssh:\n            host: \"jenkins-agent-1.example.com\"\n            credentialsId: \"ssh-agent-key\"\n            sshHostKeyVerificationStrategy: \"manuallyTrustedKeyVerificationStrategy\"\n\nunclassified:\n  globalLibraries:\n    libraries:\n      - name: \"shared-pipeline-library\"\n        defaultVersion: \"main\"\n        retriever:\n          modernSCM:\n            scm:\n              git:\n                remote: \"https://github.com/example/jenkins-shared-library.git\"\n                credentialsId: \"github-token\"\n\n  location:\n    adminAddress: \"jenkins@example.com\"\n    url: \"https://jenkins.example.com/\"\n\nsecurity:\n  globalJobDslSecurityConfiguration:\n    useScriptSecurity: true\n  \n  scriptApproval:\n    approvedSignatures:\n      - \"method java.lang.String trim\"\n      - \"method java.util.Properties getProperty java.lang.String\"\n\ncredentials:\n  system:\n    domainCredentials:\n      - credentials:\n          - usernamePassword:\n              scope: GLOBAL\n              id: \"github-user\"\n              username: \"jenkins-bot\"\n              password: \"{AQAAABAAAAAQhudQr8JjwNNI9pj8oI3L2gE=}\"\n              description: \"GitHub service account\"\n          - basicSSHUserPrivateKey:\n              scope: GLOBAL\n              id: \"ssh-agent-key\"\n              username: \"jenkins\"\n              description: \"SSH key for Jenkins agents\"\n              privateKeySource:\n                directEntry:\n                  privateKey: \"{AQAAABAAAAAQhudQr8JjwNNI9pj8oI3L2gE=}\"\n\ntool:\n  git:\n    installations:\n      - name: \"Default\"\n        home: \"/usr/bin/git\"\n  \n  maven:\n    installations:\n      - name: \"Maven 3.9\"\n        properties:\n          - installSource:\n              installers:\n                - maven:\n                    id: \"3.9.6\"\n\n  jdk:\n    installations:\n      - name: \"OpenJDK 17\"\n        home: \"/usr/lib/jvm/java-17-openjdk\"\n      - name: \"OpenJDK 11\"\n        home: \"/usr/lib/jvm/java-11-openjdk\"\nEOF\n\n# Set environment variable for JCasC\nsudo tee /etc/systemd/system/jenkins.service.d/override.conf \u003e /dev/null \u003c\u003cEOF\n[Service]\nEnvironment=\"CASC_JENKINS_CONFIG=/var/lib/jenkins/casc_configs\"\nEnvironment=\"JAVA_OPTS=-Djava.awt.headless=true -Xmx2g -Xms1g -XX:+UseG1GC\"\nEOF\n\nsudo systemctl daemon-reload\nsudo systemctl restart jenkins\n```\n\n### Secure Agent Configuration\n```bash\n# Create Jenkins agent setup script\nsudo tee /usr/local/bin/jenkins-agent-setup.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nAGENT_NAME=\"${1:-agent-1}\"\nAGENT_HOST=\"${2:-jenkins-agent-1.example.com}\"\n\n# Create agent working directory\nssh $AGENT_HOST \"sudo mkdir -p /var/lib/jenkins \u0026\u0026 sudo useradd -r -d /var/lib/jenkins jenkins\"\n\n# Generate SSH key for agent communication\nif [ ! -f ~/.ssh/jenkins_agent_rsa ]; then\n    ssh-keygen -t rsa -b 4096 -f ~/.ssh/jenkins_agent_rsa -N \"\" -C \"jenkins-agent-key\"\nfi\n\n# Copy public key to agent\nssh-copy-id -i ~/.ssh/jenkins_agent_rsa.pub jenkins@$AGENT_HOST\n\n# Install Java on agent\nssh $AGENT_HOST \"sudo apt update \u0026\u0026 sudo apt install -y openjdk-17-jre\"\n\n# Create agent via Jenkins CLI\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n  create-node $AGENT_NAME \u003c\u003cXML\n\u003cslave\u003e\n  \u003cname\u003e$AGENT_NAME\u003c/name\u003e\n  \u003cdescription\u003eSecure Jenkins Agent\u003c/description\u003e\n  \u003cremoteFS\u003e/var/lib/jenkins\u003c/remoteFS\u003e\n  \u003cnumExecutors\u003e2\u003c/numExecutors\u003e\n  \u003cmode\u003eNORMAL\u003c/mode\u003e\n  \u003cretentionStrategy class=\"hudson.slaves.RetentionStrategy\\$Always\"/\u003e\n  \u003clauncher class=\"hudson.plugins.sshslaves.SSHLauncher\"\u003e\n    \u003chost\u003e$AGENT_HOST\u003c/host\u003e\n    \u003cport\u003e22\u003c/port\u003e\n    \u003ccredentialsId\u003essh-agent-key\u003c/credentialsId\u003e\n    \u003claunchTimeoutSeconds\u003e60\u003c/launchTimeoutSeconds\u003e\n    \u003cmaxNumRetries\u003e3\u003c/maxNumRetries\u003e\n    \u003cretryWaitTime\u003e15\u003c/retryWaitTime\u003e\n    \u003csshHostKeyVerificationStrategy class=\"hudson.plugins.sshslaves.verifiers.ManuallyTrustedKeyVerificationStrategy\"/\u003e\n  \u003c/launcher\u003e\n  \u003clabel\u003elinux docker\u003c/label\u003e\n  \u003cnodeProperties\u003e\n    \u003chudson.slaves.EnvironmentVariablesNodeProperty\u003e\n      \u003cenvVars serialization=\"custom\"\u003e\n        \u003cunserializable-parents/\u003e\n        \u003ctree-map\u003e\n          \u003cdefault\u003e\n            \u003ccomparator class=\"hudson.util.CaseInsensitiveComparator\"/\u003e\n          \u003c/default\u003e\n          \u003cint\u003e1\u003c/int\u003e\n          \u003cstring\u003eJAVA_HOME\u003c/string\u003e\n          \u003cstring\u003e/usr/lib/jvm/java-17-openjdk\u003c/string\u003e\n        \u003c/tree-map\u003e\n      \u003c/envVars\u003e\n    \u003c/hudson.slaves.EnvironmentVariablesNodeProperty\u003e\n  \u003c/nodeProperties\u003e\n\u003c/slave\u003e\nXML\n\necho \"Jenkins agent $AGENT_NAME configured for host $AGENT_HOST\"\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-agent-setup.sh\n```\n\n### Pipeline Security Best Practices\n```bash\n# Create secure pipeline templates\nsudo mkdir -p /var/lib/jenkins/pipeline-templates\n\nsudo tee /var/lib/jenkins/pipeline-templates/secure-pipeline.groovy \u003e /dev/null \u003c\u003c'EOF'\n// Secure Jenkins Pipeline Template\n@Library('shared-pipeline-library') _\n\npipeline {\n    agent {\n        label 'docker \u0026\u0026 linux'\n    }\n    \n    options {\n        buildDiscarder(logRotator(numToKeepStr: '10', artifactNumToKeepStr: '5'))\n        timeout(time: 60, unit: 'MINUTES')\n        timestamps()\n        skipDefaultCheckout(true)\n        disableConcurrentBuilds()\n        ansiColor('xterm')\n    }\n    \n    environment {\n        // Use Jenkins credentials securely\n        DOCKER_REGISTRY = credentials('docker-registry-url')\n        SONAR_TOKEN = credentials('sonarqube-token')\n        \n        // Security scanning tools\n        TRIVY_VERSION = '0.47.0'\n        CLAIR_VERSION = '4.7.1'\n    }\n    \n    stages {\n        stage('Checkout') {\n            steps {\n                checkout scm\n                script {\n                    env.GIT_COMMIT_SHORT = env.GIT_COMMIT.take(8)\n                    env.BUILD_VERSION = \"${env.BUILD_NUMBER}-${env.GIT_COMMIT_SHORT}\"\n                }\n            }\n        }\n        \n        stage('Security Scan - Code') {\n            parallel {\n                stage('SAST') {\n                    steps {\n                        script {\n                            try {\n                                sh '''\n                                    # Static Application Security Testing\n                                    docker run --rm -v $(pwd):/app \\\n                                        -w /app \\\n                                        securecodewarrior/semgrep:latest \\\n                                        --config=auto --json --output=sast-results.json\n                                '''\n                                \n                                publishHTML([\n                                    allowMissing: false,\n                                    alwaysLinkToLastBuild: true,\n                                    keepAll: true,\n                                    reportDir: '.',\n                                    reportFiles: 'sast-results.json',\n                                    reportName: 'SAST Report'\n                                ])\n                            } catch (Exception e) {\n                                echo \"SAST scan failed: ${e.getMessage()}\"\n                                currentBuild.result = 'UNSTABLE'\n                            }\n                        }\n                    }\n                }\n                \n                stage('Secrets Scan') {\n                    steps {\n                        script {\n                            try {\n                                sh '''\n                                    # Secret scanning with TruffleHog\n                                    docker run --rm -v $(pwd):/repo \\\n                                        trufflesecurity/trufflehog:latest \\\n                                        git file:///repo --json \u003e secrets-scan.json\n                                    \n                                    # Fail if secrets found\n                                    if [ -s secrets-scan.json ]; then\n                                        echo \"Secrets detected in code!\"\n                                        cat secrets-scan.json\n                                        exit 1\n                                    fi\n                                '''\n                            } catch (Exception e) {\n                                error \"Secrets detected in repository!\"\n                            }\n                        }\n                    }\n                }\n                \n                stage('Dependency Check') {\n                    steps {\n                        dependencyCheck additionalArguments: '''\n                            --enableRetired\n                            --enableExperimental\n                            --scan ./\n                            --format JSON\n                            --format HTML\n                        ''', odcInstallation: 'dependency-check'\n                        \n                        dependencyCheckPublisher pattern: '**/dependency-check-report.xml'\n                    }\n                }\n            }\n        }\n        \n        stage('Build') {\n            steps {\n                script {\n                    try {\n                        sh '''\n                            # Secure Docker build\n                            docker build \\\n                                --no-cache \\\n                                --pull \\\n                                --tag ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION} \\\n                                --tag ${DOCKER_REGISTRY}/${JOB_NAME}:latest \\\n                                --build-arg BUILD_VERSION=${BUILD_VERSION} \\\n                                --build-arg BUILD_DATE=$(date -u +\"%Y-%m-%dT%H:%M:%SZ\") \\\n                                --build-arg VCS_REF=${GIT_COMMIT} \\\n                                .\n                        '''\n                    } catch (Exception e) {\n                        error \"Docker build failed: ${e.getMessage()}\"\n                    }\n                }\n            }\n        }\n        \n        stage('Security Scan - Container') {\n            steps {\n                script {\n                    try {\n                        sh '''\n                            # Container vulnerability scanning with Trivy\n                            docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\\n                                aquasec/trivy:latest image \\\n                                --format table \\\n                                --severity HIGH,CRITICAL \\\n                                --exit-code 1 \\\n                                ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}\n                        '''\n                    } catch (Exception e) {\n                        echo \"Container vulnerabilities found: ${e.getMessage()}\"\n                        currentBuild.result = 'UNSTABLE'\n                    }\n                }\n            }\n        }\n        \n        stage('Test') {\n            parallel {\n                stage('Unit Tests') {\n                    steps {\n                        sh '''\n                            # Run unit tests\n                            docker run --rm \\\n                                -v $(pwd):/workspace \\\n                                -w /workspace \\\n                                ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION} \\\n                                npm test\n                        '''\n                        \n                        publishTestResults testResultsPattern: 'test-results.xml'\n                        publishCoverage adapters: [jacocoAdapter('coverage.xml')], sourceFileResolver: sourceFiles('STORE_LAST_BUILD')\n                    }\n                }\n                \n                stage('Integration Tests') {\n                    steps {\n                        sh '''\n                            # Run integration tests in isolated environment\n                            docker-compose -f docker-compose.test.yml up --build --abort-on-container-exit\n                            docker-compose -f docker-compose.test.yml down -v\n                        '''\n                    }\n                }\n            }\n        }\n        \n        stage('Deploy') {\n            when {\n                anyOf {\n                    branch 'main'\n                    branch 'release/*'\n                }\n            }\n            steps {\n                script {\n                    try {\n                        sh '''\n                            # Secure deployment with credential binding\n                            echo \"Deploying ${BUILD_VERSION} to production\"\n                            \n                            # Push to registry\n                            docker push ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}\n                            docker push ${DOCKER_REGISTRY}/${JOB_NAME}:latest\n                            \n                            # Deploy via secure method (kubectl, ansible, etc.)\n                            kubectl set image deployment/${JOB_NAME} \\\n                                ${JOB_NAME}=${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}\n                        '''\n                    } catch (Exception e) {\n                        error \"Deployment failed: ${e.getMessage()}\"\n                    }\n                }\n            }\n        }\n    }\n    \n    post {\n        always {\n            // Clean workspace\n            cleanWs()\n            \n            // Archive artifacts securely\n            archiveArtifacts artifacts: 'target/*.jar,**/test-reports/**', allowEmptyArchive: true\n            \n            // Send notifications\n            emailext(\n                subject: \"Build ${currentBuild.result}: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\",\n                body: \"Build ${currentBuild.result} for ${env.JOB_NAME} build number ${env.BUILD_NUMBER}\",\n                to: \"${env.CHANGE_AUTHOR_EMAIL ?: 'jenkins@example.com'}\"\n            )\n        }\n        \n        failure {\n            // Alert on build failures\n            slackSend(\n                channel: '#ci-cd-alerts',\n                color: 'danger',\n                message: \"Build Failed: ${env.JOB_NAME} - ${env.BUILD_NUMBER} (\u003c${env.BUILD_URL}|Open\u003e)\"\n            )\n        }\n        \n        success {\n            // Success notifications\n            slackSend(\n                channel: '#deployments',\n                color: 'good',\n                message: \"Deployment Successful: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\"\n            )\n        }\n    }\n}\nEOF\n\nsudo chown jenkins:jenkins /var/lib/jenkins/casc_configs/jenkins.yaml\n```\n\n### SSL/TLS Configuration\n```bash\n# Configure NGINX reverse proxy for Jenkins with SSL\nsudo tee /etc/nginx/sites-available/jenkins \u003e /dev/null \u003c\u003cEOF\n# Jenkins NGINX Configuration with Security Headers\n\nupstream jenkins {\n    server 127.0.0.1:8080 fail_timeout=0;\n    keepalive 32;\n}\n\n# HTTP to HTTPS redirect\nserver {\n    listen 80;\n    server_name jenkins.example.com;\n    return 301 https://\\$server_name\\$request_uri;\n}\n\n# HTTPS server\nserver {\n    listen 443 ssl http2;\n    server_name jenkins.example.com;\n\n    # SSL configuration\n    ssl_certificate /etc/letsencrypt/live/jenkins.example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/jenkins.example.com/privkey.pem;\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;\n    ssl_prefer_server_ciphers off;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n\n    # Security headers\n    add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains\" always;\n    add_header X-Content-Type-Options nosniff always;\n    add_header X-Frame-Options DENY always;\n    add_header X-XSS-Protection \"1; mode=block\" always;\n    add_header Referrer-Policy \"strict-origin-when-cross-origin\" always;\n\n    # Jenkins-specific settings\n    client_max_body_size 50M;\n    \n    location / {\n        proxy_pass http://jenkins;\n        proxy_redirect default;\n        proxy_http_version 1.1;\n\n        # Required headers for Jenkins\n        proxy_set_header Host \\$host;\n        proxy_set_header X-Real-IP \\$remote_addr;\n        proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto \\$scheme;\n        proxy_max_temp_file_size 0;\n\n        # Jenkins WebSocket support\n        proxy_set_header Upgrade \\$http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        \n        # Timeout settings\n        proxy_connect_timeout 90;\n        proxy_send_timeout 90;\n        proxy_read_timeout 90;\n        proxy_buffering off;\n        proxy_request_buffering off;\n    }\n}\nEOF\n\n# Install SSL certificate\nsudo certbot --nginx -d jenkins.example.com\n\nsudo ln -s /etc/nginx/sites-available/jenkins /etc/nginx/sites-enabled/\nsudo nginx -t \u0026\u0026 sudo systemctl reload nginx\n```\n\n## Backup and Disaster Recovery\n\n### Comprehensive Backup Strategy\n```bash\nsudo tee /usr/local/bin/jenkins-backup.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nBACKUP_DIR=\"/backup/jenkins\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}/{config,jobs,plugins,secrets}\n\necho \"Starting Jenkins backup...\"\n\n# Gracefully shutdown Jenkins\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 quiet-down\n\n# Wait for running builds to complete (max 10 minutes)\nfor i in {1..60}; do\n    RUNNING_BUILDS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 list-builds | grep -c \"RUNNING\" || echo \"0\")\n    if [ \"$RUNNING_BUILDS\" -eq 0 ]; then\n        echo \"All builds completed, proceeding with backup...\"\n        break\n    fi\n    echo \"Waiting for $RUNNING_BUILDS running builds to complete...\"\n    sleep 10\ndone\n\n# Stop Jenkins service\nsystemctl stop jenkins\n\n# Backup Jenkins home directory\ntar --exclude='/var/lib/jenkins/workspace/*' \\\n    --exclude='/var/lib/jenkins/builds/*/archive' \\\n    --exclude='/var/lib/jenkins/.m2/repository' \\\n    --exclude='/var/lib/jenkins/logs/*' \\\n    -czf ${BACKUP_DIR}/config/jenkins-home-${DATE}.tar.gz \\\n    -C /var/lib/jenkins .\n\n# Backup individual job configurations\nmkdir -p ${BACKUP_DIR}/jobs\nfor job in /var/lib/jenkins/jobs/*/config.xml; do\n    if [ -f \"$job\" ]; then\n        job_name=$(basename $(dirname \"$job\"))\n        cp \"$job\" ${BACKUP_DIR}/jobs/${job_name}-config-${DATE}.xml\n    fi\ndone\n\n# Backup plugin list\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    list-plugins \u003e ${BACKUP_DIR}/plugins/plugin-list-${DATE}.txt\n\n# Backup secrets and credentials\nif [ -d \"/var/lib/jenkins/secrets\" ]; then\n    tar -czf ${BACKUP_DIR}/secrets/jenkins-secrets-${DATE}.tar.gz \\\n        -C /var/lib/jenkins secrets/\nfi\n\n# Start Jenkins\nsystemctl start jenkins\n\n# Wait for Jenkins to be ready\necho \"Waiting for Jenkins to start...\"\nfor i in {1..30}; do\n    if curl -f http://localhost:8080/login \u003e/dev/null 2\u003e\u00261; then\n        echo \"Jenkins is ready\"\n        break\n    fi\n    sleep 10\ndone\n\n# Cancel quiet mode\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 cancel-quiet-down\n\n# Upload to cloud storage\naws s3 cp ${BACKUP_DIR}/ s3://jenkins-backups/ --recursive --sse AES256\naz storage blob upload-batch --source ${BACKUP_DIR} --destination jenkins-backups\ngsutil cp -r ${BACKUP_DIR}/* gs://jenkins-backups/\n\n# Test backup integrity\nLATEST_BACKUP=$(ls -t ${BACKUP_DIR}/config/jenkins-home-*.tar.gz | head -1)\nif tar -tzf \"$LATEST_BACKUP\" \u003e/dev/null 2\u003e\u00261; then\n    echo \"‚úì Backup integrity verified\"\nelse\n    echo \"‚úó Backup integrity check failed\"\nfi\n\n# Keep only last 14 days of backups\nfind ${BACKUP_DIR} -name \"jenkins-*\" -type f -mtime +14 -delete\n\necho \"Jenkins backup completed: ${DATE}\"\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-backup.sh\n\n# Schedule daily backups\necho \"0 1 * * * root /usr/local/bin/jenkins-backup.sh\" | sudo tee -a /etc/crontab\n```\n\n### Jenkins Disaster Recovery\n```bash\nsudo tee /usr/local/bin/jenkins-restore.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nBACKUP_FILE=\"${1}\"\n\nif [ -z \"$BACKUP_FILE\" ]; then\n    echo \"Usage: $0 \u003cbackup_file\u003e\"\n    echo \"Available backups:\"\n    ls -la /backup/jenkins/config/jenkins-home-*.tar.gz\n    exit 1\nfi\n\necho \"Restoring Jenkins from backup: $BACKUP_FILE\"\n\n# Stop Jenkins\nsystemctl stop jenkins\n\n# Backup current installation\nmv /var/lib/jenkins /var/lib/jenkins.backup.$(date +%s)\n\n# Create new Jenkins directory\nmkdir -p /var/lib/jenkins\nchown jenkins:jenkins /var/lib/jenkins\n\n# Restore from backup\ntar -xzf \"$BACKUP_FILE\" -C /var/lib/jenkins\n\n# Set proper ownership\nchown -R jenkins:jenkins /var/lib/jenkins\n\n# Start Jenkins\nsystemctl start jenkins\n\n# Wait for Jenkins to start\necho \"Waiting for Jenkins to start...\"\nfor i in {1..60}; do\n    if curl -f http://localhost:8080/login \u003e/dev/null 2\u003e\u00261; then\n        echo \"Jenkins restored successfully\"\n        break\n    fi\n    sleep 10\ndone\n\necho \"Jenkins restore completed\"\necho \"Please verify configuration and rebuild any workspace dependencies\"\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-restore.sh\n```\n\n## Monitoring and Health Checks\n\n### Comprehensive Monitoring\n```bash\nsudo tee /usr/local/bin/jenkins-health-check.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nHEALTH_LOG=\"/var/log/jenkins-health.log\"\n\nlog_message() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" | tee -a ${HEALTH_LOG}\n}\n\n# Check service status\nif systemctl is-active jenkins \u003e/dev/null 2\u003e\u00261; then\n    log_message \"‚úì Jenkins service is running\"\nelse\n    log_message \"‚úó Jenkins service is not running\"\n    exit 1\nfi\n\n# Check web interface\nHTTP_STATUS=$(curl -s -o /dev/null -w \"%{http_code}\" http://localhost:8080/login)\nif [ \"${HTTP_STATUS}\" = \"200\" ]; then\n    log_message \"‚úì Jenkins web interface is responding\"\nelse\n    log_message \"‚úó Jenkins web interface issues (HTTP ${HTTP_STATUS})\"\nfi\n\n# Check agent connectivity\nAGENT_COUNT=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    list-computers | grep -c \"^agent\" || echo \"0\")\nONLINE_AGENTS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    list-computers | grep -c \"online\" || echo \"0\")\n\nlog_message \"‚Ñπ Jenkins agents: ${ONLINE_AGENTS}/${AGENT_COUNT} online\"\n\n# Check disk space\nDISK_USAGE=$(df /var/lib/jenkins | awk 'NR==2 {print $5}' | sed 's/%//')\nif [ ${DISK_USAGE} -gt 85 ]; then\n    log_message \"‚ö† High disk usage: ${DISK_USAGE}%\"\nelse\n    log_message \"‚úì Disk usage: ${DISK_USAGE}%\"\nfi\n\n# Check for failed builds\nFAILED_JOBS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    list-jobs | xargs -I {} java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    get-job {} | grep -c \"FAILURE\" || echo \"0\")\n\nif [ ${FAILED_JOBS} -gt 0 ]; then\n    log_message \"‚ö† ${FAILED_JOBS} jobs with recent failures\"\nfi\n\n# Check Java memory usage\nJAVA_MEMORY=$(ps -o pid,vsz,rss,comm -C java | grep jenkins | awk '{print $3/1024}' | head -1)\nlog_message \"‚Ñπ Jenkins memory usage: ${JAVA_MEMORY}MB\"\n\nlog_message \"Jenkins health check completed\"\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-health-check.sh\n\n# Schedule health checks every 15 minutes\necho \"*/15 * * * * root /usr/local/bin/jenkins-health-check.sh\" | sudo tee -a /etc/crontab\n```\n\n## Troubleshooting\n\n### Common Issues and Solutions\n```bash\n# Check Jenkins service status\nsudo systemctl status jenkins\nsudo journalctl -u jenkins -f\n\n# Check Jenkins logs\nsudo tail -f /var/log/jenkins/jenkins.log\n\n# Check Java process\nps aux | grep jenkins\njps -v  # Show Java processes\n\n# Memory issues\nsudo systemctl edit jenkins\n# Add:\n[Service]\nEnvironment=\"JAVA_OPTS=-Djava.awt.headless=true -Xmx4g -Xms2g\"\n\nsudo systemctl daemon-reload\nsudo systemctl restart jenkins\n\n# Plugin issues\n# Access Jenkins web interface\n# Go to Manage Jenkins \u003e Manage Plugins \u003e Advanced\n# Check for plugin conflicts or updates\n\n# Agent connectivity issues\n# Check SSH connectivity\nssh jenkins@agent-host\n\n# Check agent logs\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \\\n    connect-node agent-name\n\n# Build failures\n# Check workspace permissions\nsudo chown -R jenkins:jenkins /var/lib/jenkins/workspace\n\n# Clear old builds\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \\\n    delete-builds job-name 1-10\n\n# Performance issues\n# Check system resources\ntop -p $(pgrep java)\nhtop -p $(pgrep java)\n\n# Database cleanup (if using H2)\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \\\n    groovy = \u003c\u003cGROOVY\nimport jenkins.model.Jenkins\nJenkins.instance.cleanUp()\nGROOVY\n\n# Reset Jenkins configuration (emergency)\nsudo systemctl stop jenkins\nsudo rm /var/lib/jenkins/config.xml\nsudo systemctl start jenkins\n# Reconfigure via setup wizard\n```\n\n## Additional Resources\n\n- [Jenkins Documentation](https://www.jenkins.io/doc/)\n- [Jenkins Security Guide](https://www.jenkins.io/doc/book/security/)\n- [Pipeline Best Practices](https://www.jenkins.io/doc/book/pipeline/pipeline-best-practices/)\n- [Jenkins Configuration as Code](https://jenkins.io/projects/jcasc/)\n- [Jenkins Community](https://www.jenkins.io/community/)\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection.","readmeHtml":"\u003ch1 id=\"jenkins-installation-guide\" class=\"mobile-header\"\u003eJenkins Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eOpen-source automation server for building, testing, and deploying applications. Industry-leading CI/CD platform with extensive plugin ecosystem and enterprise-grade security features.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux system (any modern distribution)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot or sudo access\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eJava 11 or 17 (LTS versions recommended)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e4GB RAM minimum, 8GB+ recommended for production\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e50GB+ disk space for builds and artifacts\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eNetwork connectivity for external integrations\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"ubuntudebian\" class=\"mobile-header\"\u003eUbuntu/Debian\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update system packages\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade -y\n\n# Install Java 17 (LTS)\nsudo apt install -y openjdk-17-jdk openjdk-17-jre\n\n# Add Jenkins repository and key\nwget -q -O - https://pkg.jenkins.io/debian-stable/jenkins.io-2023.key | sudo apt-key add -\necho \u0026quot;deb https://pkg.jenkins.io/debian-stable binary/\u0026quot; | sudo tee /etc/apt/sources.list.d/jenkins.list\n\n# Update package list\nsudo apt update\n\n# Install Jenkins\nsudo apt install -y jenkins\n\n# Enable and start service\nsudo systemctl enable --now jenkins\n\n# Configure firewall\nsudo ufw allow 8080/tcp comment \u0026#039;Jenkins HTTP\u0026#039;\nsudo ufw allow OpenSSH\n\n# Verify installation\nsudo systemctl status jenkins\njava -version\njenkins --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"rhelcentosrocky-linuxalmalinux\" class=\"mobile-header\"\u003eRHEL/CentOS/Rocky Linux/AlmaLinux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Java 17\nsudo yum install -y java-17-openjdk java-17-openjdk-devel\n\n# Add Jenkins repository\nsudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo\nsudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key\n\n# Install Jenkins\nsudo yum install -y jenkins\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=8080/tcp\nsudo firewall-cmd --permanent --add-port=50000/tcp  # Agent communication\nsudo firewall-cmd --reload\n\n# Enable and start service\nsudo systemctl enable --now jenkins\n\n# Verify installation\nsudo systemctl status jenkins\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"fedora\" class=\"mobile-header\"\u003eFedora\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Java 17\nsudo dnf install -y java-17-openjdk java-17-openjdk-devel\n\n# Add Jenkins repository\nsudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo\nsudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key\n\n# Install Jenkins\nsudo dnf install -y jenkins\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=8080/tcp\nsudo firewall-cmd --reload\n\n# Enable and start service\nsudo systemctl enable --now jenkins\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"arch-linux\" class=\"mobile-header\"\u003eArch Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Java\nsudo pacman -Syu jdk17-openjdk\n\n# Install Jenkins from AUR\nyay -S jenkins\n\n# Enable and start service\nsudo systemctl enable --now jenkins\n\n# Verify installation\nsudo systemctl status jenkins\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"docker-installation-recommended-for-development\" class=\"mobile-header\"\u003eDocker Installation (Recommended for Development)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create Jenkins directories\nmkdir -p ~/jenkins/{jenkins_home,docker_certs,docker_sock}\n\n# Run Jenkins container with Docker support\ndocker run -d \\\n  --name jenkins \\\n  --restart unless-stopped \\\n  -p 8080:8080 \\\n  -p 50000:50000 \\\n  -v ~/jenkins/jenkins_home:/var/jenkins_home \\\n  -v ~/jenkins/docker_certs:/certs/client:ro \\\n  -v ~/jenkins/docker_sock:/var/run/docker.sock \\\n  --group-add $(getent group docker | cut -d: -f3) \\\n  --security-opt no-new-privileges:true \\\n  jenkins/jenkins:lts-jdk17\n\n# Get initial admin password\ndocker exec jenkins cat /var/jenkins_home/secrets/initialAdminPassword\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"security-hardening-2024-best-practices\" class=\"mobile-header\"\u003eSecurity Hardening (2024 Best Practices)\u003c/h2\u003e\n\u003ch3 id=\"initial-security-setup\" class=\"mobile-header\"\u003eInitial Security Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Get initial admin password\nsudo cat /var/lib/jenkins/secrets/initialAdminPassword\n\n# Complete setup via web interface: http://your-server:8080\n# 1. Enter admin password\n# 2. Install suggested plugins\n# 3. Create first admin user\n# 4. Configure Jenkins URL\n\n# Advanced security configuration via Jenkins CLI\n# Download Jenkins CLI\nwget http://localhost:8080/jnlpJars/jenkins-cli.jar\n\n# Create CLI configuration script\ncat \u0026gt; jenkins-security-config.sh \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nJENKINS_URL=\u0026quot;http://localhost:8080\u0026quot;\nADMIN_USER=\u0026quot;admin\u0026quot;\nADMIN_PASS=\u0026quot;secure_admin_password_2024\u0026quot;\n\n# Function to run Jenkins CLI commands\nrun_jenkins_cli() {\n    java -jar jenkins-cli.jar -s ${JENKINS_URL} -auth ${ADMIN_USER}:${ADMIN_PASS} \u0026quot;$@\u0026quot;\n}\n\n# Install essential security plugins\nrun_jenkins_cli install-plugin \\\n    authorize-project \\\n    build-timeout \\\n    credentials-binding \\\n    workflow-aggregator \\\n    matrix-auth \\\n    pam-auth \\\n    ldap \\\n    role-strategy \\\n    audit-trail \\\n    job-dsl \\\n    pipeline-stage-view \\\n    blueocean\n\n# Configure global security\nrun_jenkins_cli groovy = \u0026lt;\u0026lt;GROOVY\nimport jenkins.model.*\nimport hudson.security.*\nimport hudson.security.csrf.DefaultCrumbIssuer\n\ndef instance = Jenkins.getInstance()\n\n// Enable CSRF protection\ninstance.setCrumbIssuer(new DefaultCrumbIssuer(true))\n\n// Configure security realm (local users)\ndef hudsonRealm = new HudsonPrivateSecurityRealm(false)\ninstance.setSecurityRealm(hudsonRealm)\n\n// Create admin user\ndef adminUser = hudsonRealm.createAccount(\u0026quot;admin\u0026quot;, \u0026quot;secure_admin_password_2024\u0026quot;)\n\n// Configure authorization strategy\ndef strategy = new FullControlOnceLoggedInAuthorizationStrategy()\nstrategy.setDenyAnonymousReadAccess(true)\ninstance.setAuthorizationStrategy(strategy)\n\n// Disable CLI over remoting\ninstance.getDescriptor(\u0026quot;jenkins.CLI\u0026quot;).get().setEnabled(false)\n\n// Disable agent-to-master access control for security\ninstance.getExtensionList(jenkins.security.s2m.AdminWhitelistRule.class)\n    .get(jenkins.security.s2m.AdminWhitelistRule.class)\n    .setMasterKillSwitch(false)\n\n// Enable slave-to-master access control\ninstance.injector.getInstance(AdminWhitelistRule.class).setMasterKillSwitch(false)\n\n// Save configuration\ninstance.save()\n\nprintln \u0026quot;Security configuration applied\u0026quot;\nGROOVY\n\necho \u0026quot;Jenkins security configuration completed\u0026quot;\nEOF\n\nchmod +x jenkins-security-config.sh\n./jenkins-security-config.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-authentication-setup\" class=\"mobile-header\"\u003eAdvanced Authentication Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure LDAP authentication\ncat \u0026gt; ldap-config.groovy \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\nimport jenkins.model.*\nimport hudson.security.*\nimport hudson.security.LDAPSecurityRealm\n\ndef instance = Jenkins.getInstance()\n\n// LDAP configuration\ndef ldapRealm = new LDAPSecurityRealm(\n    \u0026quot;ldaps://ldap.example.com:636\u0026quot;,  // LDAP server\n    \u0026quot;DC=example,DC=com\u0026quot;,             // Root DN\n    \u0026quot;(\u0026amp;(objectCategory=Person)(objectClass=user)(sAMAccountName={0}))\u0026quot;, // User search filter\n    \u0026quot;CN=jenkins,OU=Service Accounts,DC=example,DC=com\u0026quot;, // Manager DN\n    \u0026quot;ldap_service_password\u0026quot;,         // Manager password\n    false,                          // Inhibit infer root DN\n    false,                          // Disable email resolution\n    null,                           // Cache configuration\n    null,                           // Environment properties\n    \u0026quot;displayName\u0026quot;,                  // Display name LDAP attribute\n    \u0026quot;mail\u0026quot;,                         // Email LDAP attribute\n    null,                           // Id strategy\n    \u0026quot;(\u0026amp;(objectClass=group)(cn={0}))\u0026quot; // Group search filter\n)\n\n// Set LDAP as security realm\ninstance.setSecurityRealm(ldapRealm)\n\n// Configure matrix-based authorization\ndef authStrategy = new ProjectMatrixAuthorizationStrategy()\n\n// Admin permissions\nauthStrategy.add(Jenkins.ADMINISTER, \u0026quot;admin\u0026quot;)\nauthStrategy.add(Jenkins.ADMINISTER, \u0026quot;jenkins-admins\u0026quot;)\n\n// Developer permissions\nauthStrategy.add(Jenkins.READ, \u0026quot;authenticated\u0026quot;)\nauthStrategy.add(Item.BUILD, \u0026quot;developers\u0026quot;)\nauthStrategy.add(Item.READ, \u0026quot;developers\u0026quot;)\nauthStrategy.add(Item.WORKSPACE, \u0026quot;developers\u0026quot;)\n\ninstance.setAuthorizationStrategy(authStrategy)\ninstance.save()\n\nprintln \u0026quot;LDAP authentication configured\u0026quot;\nEOF\n\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 groovy = \u0026lt; ldap-config.groovy\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"plugin-security-and-management\" class=\"mobile-header\"\u003ePlugin Security and Management\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create plugin security script\nsudo tee /usr/local/bin/jenkins-plugin-security.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nJENKINS_CLI=\u0026quot;/var/lib/jenkins/jenkins-cli.jar\u0026quot;\nJENKINS_URL=\u0026quot;http://localhost:8080\u0026quot;\nADMIN_USER=\u0026quot;admin\u0026quot;\nADMIN_PASS=\u0026quot;secure_admin_password_2024\u0026quot;\n\n# Function to run Jenkins CLI\njenkins_cli() {\n    java -jar ${JENKINS_CLI} -s ${JENKINS_URL} -auth ${ADMIN_USER}:${ADMIN_PASS} \u0026quot;$@\u0026quot;\n}\n\n# Check for plugin updates\necho \u0026quot;Checking for plugin security updates...\u0026quot;\njenkins_cli list-plugins | grep -E \u0026quot;\\)$\u0026quot; \u0026gt; /tmp/outdated-plugins.txt\n\nif [ -s /tmp/outdated-plugins.txt ]; then\n    echo \u0026quot;Outdated plugins found:\u0026quot;\n    cat /tmp/outdated-plugins.txt\n    \n    # Update all plugins\n    jenkins_cli install-plugin $(awk \u0026#039;{print $1}\u0026#039; /tmp/outdated-plugins.txt | tr \u0026#039;\\n\u0026#039; \u0026#039; \u0026#039;)\n    \n    echo \u0026quot;Restarting Jenkins to apply plugin updates...\u0026quot;\n    jenkins_cli safe-restart\nfi\n\n# Install essential security plugins\nSECURITY_PLUGINS=(\n    \u0026quot;authorize-project\u0026quot;\n    \u0026quot;build-timeout\u0026quot;\n    \u0026quot;credentials-binding\u0026quot;\n    \u0026quot;matrix-auth\u0026quot;\n    \u0026quot;role-strategy\u0026quot;\n    \u0026quot;audit-trail\u0026quot;\n    \u0026quot;configuration-as-code\u0026quot;\n    \u0026quot;job-dsl\u0026quot;\n    \u0026quot;pipeline-stage-view\u0026quot;\n    \u0026quot;workflow-aggregator\u0026quot;\n    \u0026quot;blueocean\u0026quot;\n    \u0026quot;pipeline-utility-steps\u0026quot;\n    \u0026quot;timestamper\u0026quot;\n    \u0026quot;ws-cleanup\u0026quot;\n    \u0026quot;build-name-setter\u0026quot;\n    \u0026quot;description-setter\u0026quot;\n)\n\nfor plugin in \u0026quot;${SECURITY_PLUGINS[@]}\u0026quot;; do\n    if ! jenkins_cli list-plugins | grep -q \u0026quot;^$plugin \u0026quot;; then\n        echo \u0026quot;Installing security plugin: $plugin\u0026quot;\n        jenkins_cli install-plugin \u0026quot;$plugin\u0026quot;\n    fi\ndone\n\necho \u0026quot;Plugin security check completed\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-plugin-security.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"advanced-configuration\" class=\"mobile-header\"\u003eAdvanced Configuration\u003c/h2\u003e\n\u003ch3 id=\"jenkins-configuration-as-code-jcasc\" class=\"mobile-header\"\u003eJenkins Configuration as Code (JCasC)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create Jenkins Configuration as Code setup\nsudo mkdir -p /var/lib/jenkins/casc_configs\n\nsudo tee /var/lib/jenkins/casc_configs/jenkins.yaml \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n# Jenkins Configuration as Code (JCasC)\njenkins:\n  systemMessage: \u0026quot;Jenkins managed by Configuration as Code\u0026quot;\n  numExecutors: 0  # Don\u0026#039;t run builds on master\n  mode: EXCLUSIVE\n  scmCheckoutRetryCount: 3\n  \n  securityRealm:\n    ldap:\n      configurations:\n        - server: \u0026quot;ldaps://ldap.example.com:636\u0026quot;\n          rootDN: \u0026quot;DC=example,DC=com\u0026quot;\n          inhibitInferRootDN: false\n          userSearchBase: \u0026quot;OU=Users\u0026quot;\n          userSearch: \u0026quot;(\u0026amp;(objectCategory=Person)(objectClass=user)(sAMAccountName={0}))\u0026quot;\n          groupSearchBase: \u0026quot;OU=Groups\u0026quot;\n          groupSearchFilter: \u0026quot;(\u0026amp;(objectClass=group)(cn={0}))\u0026quot;\n          managerDN: \u0026quot;CN=jenkins,OU=Service Accounts,DC=example,DC=com\u0026quot;\n          managerPasswordSecret: \u0026quot;ldap-password\u0026quot;\n          displayNameAttributeName: \u0026quot;displayName\u0026quot;\n          mailAddressAttributeName: \u0026quot;mail\u0026quot;\n\n  authorizationStrategy:\n    roleBased:\n      roles:\n        global:\n          - name: \u0026quot;admin\u0026quot;\n            description: \u0026quot;Jenkins administrators\u0026quot;\n            permissions:\n              - \u0026quot;Overall/Administer\u0026quot;\n            assignments:\n              - \u0026quot;jenkins-admins\u0026quot;\n          - name: \u0026quot;developer\u0026quot;\n            description: \u0026quot;Developers\u0026quot;\n            permissions:\n              - \u0026quot;Overall/Read\u0026quot;\n              - \u0026quot;Job/Build\u0026quot;\n              - \u0026quot;Job/Cancel\u0026quot;\n              - \u0026quot;Job/Read\u0026quot;\n              - \u0026quot;Job/Workspace\u0026quot;\n            assignments:\n              - \u0026quot;developers\u0026quot;\n              - \u0026quot;authenticated\u0026quot;\n\n  remotingSecurity:\n    enabled: true\n\n  nodes:\n    - permanent:\n        name: \u0026quot;agent-1\u0026quot;\n        remoteFS: \u0026quot;/var/lib/jenkins\u0026quot;\n        launcher:\n          ssh:\n            host: \u0026quot;jenkins-agent-1.example.com\u0026quot;\n            credentialsId: \u0026quot;ssh-agent-key\u0026quot;\n            sshHostKeyVerificationStrategy: \u0026quot;manuallyTrustedKeyVerificationStrategy\u0026quot;\n\nunclassified:\n  globalLibraries:\n    libraries:\n      - name: \u0026quot;shared-pipeline-library\u0026quot;\n        defaultVersion: \u0026quot;main\u0026quot;\n        retriever:\n          modernSCM:\n            scm:\n              git:\n                remote: \u0026quot;https://github.com/example/jenkins-shared-library.git\u0026quot;\n                credentialsId: \u0026quot;github-token\u0026quot;\n\n  location:\n    adminAddress: \u0026quot;jenkins@example.com\u0026quot;\n    url: \u0026quot;https://jenkins.example.com/\u0026quot;\n\nsecurity:\n  globalJobDslSecurityConfiguration:\n    useScriptSecurity: true\n  \n  scriptApproval:\n    approvedSignatures:\n      - \u0026quot;method java.lang.String trim\u0026quot;\n      - \u0026quot;method java.util.Properties getProperty java.lang.String\u0026quot;\n\ncredentials:\n  system:\n    domainCredentials:\n      - credentials:\n          - usernamePassword:\n              scope: GLOBAL\n              id: \u0026quot;github-user\u0026quot;\n              username: \u0026quot;jenkins-bot\u0026quot;\n              password: \u0026quot;{AQAAABAAAAAQhudQr8JjwNNI9pj8oI3L2gE=}\u0026quot;\n              description: \u0026quot;GitHub service account\u0026quot;\n          - basicSSHUserPrivateKey:\n              scope: GLOBAL\n              id: \u0026quot;ssh-agent-key\u0026quot;\n              username: \u0026quot;jenkins\u0026quot;\n              description: \u0026quot;SSH key for Jenkins agents\u0026quot;\n              privateKeySource:\n                directEntry:\n                  privateKey: \u0026quot;{AQAAABAAAAAQhudQr8JjwNNI9pj8oI3L2gE=}\u0026quot;\n\ntool:\n  git:\n    installations:\n      - name: \u0026quot;Default\u0026quot;\n        home: \u0026quot;/usr/bin/git\u0026quot;\n  \n  maven:\n    installations:\n      - name: \u0026quot;Maven 3.9\u0026quot;\n        properties:\n          - installSource:\n              installers:\n                - maven:\n                    id: \u0026quot;3.9.6\u0026quot;\n\n  jdk:\n    installations:\n      - name: \u0026quot;OpenJDK 17\u0026quot;\n        home: \u0026quot;/usr/lib/jvm/java-17-openjdk\u0026quot;\n      - name: \u0026quot;OpenJDK 11\u0026quot;\n        home: \u0026quot;/usr/lib/jvm/java-11-openjdk\u0026quot;\nEOF\n\n# Set environment variable for JCasC\nsudo tee /etc/systemd/system/jenkins.service.d/override.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Service]\nEnvironment=\u0026quot;CASC_JENKINS_CONFIG=/var/lib/jenkins/casc_configs\u0026quot;\nEnvironment=\u0026quot;JAVA_OPTS=-Djava.awt.headless=true -Xmx2g -Xms1g -XX:+UseG1GC\u0026quot;\nEOF\n\nsudo systemctl daemon-reload\nsudo systemctl restart jenkins\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"secure-agent-configuration\" class=\"mobile-header\"\u003eSecure Agent Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create Jenkins agent setup script\nsudo tee /usr/local/bin/jenkins-agent-setup.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nAGENT_NAME=\u0026quot;${1:-agent-1}\u0026quot;\nAGENT_HOST=\u0026quot;${2:-jenkins-agent-1.example.com}\u0026quot;\n\n# Create agent working directory\nssh $AGENT_HOST \u0026quot;sudo mkdir -p /var/lib/jenkins \u0026amp;\u0026amp; sudo useradd -r -d /var/lib/jenkins jenkins\u0026quot;\n\n# Generate SSH key for agent communication\nif [ ! -f ~/.ssh/jenkins_agent_rsa ]; then\n    ssh-keygen -t rsa -b 4096 -f ~/.ssh/jenkins_agent_rsa -N \u0026quot;\u0026quot; -C \u0026quot;jenkins-agent-key\u0026quot;\nfi\n\n# Copy public key to agent\nssh-copy-id -i ~/.ssh/jenkins_agent_rsa.pub jenkins@$AGENT_HOST\n\n# Install Java on agent\nssh $AGENT_HOST \u0026quot;sudo apt update \u0026amp;\u0026amp; sudo apt install -y openjdk-17-jre\u0026quot;\n\n# Create agent via Jenkins CLI\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n  create-node $AGENT_NAME \u0026lt;\u0026lt;XML\n\u0026lt;slave\u0026gt;\n  \u0026lt;name\u0026gt;$AGENT_NAME\u0026lt;/name\u0026gt;\n  \u0026lt;description\u0026gt;Secure Jenkins Agent\u0026lt;/description\u0026gt;\n  \u0026lt;remoteFS\u0026gt;/var/lib/jenkins\u0026lt;/remoteFS\u0026gt;\n  \u0026lt;numExecutors\u0026gt;2\u0026lt;/numExecutors\u0026gt;\n  \u0026lt;mode\u0026gt;NORMAL\u0026lt;/mode\u0026gt;\n  \u0026lt;retentionStrategy class=\u0026quot;hudson.slaves.RetentionStrategy\\$Always\u0026quot;/\u0026gt;\n  \u0026lt;launcher class=\u0026quot;hudson.plugins.sshslaves.SSHLauncher\u0026quot;\u0026gt;\n    \u0026lt;host\u0026gt;$AGENT_HOST\u0026lt;/host\u0026gt;\n    \u0026lt;port\u0026gt;22\u0026lt;/port\u0026gt;\n    \u0026lt;credentialsId\u0026gt;ssh-agent-key\u0026lt;/credentialsId\u0026gt;\n    \u0026lt;launchTimeoutSeconds\u0026gt;60\u0026lt;/launchTimeoutSeconds\u0026gt;\n    \u0026lt;maxNumRetries\u0026gt;3\u0026lt;/maxNumRetries\u0026gt;\n    \u0026lt;retryWaitTime\u0026gt;15\u0026lt;/retryWaitTime\u0026gt;\n    \u0026lt;sshHostKeyVerificationStrategy class=\u0026quot;hudson.plugins.sshslaves.verifiers.ManuallyTrustedKeyVerificationStrategy\u0026quot;/\u0026gt;\n  \u0026lt;/launcher\u0026gt;\n  \u0026lt;label\u0026gt;linux docker\u0026lt;/label\u0026gt;\n  \u0026lt;nodeProperties\u0026gt;\n    \u0026lt;hudson.slaves.EnvironmentVariablesNodeProperty\u0026gt;\n      \u0026lt;envVars serialization=\u0026quot;custom\u0026quot;\u0026gt;\n        \u0026lt;unserializable-parents/\u0026gt;\n        \u0026lt;tree-map\u0026gt;\n          \u0026lt;default\u0026gt;\n            \u0026lt;comparator class=\u0026quot;hudson.util.CaseInsensitiveComparator\u0026quot;/\u0026gt;\n          \u0026lt;/default\u0026gt;\n          \u0026lt;int\u0026gt;1\u0026lt;/int\u0026gt;\n          \u0026lt;string\u0026gt;JAVA_HOME\u0026lt;/string\u0026gt;\n          \u0026lt;string\u0026gt;/usr/lib/jvm/java-17-openjdk\u0026lt;/string\u0026gt;\n        \u0026lt;/tree-map\u0026gt;\n      \u0026lt;/envVars\u0026gt;\n    \u0026lt;/hudson.slaves.EnvironmentVariablesNodeProperty\u0026gt;\n  \u0026lt;/nodeProperties\u0026gt;\n\u0026lt;/slave\u0026gt;\nXML\n\necho \u0026quot;Jenkins agent $AGENT_NAME configured for host $AGENT_HOST\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-agent-setup.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"pipeline-security-best-practices\" class=\"mobile-header\"\u003ePipeline Security Best Practices\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create secure pipeline templates\nsudo mkdir -p /var/lib/jenkins/pipeline-templates\n\nsudo tee /var/lib/jenkins/pipeline-templates/secure-pipeline.groovy \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n// Secure Jenkins Pipeline Template\n@Library(\u0026#039;shared-pipeline-library\u0026#039;) _\n\npipeline {\n    agent {\n        label \u0026#039;docker \u0026amp;\u0026amp; linux\u0026#039;\n    }\n    \n    options {\n        buildDiscarder(logRotator(numToKeepStr: \u0026#039;10\u0026#039;, artifactNumToKeepStr: \u0026#039;5\u0026#039;))\n        timeout(time: 60, unit: \u0026#039;MINUTES\u0026#039;)\n        timestamps()\n        skipDefaultCheckout(true)\n        disableConcurrentBuilds()\n        ansiColor(\u0026#039;xterm\u0026#039;)\n    }\n    \n    environment {\n        // Use Jenkins credentials securely\n        DOCKER_REGISTRY = credentials(\u0026#039;docker-registry-url\u0026#039;)\n        SONAR_TOKEN = credentials(\u0026#039;sonarqube-token\u0026#039;)\n        \n        // Security scanning tools\n        TRIVY_VERSION = \u0026#039;0.47.0\u0026#039;\n        CLAIR_VERSION = \u0026#039;4.7.1\u0026#039;\n    }\n    \n    stages {\n        stage(\u0026#039;Checkout\u0026#039;) {\n            steps {\n                checkout scm\n                script {\n                    env.GIT_COMMIT_SHORT = env.GIT_COMMIT.take(8)\n                    env.BUILD_VERSION = \u0026quot;${env.BUILD_NUMBER}-${env.GIT_COMMIT_SHORT}\u0026quot;\n                }\n            }\n        }\n        \n        stage(\u0026#039;Security Scan - Code\u0026#039;) {\n            parallel {\n                stage(\u0026#039;SAST\u0026#039;) {\n                    steps {\n                        script {\n                            try {\n                                sh \u0026#039;\u0026#039;\u0026#039;\n                                    # Static Application Security Testing\n                                    docker run --rm -v $(pwd):/app \\\n                                        -w /app \\\n                                        securecodewarrior/semgrep:latest \\\n                                        --config=auto --json --output=sast-results.json\n                                \u0026#039;\u0026#039;\u0026#039;\n                                \n                                publishHTML([\n                                    allowMissing: false,\n                                    alwaysLinkToLastBuild: true,\n                                    keepAll: true,\n                                    reportDir: \u0026#039;.\u0026#039;,\n                                    reportFiles: \u0026#039;sast-results.json\u0026#039;,\n                                    reportName: \u0026#039;SAST Report\u0026#039;\n                                ])\n                            } catch (Exception e) {\n                                echo \u0026quot;SAST scan failed: ${e.getMessage()}\u0026quot;\n                                currentBuild.result = \u0026#039;UNSTABLE\u0026#039;\n                            }\n                        }\n                    }\n                }\n                \n                stage(\u0026#039;Secrets Scan\u0026#039;) {\n                    steps {\n                        script {\n                            try {\n                                sh \u0026#039;\u0026#039;\u0026#039;\n                                    # Secret scanning with TruffleHog\n                                    docker run --rm -v $(pwd):/repo \\\n                                        trufflesecurity/trufflehog:latest \\\n                                        git file:///repo --json \u0026gt; secrets-scan.json\n                                    \n                                    # Fail if secrets found\n                                    if [ -s secrets-scan.json ]; then\n                                        echo \u0026quot;Secrets detected in code!\u0026quot;\n                                        cat secrets-scan.json\n                                        exit 1\n                                    fi\n                                \u0026#039;\u0026#039;\u0026#039;\n                            } catch (Exception e) {\n                                error \u0026quot;Secrets detected in repository!\u0026quot;\n                            }\n                        }\n                    }\n                }\n                \n                stage(\u0026#039;Dependency Check\u0026#039;) {\n                    steps {\n                        dependencyCheck additionalArguments: \u0026#039;\u0026#039;\u0026#039;\n                            --enableRetired\n                            --enableExperimental\n                            --scan ./\n                            --format JSON\n                            --format HTML\n                        \u0026#039;\u0026#039;\u0026#039;, odcInstallation: \u0026#039;dependency-check\u0026#039;\n                        \n                        dependencyCheckPublisher pattern: \u0026#039;**/dependency-check-report.xml\u0026#039;\n                    }\n                }\n            }\n        }\n        \n        stage(\u0026#039;Build\u0026#039;) {\n            steps {\n                script {\n                    try {\n                        sh \u0026#039;\u0026#039;\u0026#039;\n                            # Secure Docker build\n                            docker build \\\n                                --no-cache \\\n                                --pull \\\n                                --tag ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION} \\\n                                --tag ${DOCKER_REGISTRY}/${JOB_NAME}:latest \\\n                                --build-arg BUILD_VERSION=${BUILD_VERSION} \\\n                                --build-arg BUILD_DATE=$(date -u +\u0026quot;%Y-%m-%dT%H:%M:%SZ\u0026quot;) \\\n                                --build-arg VCS_REF=${GIT_COMMIT} \\\n                                .\n                        \u0026#039;\u0026#039;\u0026#039;\n                    } catch (Exception e) {\n                        error \u0026quot;Docker build failed: ${e.getMessage()}\u0026quot;\n                    }\n                }\n            }\n        }\n        \n        stage(\u0026#039;Security Scan - Container\u0026#039;) {\n            steps {\n                script {\n                    try {\n                        sh \u0026#039;\u0026#039;\u0026#039;\n                            # Container vulnerability scanning with Trivy\n                            docker run --rm -v /var/run/docker.sock:/var/run/docker.sock \\\n                                aquasec/trivy:latest image \\\n                                --format table \\\n                                --severity HIGH,CRITICAL \\\n                                --exit-code 1 \\\n                                ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}\n                        \u0026#039;\u0026#039;\u0026#039;\n                    } catch (Exception e) {\n                        echo \u0026quot;Container vulnerabilities found: ${e.getMessage()}\u0026quot;\n                        currentBuild.result = \u0026#039;UNSTABLE\u0026#039;\n                    }\n                }\n            }\n        }\n        \n        stage(\u0026#039;Test\u0026#039;) {\n            parallel {\n                stage(\u0026#039;Unit Tests\u0026#039;) {\n                    steps {\n                        sh \u0026#039;\u0026#039;\u0026#039;\n                            # Run unit tests\n                            docker run --rm \\\n                                -v $(pwd):/workspace \\\n                                -w /workspace \\\n                                ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION} \\\n                                npm test\n                        \u0026#039;\u0026#039;\u0026#039;\n                        \n                        publishTestResults testResultsPattern: \u0026#039;test-results.xml\u0026#039;\n                        publishCoverage adapters: [jacocoAdapter(\u0026#039;coverage.xml\u0026#039;)], sourceFileResolver: sourceFiles(\u0026#039;STORE_LAST_BUILD\u0026#039;)\n                    }\n                }\n                \n                stage(\u0026#039;Integration Tests\u0026#039;) {\n                    steps {\n                        sh \u0026#039;\u0026#039;\u0026#039;\n                            # Run integration tests in isolated environment\n                            docker-compose -f docker-compose.test.yml up --build --abort-on-container-exit\n                            docker-compose -f docker-compose.test.yml down -v\n                        \u0026#039;\u0026#039;\u0026#039;\n                    }\n                }\n            }\n        }\n        \n        stage(\u0026#039;Deploy\u0026#039;) {\n            when {\n                anyOf {\n                    branch \u0026#039;main\u0026#039;\n                    branch \u0026#039;release/*\u0026#039;\n                }\n            }\n            steps {\n                script {\n                    try {\n                        sh \u0026#039;\u0026#039;\u0026#039;\n                            # Secure deployment with credential binding\n                            echo \u0026quot;Deploying ${BUILD_VERSION} to production\u0026quot;\n                            \n                            # Push to registry\n                            docker push ${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}\n                            docker push ${DOCKER_REGISTRY}/${JOB_NAME}:latest\n                            \n                            # Deploy via secure method (kubectl, ansible, etc.)\n                            kubectl set image deployment/${JOB_NAME} \\\n                                ${JOB_NAME}=${DOCKER_REGISTRY}/${JOB_NAME}:${BUILD_VERSION}\n                        \u0026#039;\u0026#039;\u0026#039;\n                    } catch (Exception e) {\n                        error \u0026quot;Deployment failed: ${e.getMessage()}\u0026quot;\n                    }\n                }\n            }\n        }\n    }\n    \n    post {\n        always {\n            // Clean workspace\n            cleanWs()\n            \n            // Archive artifacts securely\n            archiveArtifacts artifacts: \u0026#039;target/*.jar,**/test-reports/**\u0026#039;, allowEmptyArchive: true\n            \n            // Send notifications\n            emailext(\n                subject: \u0026quot;Build ${currentBuild.result}: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\u0026quot;,\n                body: \u0026quot;Build ${currentBuild.result} for ${env.JOB_NAME} build number ${env.BUILD_NUMBER}\u0026quot;,\n                to: \u0026quot;${env.CHANGE_AUTHOR_EMAIL ?: \u0026#039;jenkins@example.com\u0026#039;}\u0026quot;\n            )\n        }\n        \n        failure {\n            // Alert on build failures\n            slackSend(\n                channel: \u0026#039;#ci-cd-alerts\u0026#039;,\n                color: \u0026#039;danger\u0026#039;,\n                message: \u0026quot;Build Failed: ${env.JOB_NAME} - ${env.BUILD_NUMBER} (\u0026lt;${env.BUILD_URL}|Open\u0026gt;)\u0026quot;\n            )\n        }\n        \n        success {\n            // Success notifications\n            slackSend(\n                channel: \u0026#039;#deployments\u0026#039;,\n                color: \u0026#039;good\u0026#039;,\n                message: \u0026quot;Deployment Successful: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\u0026quot;\n            )\n        }\n    }\n}\nEOF\n\nsudo chown jenkins:jenkins /var/lib/jenkins/casc_configs/jenkins.yaml\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ssltls-configuration\" class=\"mobile-header\"\u003eSSL/TLS Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure NGINX reverse proxy for Jenkins with SSL\nsudo tee /etc/nginx/sites-available/jenkins \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n# Jenkins NGINX Configuration with Security Headers\n\nupstream jenkins {\n    server 127.0.0.1:8080 fail_timeout=0;\n    keepalive 32;\n}\n\n# HTTP to HTTPS redirect\nserver {\n    listen 80;\n    server_name jenkins.example.com;\n    return 301 https://\\$server_name\\$request_uri;\n}\n\n# HTTPS server\nserver {\n    listen 443 ssl http2;\n    server_name jenkins.example.com;\n\n    # SSL configuration\n    ssl_certificate /etc/letsencrypt/live/jenkins.example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/jenkins.example.com/privkey.pem;\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;\n    ssl_prefer_server_ciphers off;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n\n    # Security headers\n    add_header Strict-Transport-Security \u0026quot;max-age=31536000; includeSubDomains\u0026quot; always;\n    add_header X-Content-Type-Options nosniff always;\n    add_header X-Frame-Options DENY always;\n    add_header X-XSS-Protection \u0026quot;1; mode=block\u0026quot; always;\n    add_header Referrer-Policy \u0026quot;strict-origin-when-cross-origin\u0026quot; always;\n\n    # Jenkins-specific settings\n    client_max_body_size 50M;\n    \n    location / {\n        proxy_pass http://jenkins;\n        proxy_redirect default;\n        proxy_http_version 1.1;\n\n        # Required headers for Jenkins\n        proxy_set_header Host \\$host;\n        proxy_set_header X-Real-IP \\$remote_addr;\n        proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto \\$scheme;\n        proxy_max_temp_file_size 0;\n\n        # Jenkins WebSocket support\n        proxy_set_header Upgrade \\$http_upgrade;\n        proxy_set_header Connection \u0026quot;upgrade\u0026quot;;\n        \n        # Timeout settings\n        proxy_connect_timeout 90;\n        proxy_send_timeout 90;\n        proxy_read_timeout 90;\n        proxy_buffering off;\n        proxy_request_buffering off;\n    }\n}\nEOF\n\n# Install SSL certificate\nsudo certbot --nginx -d jenkins.example.com\n\nsudo ln -s /etc/nginx/sites-available/jenkins /etc/nginx/sites-enabled/\nsudo nginx -t \u0026amp;\u0026amp; sudo systemctl reload nginx\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-and-disaster-recovery\" class=\"mobile-header\"\u003eBackup and Disaster Recovery\u003c/h2\u003e\n\u003ch3 id=\"comprehensive-backup-strategy\" class=\"mobile-header\"\u003eComprehensive Backup Strategy\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/jenkins-backup.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nBACKUP_DIR=\u0026quot;/backup/jenkins\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}/{config,jobs,plugins,secrets}\n\necho \u0026quot;Starting Jenkins backup...\u0026quot;\n\n# Gracefully shutdown Jenkins\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 quiet-down\n\n# Wait for running builds to complete (max 10 minutes)\nfor i in {1..60}; do\n    RUNNING_BUILDS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 list-builds | grep -c \u0026quot;RUNNING\u0026quot; || echo \u0026quot;0\u0026quot;)\n    if [ \u0026quot;$RUNNING_BUILDS\u0026quot; -eq 0 ]; then\n        echo \u0026quot;All builds completed, proceeding with backup...\u0026quot;\n        break\n    fi\n    echo \u0026quot;Waiting for $RUNNING_BUILDS running builds to complete...\u0026quot;\n    sleep 10\ndone\n\n# Stop Jenkins service\nsystemctl stop jenkins\n\n# Backup Jenkins home directory\ntar --exclude=\u0026#039;/var/lib/jenkins/workspace/*\u0026#039; \\\n    --exclude=\u0026#039;/var/lib/jenkins/builds/*/archive\u0026#039; \\\n    --exclude=\u0026#039;/var/lib/jenkins/.m2/repository\u0026#039; \\\n    --exclude=\u0026#039;/var/lib/jenkins/logs/*\u0026#039; \\\n    -czf ${BACKUP_DIR}/config/jenkins-home-${DATE}.tar.gz \\\n    -C /var/lib/jenkins .\n\n# Backup individual job configurations\nmkdir -p ${BACKUP_DIR}/jobs\nfor job in /var/lib/jenkins/jobs/*/config.xml; do\n    if [ -f \u0026quot;$job\u0026quot; ]; then\n        job_name=$(basename $(dirname \u0026quot;$job\u0026quot;))\n        cp \u0026quot;$job\u0026quot; ${BACKUP_DIR}/jobs/${job_name}-config-${DATE}.xml\n    fi\ndone\n\n# Backup plugin list\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    list-plugins \u0026gt; ${BACKUP_DIR}/plugins/plugin-list-${DATE}.txt\n\n# Backup secrets and credentials\nif [ -d \u0026quot;/var/lib/jenkins/secrets\u0026quot; ]; then\n    tar -czf ${BACKUP_DIR}/secrets/jenkins-secrets-${DATE}.tar.gz \\\n        -C /var/lib/jenkins secrets/\nfi\n\n# Start Jenkins\nsystemctl start jenkins\n\n# Wait for Jenkins to be ready\necho \u0026quot;Waiting for Jenkins to start...\u0026quot;\nfor i in {1..30}; do\n    if curl -f http://localhost:8080/login \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n        echo \u0026quot;Jenkins is ready\u0026quot;\n        break\n    fi\n    sleep 10\ndone\n\n# Cancel quiet mode\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 cancel-quiet-down\n\n# Upload to cloud storage\naws s3 cp ${BACKUP_DIR}/ s3://jenkins-backups/ --recursive --sse AES256\naz storage blob upload-batch --source ${BACKUP_DIR} --destination jenkins-backups\ngsutil cp -r ${BACKUP_DIR}/* gs://jenkins-backups/\n\n# Test backup integrity\nLATEST_BACKUP=$(ls -t ${BACKUP_DIR}/config/jenkins-home-*.tar.gz | head -1)\nif tar -tzf \u0026quot;$LATEST_BACKUP\u0026quot; \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    echo \u0026quot;‚úì Backup integrity verified\u0026quot;\nelse\n    echo \u0026quot;‚úó Backup integrity check failed\u0026quot;\nfi\n\n# Keep only last 14 days of backups\nfind ${BACKUP_DIR} -name \u0026quot;jenkins-*\u0026quot; -type f -mtime +14 -delete\n\necho \u0026quot;Jenkins backup completed: ${DATE}\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-backup.sh\n\n# Schedule daily backups\necho \u0026quot;0 1 * * * root /usr/local/bin/jenkins-backup.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"jenkins-disaster-recovery\" class=\"mobile-header\"\u003eJenkins Disaster Recovery\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/jenkins-restore.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nBACKUP_FILE=\u0026quot;${1}\u0026quot;\n\nif [ -z \u0026quot;$BACKUP_FILE\u0026quot; ]; then\n    echo \u0026quot;Usage: $0 \u0026lt;backup_file\u0026gt;\u0026quot;\n    echo \u0026quot;Available backups:\u0026quot;\n    ls -la /backup/jenkins/config/jenkins-home-*.tar.gz\n    exit 1\nfi\n\necho \u0026quot;Restoring Jenkins from backup: $BACKUP_FILE\u0026quot;\n\n# Stop Jenkins\nsystemctl stop jenkins\n\n# Backup current installation\nmv /var/lib/jenkins /var/lib/jenkins.backup.$(date +%s)\n\n# Create new Jenkins directory\nmkdir -p /var/lib/jenkins\nchown jenkins:jenkins /var/lib/jenkins\n\n# Restore from backup\ntar -xzf \u0026quot;$BACKUP_FILE\u0026quot; -C /var/lib/jenkins\n\n# Set proper ownership\nchown -R jenkins:jenkins /var/lib/jenkins\n\n# Start Jenkins\nsystemctl start jenkins\n\n# Wait for Jenkins to start\necho \u0026quot;Waiting for Jenkins to start...\u0026quot;\nfor i in {1..60}; do\n    if curl -f http://localhost:8080/login \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n        echo \u0026quot;Jenkins restored successfully\u0026quot;\n        break\n    fi\n    sleep 10\ndone\n\necho \u0026quot;Jenkins restore completed\u0026quot;\necho \u0026quot;Please verify configuration and rebuild any workspace dependencies\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-restore.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"monitoring-and-health-checks\" class=\"mobile-header\"\u003eMonitoring and Health Checks\u003c/h2\u003e\n\u003ch3 id=\"comprehensive-monitoring\" class=\"mobile-header\"\u003eComprehensive Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/jenkins-health-check.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nHEALTH_LOG=\u0026quot;/var/log/jenkins-health.log\u0026quot;\n\nlog_message() {\n    echo \u0026quot;$(date \u0026#039;+%Y-%m-%d %H:%M:%S\u0026#039;) - $1\u0026quot; | tee -a ${HEALTH_LOG}\n}\n\n# Check service status\nif systemctl is-active jenkins \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;‚úì Jenkins service is running\u0026quot;\nelse\n    log_message \u0026quot;‚úó Jenkins service is not running\u0026quot;\n    exit 1\nfi\n\n# Check web interface\nHTTP_STATUS=$(curl -s -o /dev/null -w \u0026quot;%{http_code}\u0026quot; http://localhost:8080/login)\nif [ \u0026quot;${HTTP_STATUS}\u0026quot; = \u0026quot;200\u0026quot; ]; then\n    log_message \u0026quot;‚úì Jenkins web interface is responding\u0026quot;\nelse\n    log_message \u0026quot;‚úó Jenkins web interface issues (HTTP ${HTTP_STATUS})\u0026quot;\nfi\n\n# Check agent connectivity\nAGENT_COUNT=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    list-computers | grep -c \u0026quot;^agent\u0026quot; || echo \u0026quot;0\u0026quot;)\nONLINE_AGENTS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    list-computers | grep -c \u0026quot;online\u0026quot; || echo \u0026quot;0\u0026quot;)\n\nlog_message \u0026quot;‚Ñπ Jenkins agents: ${ONLINE_AGENTS}/${AGENT_COUNT} online\u0026quot;\n\n# Check disk space\nDISK_USAGE=$(df /var/lib/jenkins | awk \u0026#039;NR==2 {print $5}\u0026#039; | sed \u0026#039;s/%//\u0026#039;)\nif [ ${DISK_USAGE} -gt 85 ]; then\n    log_message \u0026quot;‚ö† High disk usage: ${DISK_USAGE}%\u0026quot;\nelse\n    log_message \u0026quot;‚úì Disk usage: ${DISK_USAGE}%\u0026quot;\nfi\n\n# Check for failed builds\nFAILED_JOBS=$(java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    list-jobs | xargs -I {} java -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:secure_admin_password_2024 \\\n    get-job {} | grep -c \u0026quot;FAILURE\u0026quot; || echo \u0026quot;0\u0026quot;)\n\nif [ ${FAILED_JOBS} -gt 0 ]; then\n    log_message \u0026quot;‚ö† ${FAILED_JOBS} jobs with recent failures\u0026quot;\nfi\n\n# Check Java memory usage\nJAVA_MEMORY=$(ps -o pid,vsz,rss,comm -C java | grep jenkins | awk \u0026#039;{print $3/1024}\u0026#039; | head -1)\nlog_message \u0026quot;‚Ñπ Jenkins memory usage: ${JAVA_MEMORY}MB\u0026quot;\n\nlog_message \u0026quot;Jenkins health check completed\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/jenkins-health-check.sh\n\n# Schedule health checks every 15 minutes\necho \u0026quot;*/15 * * * * root /usr/local/bin/jenkins-health-check.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting\" class=\"mobile-header\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues-and-solutions\" class=\"mobile-header\"\u003eCommon Issues and Solutions\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check Jenkins service status\nsudo systemctl status jenkins\nsudo journalctl -u jenkins -f\n\n# Check Jenkins logs\nsudo tail -f /var/log/jenkins/jenkins.log\n\n# Check Java process\nps aux | grep jenkins\njps -v  # Show Java processes\n\n# Memory issues\nsudo systemctl edit jenkins\n# Add:\n[Service]\nEnvironment=\u0026quot;JAVA_OPTS=-Djava.awt.headless=true -Xmx4g -Xms2g\u0026quot;\n\nsudo systemctl daemon-reload\nsudo systemctl restart jenkins\n\n# Plugin issues\n# Access Jenkins web interface\n# Go to Manage Jenkins \u0026gt; Manage Plugins \u0026gt; Advanced\n# Check for plugin conflicts or updates\n\n# Agent connectivity issues\n# Check SSH connectivity\nssh jenkins@agent-host\n\n# Check agent logs\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \\\n    connect-node agent-name\n\n# Build failures\n# Check workspace permissions\nsudo chown -R jenkins:jenkins /var/lib/jenkins/workspace\n\n# Clear old builds\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \\\n    delete-builds job-name 1-10\n\n# Performance issues\n# Check system resources\ntop -p $(pgrep java)\nhtop -p $(pgrep java)\n\n# Database cleanup (if using H2)\njava -jar jenkins-cli.jar -s http://localhost:8080 -auth admin:password \\\n    groovy = \u0026lt;\u0026lt;GROOVY\nimport jenkins.model.Jenkins\nJenkins.instance.cleanUp()\nGROOVY\n\n# Reset Jenkins configuration (emergency)\nsudo systemctl stop jenkins\nsudo rm /var/lib/jenkins/config.xml\nsudo systemctl start jenkins\n# Reconfigure via setup wizard\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.jenkins.io/doc/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eJenkins Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.jenkins.io/doc/book/security/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eJenkins Security Guide\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.jenkins.io/doc/book/pipeline/pipeline-best-practices/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ePipeline Best Practices\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://jenkins.io/projects/jcasc/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eJenkins Configuration as Code\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.jenkins.io/community/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eJenkins Community\u003c/a\u003e\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection.\u003c/p\u003e","readTime":"16 min","wordCount":3118,"lastBuilt":"2025-09-14T01:30:35.048Z"},"category":{"key":"infrastructure","name":"Infrastructure","description":"DevOps and infrastructure automation tools","icon":"üèóÔ∏è","color":"#44475a","keywords":["ansible","terraform","gitlab","jenkins","consul","etcd"]},"relatedGuides":[{"name":"adguard-home","displayName":"Adguard Home","slug":"adguard-home","description":"Repo for adguard-home","category":"infrastructure","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/adguard-home","updatedAt":"2025-09-08T03:04:18Z","createdAt":"2025-09-08T03:04:08Z","readmeRaw":"## üëã Welcome to adguard-home üöÄ  \n\nadguard-home README  \n  \n  \n## Author  \n\nü§ñ casjay: [Github](https://github.com/casjay) ü§ñ  \n","readmeHtml":"\u003ch2 id=\"welcome-to-adguard-home\" class=\"mobile-header\"\u003eüëã Welcome to adguard-home üöÄ  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eadguard-home README  \u003c/p\u003e\n\u003ch2 id=\"author\" class=\"mobile-header\"\u003eAuthor  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eü§ñ casjay: \u003ca href=\"https://github.com/casjay\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGithub\u003c/a\u003e ü§ñ  \u003c/p\u003e","readTime":"1 min","wordCount":15,"lastBuilt":"2025-09-14T01:30:47.224Z"},{"name":"adminer","displayName":"Adminer","slug":"adminer","description":"Repo for adminer","category":"infrastructure","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/adminer","updatedAt":"2025-09-08T03:04:32Z","createdAt":"2025-09-08T03:04:22Z","readmeRaw":"## üëã Welcome to adminer üöÄ  \n\nadminer README  \n  \n  \n## Author  \n\nü§ñ casjay: [Github](https://github.com/casjay) ü§ñ  \n","readmeHtml":"\u003ch2 id=\"welcome-to-adminer\" class=\"mobile-header\"\u003eüëã Welcome to adminer üöÄ  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eadminer README  \u003c/p\u003e\n\u003ch2 id=\"author\" class=\"mobile-header\"\u003eAuthor  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eü§ñ casjay: \u003ca href=\"https://github.com/casjay\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGithub\u003c/a\u003e ü§ñ  \u003c/p\u003e","readTime":"1 min","wordCount":15,"lastBuilt":"2025-09-14T01:30:47.075Z"},{"name":"ansible","displayName":"Ansible","slug":"ansible","description":"Repo for ansible","category":"infrastructure","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/ansible","updatedAt":"2025-09-14T01:29:39Z","createdAt":"2025-09-08T03:04:35Z","readmeRaw":"# Ansible Installation Guide\n\nAgentless automation platform for configuration management, application deployment, and task automation across multiple systems. Industry standard for infrastructure automation with enterprise-grade security.\n\n## Prerequisites\n\n- Linux control machine (any modern distribution)\n- Python 3.8+ on control machine\n- SSH access to target hosts\n- Python 2.7+ or 3.5+ on target hosts\n- 2GB RAM minimum, 4GB+ recommended for large infrastructures\n\n## Installation\n\n### Using Package Manager (Recommended)\n\n#### Ubuntu/Debian\n```bash\n# Update package list\nsudo apt update\n\n# Install Ansible and dependencies\nsudo apt install -y ansible python3-pip python3-venv sshpass\n\n# Install additional collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\nansible-galaxy collection install kubernetes.core\nansible-galaxy collection install amazon.aws\nansible-galaxy collection install azure.azcollection\nansible-galaxy collection install google.cloud\n\n# Verify installation\nansible --version\nansible-galaxy collection list\n```\n\n#### RHEL/CentOS/Rocky Linux/AlmaLinux\n```bash\n# Install EPEL repository\nsudo yum install -y epel-release\n\n# Install Ansible\nsudo yum install -y ansible python3-pip\n\n# For newer distributions\nsudo dnf install -y ansible python3-pip\n\n# Install collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\nansible-galaxy collection install kubernetes.core\n\n# Verify installation\nansible --version\n```\n\n#### Fedora\n```bash\n# Install Ansible\nsudo dnf install -y ansible python3-pip python3-virtualenv\n\n# Install additional collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\nansible-galaxy collection install kubernetes.core\n\n# Verify installation\nansible --version\n```\n\n#### Arch Linux\n```bash\n# Install Ansible\nsudo pacman -Syu ansible python-pip\n\n# Install collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\n\n# Verify installation\nansible --version\n```\n\n#### Alpine Linux\n```bash\n# Install Ansible\nsudo apk update\nsudo apk add ansible python3 py3-pip openssh\n\n# Install collections\nansible-galaxy collection install community.general\n\n# Verify installation\nansible --version\n```\n\n### Using pip (Latest Version)\n```bash\n# Create virtual environment (recommended)\npython3 -m venv ~/ansible-venv\nsource ~/ansible-venv/bin/activate\n\n# Install Ansible via pip\npip install --upgrade pip\npip install ansible ansible-core\n\n# Install additional packages\npip install paramiko jinja2 PyYAML cryptography\n\n# Install cloud provider SDKs\npip install boto3 botocore azure-cli google-cloud-storage\n\n# Install collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\nansible-galaxy collection install kubernetes.core\nansible-galaxy collection install amazon.aws\nansible-galaxy collection install azure.azcollection\nansible-galaxy collection install google.cloud\n\n# Add to PATH permanently\necho 'source ~/ansible-venv/bin/activate' \u003e\u003e ~/.bashrc\n\n# Verify installation\nansible --version\n```\n\n### Using Docker\n```bash\n# Create Ansible Docker container with mounted volumes\ndocker run --rm -it \\\n  -v $(pwd):/ansible \\\n  -v ~/.ssh:/root/.ssh:ro \\\n  -v ~/.aws:/root/.aws:ro \\\n  -v ~/.azure:/root/.azure:ro \\\n  --workdir /ansible \\\n  ansible/ansible:latest\n\n# Create wrapper script for ease of use\nsudo tee /usr/local/bin/ansible-docker \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\ndocker run --rm -it \\\n  -v $(pwd):/ansible \\\n  -v ~/.ssh:/root/.ssh:ro \\\n  -v ~/.aws:/root/.aws:ro \\\n  -v ~/.azure:/root/.azure:ro \\\n  -v ~/.kube:/root/.kube:ro \\\n  --workdir /ansible \\\n  --network host \\\n  ansible/ansible:latest \"$@\"\nEOF\nsudo chmod +x /usr/local/bin/ansible-docker\n\n# Create aliases\necho 'alias ansible=\"ansible-docker ansible\"' \u003e\u003e ~/.bashrc\necho 'alias ansible-playbook=\"ansible-docker ansible-playbook\"' \u003e\u003e ~/.bashrc\n```\n\n## Project Structure and Configuration\n\n### Professional Project Structure\n```bash\n# Create comprehensive Ansible project structure\nmkdir -p ~/ansible-infrastructure/{\n  inventories/{production,staging,development},\n  playbooks,\n  roles,\n  group_vars,\n  host_vars,\n  library,\n  filter_plugins,\n  callback_plugins,\n  vault,\n  collections,\n  logs\n}\n\ncd ~/ansible-infrastructure\n\n# Create ansible.cfg with security best practices\ncat \u003e ansible.cfg \u003c\u003cEOF\n[defaults]\ninventory = inventories/production/hosts.yml\nremote_user = ansible\nprivate_key_file = ~/.ssh/ansible_key\nhost_key_checking = True\ntimeout = 30\nretry_files_enabled = False\nstdout_callback = yaml\nbin_ansible_callbacks = True\ngathering = smart\nfact_caching = jsonfile\nfact_caching_connection = ~/.ansible/facts_cache\nfact_caching_timeout = 86400\ninterpreter_python = auto_silent\nvault_password_file = ~/.ansible_vault_pass\n\n# Logging\nlog_path = logs/ansible.log\ndisplay_skipped_hosts = False\ndisplay_ok_hosts = False\n\n# Performance\nforks = 20\npoll_interval = 15\ninternal_poll_interval = 0.001\n\n# Security\ncommand_warnings = True\ndeprecation_warnings = True\naction_warnings = True\nlocalhost_warning = True\n\n[ssh_connection]\nssh_args = -o ControlMaster=auto -o ControlPersist=3600s -o PreferredAuthentications=publickey\npipelining = True\ncontrol_path = ~/.ansible/cp/%%h-%%p-%%r\nretries = 3\n\n[privilege_escalation]\nbecome = False\nbecome_method = sudo\nbecome_user = root\nbecome_ask_pass = False\n\n[inventory]\nenable_plugins = host_list, script, auto, yaml, ini, toml\ncache = True\ncache_plugin = jsonfile\ncache_timeout = 3600\ncache_connection = ~/.ansible/inventory_cache\n\n[galaxy]\nserver_list = automation_hub, galaxy\nEOF\n```\n\n### Advanced Inventory Management\n```bash\n# Create production inventory with groups and variables\ncat \u003e inventories/production/hosts.yml \u003c\u003cEOF\nall:\n  children:\n    webservers:\n      hosts:\n        web-prod-01:\n          ansible_host: 10.0.1.10\n          ansible_user: ansible\n          server_role: frontend\n          backup_enabled: true\n        web-prod-02:\n          ansible_host: 10.0.1.11\n          ansible_user: ansible\n          server_role: frontend\n          backup_enabled: true\n        web-prod-03:\n          ansible_host: 10.0.1.12\n          ansible_user: ansible\n          server_role: frontend\n          backup_enabled: true\n      vars:\n        http_port: 80\n        https_port: 443\n        max_clients: 200\n        environment: production\n        monitoring_enabled: true\n\n    dbservers:\n      hosts:\n        db-prod-01:\n          ansible_host: 10.0.2.10\n          ansible_user: ansible\n          mysql_server_id: 1\n          mysql_role: master\n        db-prod-02:\n          ansible_host: 10.0.2.11\n          ansible_user: ansible\n          mysql_server_id: 2\n          mysql_role: slave\n      vars:\n        mysql_port: 3306\n        mysql_root_password: \"{{ vault_mysql_root_password }}\"\n        mysql_replication_user: \"{{ vault_mysql_replication_user }}\"\n        mysql_replication_password: \"{{ vault_mysql_replication_password }}\"\n\n    loadbalancers:\n      hosts:\n        lb-prod-01:\n          ansible_host: 10.0.3.10\n          ansible_user: ansible\n          lb_algorithm: roundrobin\n        lb-prod-02:\n          ansible_host: 10.0.3.11\n          ansible_user: ansible\n          lb_algorithm: roundrobin\n      vars:\n        haproxy_stats_enabled: true\n        haproxy_stats_user: admin\n        haproxy_stats_password: \"{{ vault_haproxy_stats_password }}\"\n\n    monitoring:\n      hosts:\n        monitor-prod-01:\n          ansible_host: 10.0.4.10\n          ansible_user: ansible\n          prometheus_retention: 30d\n          grafana_admin_password: \"{{ vault_grafana_admin_password }}\"\n\n    bastion:\n      hosts:\n        bastion-prod-01:\n          ansible_host: bastion.example.com\n          ansible_user: ansible\n          ansible_port: 22\n\n# Global variables for all hosts\nwebservers:\n  vars:\n    nginx_worker_processes: auto\n    nginx_worker_connections: 1024\n    ssl_certificate_path: /etc/ssl/certs\n    backup_schedule: \"0 2 * * *\"\n\ndbservers:\n  vars:\n    mysql_innodb_buffer_pool_size: 2G\n    mysql_max_connections: 200\n    backup_schedule: \"0 1 * * *\"\n    monitoring_enabled: true\nEOF\n\n# Create dynamic inventory script for cloud environments\ncat \u003e inventories/production/aws_ec2.yml \u003c\u003cEOF\nplugin: amazon.aws.aws_ec2\nregions:\n  - us-west-2\n  - us-east-1\nfilters:\n  tag:Environment: production\n  tag:Ansible: managed\n  instance-state-name: running\n\nhostnames:\n  - tag:Name\n  - dns-name\n  - private-ip-address\n\ncompose:\n  ansible_host: private_ip_address\n  ec2_state: ec2_state_name\n  ec2_arch: ec2_architecture\n\ngroups:\n  # Group by instance type\n  webservers: \"'web' in tags.Role\"\n  databases: \"'db' in tags.Role\"\n  loadbalancers: \"'lb' in tags.Role\"\n  \n  # Group by environment\n  production: \"tags.Environment == 'production'\"\n  staging: \"tags.Environment == 'staging'\"\n  \n  # Group by availability zone\n  us_west_2a: ec2_placement_availability_zone == \"us-west-2a\"\n  us_west_2b: ec2_placement_availability_zone == \"us-west-2b\"\n\nkeyed_groups:\n  # Create groups based on tags\n  - key: tags.Environment\n    prefix: env\n  - key: tags.Role  \n    prefix: role\n  - key: ec2_instance_type\n    prefix: type\nEOF\n```\n\n### Ansible Vault Security\n```bash\n# Create strong vault password\nopenssl rand -base64 32 \u003e ~/.ansible_vault_pass\nchmod 600 ~/.ansible_vault_pass\n\n# Create encrypted vault file for secrets\nansible-vault create group_vars/all/vault.yml\n# Enter secure passwords and API keys:\n# vault_mysql_root_password: your_secure_mysql_password\n# vault_grafana_admin_password: your_secure_grafana_password  \n# vault_ssl_private_key: |\n#   -----BEGIN PRIVATE KEY-----\n#   your_private_key_content\n#   -----END PRIVATE KEY-----\n\n# Create non-encrypted variables file\ncat \u003e group_vars/all/vars.yml \u003c\u003cEOF\n# Non-sensitive variables\nmysql_port: 3306\nnginx_port: 80\ngrafana_port: 3000\nprometheus_port: 9090\n\n# Reference vault variables\nmysql_root_password: \"{{ vault_mysql_root_password }}\"\ngrafana_admin_password: \"{{ vault_grafana_admin_password }}\"\n\n# SSL configuration\nssl_certificate_path: /etc/ssl/certs/server.crt\nssl_private_key_path: /etc/ssl/private/server.key\nssl_private_key_content: \"{{ vault_ssl_private_key }}\"\n\n# Security settings\nansible_ssh_common_args: '-o StrictHostKeyChecking=yes -o UserKnownHostsFile=~/.ssh/known_hosts'\nansible_become_method: sudo\nansible_become_user: root\nEOF\n\n# Edit vault file\nansible-vault edit group_vars/all/vault.yml\n\n# View vault file (read-only)\nansible-vault view group_vars/all/vault.yml\n\n# Change vault password\nansible-vault rekey group_vars/all/vault.yml\n```\n\n## Comprehensive Playbooks\n\n### System Hardening Playbook\n```bash\ncat \u003e playbooks/system-hardening.yml \u003c\u003cEOF\n---\n- name: System Security Hardening\n  hosts: all\n  become: yes\n  gather_facts: yes\n  vars:\n    security_packages:\n      - fail2ban\n      - ufw\n      - aide\n      - chkrootkit\n      - rkhunter\n      - clamav\n      - lynis\n    \n    disabled_services:\n      - telnet\n      - rsh\n      - rlogin\n      - tftp\n      - talk\n      - finger\n\n  pre_tasks:\n    - name: Update package cache\n      package:\n        update_cache: yes\n        cache_valid_time: 3600\n      when: ansible_os_family in [\"Debian\", \"RedHat\"]\n\n  tasks:\n    # System updates\n    - name: Upgrade all packages\n      package:\n        name: \"*\"\n        state: latest\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Upgrade all packages (Debian/Ubuntu)\n      apt:\n        upgrade: dist\n        autoremove: yes\n        autoclean: yes\n      when: ansible_os_family == \"Debian\"\n\n    # Install security packages\n    - name: Install security packages\n      package:\n        name: \"{{ security_packages }}\"\n        state: present\n\n    # User security\n    - name: Create ansible user with limited privileges\n      user:\n        name: ansible\n        groups: sudo\n        shell: /bin/bash\n        create_home: yes\n        generate_ssh_key: yes\n        ssh_key_bits: 4096\n        ssh_key_type: rsa\n\n    - name: Configure sudo for ansible user\n      lineinfile:\n        path: /etc/sudoers.d/ansible\n        line: 'ansible ALL=(ALL) NOPASSWD:ALL'\n        create: yes\n        mode: '0440'\n        validate: 'visudo -cf %s'\n\n    # SSH hardening\n    - name: Configure SSH security\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: \"{{ item.regexp }}\"\n        line: \"{{ item.line }}\"\n        backup: yes\n      loop:\n        - { regexp: '^#?PermitRootLogin', line: 'PermitRootLogin no' }\n        - { regexp: '^#?PasswordAuthentication', line: 'PasswordAuthentication no' }\n        - { regexp: '^#?X11Forwarding', line: 'X11Forwarding no' }\n        - { regexp: '^#?MaxAuthTries', line: 'MaxAuthTries 3' }\n        - { regexp: '^#?ClientAliveInterval', line: 'ClientAliveInterval 300' }\n        - { regexp: '^#?ClientAliveCountMax', line: 'ClientAliveCountMax 0' }\n        - { regexp: '^#?Protocol', line: 'Protocol 2' }\n        - { regexp: '^#?LogLevel', line: 'LogLevel VERBOSE' }\n      notify: restart ssh\n\n    # Firewall configuration\n    - name: Configure UFW firewall (Debian/Ubuntu)\n      ufw:\n        state: enabled\n        policy: deny\n        direction: incoming\n      when: ansible_os_family == \"Debian\"\n\n    - name: Allow SSH through UFW\n      ufw:\n        rule: allow\n        port: 22\n        proto: tcp\n        comment: 'SSH access'\n      when: ansible_os_family == \"Debian\"\n\n    - name: Configure firewalld (RHEL/CentOS/Fedora)\n      firewalld:\n        state: enabled\n        permanent: yes\n        immediate: yes\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Allow SSH through firewalld\n      firewalld:\n        service: ssh\n        permanent: yes\n        state: enabled\n        immediate: yes\n      when: ansible_os_family == \"RedHat\"\n\n    # Disable unnecessary services\n    - name: Disable unnecessary services\n      systemd:\n        name: \"{{ item }}\"\n        enabled: no\n        state: stopped\n      loop: \"{{ disabled_services }}\"\n      ignore_errors: yes\n\n    # File system security\n    - name: Set proper permissions on sensitive files\n      file:\n        path: \"{{ item.path }}\"\n        mode: \"{{ item.mode }}\"\n        owner: root\n        group: root\n      loop:\n        - { path: '/etc/passwd', mode: '0644' }\n        - { path: '/etc/shadow', mode: '0640' }\n        - { path: '/etc/group', mode: '0644' }\n        - { path: '/etc/gshadow', mode: '0640' }\n        - { path: '/etc/ssh/sshd_config', mode: '0600' }\n\n    # Kernel security parameters\n    - name: Configure kernel security parameters\n      sysctl:\n        name: \"{{ item.key }}\"\n        value: \"{{ item.value }}\"\n        sysctl_set: yes\n        state: present\n        reload: yes\n      loop:\n        - { key: 'net.ipv4.ip_forward', value: '0' }\n        - { key: 'net.ipv4.conf.all.send_redirects', value: '0' }\n        - { key: 'net.ipv4.conf.default.send_redirects', value: '0' }\n        - { key: 'net.ipv4.conf.all.accept_source_route', value: '0' }\n        - { key: 'net.ipv4.conf.default.accept_source_route', value: '0' }\n        - { key: 'net.ipv4.conf.all.accept_redirects', value: '0' }\n        - { key: 'net.ipv4.conf.default.accept_redirects', value: '0' }\n        - { key: 'net.ipv4.conf.all.secure_redirects', value: '0' }\n        - { key: 'net.ipv4.conf.default.secure_redirects', value: '0' }\n        - { key: 'net.ipv4.conf.all.log_martians', value: '1' }\n        - { key: 'net.ipv4.conf.default.log_martians', value: '1' }\n        - { key: 'kernel.randomize_va_space', value: '2' }\n\n    # Configure fail2ban\n    - name: Configure fail2ban for SSH protection\n      template:\n        src: templates/fail2ban-jail.local.j2\n        dest: /etc/fail2ban/jail.local\n        backup: yes\n      notify: restart fail2ban\n\n  handlers:\n    - name: restart ssh\n      service:\n        name: \"{{ 'ssh' if ansible_os_family == 'Debian' else 'sshd' }}\"\n        state: restarted\n\n    - name: restart fail2ban\n      service:\n        name: fail2ban\n        state: restarted\nEOF\n```\n\n### Application Deployment Playbook\n```bash\ncat \u003e playbooks/web-application-deployment.yml \u003c\u003cEOF\n---\n- name: Deploy Web Application Stack\n  hosts: webservers\n  become: yes\n  serial: \"25%\"  # Rolling deployment\n  max_fail_percentage: 10\n  vars:\n    app_name: mywebapp\n    app_version: \"{{ app_version | default('latest') }}\"\n    app_port: 3000\n    nginx_workers: \"{{ ansible_processor_cores }}\"\n    \n  pre_tasks:\n    - name: Check if maintenance mode file exists\n      stat:\n        path: /var/www/html/maintenance.html\n      register: maintenance_mode\n\n    - name: Fail if in maintenance mode\n      fail:\n        msg: \"Server is in maintenance mode\"\n      when: maintenance_mode.stat.exists and not force_deployment | default(false)\n\n  tasks:\n    # Application deployment\n    - name: Create application user\n      user:\n        name: \"{{ app_name }}\"\n        system: yes\n        shell: /bin/false\n        home: \"/opt/{{ app_name }}\"\n        create_home: yes\n\n    - name: Create application directories\n      file:\n        path: \"{{ item }}\"\n        state: directory\n        owner: \"{{ app_name }}\"\n        group: \"{{ app_name }}\"\n        mode: '0755'\n      loop:\n        - \"/opt/{{ app_name }}\"\n        - \"/opt/{{ app_name }}/releases\"\n        - \"/opt/{{ app_name }}/shared\"\n        - \"/var/log/{{ app_name }}\"\n\n    - name: Download application release\n      get_url:\n        url: \"https://releases.example.com/{{ app_name }}/{{ app_version }}/{{ app_name }}-{{ app_version }}.tar.gz\"\n        dest: \"/tmp/{{ app_name }}-{{ app_version }}.tar.gz\"\n        mode: '0644'\n        timeout: 300\n      register: download_result\n\n    - name: Extract application\n      unarchive:\n        src: \"/tmp/{{ app_name }}-{{ app_version }}.tar.gz\"\n        dest: \"/opt/{{ app_name }}/releases/\"\n        owner: \"{{ app_name }}\"\n        group: \"{{ app_name }}\"\n        remote_src: yes\n        creates: \"/opt/{{ app_name }}/releases/{{ app_version }}\"\n\n    - name: Create symlink to current release\n      file:\n        src: \"/opt/{{ app_name }}/releases/{{ app_version }}\"\n        dest: \"/opt/{{ app_name }}/current\"\n        state: link\n        owner: \"{{ app_name }}\"\n        group: \"{{ app_name }}\"\n      notify:\n        - reload application\n        - reload nginx\n\n    # Configuration management\n    - name: Deploy application configuration\n      template:\n        src: \"templates/{{ app_name }}.conf.j2\"\n        dest: \"/opt/{{ app_name }}/shared/{{ app_name }}.conf\"\n        owner: \"{{ app_name }}\"\n        group: \"{{ app_name }}\"\n        mode: '0640'\n        backup: yes\n      notify: reload application\n\n    # Service management\n    - name: Deploy systemd service file\n      template:\n        src: \"templates/{{ app_name }}.service.j2\"\n        dest: \"/etc/systemd/system/{{ app_name }}.service\"\n        mode: '0644'\n      notify:\n        - daemon reload\n        - restart application\n\n    - name: Enable and start application service\n      systemd:\n        name: \"{{ app_name }}\"\n        enabled: yes\n        state: started\n        daemon_reload: yes\n\n    # Health check\n    - name: Wait for application to be ready\n      uri:\n        url: \"http://localhost:{{ app_port }}/health\"\n        method: GET\n        status_code: 200\n      retries: 30\n      delay: 10\n\n    # Cleanup old releases\n    - name: Clean up old releases (keep last 3)\n      shell: |\n        cd /opt/{{ app_name }}/releases\n        ls -t | tail -n +4 | xargs rm -rf\n      args:\n        executable: /bin/bash\n\n  post_tasks:\n    - name: Verify application is running\n      uri:\n        url: \"http://{{ ansible_default_ipv4.address }}:{{ app_port }}/health\"\n        method: GET\n        status_code: 200\n      delegate_to: localhost\n\n    - name: Log deployment success\n      lineinfile:\n        path: \"/var/log/{{ app_name }}/deployments.log\"\n        line: \"{{ ansible_date_time.iso8601 }} - Successfully deployed {{ app_version }} to {{ inventory_hostname }}\"\n        create: yes\n\n  handlers:\n    - name: daemon reload\n      systemd:\n        daemon_reload: yes\n\n    - name: restart application\n      systemd:\n        name: \"{{ app_name }}\"\n        state: restarted\n\n    - name: reload application\n      systemd:\n        name: \"{{ app_name }}\"\n        state: reloaded\n\n    - name: reload nginx\n      service:\n        name: nginx\n        state: reloaded\nEOF\n```\n\n### Infrastructure as Code Playbook\n```bash\ncat \u003e playbooks/infrastructure-provisioning.yml \u003c\u003cEOF\n---\n- name: Infrastructure Provisioning and Configuration\n  hosts: all\n  become: yes\n  strategy: free  # Parallel execution\n  vars:\n    base_packages:\n      Debian:\n        - curl\n        - wget\n        - vim\n        - htop\n        - git\n        - python3\n        - python3-pip\n        - unzip\n        - tree\n      RedHat:\n        - curl\n        - wget\n        - vim\n        - htop\n        - git\n        - python3\n        - python3-pip\n        - unzip\n        - tree\n        - epel-release\n\n  tasks:\n    # System preparation\n    - name: Set hostname\n      hostname:\n        name: \"{{ inventory_hostname }}\"\n\n    - name: Update /etc/hosts\n      lineinfile:\n        path: /etc/hosts\n        line: \"{{ ansible_default_ipv4.address }} {{ inventory_hostname }}\"\n        backup: yes\n\n    # Package management\n    - name: Install base packages\n      package:\n        name: \"{{ base_packages[ansible_os_family] | default(base_packages['Debian']) }}\"\n        state: present\n\n    # Time synchronization\n    - name: Install and configure NTP\n      package:\n        name: \"{{ 'ntp' if ansible_os_family == 'Debian' else 'chrony' }}\"\n        state: present\n\n    - name: Start and enable time synchronization\n      service:\n        name: \"{{ 'ntp' if ansible_os_family == 'Debian' else 'chronyd' }}\"\n        state: started\n        enabled: yes\n\n    # Log management\n    - name: Configure logrotate for application logs\n      template:\n        src: templates/app-logrotate.j2\n        dest: /etc/logrotate.d/applications\n        mode: '0644'\n\n    # Monitoring agent installation\n    - name: Install Node Exporter for Prometheus monitoring\n      get_url:\n        url: \"https://github.com/prometheus/node_exporter/releases/download/v1.6.1/node_exporter-1.6.1.linux-amd64.tar.gz\"\n        dest: /tmp/node_exporter.tar.gz\n        mode: '0644'\n\n    - name: Extract Node Exporter\n      unarchive:\n        src: /tmp/node_exporter.tar.gz\n        dest: /tmp\n        remote_src: yes\n\n    - name: Copy Node Exporter binary\n      copy:\n        src: /tmp/node_exporter-1.6.1.linux-amd64/node_exporter\n        dest: /usr/local/bin/node_exporter\n        mode: '0755'\n        owner: root\n        group: root\n        remote_src: yes\n\n    - name: Create node_exporter systemd service\n      template:\n        src: templates/node_exporter.service.j2\n        dest: /etc/systemd/system/node_exporter.service\n        mode: '0644'\n      notify:\n        - daemon reload\n        - restart node_exporter\n\n    # Security configuration\n    - name: Configure kernel parameters for security\n      sysctl:\n        name: \"{{ item.key }}\"\n        value: \"{{ item.value }}\"\n        sysctl_set: yes\n        state: present\n        reload: yes\n      loop:\n        - { key: 'kernel.dmesg_restrict', value: '1' }\n        - { key: 'kernel.kptr_restrict', value: '2' }\n        - { key: 'kernel.yama.ptrace_scope', value: '1' }\n        - { key: 'net.ipv4.conf.all.log_martians', value: '1' }\n        - { key: 'net.ipv4.conf.default.log_martians', value: '1' }\n        - { key: 'net.ipv4.conf.all.send_redirects', value: '0' }\n        - { key: 'net.ipv4.conf.default.send_redirects', value: '0' }\n\n    # File integrity monitoring\n    - name: Initialize AIDE database\n      shell: |\n        aide --init\n        mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db\n      args:\n        creates: /var/lib/aide/aide.db\n\n    - name: Schedule AIDE integrity checks\n      cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"3\"\n        job: \"/usr/bin/aide --check\"\n        user: root\n\n  handlers:\n    - name: daemon reload\n      systemd:\n        daemon_reload: yes\n\n    - name: restart node_exporter\n      service:\n        name: node_exporter\n        state: restarted\n        enabled: yes\nEOF\n```\n\n## Advanced Role Development\n\n### Comprehensive NGINX Role\n```bash\n# Create NGINX role structure\nansible-galaxy init roles/nginx\n\n# Main tasks\ncat \u003e roles/nginx/tasks/main.yml \u003c\u003cEOF\n---\n# NGINX Installation and Configuration Role\n- name: Include OS-specific variables\n  include_vars: \"{{ ansible_os_family }}.yml\"\n\n- name: Install NGINX\n  include_tasks: \"install-{{ ansible_os_family }}.yml\"\n\n- name: Create NGINX directories\n  file:\n    path: \"{{ item }}\"\n    state: directory\n    owner: root\n    group: root\n    mode: '0755'\n  loop:\n    - /etc/nginx/sites-available\n    - /etc/nginx/sites-enabled\n    - /etc/nginx/conf.d\n    - /var/log/nginx\n    - /var/cache/nginx\n\n- name: Generate DH parameters\n  openssl_dhparam:\n    path: /etc/ssl/certs/dhparam.pem\n    size: 2048\n  when: nginx_ssl_enabled | default(false)\n\n- name: Deploy NGINX main configuration\n  template:\n    src: nginx.conf.j2\n    dest: /etc/nginx/nginx.conf\n    backup: yes\n    validate: 'nginx -t -c %s'\n  notify: reload nginx\n\n- name: Deploy virtual host configurations\n  template:\n    src: vhost.conf.j2\n    dest: \"/etc/nginx/sites-available/{{ item.name }}.conf\"\n    backup: yes\n  loop: \"{{ nginx_vhosts | default([]) }}\"\n  notify: reload nginx\n\n- name: Enable virtual hosts\n  file:\n    src: \"/etc/nginx/sites-available/{{ item.name }}.conf\"\n    dest: \"/etc/nginx/sites-enabled/{{ item.name }}.conf\"\n    state: link\n  loop: \"{{ nginx_vhosts | default([]) }}\"\n  when: item.enabled | default(true)\n  notify: reload nginx\n\n- name: Remove default site\n  file:\n    path: /etc/nginx/sites-enabled/default\n    state: absent\n  notify: reload nginx\n\n- name: Start and enable NGINX\n  service:\n    name: nginx\n    state: started\n    enabled: yes\n\n- name: Configure log rotation\n  template:\n    src: nginx-logrotate.j2\n    dest: /etc/logrotate.d/nginx\n    mode: '0644'\n\n- name: Setup NGINX monitoring\n  include_tasks: monitoring.yml\n  when: nginx_monitoring_enabled | default(false)\n\n- name: Configure SSL certificates\n  include_tasks: ssl.yml\n  when: nginx_ssl_enabled | default(false)\nEOF\n\n# OS-specific installation tasks\ncat \u003e roles/nginx/tasks/install-Debian.yml \u003c\u003cEOF\n---\n- name: Add NGINX signing key (Debian/Ubuntu)\n  apt_key:\n    url: https://nginx.org/keys/nginx_signing.key\n    state: present\n\n- name: Add NGINX repository (Debian/Ubuntu)\n  apt_repository:\n    repo: \"deb https://nginx.org/packages/{{ ansible_distribution | lower }}/ {{ ansible_distribution_release }} nginx\"\n    state: present\n\n- name: Install NGINX (Debian/Ubuntu)\n  apt:\n    name: nginx\n    state: present\n    update_cache: yes\nEOF\n\ncat \u003e roles/nginx/tasks/install-RedHat.yml \u003c\u003cEOF\n---\n- name: Add NGINX repository (RHEL/CentOS)\n  yum_repository:\n    name: nginx\n    description: NGINX Repository\n    baseurl: \"https://nginx.org/packages/centos/{{ ansible_distribution_major_version }}/$basearch/\"\n    gpgcheck: yes\n    gpgkey: https://nginx.org/keys/nginx_signing.key\n    enabled: yes\n\n- name: Install NGINX (RHEL/CentOS)\n  yum:\n    name: nginx\n    state: present\nEOF\n\n# Variables\ncat \u003e roles/nginx/vars/main.yml \u003c\u003cEOF\n---\nnginx_user: nginx\nnginx_worker_processes: auto\nnginx_worker_connections: 1024\nnginx_keepalive_timeout: 65\nnginx_ssl_enabled: false\nnginx_monitoring_enabled: true\n\nnginx_security_headers:\n  - \"add_header X-Frame-Options SAMEORIGIN always;\"\n  - \"add_header X-Content-Type-Options nosniff always;\"\n  - \"add_header X-XSS-Protection '1; mode=block' always;\"\n  - \"add_header Strict-Transport-Security 'max-age=31536000; includeSubDomains' always;\"\n\nnginx_default_vhost:\n  name: default\n  listen: 80\n  server_name: \"_\"\n  root: /var/www/html\n  index: index.html\n  enabled: false\nEOF\n\n# Templates\ncat \u003e roles/nginx/templates/nginx.conf.j2 \u003c\u003cEOF\nuser {{ nginx_user }};\nworker_processes {{ nginx_worker_processes }};\npid /var/run/nginx.pid;\n\nevents {\n    worker_connections {{ nginx_worker_connections }};\n    use epoll;\n    multi_accept on;\n}\n\nhttp {\n    # Basic settings\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n    keepalive_timeout {{ nginx_keepalive_timeout }};\n    types_hash_max_size 2048;\n    server_tokens off;\n\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n\n    # SSL configuration\n{% if nginx_ssl_enabled %}\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_prefer_server_ciphers off;\n    ssl_dhparam /etc/ssl/certs/dhparam.pem;\n{% endif %}\n\n    # Gzip compression\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types\n        application/javascript\n        application/json\n        application/xml\n        text/css\n        text/javascript\n        text/xml\n        text/plain;\n\n    # Security headers\n{% for header in nginx_security_headers %}\n    {{ header }}\n{% endfor %}\n\n    # Logging\n    log_format main '\\$remote_addr - \\$remote_user [\\$time_local] \"\\$request\" '\n                    '\\$status \\$body_bytes_sent \"\\$http_referer\" '\n                    '\"\\$http_user_agent\" \"\\$http_x_forwarded_for\"';\n\n    access_log /var/log/nginx/access.log main;\n    error_log /var/log/nginx/error.log;\n\n    # Rate limiting\n    limit_req_zone \\$binary_remote_addr zone=login:10m rate=10r/m;\n    limit_conn_zone \\$binary_remote_addr zone=addr:10m;\n\n    # Include configurations\n    include /etc/nginx/conf.d/*.conf;\n    include /etc/nginx/sites-enabled/*;\n}\nEOF\n\n# Handlers\ncat \u003e roles/nginx/handlers/main.yml \u003c\u003cEOF\n---\n- name: restart nginx\n  service:\n    name: nginx\n    state: restarted\n\n- name: reload nginx\n  service:\n    name: nginx\n    state: reloaded\n\n- name: validate nginx config\n  command: nginx -t\n  changed_when: false\nEOF\n```\n\n## Security and Compliance\n\n### Ansible Security Scanner Integration\n```bash\n# Create security scanning playbook\ncat \u003e playbooks/security-scan.yml \u003c\u003cEOF\n---\n- name: Security Compliance Scanning\n  hosts: all\n  become: yes\n  gather_facts: yes\n  vars:\n    scan_results_dir: \"/tmp/security-scans\"\n    \n  tasks:\n    - name: Create scan results directory\n      file:\n        path: \"{{ scan_results_dir }}\"\n        state: directory\n        mode: '0755'\n\n    # CIS benchmark scanning\n    - name: Download CIS benchmark script\n      get_url:\n        url: \"https://github.com/dev-sec/cis-dil-benchmark/archive/master.zip\"\n        dest: \"/tmp/cis-benchmark.zip\"\n        mode: '0644'\n\n    - name: Run CIS benchmark scan\n      shell: |\n        cd /tmp\n        unzip -o cis-benchmark.zip\n        cd cis-dil-benchmark-master\n        bash cis_ubuntu2204.sh \u003e {{ scan_results_dir }}/cis-scan-{{ inventory_hostname }}.txt\n      args:\n        creates: \"{{ scan_results_dir }}/cis-scan-{{ inventory_hostname }}.txt\"\n\n    # Lynis security audit\n    - name: Install Lynis\n      package:\n        name: lynis\n        state: present\n\n    - name: Run Lynis security audit\n      command: lynis audit system --quiet --cronjob\n      register: lynis_result\n      changed_when: false\n\n    - name: Save Lynis results\n      copy:\n        content: \"{{ lynis_result.stdout }}\"\n        dest: \"{{ scan_results_dir }}/lynis-scan-{{ inventory_hostname }}.txt\"\n        mode: '0644'\n\n    # OpenSCAP compliance scanning\n    - name: Install OpenSCAP (RHEL/CentOS)\n      package:\n        name:\n          - openscap-scanner\n          - scap-security-guide\n        state: present\n      when: ansible_os_family == \"RedHat\"\n\n    - name: Install OpenSCAP (Debian/Ubuntu)\n      package:\n        name:\n          - libopenscap8\n          - ssg-debian\n        state: present\n      when: ansible_os_family == \"Debian\"\n\n    - name: Run OpenSCAP scan\n      shell: |\n        oscap xccdf eval --profile xccdf_org.ssgproject.content_profile_standard \\\n          --results {{ scan_results_dir }}/oscap-results-{{ inventory_hostname }}.xml \\\n          --report {{ scan_results_dir }}/oscap-report-{{ inventory_hostname }}.html \\\n          /usr/share/xml/scap/ssg/content/ssg-{{ ansible_distribution | lower }}{{ ansible_distribution_major_version }}-xccdf.xml\n      ignore_errors: yes\n      when: ansible_os_family in [\"RedHat\", \"Debian\"]\n\n    # Vulnerability scanning with Trivy\n    - name: Install Trivy vulnerability scanner\n      shell: |\n        curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b /usr/local/bin\n      args:\n        creates: /usr/local/bin/trivy\n\n    - name: Run Trivy filesystem scan\n      shell: |\n        trivy fs --format json --output {{ scan_results_dir }}/trivy-scan-{{ inventory_hostname }}.json /\n      ignore_errors: yes\n\n    # Collect scan results\n    - name: Fetch scan results to control machine\n      fetch:\n        src: \"{{ item }}\"\n        dest: \"./security-reports/{{ inventory_hostname }}/\"\n        flat: yes\n      loop:\n        - \"{{ scan_results_dir }}/cis-scan-{{ inventory_hostname }}.txt\"\n        - \"{{ scan_results_dir }}/lynis-scan-{{ inventory_hostname }}.txt\"\n        - \"{{ scan_results_dir }}/oscap-report-{{ inventory_hostname }}.html\"\n        - \"{{ scan_results_dir }}/trivy-scan-{{ inventory_hostname }}.json\"\n      ignore_errors: yes\n      delegate_to: localhost\n\n  post_tasks:\n    - name: Generate compliance summary\n      template:\n        src: templates/compliance-summary.j2\n        dest: \"{{ scan_results_dir }}/compliance-summary-{{ inventory_hostname }}.txt\"\n        mode: '0644'\nEOF\n```\n\n### Ansible AWX/Tower Integration\n```bash\n# Install Ansible AWX (open source)\ncat \u003e playbooks/install-awx.yml \u003c\u003cEOF\n---\n- name: Install Ansible AWX\n  hosts: localhost\n  connection: local\n  become: yes\n  vars:\n    awx_namespace: awx\n    awx_admin_user: admin\n    awx_admin_password: \"{{ vault_awx_admin_password }}\"\n\n  tasks:\n    - name: Install prerequisite packages\n      package:\n        name:\n          - git\n          - curl\n          - docker.io\n          - docker-compose\n        state: present\n\n    - name: Clone AWX repository\n      git:\n        repo: https://github.com/ansible/awx.git\n        dest: /opt/awx\n        version: devel\n\n    - name: Create AWX Docker inventory\n      template:\n        src: templates/awx-docker-inventory.j2\n        dest: /opt/awx/installer/inventory\n        mode: '0644'\n\n    - name: Install AWX using Ansible\n      shell: ansible-playbook -i inventory install.yml\n      args:\n        chdir: /opt/awx/installer\n      environment:\n        ANSIBLE_HOST_KEY_CHECKING: False\n\n    - name: Wait for AWX to be ready\n      uri:\n        url: \"http://localhost:80/api/v2/ping/\"\n        method: GET\n      retries: 30\n      delay: 10\n\n    - name: Configure AWX organizations and projects\n      uri:\n        url: \"http://localhost:80/api/v2/organizations/\"\n        method: POST\n        user: \"{{ awx_admin_user }}\"\n        password: \"{{ awx_admin_password }}\"\n        force_basic_auth: yes\n        body_format: json\n        body:\n          name: \"Production\"\n          description: \"Production environment organization\"\n        status_code: [200, 201, 409]\nEOF\n```\n\n## Multi-Cloud Automation\n\n### AWS Infrastructure Automation\n```bash\ncat \u003e playbooks/aws-infrastructure.yml \u003c\u003cEOF\n---\n- name: AWS Infrastructure Automation\n  hosts: localhost\n  connection: local\n  gather_facts: no\n  vars:\n    aws_region: \"{{ aws_region | default('us-west-2') }}\"\n    vpc_cidr: \"{{ vpc_cidr | default('10.0.0.0/16') }}\"\n    environment: \"{{ environment | default('production') }}\"\n\n  tasks:\n    # VPC Creation\n    - name: Create VPC\n      amazon.aws.ec2_vpc_info:\n        filters:\n          \"tag:Name\": \"{{ environment }}-vpc\"\n        region: \"{{ aws_region }}\"\n      register: existing_vpc\n\n    - name: Create new VPC if not exists\n      amazon.aws.ec2_vpc_net:\n        name: \"{{ environment }}-vpc\"\n        cidr_block: \"{{ vpc_cidr }}\"\n        region: \"{{ aws_region }}\"\n        state: present\n        dns_hostnames: yes\n        dns_support: yes\n        tags:\n          Environment: \"{{ environment }}\"\n          ManagedBy: ansible\n      register: vpc\n      when: existing_vpc.vpcs | length == 0\n\n    # Security Groups\n    - name: Create web security group\n      amazon.aws.ec2_group:\n        name: \"{{ environment }}-web-sg\"\n        description: \"Security group for web servers\"\n        vpc_id: \"{{ vpc.vpc.id if vpc.vpc is defined else existing_vpc.vpcs[0].vpc_id }}\"\n        region: \"{{ aws_region }}\"\n        rules:\n          - proto: tcp\n            ports:\n              - 80\n              - 443\n            cidr_ip: 0.0.0.0/0\n            rule_desc: \"HTTP and HTTPS access\"\n          - proto: tcp\n            ports:\n              - 22\n            group_id: \"{{ environment }}-bastion-sg\"\n            rule_desc: \"SSH from bastion\"\n        tags:\n          Environment: \"{{ environment }}\"\n\n    # Launch EC2 instances\n    - name: Launch web servers\n      amazon.aws.ec2_instance:\n        name: \"{{ environment }}-web-{{ item }}\"\n        instance_type: t3.medium\n        image_id: ami-0c02fb55956c7d316  # Amazon Linux 2\n        key_name: \"{{ ec2_key_name }}\"\n        vpc_subnet_id: \"{{ web_subnet_id }}\"\n        security_groups:\n          - \"{{ environment }}-web-sg\"\n        region: \"{{ aws_region }}\"\n        state: running\n        wait: yes\n        wait_timeout: 300\n        user_data: |\n          #!/bin/bash\n          yum update -y\n          yum install -y python3\n        tags:\n          Environment: \"{{ environment }}\"\n          Role: webserver\n          Ansible: managed\n      loop: \"{{ range(1, web_server_count + 1) | list }}\"\n      register: web_instances\n\n    # Add instances to inventory\n    - name: Add web servers to inventory\n      add_host:\n        name: \"{{ item.instances[0].tags.Name }}\"\n        hostname: \"{{ item.instances[0].public_ip_address }}\"\n        groups: webservers\n        ansible_ssh_private_key_file: \"~/.ssh/{{ ec2_key_name }}.pem\"\n        ansible_user: ec2-user\n      loop: \"{{ web_instances.results }}\"\n      changed_when: false\nEOF\n```\n\n### Kubernetes Cluster Management\n```bash\ncat \u003e playbooks/k8s-cluster-management.yml \u003c\u003cEOF\n---\n- name: Kubernetes Cluster Management with Ansible\n  hosts: k8s_masters\n  become: yes\n  serial: 1\n  vars:\n    k8s_version: \"1.28.2\"\n    containerd_version: \"1.6.24\"\n    cni_version: \"1.3.0\"\n\n  tasks:\n    # Pre-flight checks\n    - name: Check system requirements\n      assert:\n        that:\n          - ansible_memtotal_mb \u003e= 1700\n          - ansible_processor_cores \u003e= 2\n        fail_msg: \"System doesn't meet minimum requirements\"\n\n    - name: Verify connectivity to all nodes\n      ping:\n      delegate_to: \"{{ item }}\"\n      loop: \"{{ groups['k8s_all'] }}\"\n\n    # Container runtime setup\n    - name: Install containerd\n      include_role:\n        name: containerd\n      vars:\n        containerd_version: \"{{ containerd_version }}\"\n\n    # Kubernetes installation\n    - name: Install Kubernetes components\n      include_role:\n        name: kubernetes\n      vars:\n        kubernetes_version: \"{{ k8s_version }}\"\n\n    # Cluster initialization\n    - name: Initialize Kubernetes cluster\n      shell: |\n        kubeadm init \\\n          --pod-network-cidr=10.244.0.0/16 \\\n          --service-cidr=10.96.0.0/12 \\\n          --apiserver-advertise-address={{ ansible_default_ipv4.address }} \\\n          --node-name={{ inventory_hostname }}\n      args:\n        creates: /etc/kubernetes/admin.conf\n      register: kubeadm_init\n\n    - name: Create .kube directory\n      file:\n        path: \"{{ ansible_env.HOME }}/.kube\"\n        state: directory\n        mode: '0755'\n\n    - name: Copy admin.conf to user's kube config\n      copy:\n        src: /etc/kubernetes/admin.conf\n        dest: \"{{ ansible_env.HOME }}/.kube/config\"\n        owner: \"{{ ansible_user }}\"\n        group: \"{{ ansible_user }}\"\n        mode: '0644'\n        remote_src: yes\n\n    # Network plugin installation\n    - name: Install Flannel CNI\n      shell: kubectl apply -f https://github.com/flannel-io/flannel/releases/latest/download/kube-flannel.yml\n      environment:\n        KUBECONFIG: \"{{ ansible_env.HOME }}/.kube/config\"\n\n    # Join worker nodes\n    - name: Get join command\n      shell: kubeadm token create --print-join-command\n      register: join_command\n      when: inventory_hostname in groups['k8s_masters'][0]\n\n    - name: Join worker nodes to cluster\n      shell: \"{{ hostvars[groups['k8s_masters'][0]]['join_command'].stdout }}\"\n      when: inventory_hostname in groups['k8s_workers']\n\n  post_tasks:\n    - name: Verify cluster status\n      shell: kubectl get nodes\n      environment:\n        KUBECONFIG: \"{{ ansible_env.HOME }}/.kube/config\"\n      register: cluster_status\n      when: inventory_hostname in groups['k8s_masters'][0]\n\n    - name: Display cluster status\n      debug:\n        var: cluster_status.stdout_lines\n      when: inventory_hostname in groups['k8s_masters'][0]\nEOF\n```\n\n## Performance Optimization and Scaling\n\n### Parallel Execution Strategies\n```bash\n# Create high-performance playbook configuration\ncat \u003e playbooks/high-performance-deployment.yml \u003c\u003cEOF\n---\n- name: High-Performance Deployment\n  hosts: all\n  become: yes\n  strategy: free  # Parallel execution\n  serial: \"30%\"   # Process 30% of hosts at a time\n  max_fail_percentage: 10\n  gather_facts: yes\n  fact_caching: smart\n  vars:\n    deployment_batch_size: 10\n    max_concurrent_tasks: 50\n\n  pre_tasks:\n    - name: Check system load\n      shell: uptime | awk '{print $(NF-2)}' | sed 's/,//'\n      register: system_load\n      changed_when: false\n\n    - name: Skip high-load systems\n      meta: end_host\n      when: system_load.stdout | float \u003e 5.0\n\n  tasks:\n    - name: Update packages with retries\n      package:\n        name: \"*\"\n        state: latest\n      retries: 3\n      delay: 30\n      async: 300\n      poll: 10\n\n    - name: Deploy configuration files in parallel\n      template:\n        src: \"{{ item.src }}\"\n        dest: \"{{ item.dest }}\"\n        mode: \"{{ item.mode | default('0644') }}\"\n        backup: yes\n      loop:\n        - { src: \"nginx.conf.j2\", dest: \"/etc/nginx/nginx.conf\" }\n        - { src: \"mysql.cnf.j2\", dest: \"/etc/mysql/my.cnf\" }\n        - { src: \"redis.conf.j2\", dest: \"/etc/redis/redis.conf\" }\n      async: 120\n      poll: 5\n      register: config_deployment\n\n    - name: Wait for all configuration deployments\n      async_status:\n        jid: \"{{ item.ansible_job_id }}\"\n      loop: \"{{ config_deployment.results }}\"\n      when: item.ansible_job_id is defined\n\n  handlers:\n    - name: restart services\n      service:\n        name: \"{{ item }}\"\n        state: restarted\n      loop:\n        - nginx\n        - mysql\n        - redis\n      listen: \"restart all services\"\nEOF\n\n# Performance monitoring playbook\ncat \u003e playbooks/performance-monitoring.yml \u003c\u003cEOF\n---\n- name: Performance Monitoring Setup\n  hosts: all\n  become: yes\n  vars:\n    monitoring_tools:\n      - htop\n      - iotop\n      - nethogs\n      - dstat\n      - sysstat\n      - perf\n\n  tasks:\n    - name: Install performance monitoring tools\n      package:\n        name: \"{{ monitoring_tools }}\"\n        state: present\n\n    - name: Configure system monitoring\n      template:\n        src: templates/sysstat.j2\n        dest: /etc/default/sysstat\n        backup: yes\n      when: ansible_os_family == \"Debian\"\n\n    - name: Enable system statistics collection\n      service:\n        name: \"{{ 'sysstat' if ansible_os_family == 'Debian' else 'sysstat' }}\"\n        enabled: yes\n        state: started\n\n    - name: Create performance monitoring script\n      template:\n        src: templates/performance-monitor.sh.j2\n        dest: /usr/local/bin/performance-monitor.sh\n        mode: '0755'\n\n    - name: Schedule performance monitoring\n      cron:\n        name: \"Performance monitoring\"\n        minute: \"*/5\"\n        job: \"/usr/local/bin/performance-monitor.sh\"\n        user: root\nEOF\n```\n\n## Testing and Validation\n\n### Molecule Testing Framework\n```bash\n# Install Molecule for role testing\npip install molecule[docker] molecule[vagrant] molecule[libvirt]\n\n# Initialize Molecule in role directory\ncd roles/nginx\nmolecule init scenario --driver-name docker\n\n# Create molecule configuration\ncat \u003e molecule/default/molecule.yml \u003c\u003cEOF\n---\ndependency:\n  name: galaxy\ndriver:\n  name: docker\nplatforms:\n  - name: nginx-ubuntu\n    image: ubuntu:22.04\n    pre_build_image: true\n    privileged: true\n    volumes:\n      - /sys/fs/cgroup:/sys/fs/cgroup:ro\n    command: /lib/systemd/systemd\n    networks:\n      - name: molecule\n  - name: nginx-centos\n    image: centos:8\n    pre_build_image: true\n    privileged: true\n    volumes:\n      - /sys/fs/cgroup:/sys/fs/cgroup:ro\n    command: /usr/sbin/init\n    networks:\n      - name: molecule\nprovisioner:\n  name: ansible\n  config_options:\n    defaults:\n      callbacks_enabled: profile_tasks,timer,yaml\n  inventory:\n    host_vars:\n      nginx-ubuntu:\n        ansible_python_interpreter: /usr/bin/python3\n      nginx-centos:\n        ansible_python_interpreter: /usr/bin/python3\nverifier:\n  name: ansible\nlint: |\n  set -e\n  yamllint .\n  ansible-lint\n  flake8\nEOF\n\n# Create test playbook\ncat \u003e molecule/default/converge.yml \u003c\u003cEOF\n---\n- name: Converge\n  hosts: all\n  become: true\n  tasks:\n    - name: \"Include nginx role\"\n      include_role:\n        name: nginx\n      vars:\n        nginx_vhosts:\n          - name: default\n            server_name: localhost\n            listen: 80\n            root: /var/www/html\n            enabled: true\nEOF\n\n# Create test verification\ncat \u003e molecule/default/verify.yml \u003c\u003cEOF\n---\n- name: Verify\n  hosts: all\n  gather_facts: false\n  tasks:\n    - name: Check if NGINX is running\n      uri:\n        url: http://localhost\n        method: GET\n      register: nginx_check\n\n    - name: Verify NGINX is responding\n      assert:\n        that:\n          - nginx_check.status == 200\n        fail_msg: \"NGINX is not responding correctly\"\n\n    - name: Check NGINX configuration\n      shell: nginx -t\n      changed_when: false\n\n    - name: Verify NGINX process\n      shell: pgrep nginx\n      changed_when: false\nEOF\n\n# Run tests\nmolecule test\n```\n\n### Ansible Lint and Security Scanning\n```bash\n# Install Ansible Lint\npip install ansible-lint\n\n# Create .ansible-lint configuration\ncat \u003e .ansible-lint \u003c\u003cEOF\n---\nprofile: production\n\nexclude_paths:\n  - .cache/\n  - .github/\n  - molecule/\n  - .venv/\n\nskip_list:\n  - yaml[line-length]  # Allow longer lines for readability\n\nwarn_list:\n  - experimental  # Warn about experimental features\n\n# Custom rules\nrules:\n  braces:\n    min-spaces-inside: 0\n    max-spaces-inside: 1\n  brackets:\n    min-spaces-inside: 0\n    max-spaces-inside: 0\n  colons:\n    max-spaces-before: 0\n    min-spaces-after: 1\n    max-spaces-after: 1\n  commas:\n    max-spaces-before: 0\n    min-spaces-after: 1\n    max-spaces-after: 1\n  comments:\n    min-spaces-from-content: 1\n  document-start: disable\n  empty-lines:\n    max: 2\n    max-start: 0\n    max-end: 1\n  hyphens:\n    max-spaces-after: 1\n  indentation:\n    spaces: 2\n    indent-sequences: true\n  line-length:\n    max: 120\n  new-line-at-end-of-file: enable\n  trailing-spaces: enable\n  truthy:\n    allowed-values: ['true', 'false', 'yes', 'no']\nEOF\n\n# Create security-focused playbook linting\ncat \u003e .yamllint \u003c\u003cEOF\n---\nextends: default\n\nrules:\n  braces:\n    min-spaces-inside: 0\n    max-spaces-inside: 1\n  brackets:\n    min-spaces-inside: 0\n    max-spaces-inside: 0\n  colons:\n    max-spaces-before: 0\n    min-spaces-after: 1\n    max-spaces-after: 1\n  commas:\n    max-spaces-before: 0\n    min-spaces-after: 1\n    max-spaces-after: 1\n  comments: disable\n  comments-indentation: disable\n  document-start: disable\n  empty-lines:\n    max: 2\n    max-start: 0\n    max-end: 1\n  hyphens:\n    max-spaces-after: 1\n  indentation:\n    spaces: 2\n    indent-sequences: true\n    check-multi-line-strings: false\n  key-duplicates: enable\n  line-length:\n    max: 120\n  new-line-at-end-of-file: enable\n  octal-values:\n    forbid-implicit-octal: true\n  trailing-spaces: enable\n  truthy: disable\nEOF\n\n# Run linting\nansible-lint playbooks/\nyamllint .\n```\n\n## Backup and Disaster Recovery\n\n### Comprehensive Backup Automation\n```bash\ncat \u003e playbooks/backup-automation.yml \u003c\u003cEOF\n---\n- name: Automated Backup System\n  hosts: all\n  become: yes\n  vars:\n    backup_root: /backup\n    backup_retention_days: 30\n    backup_schedule:\n      databases: \"0 2 * * *\"\n      files: \"0 3 * * *\"\n      configs: \"0 4 * * *\"\n\n  tasks:\n    - name: Create backup directories\n      file:\n        path: \"{{ backup_root }}/{{ item }}\"\n        state: directory\n        mode: '0755'\n        owner: root\n        group: root\n      loop:\n        - databases\n        - files\n        - configs\n        - logs\n\n    # Database backups\n    - name: Create database backup script\n      template:\n        src: templates/mysql-backup.sh.j2\n        dest: /usr/local/bin/mysql-backup.sh\n        mode: '0755'\n      when: \"'dbservers' in group_names\"\n\n    - name: Schedule database backups\n      cron:\n        name: \"MySQL backup\"\n        minute: \"0\"\n        hour: \"2\"\n        job: \"/usr/local/bin/mysql-backup.sh\"\n        user: root\n      when: \"'dbservers' in group_names\"\n\n    # File system backups\n    - name: Create file backup script\n      template:\n        src: templates/file-backup.sh.j2\n        dest: /usr/local/bin/file-backup.sh\n        mode: '0755'\n\n    - name: Schedule file backups\n      cron:\n        name: \"File system backup\"\n        minute: \"0\"\n        hour: \"3\"\n        job: \"/usr/local/bin/file-backup.sh\"\n        user: root\n\n    # Configuration backups\n    - name: Backup system configurations\n      archive:\n        path:\n          - /etc/nginx\n          - /etc/mysql\n          - /etc/systemd/system\n          - /etc/crontab\n          - /etc/hosts\n          - /etc/fstab\n        dest: \"{{ backup_root }}/configs/system-config-{{ ansible_date_time.epoch }}.tar.gz\"\n        mode: '0600'\n\n    # Remote backup synchronization\n    - name: Synchronize backups to remote storage\n      synchronize:\n        src: \"{{ backup_root }}/\"\n        dest: \"backup-server.example.com:{{ backup_root }}/{{ inventory_hostname }}/\"\n        delete: yes\n        rsync_opts:\n          - \"--exclude=*.tmp\"\n          - \"--compress\"\n          - \"--archive\"\n      when: backup_remote_sync | default(true)\n\n    # Cleanup old backups\n    - name: Clean up old backup files\n      find:\n        paths: \"{{ backup_root }}\"\n        age: \"{{ backup_retention_days }}d\"\n        file_type: file\n      register: old_backups\n\n    - name: Remove old backup files\n      file:\n        path: \"{{ item.path }}\"\n        state: absent\n      loop: \"{{ old_backups.files }}\"\nEOF\n```\n\n## Verification and Monitoring\n\n### Cross-Platform System Verification\n```bash\n# Create comprehensive verification playbook\ncat \u003e playbooks/system-verification.yml \u003c\u003cEOF\n---\n- name: System Verification and Health Check\n  hosts: all\n  become: yes\n  gather_facts: yes\n  vars:\n    health_checks:\n      - service: nginx\n        port: 80\n        process: nginx\n      - service: mysql\n        port: 3306\n        process: mysqld\n      - service: redis\n        port: 6379\n        process: redis-server\n\n  tasks:\n    # System information gathering\n    - name: Gather system information\n      setup:\n        gather_subset:\n          - all\n          - !facter\n          - !ohai\n\n    # Service verification\n    - name: Check critical services status\n      service_facts:\n\n    - name: Verify services are running\n      assert:\n        that:\n          - \"ansible_facts.services[item.service + '.service'].state == 'running'\"\n        fail_msg: \"Service {{ item.service }} is not running\"\n        success_msg: \"Service {{ item.service }} is healthy\"\n      loop: \"{{ health_checks }}\"\n      when: \"item.service + '.service' in ansible_facts.services\"\n\n    # Network connectivity tests\n    - name: Test network connectivity\n      wait_for:\n        host: \"{{ item.host }}\"\n        port: \"{{ item.port }}\"\n        timeout: 5\n      loop:\n        - { host: \"8.8.8.8\", port: 53 }\n        - { host: \"1.1.1.1\", port: 53 }\n      ignore_errors: yes\n\n    # Disk space monitoring\n    - name: Check disk space usage\n      shell: df -h | awk '$5 \u003e \"85%\" {print $0}'\n      register: disk_usage\n      changed_when: false\n      failed_when: disk_usage.stdout != \"\"\n\n    # Memory usage check\n    - name: Check memory usage\n      shell: free | grep Mem | awk '{printf \"%.0f\", $3/$2 * 100.0}'\n      register: memory_usage\n      changed_when: false\n\n    - name: Alert on high memory usage\n      debug:\n        msg: \"WARNING: Memory usage is {{ memory_usage.stdout }}%\"\n      when: memory_usage.stdout | int \u003e 85\n\n    # Security verification\n    - name: Check for failed login attempts\n      shell: grep \"Failed password\" /var/log/auth.log | tail -10\n      register: failed_logins\n      changed_when: false\n      ignore_errors: yes\n      when: ansible_os_family == \"Debian\"\n\n    - name: Check firewall status\n      shell: |\n        if command -v ufw \u003e/dev/null 2\u003e\u00261; then\n          ufw status\n        elif command -v firewall-cmd \u003e/dev/null 2\u003e\u00261; then\n          firewall-cmd --state\n        else\n          echo \"No supported firewall found\"\n        fi\n      register: firewall_status\n      changed_when: false\n\n  post_tasks:\n    - name: Generate system health report\n      template:\n        src: templates/health-report.j2\n        dest: \"/tmp/health-report-{{ inventory_hostname }}-{{ ansible_date_time.epoch }}.txt\"\n        mode: '0644'\n\n    - name: Fetch health reports\n      fetch:\n        src: \"/tmp/health-report-{{ inventory_hostname }}-{{ ansible_date_time.epoch }}.txt\"\n        dest: \"./reports/\"\n        flat: yes\nEOF\n```\n\n### Continuous Compliance Monitoring\n```bash\ncat \u003e playbooks/compliance-monitoring.yml \u003c\u003cEOF\n---\n- name: Continuous Compliance Monitoring\n  hosts: all\n  become: yes\n  vars:\n    compliance_standards:\n      - cis\n      - pci_dss\n      - soc2\n      - hipaa\n    \n    audit_log_paths:\n      - /var/log/auth.log\n      - /var/log/syslog\n      - /var/log/audit/audit.log\n\n  tasks:\n    # Install audit tools\n    - name: Install audit daemon\n      package:\n        name: \"{{ 'auditd' if ansible_os_family == 'RedHat' else 'auditd' }}\"\n        state: present\n\n    - name: Configure audit rules\n      template:\n        src: templates/audit.rules.j2\n        dest: /etc/audit/rules.d/audit.rules\n        backup: yes\n      notify: restart auditd\n\n    # CIS compliance checks\n    - name: Run CIS benchmark checks\n      shell: |\n        if [ -f /opt/cis-cat/CIS-CAT.sh ]; then\n          /opt/cis-cat/CIS-CAT.sh -b /opt/cis-cat/benchmarks/\n        else\n          echo \"CIS-CAT not installed, skipping\"\n        fi\n      register: cis_results\n      ignore_errors: yes\n\n    # File integrity monitoring\n    - name: Install AIDE\n      package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      shell: |\n        aide --init\n        mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db\n      args:\n        creates: /var/lib/aide/aide.db\n\n    - name: Schedule AIDE integrity checks\n      cron:\n        name: \"AIDE integrity check\"\n        minute: \"0\"\n        hour: \"3\"\n        job: \"/usr/bin/aide --check | mail -s 'AIDE Report' security@example.com\"\n        user: root\n\n    # Log monitoring\n    - name: Install log monitoring tools\n      package:\n        name:\n          - logwatch\n          - rsyslog\n        state: present\n\n    - name: Configure centralized logging\n      template:\n        src: templates/rsyslog.conf.j2\n        dest: /etc/rsyslog.conf\n        backup: yes\n      notify: restart rsyslog\n\n  handlers:\n    - name: restart auditd\n      service:\n        name: auditd\n        state: restarted\n\n    - name: restart rsyslog\n      service:\n        name: rsyslog\n        state: restarted\nEOF\n```\n\n## CI/CD Integration\n\n### Jenkins Pipeline Integration\n```bash\n# Create Jenkinsfile for Ansible automation\ncat \u003e Jenkinsfile \u003c\u003cEOF\npipeline {\n    agent any\n    \n    environment {\n        ANSIBLE_CONFIG = 'ansible.cfg'\n        ANSIBLE_HOST_KEY_CHECKING = 'False'\n    }\n    \n    stages {\n        stage('Lint') {\n            steps {\n                sh 'ansible-lint playbooks/'\n                sh 'yamllint .'\n            }\n        }\n        \n        stage('Syntax Check') {\n            steps {\n                sh 'ansible-playbook playbooks/site.yml --syntax-check'\n            }\n        }\n        \n        stage('Dry Run') {\n            steps {\n                sh 'ansible-playbook playbooks/site.yml --check --diff'\n            }\n        }\n        \n        stage('Deploy to Staging') {\n            when {\n                branch 'develop'\n            }\n            steps {\n                sh 'ansible-playbook -i inventories/staging playbooks/site.yml'\n            }\n        }\n        \n        stage('Deploy to Production') {\n            when {\n                branch 'main'\n            }\n            steps {\n                input 'Deploy to Production?'\n                sh 'ansible-playbook -i inventories/production playbooks/site.yml'\n            }\n        }\n        \n        stage('Verify Deployment') {\n            steps {\n                sh 'ansible-playbook playbooks/system-verification.yml'\n            }\n        }\n    }\n    \n    post {\n        always {\n            archiveArtifacts artifacts: 'logs/*.log', allowEmptyArchive: true\n            publishHTML([\n                allowMissing: false,\n                alwaysLinkToLastBuild: true,\n                keepAll: true,\n                reportDir: 'reports',\n                reportFiles: '*.html',\n                reportName: 'Ansible Report'\n            ])\n        }\n        failure {\n            emailext (\n                subject: \"Failed Pipeline: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\",\n                body: \"Something is wrong with ${env.BUILD_URL}\",\n                to: \"${env.DEFAULT_RECIPIENTS}\"\n            )\n        }\n    }\n}\nEOF\n```\n\n### GitLab CI Integration\n```bash\ncat \u003e .gitlab-ci.yml \u003c\u003cEOF\nstages:\n  - lint\n  - test\n  - deploy-staging\n  - deploy-production\n\nvariables:\n  ANSIBLE_CONFIG: ansible.cfg\n  ANSIBLE_HOST_KEY_CHECKING: \"False\"\n\nbefore_script:\n  - pip install ansible ansible-lint yamllint\n  - ansible-galaxy install -r requirements.yml\n\nlint:\n  stage: lint\n  script:\n    - ansible-lint playbooks/\n    - yamllint .\n  rules:\n    - if: '$CI_MERGE_REQUEST_IID'\n    - if: '$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH'\n\nsyntax-check:\n  stage: test\n  script:\n    - ansible-playbook playbooks/site.yml --syntax-check\n    - ansible-playbook playbooks/site.yml --check --diff -i inventories/staging\n  rules:\n    - if: '$CI_MERGE_REQUEST_IID'\n    - if: '$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH'\n\ndeploy-staging:\n  stage: deploy-staging\n  script:\n    - ansible-playbook -i inventories/staging playbooks/site.yml\n  rules:\n    - if: '$CI_COMMIT_BRANCH == \"develop\"'\n\ndeploy-production:\n  stage: deploy-production\n  script:\n    - ansible-playbook -i inventories/production playbooks/site.yml\n  rules:\n    - if: '$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH'\n      when: manual\n  environment:\n    name: production\n    url: https://production.example.com\nEOF\n```\n\n## Troubleshooting (Cross-Platform)\n\n### Common Issues and Solutions\n```bash\n# Debug connection issues\nansible all -m ping -vvv\n\n# Check SSH connectivity\nansible all -m setup --ask-pass --ask-become-pass\n\n# Verify inventory\nansible-inventory --list\nansible-inventory --graph\n\n# Test specific host\nansible target-host -m command -a \"uptime\"\n\n# Check syntax without execution\nansible-playbook playbooks/site.yml --syntax-check\n\n# Dry run with verbose output\nansible-playbook playbooks/site.yml --check --diff -vvv\n\n# Debug variable resolution\nansible-playbook playbooks/site.yml --extra-vars=\"debug=true\" --tags debug\n\n# Check facts\nansible all -m setup | grep ansible_os_family\n\n# Connection troubleshooting\nssh -vvv user@target-host\n\n# Permission issues\nansible all -m file -a \"path=/tmp/test state=touch\" --become\n\n# Vault issues\nansible-vault view group_vars/all/vault.yml\n\n# Performance debugging\nansible-playbook playbooks/site.yml --start-at-task=\"specific task name\"\nansible-playbook playbooks/site.yml --step\n\n# Module testing\nansible localhost -m debug -a \"var=hostvars\"\nansible localhost -m setup\n\n# Check for syntax errors in roles\nfind roles/ -name \"*.yml\" -exec ansible-playbook {} --syntax-check \\;\n```\n\n### Advanced Debugging\n```bash\n# Enable comprehensive logging\nexport ANSIBLE_DEBUG=1\nexport ANSIBLE_VERBOSITY=4\nansible-playbook playbooks/site.yml\n\n# Profile playbook execution\nansible-playbook playbooks/site.yml --extra-vars=\"profile_tasks_sort_order=none\"\n\n# Memory usage analysis\nansible-playbook playbooks/site.yml --extra-vars=\"ansible_python_interpreter=/usr/bin/python3\"\n\n# Network debugging\nansible all -m command -a \"ss -tulpn\"\nansible all -m command -a \"netstat -rn\"\n\n# Process debugging\nansible all -m command -a \"ps aux --sort=-%mem | head -10\"\n\n# Disk usage analysis\nansible all -m command -a \"df -h\"\nansible all -m command -a \"du -sh /var/log/*\"\n\n# Service debugging\nansible all -m systemd -a \"name=nginx\" --become\nansible all -m command -a \"systemctl status nginx\" --become\n\n# Variable debugging\nansible-playbook playbooks/site.yml --extra-vars=\"debug_vars=true\" --tags debug_vars\n```\n\n## Additional Resources\n\n- [Official Documentation](https://docs.ansible.com/)\n- [Ansible Galaxy](https://galaxy.ansible.com/)\n- [Best Practices Guide](https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html)\n- [Security Best Practices](https://docs.ansible.com/ansible/latest/user_guide/become.html#security-best-practices)\n- [Ansible Molecule Testing](https://molecule.readthedocs.io/)\n- [Community Collections](https://docs.ansible.com/ansible/latest/collections/index.html)\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection.","readmeHtml":"\u003ch1 id=\"ansible-installation-guide\" class=\"mobile-header\"\u003eAnsible Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eAgentless automation platform for configuration management, application deployment, and task automation across multiple systems. Industry standard for infrastructure automation with enterprise-grade security.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux control machine (any modern distribution)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003ePython 3.8+ on control machine\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eSSH access to target hosts\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003ePython 2.7+ or 3.5+ on target hosts\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e2GB RAM minimum, 4GB+ recommended for large infrastructures\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"using-package-manager-recommended\" class=\"mobile-header\"\u003eUsing Package Manager (Recommended)\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### Ubuntu/Debian\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update package list\nsudo apt update\n\n# Install Ansible and dependencies\nsudo apt install -y ansible python3-pip python3-venv sshpass\n\n# Install additional collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\nansible-galaxy collection install kubernetes.core\nansible-galaxy collection install amazon.aws\nansible-galaxy collection install azure.azcollection\nansible-galaxy collection install google.cloud\n\n# Verify installation\nansible --version\nansible-galaxy collection list\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### RHEL/CentOS/Rocky Linux/AlmaLinux\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install EPEL repository\nsudo yum install -y epel-release\n\n# Install Ansible\nsudo yum install -y ansible python3-pip\n\n# For newer distributions\nsudo dnf install -y ansible python3-pip\n\n# Install collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\nansible-galaxy collection install kubernetes.core\n\n# Verify installation\nansible --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### Fedora\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Ansible\nsudo dnf install -y ansible python3-pip python3-virtualenv\n\n# Install additional collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\nansible-galaxy collection install kubernetes.core\n\n# Verify installation\nansible --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### Arch Linux\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Ansible\nsudo pacman -Syu ansible python-pip\n\n# Install collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\n\n# Verify installation\nansible --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### Alpine Linux\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Ansible\nsudo apk update\nsudo apk add ansible python3 py3-pip openssh\n\n# Install collections\nansible-galaxy collection install community.general\n\n# Verify installation\nansible --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"using-pip-latest-version\" class=\"mobile-header\"\u003eUsing pip (Latest Version)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create virtual environment (recommended)\npython3 -m venv ~/ansible-venv\nsource ~/ansible-venv/bin/activate\n\n# Install Ansible via pip\npip install --upgrade pip\npip install ansible ansible-core\n\n# Install additional packages\npip install paramiko jinja2 PyYAML cryptography\n\n# Install cloud provider SDKs\npip install boto3 botocore azure-cli google-cloud-storage\n\n# Install collections\nansible-galaxy collection install community.general\nansible-galaxy collection install ansible.posix\nansible-galaxy collection install kubernetes.core\nansible-galaxy collection install amazon.aws\nansible-galaxy collection install azure.azcollection\nansible-galaxy collection install google.cloud\n\n# Add to PATH permanently\necho \u0026#039;source ~/ansible-venv/bin/activate\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\n\n# Verify installation\nansible --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"using-docker\" class=\"mobile-header\"\u003eUsing Docker\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create Ansible Docker container with mounted volumes\ndocker run --rm -it \\\n  -v $(pwd):/ansible \\\n  -v ~/.ssh:/root/.ssh:ro \\\n  -v ~/.aws:/root/.aws:ro \\\n  -v ~/.azure:/root/.azure:ro \\\n  --workdir /ansible \\\n  ansible/ansible:latest\n\n# Create wrapper script for ease of use\nsudo tee /usr/local/bin/ansible-docker \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\ndocker run --rm -it \\\n  -v $(pwd):/ansible \\\n  -v ~/.ssh:/root/.ssh:ro \\\n  -v ~/.aws:/root/.aws:ro \\\n  -v ~/.azure:/root/.azure:ro \\\n  -v ~/.kube:/root/.kube:ro \\\n  --workdir /ansible \\\n  --network host \\\n  ansible/ansible:latest \u0026quot;$@\u0026quot;\nEOF\nsudo chmod +x /usr/local/bin/ansible-docker\n\n# Create aliases\necho \u0026#039;alias ansible=\u0026quot;ansible-docker ansible\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\necho \u0026#039;alias ansible-playbook=\u0026quot;ansible-docker ansible-playbook\u0026quot;\u0026#039; \u0026gt;\u0026gt; ~/.bashrc\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"project-structure-and-configuration\" class=\"mobile-header\"\u003eProject Structure and Configuration\u003c/h2\u003e\n\u003ch3 id=\"professional-project-structure\" class=\"mobile-header\"\u003eProfessional Project Structure\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create comprehensive Ansible project structure\nmkdir -p ~/ansible-infrastructure/{\n  inventories/{production,staging,development},\n  playbooks,\n  roles,\n  group_vars,\n  host_vars,\n  library,\n  filter_plugins,\n  callback_plugins,\n  vault,\n  collections,\n  logs\n}\n\ncd ~/ansible-infrastructure\n\n# Create ansible.cfg with security best practices\ncat \u0026gt; ansible.cfg \u0026lt;\u0026lt;EOF\n[defaults]\ninventory = inventories/production/hosts.yml\nremote_user = ansible\nprivate_key_file = ~/.ssh/ansible_key\nhost_key_checking = True\ntimeout = 30\nretry_files_enabled = False\nstdout_callback = yaml\nbin_ansible_callbacks = True\ngathering = smart\nfact_caching = jsonfile\nfact_caching_connection = ~/.ansible/facts_cache\nfact_caching_timeout = 86400\ninterpreter_python = auto_silent\nvault_password_file = ~/.ansible_vault_pass\n\n# Logging\nlog_path = logs/ansible.log\ndisplay_skipped_hosts = False\ndisplay_ok_hosts = False\n\n# Performance\nforks = 20\npoll_interval = 15\ninternal_poll_interval = 0.001\n\n# Security\ncommand_warnings = True\ndeprecation_warnings = True\naction_warnings = True\nlocalhost_warning = True\n\n[ssh_connection]\nssh_args = -o ControlMaster=auto -o ControlPersist=3600s -o PreferredAuthentications=publickey\npipelining = True\ncontrol_path = ~/.ansible/cp/%%h-%%p-%%r\nretries = 3\n\n[privilege_escalation]\nbecome = False\nbecome_method = sudo\nbecome_user = root\nbecome_ask_pass = False\n\n[inventory]\nenable_plugins = host_list, script, auto, yaml, ini, toml\ncache = True\ncache_plugin = jsonfile\ncache_timeout = 3600\ncache_connection = ~/.ansible/inventory_cache\n\n[galaxy]\nserver_list = automation_hub, galaxy\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-inventory-management\" class=\"mobile-header\"\u003eAdvanced Inventory Management\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create production inventory with groups and variables\ncat \u0026gt; inventories/production/hosts.yml \u0026lt;\u0026lt;EOF\nall:\n  children:\n    webservers:\n      hosts:\n        web-prod-01:\n          ansible_host: 10.0.1.10\n          ansible_user: ansible\n          server_role: frontend\n          backup_enabled: true\n        web-prod-02:\n          ansible_host: 10.0.1.11\n          ansible_user: ansible\n          server_role: frontend\n          backup_enabled: true\n        web-prod-03:\n          ansible_host: 10.0.1.12\n          ansible_user: ansible\n          server_role: frontend\n          backup_enabled: true\n      vars:\n        http_port: 80\n        https_port: 443\n        max_clients: 200\n        environment: production\n        monitoring_enabled: true\n\n    dbservers:\n      hosts:\n        db-prod-01:\n          ansible_host: 10.0.2.10\n          ansible_user: ansible\n          mysql_server_id: 1\n          mysql_role: master\n        db-prod-02:\n          ansible_host: 10.0.2.11\n          ansible_user: ansible\n          mysql_server_id: 2\n          mysql_role: slave\n      vars:\n        mysql_port: 3306\n        mysql_root_password: \u0026quot;{{ vault_mysql_root_password }}\u0026quot;\n        mysql_replication_user: \u0026quot;{{ vault_mysql_replication_user }}\u0026quot;\n        mysql_replication_password: \u0026quot;{{ vault_mysql_replication_password }}\u0026quot;\n\n    loadbalancers:\n      hosts:\n        lb-prod-01:\n          ansible_host: 10.0.3.10\n          ansible_user: ansible\n          lb_algorithm: roundrobin\n        lb-prod-02:\n          ansible_host: 10.0.3.11\n          ansible_user: ansible\n          lb_algorithm: roundrobin\n      vars:\n        haproxy_stats_enabled: true\n        haproxy_stats_user: admin\n        haproxy_stats_password: \u0026quot;{{ vault_haproxy_stats_password }}\u0026quot;\n\n    monitoring:\n      hosts:\n        monitor-prod-01:\n          ansible_host: 10.0.4.10\n          ansible_user: ansible\n          prometheus_retention: 30d\n          grafana_admin_password: \u0026quot;{{ vault_grafana_admin_password }}\u0026quot;\n\n    bastion:\n      hosts:\n        bastion-prod-01:\n          ansible_host: bastion.example.com\n          ansible_user: ansible\n          ansible_port: 22\n\n# Global variables for all hosts\nwebservers:\n  vars:\n    nginx_worker_processes: auto\n    nginx_worker_connections: 1024\n    ssl_certificate_path: /etc/ssl/certs\n    backup_schedule: \u0026quot;0 2 * * *\u0026quot;\n\ndbservers:\n  vars:\n    mysql_innodb_buffer_pool_size: 2G\n    mysql_max_connections: 200\n    backup_schedule: \u0026quot;0 1 * * *\u0026quot;\n    monitoring_enabled: true\nEOF\n\n# Create dynamic inventory script for cloud environments\ncat \u0026gt; inventories/production/aws_ec2.yml \u0026lt;\u0026lt;EOF\nplugin: amazon.aws.aws_ec2\nregions:\n  - us-west-2\n  - us-east-1\nfilters:\n  tag:Environment: production\n  tag:Ansible: managed\n  instance-state-name: running\n\nhostnames:\n  - tag:Name\n  - dns-name\n  - private-ip-address\n\ncompose:\n  ansible_host: private_ip_address\n  ec2_state: ec2_state_name\n  ec2_arch: ec2_architecture\n\ngroups:\n  # Group by instance type\n  webservers: \u0026quot;\u0026#039;web\u0026#039; in tags.Role\u0026quot;\n  databases: \u0026quot;\u0026#039;db\u0026#039; in tags.Role\u0026quot;\n  loadbalancers: \u0026quot;\u0026#039;lb\u0026#039; in tags.Role\u0026quot;\n  \n  # Group by environment\n  production: \u0026quot;tags.Environment == \u0026#039;production\u0026#039;\u0026quot;\n  staging: \u0026quot;tags.Environment == \u0026#039;staging\u0026#039;\u0026quot;\n  \n  # Group by availability zone\n  us_west_2a: ec2_placement_availability_zone == \u0026quot;us-west-2a\u0026quot;\n  us_west_2b: ec2_placement_availability_zone == \u0026quot;us-west-2b\u0026quot;\n\nkeyed_groups:\n  # Create groups based on tags\n  - key: tags.Environment\n    prefix: env\n  - key: tags.Role  \n    prefix: role\n  - key: ec2_instance_type\n    prefix: type\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ansible-vault-security\" class=\"mobile-header\"\u003eAnsible Vault Security\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create strong vault password\nopenssl rand -base64 32 \u0026gt; ~/.ansible_vault_pass\nchmod 600 ~/.ansible_vault_pass\n\n# Create encrypted vault file for secrets\nansible-vault create group_vars/all/vault.yml\n# Enter secure passwords and API keys:\n# vault_mysql_root_password: your_secure_mysql_password\n# vault_grafana_admin_password: your_secure_grafana_password  \n# vault_ssl_private_key: |\n#   -----BEGIN PRIVATE KEY-----\n#   your_private_key_content\n#   -----END PRIVATE KEY-----\n\n# Create non-encrypted variables file\ncat \u0026gt; group_vars/all/vars.yml \u0026lt;\u0026lt;EOF\n# Non-sensitive variables\nmysql_port: 3306\nnginx_port: 80\ngrafana_port: 3000\nprometheus_port: 9090\n\n# Reference vault variables\nmysql_root_password: \u0026quot;{{ vault_mysql_root_password }}\u0026quot;\ngrafana_admin_password: \u0026quot;{{ vault_grafana_admin_password }}\u0026quot;\n\n# SSL configuration\nssl_certificate_path: /etc/ssl/certs/server.crt\nssl_private_key_path: /etc/ssl/private/server.key\nssl_private_key_content: \u0026quot;{{ vault_ssl_private_key }}\u0026quot;\n\n# Security settings\nansible_ssh_common_args: \u0026#039;-o StrictHostKeyChecking=yes -o UserKnownHostsFile=~/.ssh/known_hosts\u0026#039;\nansible_become_method: sudo\nansible_become_user: root\nEOF\n\n# Edit vault file\nansible-vault edit group_vars/all/vault.yml\n\n# View vault file (read-only)\nansible-vault view group_vars/all/vault.yml\n\n# Change vault password\nansible-vault rekey group_vars/all/vault.yml\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"comprehensive-playbooks\" class=\"mobile-header\"\u003eComprehensive Playbooks\u003c/h2\u003e\n\u003ch3 id=\"system-hardening-playbook\" class=\"mobile-header\"\u003eSystem Hardening Playbook\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecat \u0026gt; playbooks/system-hardening.yml \u0026lt;\u0026lt;EOF\n---\n- name: System Security Hardening\n  hosts: all\n  become: yes\n  gather_facts: yes\n  vars:\n    security_packages:\n      - fail2ban\n      - ufw\n      - aide\n      - chkrootkit\n      - rkhunter\n      - clamav\n      - lynis\n    \n    disabled_services:\n      - telnet\n      - rsh\n      - rlogin\n      - tftp\n      - talk\n      - finger\n\n  pre_tasks:\n    - name: Update package cache\n      package:\n        update_cache: yes\n        cache_valid_time: 3600\n      when: ansible_os_family in [\u0026quot;Debian\u0026quot;, \u0026quot;RedHat\u0026quot;]\n\n  tasks:\n    # System updates\n    - name: Upgrade all packages\n      package:\n        name: \u0026quot;*\u0026quot;\n        state: latest\n      when: ansible_os_family == \u0026quot;RedHat\u0026quot;\n\n    - name: Upgrade all packages (Debian/Ubuntu)\n      apt:\n        upgrade: dist\n        autoremove: yes\n        autoclean: yes\n      when: ansible_os_family == \u0026quot;Debian\u0026quot;\n\n    # Install security packages\n    - name: Install security packages\n      package:\n        name: \u0026quot;{{ security_packages }}\u0026quot;\n        state: present\n\n    # User security\n    - name: Create ansible user with limited privileges\n      user:\n        name: ansible\n        groups: sudo\n        shell: /bin/bash\n        create_home: yes\n        generate_ssh_key: yes\n        ssh_key_bits: 4096\n        ssh_key_type: rsa\n\n    - name: Configure sudo for ansible user\n      lineinfile:\n        path: /etc/sudoers.d/ansible\n        line: \u0026#039;ansible ALL=(ALL) NOPASSWD:ALL\u0026#039;\n        create: yes\n        mode: \u0026#039;0440\u0026#039;\n        validate: \u0026#039;visudo -cf %s\u0026#039;\n\n    # SSH hardening\n    - name: Configure SSH security\n      lineinfile:\n        path: /etc/ssh/sshd_config\n        regexp: \u0026quot;{{ item.regexp }}\u0026quot;\n        line: \u0026quot;{{ item.line }}\u0026quot;\n        backup: yes\n      loop:\n        - { regexp: \u0026#039;^#?PermitRootLogin\u0026#039;, line: \u0026#039;PermitRootLogin no\u0026#039; }\n        - { regexp: \u0026#039;^#?PasswordAuthentication\u0026#039;, line: \u0026#039;PasswordAuthentication no\u0026#039; }\n        - { regexp: \u0026#039;^#?X11Forwarding\u0026#039;, line: \u0026#039;X11Forwarding no\u0026#039; }\n        - { regexp: \u0026#039;^#?MaxAuthTries\u0026#039;, line: \u0026#039;MaxAuthTries 3\u0026#039; }\n        - { regexp: \u0026#039;^#?ClientAliveInterval\u0026#039;, line: \u0026#039;ClientAliveInterval 300\u0026#039; }\n        - { regexp: \u0026#039;^#?ClientAliveCountMax\u0026#039;, line: \u0026#039;ClientAliveCountMax 0\u0026#039; }\n        - { regexp: \u0026#039;^#?Protocol\u0026#039;, line: \u0026#039;Protocol 2\u0026#039; }\n        - { regexp: \u0026#039;^#?LogLevel\u0026#039;, line: \u0026#039;LogLevel VERBOSE\u0026#039; }\n      notify: restart ssh\n\n    # Firewall configuration\n    - name: Configure UFW firewall (Debian/Ubuntu)\n      ufw:\n        state: enabled\n        policy: deny\n        direction: incoming\n      when: ansible_os_family == \u0026quot;Debian\u0026quot;\n\n    - name: Allow SSH through UFW\n      ufw:\n        rule: allow\n        port: 22\n        proto: tcp\n        comment: \u0026#039;SSH access\u0026#039;\n      when: ansible_os_family == \u0026quot;Debian\u0026quot;\n\n    - name: Configure firewalld (RHEL/CentOS/Fedora)\n      firewalld:\n        state: enabled\n        permanent: yes\n        immediate: yes\n      when: ansible_os_family == \u0026quot;RedHat\u0026quot;\n\n    - name: Allow SSH through firewalld\n      firewalld:\n        service: ssh\n        permanent: yes\n        state: enabled\n        immediate: yes\n      when: ansible_os_family == \u0026quot;RedHat\u0026quot;\n\n    # Disable unnecessary services\n    - name: Disable unnecessary services\n      systemd:\n        name: \u0026quot;{{ item }}\u0026quot;\n        enabled: no\n        state: stopped\n      loop: \u0026quot;{{ disabled_services }}\u0026quot;\n      ignore_errors: yes\n\n    # File system security\n    - name: Set proper permissions on sensitive files\n      file:\n        path: \u0026quot;{{ item.path }}\u0026quot;\n        mode: \u0026quot;{{ item.mode }}\u0026quot;\n        owner: root\n        group: root\n      loop:\n        - { path: \u0026#039;/etc/passwd\u0026#039;, mode: \u0026#039;0644\u0026#039; }\n        - { path: \u0026#039;/etc/shadow\u0026#039;, mode: \u0026#039;0640\u0026#039; }\n        - { path: \u0026#039;/etc/group\u0026#039;, mode: \u0026#039;0644\u0026#039; }\n        - { path: \u0026#039;/etc/gshadow\u0026#039;, mode: \u0026#039;0640\u0026#039; }\n        - { path: \u0026#039;/etc/ssh/sshd_config\u0026#039;, mode: \u0026#039;0600\u0026#039; }\n\n    # Kernel security parameters\n    - name: Configure kernel security parameters\n      sysctl:\n        name: \u0026quot;{{ item.key }}\u0026quot;\n        value: \u0026quot;{{ item.value }}\u0026quot;\n        sysctl_set: yes\n        state: present\n        reload: yes\n      loop:\n        - { key: \u0026#039;net.ipv4.ip_forward\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.all.send_redirects\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.default.send_redirects\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.all.accept_source_route\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.default.accept_source_route\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.all.accept_redirects\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.default.accept_redirects\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.all.secure_redirects\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.default.secure_redirects\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.all.log_martians\u0026#039;, value: \u0026#039;1\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.default.log_martians\u0026#039;, value: \u0026#039;1\u0026#039; }\n        - { key: \u0026#039;kernel.randomize_va_space\u0026#039;, value: \u0026#039;2\u0026#039; }\n\n    # Configure fail2ban\n    - name: Configure fail2ban for SSH protection\n      template:\n        src: templates/fail2ban-jail.local.j2\n        dest: /etc/fail2ban/jail.local\n        backup: yes\n      notify: restart fail2ban\n\n  handlers:\n    - name: restart ssh\n      service:\n        name: \u0026quot;{{ \u0026#039;ssh\u0026#039; if ansible_os_family == \u0026#039;Debian\u0026#039; else \u0026#039;sshd\u0026#039; }}\u0026quot;\n        state: restarted\n\n    - name: restart fail2ban\n      service:\n        name: fail2ban\n        state: restarted\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"application-deployment-playbook\" class=\"mobile-header\"\u003eApplication Deployment Playbook\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecat \u0026gt; playbooks/web-application-deployment.yml \u0026lt;\u0026lt;EOF\n---\n- name: Deploy Web Application Stack\n  hosts: webservers\n  become: yes\n  serial: \u0026quot;25%\u0026quot;  # Rolling deployment\n  max_fail_percentage: 10\n  vars:\n    app_name: mywebapp\n    app_version: \u0026quot;{{ app_version | default(\u0026#039;latest\u0026#039;) }}\u0026quot;\n    app_port: 3000\n    nginx_workers: \u0026quot;{{ ansible_processor_cores }}\u0026quot;\n    \n  pre_tasks:\n    - name: Check if maintenance mode file exists\n      stat:\n        path: /var/www/html/maintenance.html\n      register: maintenance_mode\n\n    - name: Fail if in maintenance mode\n      fail:\n        msg: \u0026quot;Server is in maintenance mode\u0026quot;\n      when: maintenance_mode.stat.exists and not force_deployment | default(false)\n\n  tasks:\n    # Application deployment\n    - name: Create application user\n      user:\n        name: \u0026quot;{{ app_name }}\u0026quot;\n        system: yes\n        shell: /bin/false\n        home: \u0026quot;/opt/{{ app_name }}\u0026quot;\n        create_home: yes\n\n    - name: Create application directories\n      file:\n        path: \u0026quot;{{ item }}\u0026quot;\n        state: directory\n        owner: \u0026quot;{{ app_name }}\u0026quot;\n        group: \u0026quot;{{ app_name }}\u0026quot;\n        mode: \u0026#039;0755\u0026#039;\n      loop:\n        - \u0026quot;/opt/{{ app_name }}\u0026quot;\n        - \u0026quot;/opt/{{ app_name }}/releases\u0026quot;\n        - \u0026quot;/opt/{{ app_name }}/shared\u0026quot;\n        - \u0026quot;/var/log/{{ app_name }}\u0026quot;\n\n    - name: Download application release\n      get_url:\n        url: \u0026quot;https://releases.example.com/{{ app_name }}/{{ app_version }}/{{ app_name }}-{{ app_version }}.tar.gz\u0026quot;\n        dest: \u0026quot;/tmp/{{ app_name }}-{{ app_version }}.tar.gz\u0026quot;\n        mode: \u0026#039;0644\u0026#039;\n        timeout: 300\n      register: download_result\n\n    - name: Extract application\n      unarchive:\n        src: \u0026quot;/tmp/{{ app_name }}-{{ app_version }}.tar.gz\u0026quot;\n        dest: \u0026quot;/opt/{{ app_name }}/releases/\u0026quot;\n        owner: \u0026quot;{{ app_name }}\u0026quot;\n        group: \u0026quot;{{ app_name }}\u0026quot;\n        remote_src: yes\n        creates: \u0026quot;/opt/{{ app_name }}/releases/{{ app_version }}\u0026quot;\n\n    - name: Create symlink to current release\n      file:\n        src: \u0026quot;/opt/{{ app_name }}/releases/{{ app_version }}\u0026quot;\n        dest: \u0026quot;/opt/{{ app_name }}/current\u0026quot;\n        state: link\n        owner: \u0026quot;{{ app_name }}\u0026quot;\n        group: \u0026quot;{{ app_name }}\u0026quot;\n      notify:\n        - reload application\n        - reload nginx\n\n    # Configuration management\n    - name: Deploy application configuration\n      template:\n        src: \u0026quot;templates/{{ app_name }}.conf.j2\u0026quot;\n        dest: \u0026quot;/opt/{{ app_name }}/shared/{{ app_name }}.conf\u0026quot;\n        owner: \u0026quot;{{ app_name }}\u0026quot;\n        group: \u0026quot;{{ app_name }}\u0026quot;\n        mode: \u0026#039;0640\u0026#039;\n        backup: yes\n      notify: reload application\n\n    # Service management\n    - name: Deploy systemd service file\n      template:\n        src: \u0026quot;templates/{{ app_name }}.service.j2\u0026quot;\n        dest: \u0026quot;/etc/systemd/system/{{ app_name }}.service\u0026quot;\n        mode: \u0026#039;0644\u0026#039;\n      notify:\n        - daemon reload\n        - restart application\n\n    - name: Enable and start application service\n      systemd:\n        name: \u0026quot;{{ app_name }}\u0026quot;\n        enabled: yes\n        state: started\n        daemon_reload: yes\n\n    # Health check\n    - name: Wait for application to be ready\n      uri:\n        url: \u0026quot;http://localhost:{{ app_port }}/health\u0026quot;\n        method: GET\n        status_code: 200\n      retries: 30\n      delay: 10\n\n    # Cleanup old releases\n    - name: Clean up old releases (keep last 3)\n      shell: |\n        cd /opt/{{ app_name }}/releases\n        ls -t | tail -n +4 | xargs rm -rf\n      args:\n        executable: /bin/bash\n\n  post_tasks:\n    - name: Verify application is running\n      uri:\n        url: \u0026quot;http://{{ ansible_default_ipv4.address }}:{{ app_port }}/health\u0026quot;\n        method: GET\n        status_code: 200\n      delegate_to: localhost\n\n    - name: Log deployment success\n      lineinfile:\n        path: \u0026quot;/var/log/{{ app_name }}/deployments.log\u0026quot;\n        line: \u0026quot;{{ ansible_date_time.iso8601 }} - Successfully deployed {{ app_version }} to {{ inventory_hostname }}\u0026quot;\n        create: yes\n\n  handlers:\n    - name: daemon reload\n      systemd:\n        daemon_reload: yes\n\n    - name: restart application\n      systemd:\n        name: \u0026quot;{{ app_name }}\u0026quot;\n        state: restarted\n\n    - name: reload application\n      systemd:\n        name: \u0026quot;{{ app_name }}\u0026quot;\n        state: reloaded\n\n    - name: reload nginx\n      service:\n        name: nginx\n        state: reloaded\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"infrastructure-as-code-playbook\" class=\"mobile-header\"\u003eInfrastructure as Code Playbook\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecat \u0026gt; playbooks/infrastructure-provisioning.yml \u0026lt;\u0026lt;EOF\n---\n- name: Infrastructure Provisioning and Configuration\n  hosts: all\n  become: yes\n  strategy: free  # Parallel execution\n  vars:\n    base_packages:\n      Debian:\n        - curl\n        - wget\n        - vim\n        - htop\n        - git\n        - python3\n        - python3-pip\n        - unzip\n        - tree\n      RedHat:\n        - curl\n        - wget\n        - vim\n        - htop\n        - git\n        - python3\n        - python3-pip\n        - unzip\n        - tree\n        - epel-release\n\n  tasks:\n    # System preparation\n    - name: Set hostname\n      hostname:\n        name: \u0026quot;{{ inventory_hostname }}\u0026quot;\n\n    - name: Update /etc/hosts\n      lineinfile:\n        path: /etc/hosts\n        line: \u0026quot;{{ ansible_default_ipv4.address }} {{ inventory_hostname }}\u0026quot;\n        backup: yes\n\n    # Package management\n    - name: Install base packages\n      package:\n        name: \u0026quot;{{ base_packages[ansible_os_family] | default(base_packages[\u0026#039;Debian\u0026#039;]) }}\u0026quot;\n        state: present\n\n    # Time synchronization\n    - name: Install and configure NTP\n      package:\n        name: \u0026quot;{{ \u0026#039;ntp\u0026#039; if ansible_os_family == \u0026#039;Debian\u0026#039; else \u0026#039;chrony\u0026#039; }}\u0026quot;\n        state: present\n\n    - name: Start and enable time synchronization\n      service:\n        name: \u0026quot;{{ \u0026#039;ntp\u0026#039; if ansible_os_family == \u0026#039;Debian\u0026#039; else \u0026#039;chronyd\u0026#039; }}\u0026quot;\n        state: started\n        enabled: yes\n\n    # Log management\n    - name: Configure logrotate for application logs\n      template:\n        src: templates/app-logrotate.j2\n        dest: /etc/logrotate.d/applications\n        mode: \u0026#039;0644\u0026#039;\n\n    # Monitoring agent installation\n    - name: Install Node Exporter for Prometheus monitoring\n      get_url:\n        url: \u0026quot;https://github.com/prometheus/node_exporter/releases/download/v1.6.1/node_exporter-1.6.1.linux-amd64.tar.gz\u0026quot;\n        dest: /tmp/node_exporter.tar.gz\n        mode: \u0026#039;0644\u0026#039;\n\n    - name: Extract Node Exporter\n      unarchive:\n        src: /tmp/node_exporter.tar.gz\n        dest: /tmp\n        remote_src: yes\n\n    - name: Copy Node Exporter binary\n      copy:\n        src: /tmp/node_exporter-1.6.1.linux-amd64/node_exporter\n        dest: /usr/local/bin/node_exporter\n        mode: \u0026#039;0755\u0026#039;\n        owner: root\n        group: root\n        remote_src: yes\n\n    - name: Create node_exporter systemd service\n      template:\n        src: templates/node_exporter.service.j2\n        dest: /etc/systemd/system/node_exporter.service\n        mode: \u0026#039;0644\u0026#039;\n      notify:\n        - daemon reload\n        - restart node_exporter\n\n    # Security configuration\n    - name: Configure kernel parameters for security\n      sysctl:\n        name: \u0026quot;{{ item.key }}\u0026quot;\n        value: \u0026quot;{{ item.value }}\u0026quot;\n        sysctl_set: yes\n        state: present\n        reload: yes\n      loop:\n        - { key: \u0026#039;kernel.dmesg_restrict\u0026#039;, value: \u0026#039;1\u0026#039; }\n        - { key: \u0026#039;kernel.kptr_restrict\u0026#039;, value: \u0026#039;2\u0026#039; }\n        - { key: \u0026#039;kernel.yama.ptrace_scope\u0026#039;, value: \u0026#039;1\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.all.log_martians\u0026#039;, value: \u0026#039;1\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.default.log_martians\u0026#039;, value: \u0026#039;1\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.all.send_redirects\u0026#039;, value: \u0026#039;0\u0026#039; }\n        - { key: \u0026#039;net.ipv4.conf.default.send_redirects\u0026#039;, value: \u0026#039;0\u0026#039; }\n\n    # File integrity monitoring\n    - name: Initialize AIDE database\n      shell: |\n        aide --init\n        mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db\n      args:\n        creates: /var/lib/aide/aide.db\n\n    - name: Schedule AIDE integrity checks\n      cron:\n        name: \u0026quot;AIDE integrity check\u0026quot;\n        minute: \u0026quot;0\u0026quot;\n        hour: \u0026quot;3\u0026quot;\n        job: \u0026quot;/usr/bin/aide --check\u0026quot;\n        user: root\n\n  handlers:\n    - name: daemon reload\n      systemd:\n        daemon_reload: yes\n\n    - name: restart node_exporter\n      service:\n        name: node_exporter\n        state: restarted\n        enabled: yes\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"advanced-role-development\" class=\"mobile-header\"\u003eAdvanced Role Development\u003c/h2\u003e\n\u003ch3 id=\"comprehensive-nginx-role\" class=\"mobile-header\"\u003eComprehensive NGINX Role\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create NGINX role structure\nansible-galaxy init roles/nginx\n\n# Main tasks\ncat \u0026gt; roles/nginx/tasks/main.yml \u0026lt;\u0026lt;EOF\n---\n# NGINX Installation and Configuration Role\n- name: Include OS-specific variables\n  include_vars: \u0026quot;{{ ansible_os_family }}.yml\u0026quot;\n\n- name: Install NGINX\n  include_tasks: \u0026quot;install-{{ ansible_os_family }}.yml\u0026quot;\n\n- name: Create NGINX directories\n  file:\n    path: \u0026quot;{{ item }}\u0026quot;\n    state: directory\n    owner: root\n    group: root\n    mode: \u0026#039;0755\u0026#039;\n  loop:\n    - /etc/nginx/sites-available\n    - /etc/nginx/sites-enabled\n    - /etc/nginx/conf.d\n    - /var/log/nginx\n    - /var/cache/nginx\n\n- name: Generate DH parameters\n  openssl_dhparam:\n    path: /etc/ssl/certs/dhparam.pem\n    size: 2048\n  when: nginx_ssl_enabled | default(false)\n\n- name: Deploy NGINX main configuration\n  template:\n    src: nginx.conf.j2\n    dest: /etc/nginx/nginx.conf\n    backup: yes\n    validate: \u0026#039;nginx -t -c %s\u0026#039;\n  notify: reload nginx\n\n- name: Deploy virtual host configurations\n  template:\n    src: vhost.conf.j2\n    dest: \u0026quot;/etc/nginx/sites-available/{{ item.name }}.conf\u0026quot;\n    backup: yes\n  loop: \u0026quot;{{ nginx_vhosts | default([]) }}\u0026quot;\n  notify: reload nginx\n\n- name: Enable virtual hosts\n  file:\n    src: \u0026quot;/etc/nginx/sites-available/{{ item.name }}.conf\u0026quot;\n    dest: \u0026quot;/etc/nginx/sites-enabled/{{ item.name }}.conf\u0026quot;\n    state: link\n  loop: \u0026quot;{{ nginx_vhosts | default([]) }}\u0026quot;\n  when: item.enabled | default(true)\n  notify: reload nginx\n\n- name: Remove default site\n  file:\n    path: /etc/nginx/sites-enabled/default\n    state: absent\n  notify: reload nginx\n\n- name: Start and enable NGINX\n  service:\n    name: nginx\n    state: started\n    enabled: yes\n\n- name: Configure log rotation\n  template:\n    src: nginx-logrotate.j2\n    dest: /etc/logrotate.d/nginx\n    mode: \u0026#039;0644\u0026#039;\n\n- name: Setup NGINX monitoring\n  include_tasks: monitoring.yml\n  when: nginx_monitoring_enabled | default(false)\n\n- name: Configure SSL certificates\n  include_tasks: ssl.yml\n  when: nginx_ssl_enabled | default(false)\nEOF\n\n# OS-specific installation tasks\ncat \u0026gt; roles/nginx/tasks/install-Debian.yml \u0026lt;\u0026lt;EOF\n---\n- name: Add NGINX signing key (Debian/Ubuntu)\n  apt_key:\n    url: https://nginx.org/keys/nginx_signing.key\n    state: present\n\n- name: Add NGINX repository (Debian/Ubuntu)\n  apt_repository:\n    repo: \u0026quot;deb https://nginx.org/packages/{{ ansible_distribution | lower }}/ {{ ansible_distribution_release }} nginx\u0026quot;\n    state: present\n\n- name: Install NGINX (Debian/Ubuntu)\n  apt:\n    name: nginx\n    state: present\n    update_cache: yes\nEOF\n\ncat \u0026gt; roles/nginx/tasks/install-RedHat.yml \u0026lt;\u0026lt;EOF\n---\n- name: Add NGINX repository (RHEL/CentOS)\n  yum_repository:\n    name: nginx\n    description: NGINX Repository\n    baseurl: \u0026quot;https://nginx.org/packages/centos/{{ ansible_distribution_major_version }}/$basearch/\u0026quot;\n    gpgcheck: yes\n    gpgkey: https://nginx.org/keys/nginx_signing.key\n    enabled: yes\n\n- name: Install NGINX (RHEL/CentOS)\n  yum:\n    name: nginx\n    state: present\nEOF\n\n# Variables\ncat \u0026gt; roles/nginx/vars/main.yml \u0026lt;\u0026lt;EOF\n---\nnginx_user: nginx\nnginx_worker_processes: auto\nnginx_worker_connections: 1024\nnginx_keepalive_timeout: 65\nnginx_ssl_enabled: false\nnginx_monitoring_enabled: true\n\nnginx_security_headers:\n  - \u0026quot;add_header X-Frame-Options SAMEORIGIN always;\u0026quot;\n  - \u0026quot;add_header X-Content-Type-Options nosniff always;\u0026quot;\n  - \u0026quot;add_header X-XSS-Protection \u0026#039;1; mode=block\u0026#039; always;\u0026quot;\n  - \u0026quot;add_header Strict-Transport-Security \u0026#039;max-age=31536000; includeSubDomains\u0026#039; always;\u0026quot;\n\nnginx_default_vhost:\n  name: default\n  listen: 80\n  server_name: \u0026quot;_\u0026quot;\n  root: /var/www/html\n  index: index.html\n  enabled: false\nEOF\n\n# Templates\ncat \u0026gt; roles/nginx/templates/nginx.conf.j2 \u0026lt;\u0026lt;EOF\nuser {{ nginx_user }};\nworker_processes {{ nginx_worker_processes }};\npid /var/run/nginx.pid;\n\nevents {\n    worker_connections {{ nginx_worker_connections }};\n    use epoll;\n    multi_accept on;\n}\n\nhttp {\n    # Basic settings\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n    keepalive_timeout {{ nginx_keepalive_timeout }};\n    types_hash_max_size 2048;\n    server_tokens off;\n\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n\n    # SSL configuration\n{% if nginx_ssl_enabled %}\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_prefer_server_ciphers off;\n    ssl_dhparam /etc/ssl/certs/dhparam.pem;\n{% endif %}\n\n    # Gzip compression\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types\n        application/javascript\n        application/json\n        application/xml\n        text/css\n        text/javascript\n        text/xml\n        text/plain;\n\n    # Security headers\n{% for header in nginx_security_headers %}\n    {{ header }}\n{% endfor %}\n\n    # Logging\n    log_format main \u0026#039;\\$remote_addr - \\$remote_user [\\$time_local] \u0026quot;\\$request\u0026quot; \u0026#039;\n                    \u0026#039;\\$status \\$body_bytes_sent \u0026quot;\\$http_referer\u0026quot; \u0026#039;\n                    \u0026#039;\u0026quot;\\$http_user_agent\u0026quot; \u0026quot;\\$http_x_forwarded_for\u0026quot;\u0026#039;;\n\n    access_log /var/log/nginx/access.log main;\n    error_log /var/log/nginx/error.log;\n\n    # Rate limiting\n    limit_req_zone \\$binary_remote_addr zone=login:10m rate=10r/m;\n    limit_conn_zone \\$binary_remote_addr zone=addr:10m;\n\n    # Include configurations\n    include /etc/nginx/conf.d/*.conf;\n    include /etc/nginx/sites-enabled/*;\n}\nEOF\n\n# Handlers\ncat \u0026gt; roles/nginx/handlers/main.yml \u0026lt;\u0026lt;EOF\n---\n- name: restart nginx\n  service:\n    name: nginx\n    state: restarted\n\n- name: reload nginx\n  service:\n    name: nginx\n    state: reloaded\n\n- name: validate nginx config\n  command: nginx -t\n  changed_when: false\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"security-and-compliance\" class=\"mobile-header\"\u003eSecurity and Compliance\u003c/h2\u003e\n\u003ch3 id=\"ansible-security-scanner-integration\" class=\"mobile-header\"\u003eAnsible Security Scanner Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create security scanning playbook\ncat \u0026gt; playbooks/security-scan.yml \u0026lt;\u0026lt;EOF\n---\n- name: Security Compliance Scanning\n  hosts: all\n  become: yes\n  gather_facts: yes\n  vars:\n    scan_results_dir: \u0026quot;/tmp/security-scans\u0026quot;\n    \n  tasks:\n    - name: Create scan results directory\n      file:\n        path: \u0026quot;{{ scan_results_dir }}\u0026quot;\n        state: directory\n        mode: \u0026#039;0755\u0026#039;\n\n    # CIS benchmark scanning\n    - name: Download CIS benchmark script\n      get_url:\n        url: \u0026quot;https://github.com/dev-sec/cis-dil-benchmark/archive/master.zip\u0026quot;\n        dest: \u0026quot;/tmp/cis-benchmark.zip\u0026quot;\n        mode: \u0026#039;0644\u0026#039;\n\n    - name: Run CIS benchmark scan\n      shell: |\n        cd /tmp\n        unzip -o cis-benchmark.zip\n        cd cis-dil-benchmark-master\n        bash cis_ubuntu2204.sh \u0026gt; {{ scan_results_dir }}/cis-scan-{{ inventory_hostname }}.txt\n      args:\n        creates: \u0026quot;{{ scan_results_dir }}/cis-scan-{{ inventory_hostname }}.txt\u0026quot;\n\n    # Lynis security audit\n    - name: Install Lynis\n      package:\n        name: lynis\n        state: present\n\n    - name: Run Lynis security audit\n      command: lynis audit system --quiet --cronjob\n      register: lynis_result\n      changed_when: false\n\n    - name: Save Lynis results\n      copy:\n        content: \u0026quot;{{ lynis_result.stdout }}\u0026quot;\n        dest: \u0026quot;{{ scan_results_dir }}/lynis-scan-{{ inventory_hostname }}.txt\u0026quot;\n        mode: \u0026#039;0644\u0026#039;\n\n    # OpenSCAP compliance scanning\n    - name: Install OpenSCAP (RHEL/CentOS)\n      package:\n        name:\n          - openscap-scanner\n          - scap-security-guide\n        state: present\n      when: ansible_os_family == \u0026quot;RedHat\u0026quot;\n\n    - name: Install OpenSCAP (Debian/Ubuntu)\n      package:\n        name:\n          - libopenscap8\n          - ssg-debian\n        state: present\n      when: ansible_os_family == \u0026quot;Debian\u0026quot;\n\n    - name: Run OpenSCAP scan\n      shell: |\n        oscap xccdf eval --profile xccdf_org.ssgproject.content_profile_standard \\\n          --results {{ scan_results_dir }}/oscap-results-{{ inventory_hostname }}.xml \\\n          --report {{ scan_results_dir }}/oscap-report-{{ inventory_hostname }}.html \\\n          /usr/share/xml/scap/ssg/content/ssg-{{ ansible_distribution | lower }}{{ ansible_distribution_major_version }}-xccdf.xml\n      ignore_errors: yes\n      when: ansible_os_family in [\u0026quot;RedHat\u0026quot;, \u0026quot;Debian\u0026quot;]\n\n    # Vulnerability scanning with Trivy\n    - name: Install Trivy vulnerability scanner\n      shell: |\n        curl -sfL https://raw.githubusercontent.com/aquasecurity/trivy/main/contrib/install.sh | sh -s -- -b /usr/local/bin\n      args:\n        creates: /usr/local/bin/trivy\n\n    - name: Run Trivy filesystem scan\n      shell: |\n        trivy fs --format json --output {{ scan_results_dir }}/trivy-scan-{{ inventory_hostname }}.json /\n      ignore_errors: yes\n\n    # Collect scan results\n    - name: Fetch scan results to control machine\n      fetch:\n        src: \u0026quot;{{ item }}\u0026quot;\n        dest: \u0026quot;./security-reports/{{ inventory_hostname }}/\u0026quot;\n        flat: yes\n      loop:\n        - \u0026quot;{{ scan_results_dir }}/cis-scan-{{ inventory_hostname }}.txt\u0026quot;\n        - \u0026quot;{{ scan_results_dir }}/lynis-scan-{{ inventory_hostname }}.txt\u0026quot;\n        - \u0026quot;{{ scan_results_dir }}/oscap-report-{{ inventory_hostname }}.html\u0026quot;\n        - \u0026quot;{{ scan_results_dir }}/trivy-scan-{{ inventory_hostname }}.json\u0026quot;\n      ignore_errors: yes\n      delegate_to: localhost\n\n  post_tasks:\n    - name: Generate compliance summary\n      template:\n        src: templates/compliance-summary.j2\n        dest: \u0026quot;{{ scan_results_dir }}/compliance-summary-{{ inventory_hostname }}.txt\u0026quot;\n        mode: \u0026#039;0644\u0026#039;\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ansible-awxtower-integration\" class=\"mobile-header\"\u003eAnsible AWX/Tower Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Ansible AWX (open source)\ncat \u0026gt; playbooks/install-awx.yml \u0026lt;\u0026lt;EOF\n---\n- name: Install Ansible AWX\n  hosts: localhost\n  connection: local\n  become: yes\n  vars:\n    awx_namespace: awx\n    awx_admin_user: admin\n    awx_admin_password: \u0026quot;{{ vault_awx_admin_password }}\u0026quot;\n\n  tasks:\n    - name: Install prerequisite packages\n      package:\n        name:\n          - git\n          - curl\n          - docker.io\n          - docker-compose\n        state: present\n\n    - name: Clone AWX repository\n      git:\n        repo: https://github.com/ansible/awx.git\n        dest: /opt/awx\n        version: devel\n\n    - name: Create AWX Docker inventory\n      template:\n        src: templates/awx-docker-inventory.j2\n        dest: /opt/awx/installer/inventory\n        mode: \u0026#039;0644\u0026#039;\n\n    - name: Install AWX using Ansible\n      shell: ansible-playbook -i inventory install.yml\n      args:\n        chdir: /opt/awx/installer\n      environment:\n        ANSIBLE_HOST_KEY_CHECKING: False\n\n    - name: Wait for AWX to be ready\n      uri:\n        url: \u0026quot;http://localhost:80/api/v2/ping/\u0026quot;\n        method: GET\n      retries: 30\n      delay: 10\n\n    - name: Configure AWX organizations and projects\n      uri:\n        url: \u0026quot;http://localhost:80/api/v2/organizations/\u0026quot;\n        method: POST\n        user: \u0026quot;{{ awx_admin_user }}\u0026quot;\n        password: \u0026quot;{{ awx_admin_password }}\u0026quot;\n        force_basic_auth: yes\n        body_format: json\n        body:\n          name: \u0026quot;Production\u0026quot;\n          description: \u0026quot;Production environment organization\u0026quot;\n        status_code: [200, 201, 409]\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"multi-cloud-automation\" class=\"mobile-header\"\u003eMulti-Cloud Automation\u003c/h2\u003e\n\u003ch3 id=\"aws-infrastructure-automation\" class=\"mobile-header\"\u003eAWS Infrastructure Automation\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecat \u0026gt; playbooks/aws-infrastructure.yml \u0026lt;\u0026lt;EOF\n---\n- name: AWS Infrastructure Automation\n  hosts: localhost\n  connection: local\n  gather_facts: no\n  vars:\n    aws_region: \u0026quot;{{ aws_region | default(\u0026#039;us-west-2\u0026#039;) }}\u0026quot;\n    vpc_cidr: \u0026quot;{{ vpc_cidr | default(\u0026#039;10.0.0.0/16\u0026#039;) }}\u0026quot;\n    environment: \u0026quot;{{ environment | default(\u0026#039;production\u0026#039;) }}\u0026quot;\n\n  tasks:\n    # VPC Creation\n    - name: Create VPC\n      amazon.aws.ec2_vpc_info:\n        filters:\n          \u0026quot;tag:Name\u0026quot;: \u0026quot;{{ environment }}-vpc\u0026quot;\n        region: \u0026quot;{{ aws_region }}\u0026quot;\n      register: existing_vpc\n\n    - name: Create new VPC if not exists\n      amazon.aws.ec2_vpc_net:\n        name: \u0026quot;{{ environment }}-vpc\u0026quot;\n        cidr_block: \u0026quot;{{ vpc_cidr }}\u0026quot;\n        region: \u0026quot;{{ aws_region }}\u0026quot;\n        state: present\n        dns_hostnames: yes\n        dns_support: yes\n        tags:\n          Environment: \u0026quot;{{ environment }}\u0026quot;\n          ManagedBy: ansible\n      register: vpc\n      when: existing_vpc.vpcs | length == 0\n\n    # Security Groups\n    - name: Create web security group\n      amazon.aws.ec2_group:\n        name: \u0026quot;{{ environment }}-web-sg\u0026quot;\n        description: \u0026quot;Security group for web servers\u0026quot;\n        vpc_id: \u0026quot;{{ vpc.vpc.id if vpc.vpc is defined else existing_vpc.vpcs[0].vpc_id }}\u0026quot;\n        region: \u0026quot;{{ aws_region }}\u0026quot;\n        rules:\n          - proto: tcp\n            ports:\n              - 80\n              - 443\n            cidr_ip: 0.0.0.0/0\n            rule_desc: \u0026quot;HTTP and HTTPS access\u0026quot;\n          - proto: tcp\n            ports:\n              - 22\n            group_id: \u0026quot;{{ environment }}-bastion-sg\u0026quot;\n            rule_desc: \u0026quot;SSH from bastion\u0026quot;\n        tags:\n          Environment: \u0026quot;{{ environment }}\u0026quot;\n\n    # Launch EC2 instances\n    - name: Launch web servers\n      amazon.aws.ec2_instance:\n        name: \u0026quot;{{ environment }}-web-{{ item }}\u0026quot;\n        instance_type: t3.medium\n        image_id: ami-0c02fb55956c7d316  # Amazon Linux 2\n        key_name: \u0026quot;{{ ec2_key_name }}\u0026quot;\n        vpc_subnet_id: \u0026quot;{{ web_subnet_id }}\u0026quot;\n        security_groups:\n          - \u0026quot;{{ environment }}-web-sg\u0026quot;\n        region: \u0026quot;{{ aws_region }}\u0026quot;\n        state: running\n        wait: yes\n        wait_timeout: 300\n        user_data: |\n          #!/bin/bash\n          yum update -y\n          yum install -y python3\n        tags:\n          Environment: \u0026quot;{{ environment }}\u0026quot;\n          Role: webserver\n          Ansible: managed\n      loop: \u0026quot;{{ range(1, web_server_count + 1) | list }}\u0026quot;\n      register: web_instances\n\n    # Add instances to inventory\n    - name: Add web servers to inventory\n      add_host:\n        name: \u0026quot;{{ item.instances[0].tags.Name }}\u0026quot;\n        hostname: \u0026quot;{{ item.instances[0].public_ip_address }}\u0026quot;\n        groups: webservers\n        ansible_ssh_private_key_file: \u0026quot;~/.ssh/{{ ec2_key_name }}.pem\u0026quot;\n        ansible_user: ec2-user\n      loop: \u0026quot;{{ web_instances.results }}\u0026quot;\n      changed_when: false\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"kubernetes-cluster-management\" class=\"mobile-header\"\u003eKubernetes Cluster Management\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecat \u0026gt; playbooks/k8s-cluster-management.yml \u0026lt;\u0026lt;EOF\n---\n- name: Kubernetes Cluster Management with Ansible\n  hosts: k8s_masters\n  become: yes\n  serial: 1\n  vars:\n    k8s_version: \u0026quot;1.28.2\u0026quot;\n    containerd_version: \u0026quot;1.6.24\u0026quot;\n    cni_version: \u0026quot;1.3.0\u0026quot;\n\n  tasks:\n    # Pre-flight checks\n    - name: Check system requirements\n      assert:\n        that:\n          - ansible_memtotal_mb \u0026gt;= 1700\n          - ansible_processor_cores \u0026gt;= 2\n        fail_msg: \u0026quot;System doesn\u0026#039;t meet minimum requirements\u0026quot;\n\n    - name: Verify connectivity to all nodes\n      ping:\n      delegate_to: \u0026quot;{{ item }}\u0026quot;\n      loop: \u0026quot;{{ groups[\u0026#039;k8s_all\u0026#039;] }}\u0026quot;\n\n    # Container runtime setup\n    - name: Install containerd\n      include_role:\n        name: containerd\n      vars:\n        containerd_version: \u0026quot;{{ containerd_version }}\u0026quot;\n\n    # Kubernetes installation\n    - name: Install Kubernetes components\n      include_role:\n        name: kubernetes\n      vars:\n        kubernetes_version: \u0026quot;{{ k8s_version }}\u0026quot;\n\n    # Cluster initialization\n    - name: Initialize Kubernetes cluster\n      shell: |\n        kubeadm init \\\n          --pod-network-cidr=10.244.0.0/16 \\\n          --service-cidr=10.96.0.0/12 \\\n          --apiserver-advertise-address={{ ansible_default_ipv4.address }} \\\n          --node-name={{ inventory_hostname }}\n      args:\n        creates: /etc/kubernetes/admin.conf\n      register: kubeadm_init\n\n    - name: Create .kube directory\n      file:\n        path: \u0026quot;{{ ansible_env.HOME }}/.kube\u0026quot;\n        state: directory\n        mode: \u0026#039;0755\u0026#039;\n\n    - name: Copy admin.conf to user\u0026#039;s kube config\n      copy:\n        src: /etc/kubernetes/admin.conf\n        dest: \u0026quot;{{ ansible_env.HOME }}/.kube/config\u0026quot;\n        owner: \u0026quot;{{ ansible_user }}\u0026quot;\n        group: \u0026quot;{{ ansible_user }}\u0026quot;\n        mode: \u0026#039;0644\u0026#039;\n        remote_src: yes\n\n    # Network plugin installation\n    - name: Install Flannel CNI\n      shell: kubectl apply -f https://github.com/flannel-io/flannel/releases/latest/download/kube-flannel.yml\n      environment:\n        KUBECONFIG: \u0026quot;{{ ansible_env.HOME }}/.kube/config\u0026quot;\n\n    # Join worker nodes\n    - name: Get join command\n      shell: kubeadm token create --print-join-command\n      register: join_command\n      when: inventory_hostname in groups[\u0026#039;k8s_masters\u0026#039;][0]\n\n    - name: Join worker nodes to cluster\n      shell: \u0026quot;{{ hostvars[groups[\u0026#039;k8s_masters\u0026#039;][0]][\u0026#039;join_command\u0026#039;].stdout }}\u0026quot;\n      when: inventory_hostname in groups[\u0026#039;k8s_workers\u0026#039;]\n\n  post_tasks:\n    - name: Verify cluster status\n      shell: kubectl get nodes\n      environment:\n        KUBECONFIG: \u0026quot;{{ ansible_env.HOME }}/.kube/config\u0026quot;\n      register: cluster_status\n      when: inventory_hostname in groups[\u0026#039;k8s_masters\u0026#039;][0]\n\n    - name: Display cluster status\n      debug:\n        var: cluster_status.stdout_lines\n      when: inventory_hostname in groups[\u0026#039;k8s_masters\u0026#039;][0]\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"performance-optimization-and-scaling\" class=\"mobile-header\"\u003ePerformance Optimization and Scaling\u003c/h2\u003e\n\u003ch3 id=\"parallel-execution-strategies\" class=\"mobile-header\"\u003eParallel Execution Strategies\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create high-performance playbook configuration\ncat \u0026gt; playbooks/high-performance-deployment.yml \u0026lt;\u0026lt;EOF\n---\n- name: High-Performance Deployment\n  hosts: all\n  become: yes\n  strategy: free  # Parallel execution\n  serial: \u0026quot;30%\u0026quot;   # Process 30% of hosts at a time\n  max_fail_percentage: 10\n  gather_facts: yes\n  fact_caching: smart\n  vars:\n    deployment_batch_size: 10\n    max_concurrent_tasks: 50\n\n  pre_tasks:\n    - name: Check system load\n      shell: uptime | awk \u0026#039;{print $(NF-2)}\u0026#039; | sed \u0026#039;s/,//\u0026#039;\n      register: system_load\n      changed_when: false\n\n    - name: Skip high-load systems\n      meta: end_host\n      when: system_load.stdout | float \u0026gt; 5.0\n\n  tasks:\n    - name: Update packages with retries\n      package:\n        name: \u0026quot;*\u0026quot;\n        state: latest\n      retries: 3\n      delay: 30\n      async: 300\n      poll: 10\n\n    - name: Deploy configuration files in parallel\n      template:\n        src: \u0026quot;{{ item.src }}\u0026quot;\n        dest: \u0026quot;{{ item.dest }}\u0026quot;\n        mode: \u0026quot;{{ item.mode | default(\u0026#039;0644\u0026#039;) }}\u0026quot;\n        backup: yes\n      loop:\n        - { src: \u0026quot;nginx.conf.j2\u0026quot;, dest: \u0026quot;/etc/nginx/nginx.conf\u0026quot; }\n        - { src: \u0026quot;mysql.cnf.j2\u0026quot;, dest: \u0026quot;/etc/mysql/my.cnf\u0026quot; }\n        - { src: \u0026quot;redis.conf.j2\u0026quot;, dest: \u0026quot;/etc/redis/redis.conf\u0026quot; }\n      async: 120\n      poll: 5\n      register: config_deployment\n\n    - name: Wait for all configuration deployments\n      async_status:\n        jid: \u0026quot;{{ item.ansible_job_id }}\u0026quot;\n      loop: \u0026quot;{{ config_deployment.results }}\u0026quot;\n      when: item.ansible_job_id is defined\n\n  handlers:\n    - name: restart services\n      service:\n        name: \u0026quot;{{ item }}\u0026quot;\n        state: restarted\n      loop:\n        - nginx\n        - mysql\n        - redis\n      listen: \u0026quot;restart all services\u0026quot;\nEOF\n\n# Performance monitoring playbook\ncat \u0026gt; playbooks/performance-monitoring.yml \u0026lt;\u0026lt;EOF\n---\n- name: Performance Monitoring Setup\n  hosts: all\n  become: yes\n  vars:\n    monitoring_tools:\n      - htop\n      - iotop\n      - nethogs\n      - dstat\n      - sysstat\n      - perf\n\n  tasks:\n    - name: Install performance monitoring tools\n      package:\n        name: \u0026quot;{{ monitoring_tools }}\u0026quot;\n        state: present\n\n    - name: Configure system monitoring\n      template:\n        src: templates/sysstat.j2\n        dest: /etc/default/sysstat\n        backup: yes\n      when: ansible_os_family == \u0026quot;Debian\u0026quot;\n\n    - name: Enable system statistics collection\n      service:\n        name: \u0026quot;{{ \u0026#039;sysstat\u0026#039; if ansible_os_family == \u0026#039;Debian\u0026#039; else \u0026#039;sysstat\u0026#039; }}\u0026quot;\n        enabled: yes\n        state: started\n\n    - name: Create performance monitoring script\n      template:\n        src: templates/performance-monitor.sh.j2\n        dest: /usr/local/bin/performance-monitor.sh\n        mode: \u0026#039;0755\u0026#039;\n\n    - name: Schedule performance monitoring\n      cron:\n        name: \u0026quot;Performance monitoring\u0026quot;\n        minute: \u0026quot;*/5\u0026quot;\n        job: \u0026quot;/usr/local/bin/performance-monitor.sh\u0026quot;\n        user: root\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"testing-and-validation\" class=\"mobile-header\"\u003eTesting and Validation\u003c/h2\u003e\n\u003ch3 id=\"molecule-testing-framework\" class=\"mobile-header\"\u003eMolecule Testing Framework\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Molecule for role testing\npip install molecule[docker] molecule[vagrant] molecule[libvirt]\n\n# Initialize Molecule in role directory\ncd roles/nginx\nmolecule init scenario --driver-name docker\n\n# Create molecule configuration\ncat \u0026gt; molecule/default/molecule.yml \u0026lt;\u0026lt;EOF\n---\ndependency:\n  name: galaxy\ndriver:\n  name: docker\nplatforms:\n  - name: nginx-ubuntu\n    image: ubuntu:22.04\n    pre_build_image: true\n    privileged: true\n    volumes:\n      - /sys/fs/cgroup:/sys/fs/cgroup:ro\n    command: /lib/systemd/systemd\n    networks:\n      - name: molecule\n  - name: nginx-centos\n    image: centos:8\n    pre_build_image: true\n    privileged: true\n    volumes:\n      - /sys/fs/cgroup:/sys/fs/cgroup:ro\n    command: /usr/sbin/init\n    networks:\n      - name: molecule\nprovisioner:\n  name: ansible\n  config_options:\n    defaults:\n      callbacks_enabled: profile_tasks,timer,yaml\n  inventory:\n    host_vars:\n      nginx-ubuntu:\n        ansible_python_interpreter: /usr/bin/python3\n      nginx-centos:\n        ansible_python_interpreter: /usr/bin/python3\nverifier:\n  name: ansible\nlint: |\n  set -e\n  yamllint .\n  ansible-lint\n  flake8\nEOF\n\n# Create test playbook\ncat \u0026gt; molecule/default/converge.yml \u0026lt;\u0026lt;EOF\n---\n- name: Converge\n  hosts: all\n  become: true\n  tasks:\n    - name: \u0026quot;Include nginx role\u0026quot;\n      include_role:\n        name: nginx\n      vars:\n        nginx_vhosts:\n          - name: default\n            server_name: localhost\n            listen: 80\n            root: /var/www/html\n            enabled: true\nEOF\n\n# Create test verification\ncat \u0026gt; molecule/default/verify.yml \u0026lt;\u0026lt;EOF\n---\n- name: Verify\n  hosts: all\n  gather_facts: false\n  tasks:\n    - name: Check if NGINX is running\n      uri:\n        url: http://localhost\n        method: GET\n      register: nginx_check\n\n    - name: Verify NGINX is responding\n      assert:\n        that:\n          - nginx_check.status == 200\n        fail_msg: \u0026quot;NGINX is not responding correctly\u0026quot;\n\n    - name: Check NGINX configuration\n      shell: nginx -t\n      changed_when: false\n\n    - name: Verify NGINX process\n      shell: pgrep nginx\n      changed_when: false\nEOF\n\n# Run tests\nmolecule test\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ansible-lint-and-security-scanning\" class=\"mobile-header\"\u003eAnsible Lint and Security Scanning\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Ansible Lint\npip install ansible-lint\n\n# Create .ansible-lint configuration\ncat \u0026gt; .ansible-lint \u0026lt;\u0026lt;EOF\n---\nprofile: production\n\nexclude_paths:\n  - .cache/\n  - .github/\n  - molecule/\n  - .venv/\n\nskip_list:\n  - yaml[line-length]  # Allow longer lines for readability\n\nwarn_list:\n  - experimental  # Warn about experimental features\n\n# Custom rules\nrules:\n  braces:\n    min-spaces-inside: 0\n    max-spaces-inside: 1\n  brackets:\n    min-spaces-inside: 0\n    max-spaces-inside: 0\n  colons:\n    max-spaces-before: 0\n    min-spaces-after: 1\n    max-spaces-after: 1\n  commas:\n    max-spaces-before: 0\n    min-spaces-after: 1\n    max-spaces-after: 1\n  comments:\n    min-spaces-from-content: 1\n  document-start: disable\n  empty-lines:\n    max: 2\n    max-start: 0\n    max-end: 1\n  hyphens:\n    max-spaces-after: 1\n  indentation:\n    spaces: 2\n    indent-sequences: true\n  line-length:\n    max: 120\n  new-line-at-end-of-file: enable\n  trailing-spaces: enable\n  truthy:\n    allowed-values: [\u0026#039;true\u0026#039;, \u0026#039;false\u0026#039;, \u0026#039;yes\u0026#039;, \u0026#039;no\u0026#039;]\nEOF\n\n# Create security-focused playbook linting\ncat \u0026gt; .yamllint \u0026lt;\u0026lt;EOF\n---\nextends: default\n\nrules:\n  braces:\n    min-spaces-inside: 0\n    max-spaces-inside: 1\n  brackets:\n    min-spaces-inside: 0\n    max-spaces-inside: 0\n  colons:\n    max-spaces-before: 0\n    min-spaces-after: 1\n    max-spaces-after: 1\n  commas:\n    max-spaces-before: 0\n    min-spaces-after: 1\n    max-spaces-after: 1\n  comments: disable\n  comments-indentation: disable\n  document-start: disable\n  empty-lines:\n    max: 2\n    max-start: 0\n    max-end: 1\n  hyphens:\n    max-spaces-after: 1\n  indentation:\n    spaces: 2\n    indent-sequences: true\n    check-multi-line-strings: false\n  key-duplicates: enable\n  line-length:\n    max: 120\n  new-line-at-end-of-file: enable\n  octal-values:\n    forbid-implicit-octal: true\n  trailing-spaces: enable\n  truthy: disable\nEOF\n\n# Run linting\nansible-lint playbooks/\nyamllint .\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-and-disaster-recovery\" class=\"mobile-header\"\u003eBackup and Disaster Recovery\u003c/h2\u003e\n\u003ch3 id=\"comprehensive-backup-automation\" class=\"mobile-header\"\u003eComprehensive Backup Automation\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecat \u0026gt; playbooks/backup-automation.yml \u0026lt;\u0026lt;EOF\n---\n- name: Automated Backup System\n  hosts: all\n  become: yes\n  vars:\n    backup_root: /backup\n    backup_retention_days: 30\n    backup_schedule:\n      databases: \u0026quot;0 2 * * *\u0026quot;\n      files: \u0026quot;0 3 * * *\u0026quot;\n      configs: \u0026quot;0 4 * * *\u0026quot;\n\n  tasks:\n    - name: Create backup directories\n      file:\n        path: \u0026quot;{{ backup_root }}/{{ item }}\u0026quot;\n        state: directory\n        mode: \u0026#039;0755\u0026#039;\n        owner: root\n        group: root\n      loop:\n        - databases\n        - files\n        - configs\n        - logs\n\n    # Database backups\n    - name: Create database backup script\n      template:\n        src: templates/mysql-backup.sh.j2\n        dest: /usr/local/bin/mysql-backup.sh\n        mode: \u0026#039;0755\u0026#039;\n      when: \u0026quot;\u0026#039;dbservers\u0026#039; in group_names\u0026quot;\n\n    - name: Schedule database backups\n      cron:\n        name: \u0026quot;MySQL backup\u0026quot;\n        minute: \u0026quot;0\u0026quot;\n        hour: \u0026quot;2\u0026quot;\n        job: \u0026quot;/usr/local/bin/mysql-backup.sh\u0026quot;\n        user: root\n      when: \u0026quot;\u0026#039;dbservers\u0026#039; in group_names\u0026quot;\n\n    # File system backups\n    - name: Create file backup script\n      template:\n        src: templates/file-backup.sh.j2\n        dest: /usr/local/bin/file-backup.sh\n        mode: \u0026#039;0755\u0026#039;\n\n    - name: Schedule file backups\n      cron:\n        name: \u0026quot;File system backup\u0026quot;\n        minute: \u0026quot;0\u0026quot;\n        hour: \u0026quot;3\u0026quot;\n        job: \u0026quot;/usr/local/bin/file-backup.sh\u0026quot;\n        user: root\n\n    # Configuration backups\n    - name: Backup system configurations\n      archive:\n        path:\n          - /etc/nginx\n          - /etc/mysql\n          - /etc/systemd/system\n          - /etc/crontab\n          - /etc/hosts\n          - /etc/fstab\n        dest: \u0026quot;{{ backup_root }}/configs/system-config-{{ ansible_date_time.epoch }}.tar.gz\u0026quot;\n        mode: \u0026#039;0600\u0026#039;\n\n    # Remote backup synchronization\n    - name: Synchronize backups to remote storage\n      synchronize:\n        src: \u0026quot;{{ backup_root }}/\u0026quot;\n        dest: \u0026quot;backup-server.example.com:{{ backup_root }}/{{ inventory_hostname }}/\u0026quot;\n        delete: yes\n        rsync_opts:\n          - \u0026quot;--exclude=*.tmp\u0026quot;\n          - \u0026quot;--compress\u0026quot;\n          - \u0026quot;--archive\u0026quot;\n      when: backup_remote_sync | default(true)\n\n    # Cleanup old backups\n    - name: Clean up old backup files\n      find:\n        paths: \u0026quot;{{ backup_root }}\u0026quot;\n        age: \u0026quot;{{ backup_retention_days }}d\u0026quot;\n        file_type: file\n      register: old_backups\n\n    - name: Remove old backup files\n      file:\n        path: \u0026quot;{{ item.path }}\u0026quot;\n        state: absent\n      loop: \u0026quot;{{ old_backups.files }}\u0026quot;\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"verification-and-monitoring\" class=\"mobile-header\"\u003eVerification and Monitoring\u003c/h2\u003e\n\u003ch3 id=\"cross-platform-system-verification\" class=\"mobile-header\"\u003eCross-Platform System Verification\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create comprehensive verification playbook\ncat \u0026gt; playbooks/system-verification.yml \u0026lt;\u0026lt;EOF\n---\n- name: System Verification and Health Check\n  hosts: all\n  become: yes\n  gather_facts: yes\n  vars:\n    health_checks:\n      - service: nginx\n        port: 80\n        process: nginx\n      - service: mysql\n        port: 3306\n        process: mysqld\n      - service: redis\n        port: 6379\n        process: redis-server\n\n  tasks:\n    # System information gathering\n    - name: Gather system information\n      setup:\n        gather_subset:\n          - all\n          - !facter\n          - !ohai\n\n    # Service verification\n    - name: Check critical services status\n      service_facts:\n\n    - name: Verify services are running\n      assert:\n        that:\n          - \u0026quot;ansible_facts.services[item.service + \u0026#039;.service\u0026#039;].state == \u0026#039;running\u0026#039;\u0026quot;\n        fail_msg: \u0026quot;Service {{ item.service }} is not running\u0026quot;\n        success_msg: \u0026quot;Service {{ item.service }} is healthy\u0026quot;\n      loop: \u0026quot;{{ health_checks }}\u0026quot;\n      when: \u0026quot;item.service + \u0026#039;.service\u0026#039; in ansible_facts.services\u0026quot;\n\n    # Network connectivity tests\n    - name: Test network connectivity\n      wait_for:\n        host: \u0026quot;{{ item.host }}\u0026quot;\n        port: \u0026quot;{{ item.port }}\u0026quot;\n        timeout: 5\n      loop:\n        - { host: \u0026quot;8.8.8.8\u0026quot;, port: 53 }\n        - { host: \u0026quot;1.1.1.1\u0026quot;, port: 53 }\n      ignore_errors: yes\n\n    # Disk space monitoring\n    - name: Check disk space usage\n      shell: df -h | awk \u0026#039;$5 \u0026gt; \u0026quot;85%\u0026quot; {print $0}\u0026#039;\n      register: disk_usage\n      changed_when: false\n      failed_when: disk_usage.stdout != \u0026quot;\u0026quot;\n\n    # Memory usage check\n    - name: Check memory usage\n      shell: free | grep Mem | awk \u0026#039;{printf \u0026quot;%.0f\u0026quot;, $3/$2 * 100.0}\u0026#039;\n      register: memory_usage\n      changed_when: false\n\n    - name: Alert on high memory usage\n      debug:\n        msg: \u0026quot;WARNING: Memory usage is {{ memory_usage.stdout }}%\u0026quot;\n      when: memory_usage.stdout | int \u0026gt; 85\n\n    # Security verification\n    - name: Check for failed login attempts\n      shell: grep \u0026quot;Failed password\u0026quot; /var/log/auth.log | tail -10\n      register: failed_logins\n      changed_when: false\n      ignore_errors: yes\n      when: ansible_os_family == \u0026quot;Debian\u0026quot;\n\n    - name: Check firewall status\n      shell: |\n        if command -v ufw \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n          ufw status\n        elif command -v firewall-cmd \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n          firewall-cmd --state\n        else\n          echo \u0026quot;No supported firewall found\u0026quot;\n        fi\n      register: firewall_status\n      changed_when: false\n\n  post_tasks:\n    - name: Generate system health report\n      template:\n        src: templates/health-report.j2\n        dest: \u0026quot;/tmp/health-report-{{ inventory_hostname }}-{{ ansible_date_time.epoch }}.txt\u0026quot;\n        mode: \u0026#039;0644\u0026#039;\n\n    - name: Fetch health reports\n      fetch:\n        src: \u0026quot;/tmp/health-report-{{ inventory_hostname }}-{{ ansible_date_time.epoch }}.txt\u0026quot;\n        dest: \u0026quot;./reports/\u0026quot;\n        flat: yes\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"continuous-compliance-monitoring\" class=\"mobile-header\"\u003eContinuous Compliance Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecat \u0026gt; playbooks/compliance-monitoring.yml \u0026lt;\u0026lt;EOF\n---\n- name: Continuous Compliance Monitoring\n  hosts: all\n  become: yes\n  vars:\n    compliance_standards:\n      - cis\n      - pci_dss\n      - soc2\n      - hipaa\n    \n    audit_log_paths:\n      - /var/log/auth.log\n      - /var/log/syslog\n      - /var/log/audit/audit.log\n\n  tasks:\n    # Install audit tools\n    - name: Install audit daemon\n      package:\n        name: \u0026quot;{{ \u0026#039;auditd\u0026#039; if ansible_os_family == \u0026#039;RedHat\u0026#039; else \u0026#039;auditd\u0026#039; }}\u0026quot;\n        state: present\n\n    - name: Configure audit rules\n      template:\n        src: templates/audit.rules.j2\n        dest: /etc/audit/rules.d/audit.rules\n        backup: yes\n      notify: restart auditd\n\n    # CIS compliance checks\n    - name: Run CIS benchmark checks\n      shell: |\n        if [ -f /opt/cis-cat/CIS-CAT.sh ]; then\n          /opt/cis-cat/CIS-CAT.sh -b /opt/cis-cat/benchmarks/\n        else\n          echo \u0026quot;CIS-CAT not installed, skipping\u0026quot;\n        fi\n      register: cis_results\n      ignore_errors: yes\n\n    # File integrity monitoring\n    - name: Install AIDE\n      package:\n        name: aide\n        state: present\n\n    - name: Initialize AIDE database\n      shell: |\n        aide --init\n        mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db\n      args:\n        creates: /var/lib/aide/aide.db\n\n    - name: Schedule AIDE integrity checks\n      cron:\n        name: \u0026quot;AIDE integrity check\u0026quot;\n        minute: \u0026quot;0\u0026quot;\n        hour: \u0026quot;3\u0026quot;\n        job: \u0026quot;/usr/bin/aide --check | mail -s \u0026#039;AIDE Report\u0026#039; security@example.com\u0026quot;\n        user: root\n\n    # Log monitoring\n    - name: Install log monitoring tools\n      package:\n        name:\n          - logwatch\n          - rsyslog\n        state: present\n\n    - name: Configure centralized logging\n      template:\n        src: templates/rsyslog.conf.j2\n        dest: /etc/rsyslog.conf\n        backup: yes\n      notify: restart rsyslog\n\n  handlers:\n    - name: restart auditd\n      service:\n        name: auditd\n        state: restarted\n\n    - name: restart rsyslog\n      service:\n        name: rsyslog\n        state: restarted\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"cicd-integration\" class=\"mobile-header\"\u003eCI/CD Integration\u003c/h2\u003e\n\u003ch3 id=\"jenkins-pipeline-integration\" class=\"mobile-header\"\u003eJenkins Pipeline Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create Jenkinsfile for Ansible automation\ncat \u0026gt; Jenkinsfile \u0026lt;\u0026lt;EOF\npipeline {\n    agent any\n    \n    environment {\n        ANSIBLE_CONFIG = \u0026#039;ansible.cfg\u0026#039;\n        ANSIBLE_HOST_KEY_CHECKING = \u0026#039;False\u0026#039;\n    }\n    \n    stages {\n        stage(\u0026#039;Lint\u0026#039;) {\n            steps {\n                sh \u0026#039;ansible-lint playbooks/\u0026#039;\n                sh \u0026#039;yamllint .\u0026#039;\n            }\n        }\n        \n        stage(\u0026#039;Syntax Check\u0026#039;) {\n            steps {\n                sh \u0026#039;ansible-playbook playbooks/site.yml --syntax-check\u0026#039;\n            }\n        }\n        \n        stage(\u0026#039;Dry Run\u0026#039;) {\n            steps {\n                sh \u0026#039;ansible-playbook playbooks/site.yml --check --diff\u0026#039;\n            }\n        }\n        \n        stage(\u0026#039;Deploy to Staging\u0026#039;) {\n            when {\n                branch \u0026#039;develop\u0026#039;\n            }\n            steps {\n                sh \u0026#039;ansible-playbook -i inventories/staging playbooks/site.yml\u0026#039;\n            }\n        }\n        \n        stage(\u0026#039;Deploy to Production\u0026#039;) {\n            when {\n                branch \u0026#039;main\u0026#039;\n            }\n            steps {\n                input \u0026#039;Deploy to Production?\u0026#039;\n                sh \u0026#039;ansible-playbook -i inventories/production playbooks/site.yml\u0026#039;\n            }\n        }\n        \n        stage(\u0026#039;Verify Deployment\u0026#039;) {\n            steps {\n                sh \u0026#039;ansible-playbook playbooks/system-verification.yml\u0026#039;\n            }\n        }\n    }\n    \n    post {\n        always {\n            archiveArtifacts artifacts: \u0026#039;logs/*.log\u0026#039;, allowEmptyArchive: true\n            publishHTML([\n                allowMissing: false,\n                alwaysLinkToLastBuild: true,\n                keepAll: true,\n                reportDir: \u0026#039;reports\u0026#039;,\n                reportFiles: \u0026#039;*.html\u0026#039;,\n                reportName: \u0026#039;Ansible Report\u0026#039;\n            ])\n        }\n        failure {\n            emailext (\n                subject: \u0026quot;Failed Pipeline: ${env.JOB_NAME} - ${env.BUILD_NUMBER}\u0026quot;,\n                body: \u0026quot;Something is wrong with ${env.BUILD_URL}\u0026quot;,\n                to: \u0026quot;${env.DEFAULT_RECIPIENTS}\u0026quot;\n            )\n        }\n    }\n}\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"gitlab-ci-integration\" class=\"mobile-header\"\u003eGitLab CI Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003ecat \u0026gt; .gitlab-ci.yml \u0026lt;\u0026lt;EOF\nstages:\n  - lint\n  - test\n  - deploy-staging\n  - deploy-production\n\nvariables:\n  ANSIBLE_CONFIG: ansible.cfg\n  ANSIBLE_HOST_KEY_CHECKING: \u0026quot;False\u0026quot;\n\nbefore_script:\n  - pip install ansible ansible-lint yamllint\n  - ansible-galaxy install -r requirements.yml\n\nlint:\n  stage: lint\n  script:\n    - ansible-lint playbooks/\n    - yamllint .\n  rules:\n    - if: \u0026#039;$CI_MERGE_REQUEST_IID\u0026#039;\n    - if: \u0026#039;$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH\u0026#039;\n\nsyntax-check:\n  stage: test\n  script:\n    - ansible-playbook playbooks/site.yml --syntax-check\n    - ansible-playbook playbooks/site.yml --check --diff -i inventories/staging\n  rules:\n    - if: \u0026#039;$CI_MERGE_REQUEST_IID\u0026#039;\n    - if: \u0026#039;$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH\u0026#039;\n\ndeploy-staging:\n  stage: deploy-staging\n  script:\n    - ansible-playbook -i inventories/staging playbooks/site.yml\n  rules:\n    - if: \u0026#039;$CI_COMMIT_BRANCH == \u0026quot;develop\u0026quot;\u0026#039;\n\ndeploy-production:\n  stage: deploy-production\n  script:\n    - ansible-playbook -i inventories/production playbooks/site.yml\n  rules:\n    - if: \u0026#039;$CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH\u0026#039;\n      when: manual\n  environment:\n    name: production\n    url: https://production.example.com\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting-cross-platform\" class=\"mobile-header\"\u003eTroubleshooting (Cross-Platform)\u003c/h2\u003e\n\u003ch3 id=\"common-issues-and-solutions\" class=\"mobile-header\"\u003eCommon Issues and Solutions\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Debug connection issues\nansible all -m ping -vvv\n\n# Check SSH connectivity\nansible all -m setup --ask-pass --ask-become-pass\n\n# Verify inventory\nansible-inventory --list\nansible-inventory --graph\n\n# Test specific host\nansible target-host -m command -a \u0026quot;uptime\u0026quot;\n\n# Check syntax without execution\nansible-playbook playbooks/site.yml --syntax-check\n\n# Dry run with verbose output\nansible-playbook playbooks/site.yml --check --diff -vvv\n\n# Debug variable resolution\nansible-playbook playbooks/site.yml --extra-vars=\u0026quot;debug=true\u0026quot; --tags debug\n\n# Check facts\nansible all -m setup | grep ansible_os_family\n\n# Connection troubleshooting\nssh -vvv user@target-host\n\n# Permission issues\nansible all -m file -a \u0026quot;path=/tmp/test state=touch\u0026quot; --become\n\n# Vault issues\nansible-vault view group_vars/all/vault.yml\n\n# Performance debugging\nansible-playbook playbooks/site.yml --start-at-task=\u0026quot;specific task name\u0026quot;\nansible-playbook playbooks/site.yml --step\n\n# Module testing\nansible localhost -m debug -a \u0026quot;var=hostvars\u0026quot;\nansible localhost -m setup\n\n# Check for syntax errors in roles\nfind roles/ -name \u0026quot;*.yml\u0026quot; -exec ansible-playbook {} --syntax-check \\;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-debugging\" class=\"mobile-header\"\u003eAdvanced Debugging\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable comprehensive logging\nexport ANSIBLE_DEBUG=1\nexport ANSIBLE_VERBOSITY=4\nansible-playbook playbooks/site.yml\n\n# Profile playbook execution\nansible-playbook playbooks/site.yml --extra-vars=\u0026quot;profile_tasks_sort_order=none\u0026quot;\n\n# Memory usage analysis\nansible-playbook playbooks/site.yml --extra-vars=\u0026quot;ansible_python_interpreter=/usr/bin/python3\u0026quot;\n\n# Network debugging\nansible all -m command -a \u0026quot;ss -tulpn\u0026quot;\nansible all -m command -a \u0026quot;netstat -rn\u0026quot;\n\n# Process debugging\nansible all -m command -a \u0026quot;ps aux --sort=-%mem | head -10\u0026quot;\n\n# Disk usage analysis\nansible all -m command -a \u0026quot;df -h\u0026quot;\nansible all -m command -a \u0026quot;du -sh /var/log/*\u0026quot;\n\n# Service debugging\nansible all -m systemd -a \u0026quot;name=nginx\u0026quot; --become\nansible all -m command -a \u0026quot;systemctl status nginx\u0026quot; --become\n\n# Variable debugging\nansible-playbook playbooks/site.yml --extra-vars=\u0026quot;debug_vars=true\u0026quot; --tags debug_vars\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://docs.ansible.com/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eOfficial Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://galaxy.ansible.com/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eAnsible Galaxy\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://docs.ansible.com/ansible/latest/user_guide/playbooks_best_practices.html\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eBest Practices Guide\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://docs.ansible.com/ansible/latest/user_guide/become.html#security-best-practices\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eSecurity Best Practices\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://molecule.readthedocs.io/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eAnsible Molecule Testing\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://docs.ansible.com/ansible/latest/collections/index.html\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eCommunity Collections\u003c/a\u003e\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection.\u003c/p\u003e","readTime":"31 min","wordCount":6191,"lastBuilt":"2025-09-14T01:30:36.735Z"}]},"__N_SSG":true},"page":"/[category]/[guide]","query":{"category":"infrastructure","guide":"jenkins"},"buildId":"Bpk6_onWDzX5EeMLHWxll","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
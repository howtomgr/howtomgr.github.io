<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/><meta name="theme-color" content="#bd93f9"/><link rel="icon" href="/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><title class="jsx-f92e766e9414ef16">Security Installation Guides - HowToMgr</title><meta name="description" content="6 security installation guides. Security tools and authentication systems" class="jsx-f92e766e9414ef16"/><meta name="keywords" content="installation guides, tutorials, linux, docker, kubernetes, mobile-first, responsive" class="jsx-f92e766e9414ef16"/><meta property="og:title" content="Security Installation Guides - HowToMgr" class="jsx-f92e766e9414ef16"/><meta property="og:description" content="6 security installation guides. Security tools and authentication systems" class="jsx-f92e766e9414ef16"/><meta property="og:type" content="website" class="jsx-f92e766e9414ef16"/><meta property="og:url" content="https://howtomgr.github.io" class="jsx-f92e766e9414ef16"/><meta property="og:image" content="https://howtomgr.github.io/social-preview.png" class="jsx-f92e766e9414ef16"/><meta property="twitter:card" content="summary_large_image" class="jsx-f92e766e9414ef16"/><meta property="twitter:title" content="Security Installation Guides - HowToMgr" class="jsx-f92e766e9414ef16"/><meta property="twitter:description" content="6 security installation guides. Security tools and authentication systems" class="jsx-f92e766e9414ef16"/><meta name="next-head-count" content="17"/><link rel="dns-prefetch" href="//api.github.com"/><link rel="dns-prefetch" href="//github.com"/><link rel="preload" href="/favicon.ico" as="image"/><meta name="application-name" content="HowToMgr"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="default"/><meta name="apple-mobile-web-app-title" content="HowToMgr"/><meta name="format-detection" content="telephone=no"/><meta name="mobile-web-app-capable" content="yes"/><noscript><style>
            .requires-js { display: none !important; }
            .no-js-message { display: block !important; }
          </style></noscript><link rel="preload" href="/_next/static/css/eec6c1c201affe77.css" as="style"/><link rel="stylesheet" href="/_next/static/css/eec6c1c201affe77.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-2b1f7a23d657eae4.js" defer=""></script><script src="/_next/static/chunks/main-6ec3f7584970eebe.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f7367f88af207b64.js" defer=""></script><script src="/_next/static/chunks/119-abfbe7c9e22798da.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcategory%5D-a09421b9c40c6469.js" defer=""></script><script src="/_next/static/FWaJNz_CPEuOjXz3AhtJ8/_buildManifest.js" defer=""></script><script src="/_next/static/FWaJNz_CPEuOjXz3AhtJ8/_ssgManifest.js" defer=""></script><style id="__jsx-fba8d10132152d7">.search-box.jsx-fba8d10132152d7{position:relative;width:100%;max-width:500px}.search-input-container.jsx-fba8d10132152d7{position:relative;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.search-input.jsx-fba8d10132152d7{width:100%;padding:var(--space-3)var(--space-4);padding-right:80px;border:2px solid var(--bg-surface);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg);background:var(--bg-primary);color:var(--text-primary);font-size:var(--font-base);-webkit-transition:var(--transition);-moz-transition:var(--transition);-o-transition:var(--transition);transition:var(--transition);min-height:48px}.search-input.jsx-fba8d10132152d7:focus{border-color:var(--accent-primary);outline:none;-webkit-box-shadow:0 0 0 3px rgba(189,147,249,.15);-moz-box-shadow:0 0 0 3px rgba(189,147,249,.15);box-shadow:0 0 0 3px rgba(189,147,249,.15)}.search-indicator.jsx-fba8d10132152d7{position:absolute;right:50px;color:var(--text-muted);pointer-events:none}.search-clear.jsx-fba8d10132152d7{position:absolute;right:var(--space-3);background:var(--bg-surface);border:none;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;width:24px;height:24px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;cursor:pointer;color:var(--text-muted);font-size:var(--font-sm)}.search-clear.jsx-fba8d10132152d7:hover{background:var(--accent-error);color:var(--bg-primary)}.search-results.jsx-fba8d10132152d7{position:absolute;top:100%;left:0;right:0;background:var(--bg-secondary);border:1px solid var(--bg-surface);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg);-webkit-box-shadow:var(--box-shadow-lg);-moz-box-shadow:var(--box-shadow-lg);box-shadow:var(--box-shadow-lg);max-height:400px;overflow-y:auto;z-index:var(--z-dropdown);margin-top:var(--space-2)}.search-result-item.jsx-fba8d10132152d7{display:block;padding:var(--space-4);border-bottom:1px solid var(--bg-surface);cursor:pointer;-webkit-transition:var(--transition);-moz-transition:var(--transition);-o-transition:var(--transition);transition:var(--transition);text-decoration:none;color:inherit}.search-result-item.jsx-fba8d10132152d7:last-child{border-bottom:none}.search-result-item.jsx-fba8d10132152d7:hover,.search-result-item.selected.jsx-fba8d10132152d7{background:var(--bg-surface);text-decoration:none;color:inherit}.result-header.jsx-fba8d10132152d7{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start;gap:var(--space-3);margin-bottom:var(--space-2)}.result-title.jsx-fba8d10132152d7{color:var(--accent-primary);font-size:var(--font-base);font-weight:600;margin:0}.result-badges.jsx-fba8d10132152d7{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-1)}.result-category.jsx-fba8d10132152d7,.result-language.jsx-fba8d10132152d7{padding:var(--space-1)var(--space-2);-webkit-border-radius:var(--border-radius-sm);-moz-border-radius:var(--border-radius-sm);border-radius:var(--border-radius-sm);font-size:var(--font-xs);font-weight:600;text-transform:uppercase}.result-category.jsx-fba8d10132152d7{background:var(--accent-primary);color:var(--bg-primary)}.result-language.jsx-fba8d10132152d7{background:var(--accent-secondary);color:var(--bg-primary)}.result-description.jsx-fba8d10132152d7{color:var(--text-secondary);font-size:var(--font-sm);margin:0 0 var(--space-2)0;line-height:1.4}.result-meta.jsx-fba8d10132152d7{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-3);font-size:var(--font-xs);color:var(--text-muted)}.search-empty.jsx-fba8d10132152d7{padding:var(--space-6)var(--space-4);text-align:center;color:var(--text-secondary)}.empty-icon.jsx-fba8d10132152d7{font-size:var(--font-2xl);margin-bottom:var(--space-3);opacity:.5}.empty-text.jsx-fba8d10132152d7 strong.jsx-fba8d10132152d7{display:block;color:var(--text-primary);margin-bottom:var(--space-2)}.empty-text.jsx-fba8d10132152d7 p.jsx-fba8d10132152d7{margin:0;font-size:var(--font-sm)}@media(max-width:767px){.search-input.jsx-fba8d10132152d7{min-height:52px;font-size:var(--font-base)}.result-header.jsx-fba8d10132152d7{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start;gap:var(--space-2)}.result-badges.jsx-fba8d10132152d7{-webkit-box-ordinal-group:0;-webkit-order:-1;-moz-box-ordinal-group:0;-ms-flex-order:-1;order:-1}}</style><style id="__jsx-6e7ce48e453c7e27">.breadcrumb.jsx-6e7ce48e453c7e27{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:var(--space-2);margin-bottom:var(--space-6);font-size:var(--font-sm);color:var(--text-secondary)}.breadcrumb.jsx-6e7ce48e453c7e27 a.jsx-6e7ce48e453c7e27{color:var(--accent-primary);text-decoration:none}.breadcrumb.jsx-6e7ce48e453c7e27 a.jsx-6e7ce48e453c7e27:hover{text-decoration:underline}.separator.jsx-6e7ce48e453c7e27{color:var(--text-muted)}.current.jsx-6e7ce48e453c7e27{color:var(--text-primary);font-weight:500}.category-header.jsx-6e7ce48e453c7e27{text-align:center;margin-bottom:var(--space-8);padding:var(--space-6)0;background:var(--bg-secondary);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg)}.category-icon.jsx-6e7ce48e453c7e27{font-size:3rem;margin-bottom:var(--space-4)}.category-title.jsx-6e7ce48e453c7e27{color:var(--accent-primary);font-size:var(--font-3xl);margin-bottom:var(--space-4)}.category-description.jsx-6e7ce48e453c7e27{color:var(--text-secondary);font-size:var(--font-lg);margin-bottom:var(--space-4);max-width:600px;margin-left:auto;margin-right:auto}.category-stats.jsx-6e7ce48e453c7e27{margin-top:var(--space-4)}.category-search.jsx-6e7ce48e453c7e27{margin-bottom:var(--space-6);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.controls-section.jsx-6e7ce48e453c7e27{margin-bottom:var(--space-6);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}.sort-select.jsx-6e7ce48e453c7e27{padding:var(--space-2)var(--space-4);border:1px solid var(--bg-surface);-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);background:var(--bg-primary);color:var(--text-primary);font-size:var(--font-sm)}.guides-section.jsx-6e7ce48e453c7e27{margin-bottom:var(--space-8)}.guide-card.jsx-6e7ce48e453c7e27:hover .mobile-card-title.jsx-6e7ce48e453c7e27{color:var(--accent-secondary)}.empty-state.jsx-6e7ce48e453c7e27{text-align:center;padding:var(--space-8);color:var(--text-secondary)}.empty-state.jsx-6e7ce48e453c7e27 h3.jsx-6e7ce48e453c7e27{color:var(--text-primary);margin-bottom:var(--space-4)}.loading-container.jsx-6e7ce48e453c7e27{text-align:center;padding:var(--space-8);color:var(--text-secondary)}.error-container.jsx-6e7ce48e453c7e27{text-align:center;padding:var(--space-8)}@media(max-width:767px){.category-header.jsx-6e7ce48e453c7e27{padding:var(--space-4);margin-bottom:var(--space-6)}.category-title.jsx-6e7ce48e453c7e27{font-size:var(--font-2xl)}.category-description.jsx-6e7ce48e453c7e27{font-size:var(--font-base)}.category-icon.jsx-6e7ce48e453c7e27{font-size:2.5rem}}</style><style id="__jsx-f92e766e9414ef16">.app-container.jsx-f92e766e9414ef16{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding-top:56px}.main-content.jsx-f92e766e9414ef16{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:var(--space-6)0}.mobile-footer.jsx-f92e766e9414ef16{background:var(--bg-secondary);border-top:1px solid var(--bg-surface);padding:var(--space-6)0;margin-top:auto}.footer-content.jsx-f92e766e9414ef16{text-align:center}.footer-links.jsx-f92e766e9414ef16{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:var(--space-6);margin-bottom:var(--space-4);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.footer-links.jsx-f92e766e9414ef16 a.jsx-f92e766e9414ef16{color:var(--accent-primary);text-decoration:none;font-size:var(--font-sm)}.footer-links.jsx-f92e766e9414ef16 a.jsx-f92e766e9414ef16:hover{color:var(--accent-secondary)}.footer-separator.jsx-f92e766e9414ef16{height:1px;background:var(--bg-surface);margin:var(--space-4)auto;width:200px}.footer-text.jsx-f92e766e9414ef16,.footer-tech.jsx-f92e766e9414ef16{color:var(--text-secondary);font-size:var(--font-sm);margin-bottom:var(--space-2)}.footer-disclaimer.jsx-f92e766e9414ef16{color:var(--text-muted);font-size:var(--font-xs)}.nav-links.jsx-f92e766e9414ef16{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4)}.nav-link.jsx-f92e766e9414ef16{color:var(--text-primary);text-decoration:none;padding:var(--space-2)var(--space-3);-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);font-size:var(--font-sm);font-weight:500;-webkit-transition:var(--transition);-moz-transition:var(--transition);-o-transition:var(--transition);transition:var(--transition);min-height:36px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.nav-link.jsx-f92e766e9414ef16:hover{background:var(--bg-surface);color:var(--accent-primary);text-decoration:none}[data-theme="light"].jsx-f92e766e9414ef16 .theme-icon-dark.jsx-f92e766e9414ef16{display:none}[data-theme="light"].jsx-f92e766e9414ef16 .theme-icon-light.jsx-f92e766e9414ef16{display:inline!important}@media(max-width:767px){.main-content.jsx-f92e766e9414ef16{padding:var(--space-4)0}.footer-links.jsx-f92e766e9414ef16{gap:var(--space-4)}}</style></head><body><noscript><div class="no-js-message" style="padding:1rem;background:#ff5555;color:#f8f8f2;text-align:center;font-size:0.9rem">This site requires JavaScript to function properly. Please enable JavaScript in your browser.</div></noscript><div id="__next"><div class="jsx-f92e766e9414ef16 app-container"><a href="#main-content" class="jsx-f92e766e9414ef16 skip-link">Skip to main content</a><nav class="jsx-f92e766e9414ef16 mobile-nav"><div class="jsx-f92e766e9414ef16 mobile-nav-content"><a class="mobile-brand" href="/"><span role="img" aria-label="Books" class="jsx-f92e766e9414ef16">📚</span>HowToMgr</a><div class="jsx-f92e766e9414ef16 nav-links"><a class="nav-link" href="/all/">All</a><a class="nav-link" href="/search/">Search</a></div><button aria-label="Toggle theme" title="Switch theme" class="jsx-f92e766e9414ef16 mobile-theme-toggle touch-target"><span class="jsx-f92e766e9414ef16 theme-icon-dark">🌙</span><span style="display:none" class="jsx-f92e766e9414ef16 theme-icon-light">☀️</span></button></div></nav><main id="main-content" tabindex="-1" class="jsx-f92e766e9414ef16 main-content"><div class="jsx-f92e766e9414ef16 container"><nav aria-label="Breadcrumb" class="jsx-6e7ce48e453c7e27 breadcrumb"><a href="/">Home</a><span class="jsx-6e7ce48e453c7e27 separator">→</span><span class="jsx-6e7ce48e453c7e27 current">Security</span></nav><section class="jsx-6e7ce48e453c7e27 category-header"><div style="color:#ff5555" class="jsx-6e7ce48e453c7e27 category-icon">🔒</div><h1 class="jsx-6e7ce48e453c7e27 category-title">Security</h1><p class="jsx-6e7ce48e453c7e27 category-description">Security tools and authentication systems</p><div class="jsx-6e7ce48e453c7e27 category-stats"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-primary">6<!-- --> guides available</span></div></section><section class="jsx-6e7ce48e453c7e27 category-search"><div class="jsx-fba8d10132152d7 search-box"><div class="jsx-fba8d10132152d7 search-input-container"><input type="search" placeholder="Search security..." autoComplete="off" aria-label="Search installation guides" class="jsx-fba8d10132152d7 search-input" value=""/><div class="jsx-fba8d10132152d7 search-indicator"><span class="jsx-fba8d10132152d7 search-icon">🔍</span></div></div></div></section><section class="jsx-6e7ce48e453c7e27 controls-section"><div class="jsx-6e7ce48e453c7e27 sort-controls"><label for="sort-select" class="jsx-6e7ce48e453c7e27 sr-only">Sort guides</label><select id="sort-select" class="jsx-6e7ce48e453c7e27 sort-select"><option value="name" class="jsx-6e7ce48e453c7e27" selected="">Name (A-Z)</option><option value="updated" class="jsx-6e7ce48e453c7e27">Recently Updated</option><option value="stars" class="jsx-6e7ce48e453c7e27">Most Popular</option></select></div></section><section class="jsx-6e7ce48e453c7e27 guides-section"><div class="jsx-6e7ce48e453c7e27 mobile-grid"><a class="mobile-card guide-card" href="/security/fail2ban/"><div class="jsx-6e7ce48e453c7e27 mobile-card-header"><h3 class="jsx-6e7ce48e453c7e27 mobile-card-title">Fail2ban</h3><p class="jsx-6e7ce48e453c7e27 mobile-card-description">Repo for fail2ban</p></div><div class="jsx-6e7ce48e453c7e27 mobile-card-meta"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-info">12 min</span></div></a><a class="mobile-card guide-card" href="/security/keycloak/"><div class="jsx-6e7ce48e453c7e27 mobile-card-header"><h3 class="jsx-6e7ce48e453c7e27 mobile-card-title">Keycloak</h3><p class="jsx-6e7ce48e453c7e27 mobile-card-description">Repo for keycloak</p></div><div class="jsx-6e7ce48e453c7e27 mobile-card-meta"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-info">1 min</span></div></a><a class="mobile-card guide-card" href="/security/openvpn/"><div class="jsx-6e7ce48e453c7e27 mobile-card-header"><h3 class="jsx-6e7ce48e453c7e27 mobile-card-title">Openvpn</h3><p class="jsx-6e7ce48e453c7e27 mobile-card-description">Repo for openvpn</p></div><div class="jsx-6e7ce48e453c7e27 mobile-card-meta"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-info">1 min</span></div></a><a class="mobile-card guide-card" href="/security/pihole/"><div class="jsx-6e7ce48e453c7e27 mobile-card-header"><h3 class="jsx-6e7ce48e453c7e27 mobile-card-title">Pi-hole</h3><p class="jsx-6e7ce48e453c7e27 mobile-card-description">Repo for pihole</p></div><div class="jsx-6e7ce48e453c7e27 mobile-card-meta"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-info">3 min</span></div></a><a class="mobile-card guide-card" href="/security/vault/"><div class="jsx-6e7ce48e453c7e27 mobile-card-header"><h3 class="jsx-6e7ce48e453c7e27 mobile-card-title">Vault</h3><p class="jsx-6e7ce48e453c7e27 mobile-card-description">Repo for vault</p></div><div class="jsx-6e7ce48e453c7e27 mobile-card-meta"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-info">27 min</span></div></a><a class="mobile-card guide-card" href="/security/wireguard/"><div class="jsx-6e7ce48e453c7e27 mobile-card-header"><h3 class="jsx-6e7ce48e453c7e27 mobile-card-title">Wireguard</h3><p class="jsx-6e7ce48e453c7e27 mobile-card-description">Repo for wireguard</p></div><div class="jsx-6e7ce48e453c7e27 mobile-card-meta"><span class="jsx-6e7ce48e453c7e27 mobile-badge mobile-badge-info">14 min</span></div></a></div></section></div></main><footer class="jsx-f92e766e9414ef16 mobile-footer"><div class="jsx-f92e766e9414ef16 container"><div class="jsx-f92e766e9414ef16 footer-content"><div class="jsx-f92e766e9414ef16 footer-links"><a href="/">Home</a><a href="https://github.com/howtomgr" target="_blank" rel="noopener" class="jsx-f92e766e9414ef16">GitHub</a><a href="https://github.com/howtomgr/howtomgr.github.io" target="_blank" rel="noopener" class="jsx-f92e766e9414ef16">Source</a></div><div class="jsx-f92e766e9414ef16 footer-separator"></div><p class="jsx-f92e766e9414ef16 footer-text">© <!-- -->2025<!-- --> HowToMgr Organization. Open source installation guides.</p><p class="jsx-f92e766e9414ef16 footer-tech">Built with ❤️ using Next.js + GitHub Pages</p><p class="jsx-f92e766e9414ef16 footer-disclaimer"><small class="jsx-f92e766e9414ef16">All guides are provided as-is. Please review and test before production use.</small></p></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"category":{"key":"security","name":"Security","description":"Security tools and authentication systems","icon":"🔒","color":"#ff5555","keywords":["vault","authelia","keycloak","pihole","fail2ban","wireguard","openvpn"]},"guides":[{"name":"fail2ban","displayName":"Fail2ban","slug":"fail2ban","description":"Repo for fail2ban","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/fail2ban","updatedAt":"2025-09-14T01:29:56Z","createdAt":"2025-09-08T03:07:24Z","readmeRaw":"# Fail2Ban Installation Guide\n\nIntrusion prevention software that protects servers from brute-force attacks by monitoring log files and automatically banning malicious IP addresses. Essential security tool for any public-facing server.\n\n## Prerequisites\n\n- Linux system (any modern distribution)\n- Root or sudo access\n- iptables or firewalld\n- Log files to monitor (SSH, web server, etc.)\n- Python 3.6+ (usually pre-installed)\n\n## Installation\n\n### Ubuntu/Debian\n```bash\n# Update system packages\nsudo apt update \u0026\u0026 sudo apt upgrade -y\n\n# Install Fail2Ban\nsudo apt install -y fail2ban whois\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nsudo systemctl status fail2ban\nfail2ban-client version\n```\n\n### RHEL/CentOS/Rocky Linux/AlmaLinux\n```bash\n# Install EPEL repository\nsudo yum install -y epel-release\n\n# Install Fail2Ban\nsudo yum install -y fail2ban fail2ban-systemd whois\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nsudo systemctl status fail2ban\n```\n\n### Fedora\n```bash\n# Install Fail2Ban\nsudo dnf install -y fail2ban whois\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nsudo systemctl status fail2ban\n```\n\n## Configuration\n\n### Basic Configuration\n```bash\n# Create local jail configuration (never edit jail.conf directly)\nsudo tee /etc/fail2ban/jail.local \u003e /dev/null \u003c\u003cEOF\n# Fail2Ban Local Configuration\n\n[DEFAULT]\n# Ban settings\nbantime = 3600\nfindtime = 600\nmaxretry = 3\nbackend = auto\n\n# Notification settings\ndestemail = admin@example.com\nsender = fail2ban@example.com\nmta = sendmail\n\n# Actions\naction = %(action_mwl)s\n\n# Ignore IP addresses (whitelist)\nignoreip = 127.0.0.1/8 ::1 192.168.1.0/24 10.0.0.0/8\n\n# SSH protection\n[sshd]\nenabled = true\nport = ssh,2222\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 3600\n\n# HTTP/HTTPS brute force protection\n[nginx-http-auth]\nenabled = true\nfilter = nginx-http-auth\nlogpath = /var/log/nginx/error.log\nmaxretry = 3\n\n[nginx-noscript]\nenabled = true\nfilter = nginx-noscript\nlogpath = /var/log/nginx/access.log\nmaxretry = 6\n\n[nginx-badbots]\nenabled = true\nfilter = nginx-badbots\nlogpath = /var/log/nginx/access.log\nmaxretry = 2\n\n# Apache protection\n[apache-auth]\nenabled = false\nfilter = apache-auth\nlogpath = /var/log/apache2/error.log\nmaxretry = 3\n\n[apache-badbots]\nenabled = false\nfilter = apache-badbots\nlogpath = /var/log/apache2/access.log\nmaxretry = 2\n\n# Database protection\n[mysql]\nenabled = false\nfilter = mysql-auth\nlogpath = /var/log/mysql/error.log\nmaxretry = 3\nbantime = 7200\n\n[postgresql]\nenabled = false\nfilter = postgresql\nlogpath = /var/log/postgresql/postgresql-*-main.log\nmaxretry = 3\n\n# Mail server protection\n[postfix]\nenabled = false\nfilter = postfix\nlogpath = /var/log/mail.log\nmaxretry = 3\n\n[dovecot]\nenabled = false\nfilter = dovecot\nlogpath = /var/log/mail.log\nmaxretry = 3\n\n# FTP protection\n[vsftpd]\nenabled = false\nfilter = vsftpd\nlogpath = /var/log/vsftpd.log\nmaxretry = 3\n\n# Custom application protection\n[custom-app]\nenabled = false\nfilter = custom-app\nlogpath = /var/log/myapp/error.log\nmaxretry = 5\nbantime = 1800\nEOF\n```\n\n### Custom Filters\n```bash\n# Create custom filter for web applications\nsudo tee /etc/fail2ban/filter.d/nginx-custom.conf \u003e /dev/null \u003c\u003cEOF\n# Custom NGINX filter for advanced protection\n\n[Definition]\nfailregex = \n    # Failed login attempts\n    ^\u003cHOST\u003e -.*POST.*(wp-login\\.php|login|signin|admin).*HTTP/[0-9\\.]+\\\" 200\n    # Directory traversal attempts\n    ^\u003cHOST\u003e -.*GET.*(\\.\\./|\\.\\.\\%2F).*HTTP/[0-9\\.]+\\\" 404\n    # SQL injection attempts  \n    ^\u003cHOST\u003e -.*GET.*(union|select|insert|cast|set|declare|drop|create|alter|delete|update|replace|truncate).*HTTP/[0-9\\.]+\\\" 200\n    # XSS attempts\n    ^\u003cHOST\u003e -.*GET.*(script|javascript|vbscript|onload|onerror|onclick).*HTTP/[0-9\\.]+\\\" 200\n    # Suspicious user agents\n    ^\u003cHOST\u003e -.*\\\"(.*sqlmap.*|.*nikto.*|.*nessus.*|.*openvas.*|.*python-requests.*|.*curl.*|.*wget.*)\\\"$\n    # Too many 404 errors\n    ^\u003cHOST\u003e -.*\\\" 404 \n\nignoreregex =\n    # Ignore legitimate requests\n    ^\u003cHOST\u003e -.*GET.*/favicon\\.ico.*HTTP/[0-9\\.]+\\\" 404\n    ^\u003cHOST\u003e -.*GET.*/robots\\.txt.*HTTP/[0-9\\.]+\\\" 404\nEOF\n\n# Create WordPress-specific filter\nsudo tee /etc/fail2ban/filter.d/wordpress.conf \u003e /dev/null \u003c\u003cEOF\n[Definition]\nfailregex = \n    # WordPress login failures\n    ^\u003cHOST\u003e -.*POST.*/wp-login\\.php.*HTTP/[0-9\\.]+\\\" 200\n    # WordPress admin access attempts\n    ^\u003cHOST\u003e -.*GET.*/wp-admin.*HTTP/[0-9\\.]+\\\" 403\n    # XML-RPC attacks\n    ^\u003cHOST\u003e -.*POST.*/xmlrpc\\.php.*HTTP/[0-9\\.]+\\\" 200\n\nignoreregex =\n    # Ignore successful admin logins (adjust pattern as needed)\n    ^\u003cHOST\u003e -.*POST.*/wp-login\\.php.*HTTP/[0-9\\.]+\\\" 302\nEOF\n\n# Add WordPress jail to jail.local\nsudo tee -a /etc/fail2ban/jail.local \u003e /dev/null \u003c\u003cEOF\n\n[wordpress]\nenabled = true\nfilter = wordpress\nlogpath = /var/log/nginx/access.log\nport = http,https\nmaxretry = 3\nbantime = 1800\nfindtime = 600\nEOF\n\nsudo systemctl restart fail2ban\n```\n\n### Advanced Configuration\n```bash\n# Create advanced fail2ban configuration with multiple actions\nsudo tee /etc/fail2ban/action.d/telegram.conf \u003e /dev/null \u003c\u003cEOF\n# Telegram notification action\n\n[Definition]\nactionstart = \nactionstop = \nactioncheck = \nactionban = curl -s \"https://api.telegram.org/bot\u003cbot_token\u003e/sendMessage\" -d \"chat_id=\u003cchat_id\u003e\u0026text=🚫 Fail2Ban: \u003cname\u003e banned \u003cip\u003e for \u003cfailures\u003e failures\"\nactionunban = curl -s \"https://api.telegram.org/bot\u003cbot_token\u003e/sendMessage\" -d \"chat_id=\u003cchat_id\u003e\u0026text=✅ Fail2Ban: \u003cname\u003e unbanned \u003cip\u003e\"\n\n[Init]\nbot_token = your_telegram_bot_token\nchat_id = your_telegram_chat_id\nEOF\n\n# Create comprehensive protection configuration\nsudo tee /etc/fail2ban/jail.d/comprehensive.conf \u003e /dev/null \u003c\u003cEOF\n# Comprehensive Security Configuration\n\n[DEFAULT]\n# Enhanced ban settings\nbantime.increment = true\nbantime.rndtime = 60\nbantime.maxtime = 86400\nbantime.factor = 2\nbantime.formula = ban.Time * (1\u003c\u003c(ban.Count if ban.Count\u003c20 else 20)) * banFactor\n\n# Multiple actions (ban + notify)\naction = %(action_mwl)s[dest=security@example.com]\n         telegram[bot_token=your_bot_token, chat_id=your_chat_id]\n\n[sshd-aggressive]\nenabled = true\nport = ssh\nfilter = sshd[mode=aggressive]\nlogpath = /var/log/auth.log\nmaxretry = 2\nbantime = 7200\nfindtime = 300\n\n[nginx-limit-req]\nenabled = true\nfilter = nginx-limit-req\nlogpath = /var/log/nginx/error.log\nmaxretry = 10\nbantime = 3600\n\n[nginx-noproxy]\nenabled = true\nfilter = nginx-noproxy\nlogpath = /var/log/nginx/access.log\nmaxretry = 2\nbantime = 86400\n\n# Protect against port scans\n[port-scan]\nenabled = true\nfilter = port-scan\nlogpath = /var/log/messages\nmaxretry = 1\nbantime = 86400\n\n# DNS amplification protection\n[named-refused]\nenabled = false\nfilter = named-refused\nlogpath = /var/log/messages\nmaxretry = 5\nbantime = 3600\nEOF\n```\n\n### Custom Filters for Applications\n```bash\n# Create filter for Node.js applications\nsudo tee /etc/fail2ban/filter.d/nodejs-auth.conf \u003e /dev/null \u003c\u003cEOF\n[Definition]\nfailregex = ^.*Authentication failed for.*from \u003cHOST\u003e.*$\n            ^.*Invalid login attempt.*IP: \u003cHOST\u003e.*$\n            ^.*Failed login.*remote_addr: \u003cHOST\u003e.*$\nignoreregex =\nEOF\n\n# Create filter for Grafana\nsudo tee /etc/fail2ban/filter.d/grafana.conf \u003e /dev/null \u003c\u003cEOF\n[Definition]\nfailregex = ^.*logger=context.*error=\"invalid username or password\".*remote_addr=\u003cHOST\u003e\n            ^.*logger=context.*error=\"user not found\".*remote_addr=\u003cHOST\u003e\nignoreregex =\nEOF\n\n# Create filter for GitLab\nsudo tee /etc/fail2ban/filter.d/gitlab.conf \u003e /dev/null \u003c\u003cEOF\n[Definition]\nfailregex = ^.*Failed Login:.*IP: \u003cHOST\u003e.*$\n            ^.*Rack_Attack.*Throttle.*IP: \u003cHOST\u003e.*$\nignoreregex =\nEOF\n\n# Add application-specific jails\nsudo tee /etc/fail2ban/jail.d/applications.conf \u003e /dev/null \u003c\u003cEOF\n[nodejs-auth]\nenabled = false\nfilter = nodejs-auth\nlogpath = /var/log/nodejs/app.log\nmaxretry = 5\nbantime = 1800\n\n[grafana]\nenabled = false\nfilter = grafana\nlogpath = /var/log/grafana/grafana.log\nmaxretry = 5\nbantime = 3600\n\n[gitlab]\nenabled = false\nfilter = gitlab\nlogpath = /var/log/gitlab/gitlab-rails/production.log\nmaxretry = 5\nbantime = 3600\nEOF\n```\n\n## Monitoring and Management\n\n### Fail2Ban Management Script\n```bash\nsudo tee /usr/local/bin/fail2ban-manager.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\n\ncase \"${1}\" in\n    \"status\")\n        echo \"=== Fail2Ban Status ===\"\n        sudo fail2ban-client status\n        echo \"\"\n        echo \"=== Active Jails ===\"\n        for jail in $(sudo fail2ban-client status | grep \"Jail list:\" | sed -e 's/.*Jail list://' -e 's/,/ /g'); do\n            echo \"Jail: $jail\"\n            sudo fail2ban-client status $jail\n            echo \"\"\n        done\n        ;;\n        \n    \"unban\")\n        IP=\"${2}\"\n        if [ -z \"$IP\" ]; then\n            echo \"Usage: $0 unban \u003cip_address\u003e\"\n            exit 1\n        fi\n        \n        echo \"Unbanning IP: $IP from all jails\"\n        for jail in $(sudo fail2ban-client status | grep \"Jail list:\" | sed -e 's/.*Jail list://' -e 's/,/ /g'); do\n            sudo fail2ban-client set $jail unbanip $IP 2\u003e/dev/null \u0026\u0026 echo \"  - Unbanned from $jail\"\n        done\n        ;;\n        \n    \"ban\")\n        IP=\"${2}\"\n        JAIL=\"${3:-sshd}\"\n        if [ -z \"$IP\" ]; then\n            echo \"Usage: $0 ban \u003cip_address\u003e [jail_name]\"\n            exit 1\n        fi\n        \n        echo \"Banning IP: $IP in jail: $JAIL\"\n        sudo fail2ban-client set $JAIL banip $IP\n        ;;\n        \n    \"whitelist\")\n        IP=\"${2}\"\n        if [ -z \"$IP\" ]; then\n            echo \"Usage: $0 whitelist \u003cip_address\u003e\"\n            exit 1\n        fi\n        \n        echo \"Adding $IP to whitelist\"\n        sudo sed -i \"s/ignoreip = .*/\u0026 $IP/\" /etc/fail2ban/jail.local\n        sudo systemctl restart fail2ban\n        ;;\n        \n    \"logs\")\n        JAIL=\"${2:-sshd}\"\n        echo \"Recent bans for jail: $JAIL\"\n        sudo grep \"Ban\\|Unban\" /var/log/fail2ban.log | grep \"$JAIL\" | tail -20\n        ;;\n        \n    \"stats\")\n        echo \"=== Fail2Ban Statistics ===\"\n        echo \"Total bans today: $(sudo grep \"$(date +'%Y-%m-%d')\" /var/log/fail2ban.log | grep -c \"Ban \")\"\n        echo \"Total unbans today: $(sudo grep \"$(date +'%Y-%m-%d')\" /var/log/fail2ban.log | grep -c \"Unban \")\"\n        echo \"\"\n        echo \"Top banned IPs (last 1000 entries):\"\n        sudo tail -1000 /var/log/fail2ban.log | grep \"Ban \" | awk '{print $(NF-1)}' | sort | uniq -c | sort -nr | head -10\n        ;;\n        \n    \"test\")\n        JAIL=\"${2:-sshd}\"\n        LOG_FILE=\"${3:-/var/log/auth.log}\"\n        echo \"Testing filter for jail: $JAIL\"\n        echo \"Log file: $LOG_FILE\"\n        sudo fail2ban-regex $LOG_FILE /etc/fail2ban/filter.d/${JAIL}.conf\n        ;;\n        \n    \"reload\")\n        echo \"Reloading Fail2Ban configuration...\"\n        sudo fail2ban-client reload\n        echo \"Configuration reloaded\"\n        ;;\n        \n    *)\n        echo \"Fail2Ban Management Script\"\n        echo \"Usage: $0 {status|unban|ban|whitelist|logs|stats|test|reload}\"\n        echo \"\"\n        echo \"Examples:\"\n        echo \"  $0 status                    # Show status of all jails\"\n        echo \"  $0 unban 192.168.1.100      # Unban IP from all jails\"\n        echo \"  $0 ban 10.0.0.1 sshd        # Ban IP in specific jail\"\n        echo \"  $0 whitelist 192.168.1.50   # Add IP to whitelist\"\n        echo \"  $0 logs sshd                # Show recent logs for jail\"\n        echo \"  $0 stats                    # Show ban statistics\"\n        echo \"  $0 test sshd                # Test jail filter\"\n        echo \"  $0 reload                   # Reload configuration\"\n        exit 1\n        ;;\nesac\nEOF\n\nsudo chmod +x /usr/local/bin/fail2ban-manager.sh\n```\n\n### Security Monitoring\n```bash\n# Create comprehensive monitoring script\nsudo tee /usr/local/bin/fail2ban-monitor.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nMONITOR_LOG=\"/var/log/fail2ban-monitor.log\"\n\nlog_message() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" | tee -a ${MONITOR_LOG}\n}\n\n# Check Fail2Ban service\nif systemctl is-active fail2ban \u003e/dev/null 2\u003e\u00261; then\n    log_message \"✓ Fail2Ban service is running\"\nelse\n    log_message \"✗ Fail2Ban service is not running\"\n    exit 1\nfi\n\n# Check jail status\nACTIVE_JAILS=$(sudo fail2ban-client status | grep \"Jail list:\" | sed -e 's/.*Jail list://' -e 's/,/ /g' | wc -w)\nlog_message \"ℹ Active jails: ${ACTIVE_JAILS}\"\n\n# Check today's bans\nBANS_TODAY=$(sudo grep \"$(date +'%Y-%m-%d')\" /var/log/fail2ban.log | grep -c \"Ban \" 2\u003e/dev/null || echo \"0\")\nUNBANS_TODAY=$(sudo grep \"$(date +'%Y-%m-%d')\" /var/log/fail2ban.log | grep -c \"Unban \" 2\u003e/dev/null || echo \"0\")\nlog_message \"ℹ Today's activity: ${BANS_TODAY} bans, ${UNBANS_TODAY} unbans\"\n\n# Check currently banned IPs\nTOTAL_BANNED=0\nfor jail in $(sudo fail2ban-client status | grep \"Jail list:\" | sed -e 's/.*Jail list://' -e 's/,/ /g'); do\n    JAIL_BANNED=$(sudo fail2ban-client status $jail | grep \"Currently banned:\" | awk '{print $3}')\n    TOTAL_BANNED=$((TOTAL_BANNED + JAIL_BANNED))\ndone\n\nlog_message \"ℹ Currently banned IPs: ${TOTAL_BANNED}\"\n\n# Check for configuration errors\nif ! sudo fail2ban-client status \u003e/dev/null 2\u003e\u00261; then\n    log_message \"⚠ Fail2Ban configuration errors detected\"\n    sudo fail2ban-client status 2\u003e\u00261 | head -5 \u003e\u003e ${MONITOR_LOG}\nfi\n\n# Check log file accessibility\nfor jail in $(sudo fail2ban-client status | grep \"Jail list:\" | sed -e 's/.*Jail list://' -e 's/,/ /g'); do\n    LOG_PATH=$(sudo fail2ban-client get $jail logpath 2\u003e/dev/null)\n    if [ -n \"$LOG_PATH\" ] \u0026\u0026 [ ! -r \"$LOG_PATH\" ]; then\n        log_message \"⚠ Cannot read log file for $jail: $LOG_PATH\"\n    fi\ndone\n\nlog_message \"Fail2Ban monitoring completed\"\nEOF\n\nsudo chmod +x /usr/local/bin/fail2ban-monitor.sh\n\n# Schedule monitoring every 15 minutes\necho \"*/15 * * * * root /usr/local/bin/fail2ban-monitor.sh\" | sudo tee -a /etc/crontab\n```\n\n### Geographic Blocking Integration\n```bash\n# Install GeoIP for country-based blocking\nsudo apt install -y geoip-database geoip-bin  # Ubuntu/Debian\nsudo yum install -y GeoIP GeoIP-data          # RHEL/CentOS\n\n# Create geographic blocking filter\nsudo tee /etc/fail2ban/filter.d/geoip-block.conf \u003e /dev/null \u003c\u003cEOF\n[Definition]\n# Block connections from specific countries\nfailregex = ^\u003cHOST\u003e -\nignoreregex =\n\n[Init]\n# Countries to block (ISO country codes)\ncountries = CN,RU,KP,IR\nEOF\n\n# Create action for geographic blocking\nsudo tee /etc/fail2ban/action.d/geoip-block.conf \u003e /dev/null \u003c\u003cEOF\n[Definition]\nactioncheck = \nactionstart = \nactionstop = \nactionban = COUNTRY=$(geoiplookup \u003cip\u003e | awk -F: '{print $2}' | awk '{print $1}'); if echo \"CN RU KP IR\" | grep -q \"$COUNTRY\"; then iptables -A f2b-\u003cname\u003e -s \u003cip\u003e -j DROP; fi\nactionunban = iptables -D f2b-\u003cname\u003e -s \u003cip\u003e -j DROP 2\u003e/dev/null || true\n\n[Init]\nname = geoip-block\nEOF\n\n# Add geographic blocking jail\nsudo tee /etc/fail2ban/jail.d/geoip.conf \u003e /dev/null \u003c\u003cEOF\n[geoip-block]\nenabled = false  # Enable if needed\nfilter = geoip-block\naction = geoip-block\nlogpath = /var/log/nginx/access.log\nmaxretry = 1\nbantime = 86400\nfindtime = 60\nEOF\n```\n\n## Integration Examples\n\n### Web Server Integration\n```bash\n# NGINX: Enable logging for Fail2Ban\nsudo tee -a /etc/nginx/nginx.conf \u003e /dev/null \u003c\u003cEOF\n\nhttp {\n    # Log format for Fail2Ban\n    log_format fail2ban '\\$remote_addr - \\$remote_user [\\$time_local] '\n                       '\"\\$request\" \\$status \\$body_bytes_sent '\n                       '\"\\$http_referer\" \"\\$http_user_agent\"';\n    \n    # Enable access and error logging\n    access_log /var/log/nginx/access.log fail2ban;\n    error_log /var/log/nginx/error.log warn;\n}\nEOF\n\nsudo nginx -t \u0026\u0026 sudo systemctl reload nginx\n\n# Apache: Enable logging\nsudo tee -a /etc/apache2/apache2.conf \u003e /dev/null \u003c\u003cEOF\n\n# Enhanced logging for Fail2Ban\nLogFormat \"%h %l %u %t \\\"%r\\\" %\u003es %O \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" fail2ban\nCustomLog \\${APACHE_LOG_DIR}/access.log fail2ban\nErrorLog \\${APACHE_LOG_DIR}/error.log\nLogLevel warn\nEOF\n\nsudo systemctl reload apache2\n```\n\n## Backup and Disaster Recovery\n\n### Configuration Backup\n```bash\nsudo tee /usr/local/bin/fail2ban-backup.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nBACKUP_DIR=\"/backup/fail2ban\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}\n\necho \"Starting Fail2Ban backup...\"\n\n# Backup configuration files\ntar -czf ${BACKUP_DIR}/fail2ban-config-${DATE}.tar.gz \\\n    /etc/fail2ban/ \\\n    /var/lib/fail2ban/\n\n# Export current ban list\nsudo fail2ban-client status | grep \"Jail list:\" | sed -e 's/.*Jail list://' -e 's/,/ /g' \u003e /tmp/jails.txt\nwhile read jail; do\n    sudo fail2ban-client status $jail | grep \"Banned IP list:\" \u003e ${BACKUP_DIR}/banned-ips-${jail}-${DATE}.txt\ndone \u003c /tmp/jails.txt\n\n# Keep last 30 backups\nfind ${BACKUP_DIR} -name \"fail2ban-*\" -type f -mtime +30 -delete\n\necho \"Fail2Ban backup completed: ${DATE}\"\nEOF\n\nsudo chmod +x /usr/local/bin/fail2ban-backup.sh\n\n# Schedule weekly backups\necho \"0 4 * * 0 root /usr/local/bin/fail2ban-backup.sh\" | sudo tee -a /etc/crontab\n```\n\n## Troubleshooting\n\n### Common Issues and Solutions\n```bash\n# Check Fail2Ban service status\nsudo systemctl status fail2ban\nsudo journalctl -u fail2ban -f\n\n# Check jail status\nsudo fail2ban-client status\nsudo fail2ban-client status sshd\n\n# Test filter patterns\nsudo fail2ban-regex /var/log/auth.log /etc/fail2ban/filter.d/sshd.conf\n\n# Check banned IPs\nsudo fail2ban-client status sshd\nsudo iptables -L -n | grep f2b\n\n# View Fail2Ban logs\nsudo tail -f /var/log/fail2ban.log\n\n# Unban IP address\nsudo fail2ban-client set sshd unbanip 192.168.1.100\n\n# Ban IP manually\nsudo fail2ban-client set sshd banip 10.0.0.1\n\n# Reload configuration\nsudo fail2ban-client reload\n\n# Test SSH jail\nsudo grep \"Failed password\" /var/log/auth.log | head -5\nsudo fail2ban-regex /var/log/auth.log /etc/fail2ban/filter.d/sshd.conf\n\n# Check iptables rules\nsudo iptables -L f2b-sshd -n\nsudo iptables -L INPUT -n | grep f2b\n\n# Debug mode\nsudo fail2ban-server -f -v\n\n# Configuration validation\nsudo fail2ban-client -t\n\n# Check log file permissions\nls -la /var/log/auth.log\nls -la /var/log/nginx/access.log\n\n# Monitor real-time bans\nsudo tail -f /var/log/fail2ban.log | grep \"Ban\\|Unban\"\n\n# Check jail configuration\nsudo fail2ban-client get sshd maxretry\nsudo fail2ban-client get sshd bantime\nsudo fail2ban-client get sshd findtime\n```\n\n## Additional Resources\n\n- [Fail2Ban Documentation](https://fail2ban.readthedocs.io/)\n- [Fail2Ban GitHub](https://github.com/fail2ban/fail2ban)\n- [Filter Configuration Guide](https://fail2ban.readthedocs.io/en/stable/filters.html)\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection.","readmeHtml":"\u003ch1 id=\"fail2ban-installation-guide\" class=\"mobile-header\"\u003eFail2Ban Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eIntrusion prevention software that protects servers from brute-force attacks by monitoring log files and automatically banning malicious IP addresses. Essential security tool for any public-facing server.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux system (any modern distribution)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot or sudo access\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eiptables or firewalld\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eLog files to monitor (SSH, web server, etc.)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003ePython 3.6+ (usually pre-installed)\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"ubuntudebian\" class=\"mobile-header\"\u003eUbuntu/Debian\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update system packages\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade -y\n\n# Install Fail2Ban\nsudo apt install -y fail2ban whois\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nsudo systemctl status fail2ban\nfail2ban-client version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"rhelcentosrocky-linuxalmalinux\" class=\"mobile-header\"\u003eRHEL/CentOS/Rocky Linux/AlmaLinux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install EPEL repository\nsudo yum install -y epel-release\n\n# Install Fail2Ban\nsudo yum install -y fail2ban fail2ban-systemd whois\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nsudo systemctl status fail2ban\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"fedora\" class=\"mobile-header\"\u003eFedora\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install Fail2Ban\nsudo dnf install -y fail2ban whois\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nsudo systemctl status fail2ban\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"configuration\" class=\"mobile-header\"\u003eConfiguration\u003c/h2\u003e\n\u003ch3 id=\"basic-configuration\" class=\"mobile-header\"\u003eBasic Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create local jail configuration (never edit jail.conf directly)\nsudo tee /etc/fail2ban/jail.local \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n# Fail2Ban Local Configuration\n\n[DEFAULT]\n# Ban settings\nbantime = 3600\nfindtime = 600\nmaxretry = 3\nbackend = auto\n\n# Notification settings\ndestemail = admin@example.com\nsender = fail2ban@example.com\nmta = sendmail\n\n# Actions\naction = %(action_mwl)s\n\n# Ignore IP addresses (whitelist)\nignoreip = 127.0.0.1/8 ::1 192.168.1.0/24 10.0.0.0/8\n\n# SSH protection\n[sshd]\nenabled = true\nport = ssh,2222\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 3600\n\n# HTTP/HTTPS brute force protection\n[nginx-http-auth]\nenabled = true\nfilter = nginx-http-auth\nlogpath = /var/log/nginx/error.log\nmaxretry = 3\n\n[nginx-noscript]\nenabled = true\nfilter = nginx-noscript\nlogpath = /var/log/nginx/access.log\nmaxretry = 6\n\n[nginx-badbots]\nenabled = true\nfilter = nginx-badbots\nlogpath = /var/log/nginx/access.log\nmaxretry = 2\n\n# Apache protection\n[apache-auth]\nenabled = false\nfilter = apache-auth\nlogpath = /var/log/apache2/error.log\nmaxretry = 3\n\n[apache-badbots]\nenabled = false\nfilter = apache-badbots\nlogpath = /var/log/apache2/access.log\nmaxretry = 2\n\n# Database protection\n[mysql]\nenabled = false\nfilter = mysql-auth\nlogpath = /var/log/mysql/error.log\nmaxretry = 3\nbantime = 7200\n\n[postgresql]\nenabled = false\nfilter = postgresql\nlogpath = /var/log/postgresql/postgresql-*-main.log\nmaxretry = 3\n\n# Mail server protection\n[postfix]\nenabled = false\nfilter = postfix\nlogpath = /var/log/mail.log\nmaxretry = 3\n\n[dovecot]\nenabled = false\nfilter = dovecot\nlogpath = /var/log/mail.log\nmaxretry = 3\n\n# FTP protection\n[vsftpd]\nenabled = false\nfilter = vsftpd\nlogpath = /var/log/vsftpd.log\nmaxretry = 3\n\n# Custom application protection\n[custom-app]\nenabled = false\nfilter = custom-app\nlogpath = /var/log/myapp/error.log\nmaxretry = 5\nbantime = 1800\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"custom-filters\" class=\"mobile-header\"\u003eCustom Filters\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create custom filter for web applications\nsudo tee /etc/fail2ban/filter.d/nginx-custom.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n# Custom NGINX filter for advanced protection\n\n[Definition]\nfailregex = \n    # Failed login attempts\n    ^\u0026lt;HOST\u0026gt; -.*POST.*(wp-login\\.php|login|signin|admin).*HTTP/[0-9\\.]+\\\u0026quot; 200\n    # Directory traversal attempts\n    ^\u0026lt;HOST\u0026gt; -.*GET.*(\\.\\./|\\.\\.\\%2F).*HTTP/[0-9\\.]+\\\u0026quot; 404\n    # SQL injection attempts  \n    ^\u0026lt;HOST\u0026gt; -.*GET.*(union|select|insert|cast|set|declare|drop|create|alter|delete|update|replace|truncate).*HTTP/[0-9\\.]+\\\u0026quot; 200\n    # XSS attempts\n    ^\u0026lt;HOST\u0026gt; -.*GET.*(script|javascript|vbscript|onload|onerror|onclick).*HTTP/[0-9\\.]+\\\u0026quot; 200\n    # Suspicious user agents\n    ^\u0026lt;HOST\u0026gt; -.*\\\u0026quot;(.*sqlmap.*|.*nikto.*|.*nessus.*|.*openvas.*|.*python-requests.*|.*curl.*|.*wget.*)\\\u0026quot;$\n    # Too many 404 errors\n    ^\u0026lt;HOST\u0026gt; -.*\\\u0026quot; 404 \n\nignoreregex =\n    # Ignore legitimate requests\n    ^\u0026lt;HOST\u0026gt; -.*GET.*/favicon\\.ico.*HTTP/[0-9\\.]+\\\u0026quot; 404\n    ^\u0026lt;HOST\u0026gt; -.*GET.*/robots\\.txt.*HTTP/[0-9\\.]+\\\u0026quot; 404\nEOF\n\n# Create WordPress-specific filter\nsudo tee /etc/fail2ban/filter.d/wordpress.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Definition]\nfailregex = \n    # WordPress login failures\n    ^\u0026lt;HOST\u0026gt; -.*POST.*/wp-login\\.php.*HTTP/[0-9\\.]+\\\u0026quot; 200\n    # WordPress admin access attempts\n    ^\u0026lt;HOST\u0026gt; -.*GET.*/wp-admin.*HTTP/[0-9\\.]+\\\u0026quot; 403\n    # XML-RPC attacks\n    ^\u0026lt;HOST\u0026gt; -.*POST.*/xmlrpc\\.php.*HTTP/[0-9\\.]+\\\u0026quot; 200\n\nignoreregex =\n    # Ignore successful admin logins (adjust pattern as needed)\n    ^\u0026lt;HOST\u0026gt; -.*POST.*/wp-login\\.php.*HTTP/[0-9\\.]+\\\u0026quot; 302\nEOF\n\n# Add WordPress jail to jail.local\nsudo tee -a /etc/fail2ban/jail.local \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n\n[wordpress]\nenabled = true\nfilter = wordpress\nlogpath = /var/log/nginx/access.log\nport = http,https\nmaxretry = 3\nbantime = 1800\nfindtime = 600\nEOF\n\nsudo systemctl restart fail2ban\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-configuration\" class=\"mobile-header\"\u003eAdvanced Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create advanced fail2ban configuration with multiple actions\nsudo tee /etc/fail2ban/action.d/telegram.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n# Telegram notification action\n\n[Definition]\nactionstart = \nactionstop = \nactioncheck = \nactionban = curl -s \u0026quot;https://api.telegram.org/bot\u0026lt;bot_token\u0026gt;/sendMessage\u0026quot; -d \u0026quot;chat_id=\u0026lt;chat_id\u0026gt;\u0026amp;text=🚫 Fail2Ban: \u0026lt;name\u0026gt; banned \u0026lt;ip\u0026gt; for \u0026lt;failures\u0026gt; failures\u0026quot;\nactionunban = curl -s \u0026quot;https://api.telegram.org/bot\u0026lt;bot_token\u0026gt;/sendMessage\u0026quot; -d \u0026quot;chat_id=\u0026lt;chat_id\u0026gt;\u0026amp;text=✅ Fail2Ban: \u0026lt;name\u0026gt; unbanned \u0026lt;ip\u0026gt;\u0026quot;\n\n[Init]\nbot_token = your_telegram_bot_token\nchat_id = your_telegram_chat_id\nEOF\n\n# Create comprehensive protection configuration\nsudo tee /etc/fail2ban/jail.d/comprehensive.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n# Comprehensive Security Configuration\n\n[DEFAULT]\n# Enhanced ban settings\nbantime.increment = true\nbantime.rndtime = 60\nbantime.maxtime = 86400\nbantime.factor = 2\nbantime.formula = ban.Time * (1\u0026lt;\u0026lt;(ban.Count if ban.Count\u0026lt;20 else 20)) * banFactor\n\n# Multiple actions (ban + notify)\naction = %(action_mwl)s[dest=security@example.com]\n         telegram[bot_token=your_bot_token, chat_id=your_chat_id]\n\n[sshd-aggressive]\nenabled = true\nport = ssh\nfilter = sshd[mode=aggressive]\nlogpath = /var/log/auth.log\nmaxretry = 2\nbantime = 7200\nfindtime = 300\n\n[nginx-limit-req]\nenabled = true\nfilter = nginx-limit-req\nlogpath = /var/log/nginx/error.log\nmaxretry = 10\nbantime = 3600\n\n[nginx-noproxy]\nenabled = true\nfilter = nginx-noproxy\nlogpath = /var/log/nginx/access.log\nmaxretry = 2\nbantime = 86400\n\n# Protect against port scans\n[port-scan]\nenabled = true\nfilter = port-scan\nlogpath = /var/log/messages\nmaxretry = 1\nbantime = 86400\n\n# DNS amplification protection\n[named-refused]\nenabled = false\nfilter = named-refused\nlogpath = /var/log/messages\nmaxretry = 5\nbantime = 3600\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"custom-filters-for-applications\" class=\"mobile-header\"\u003eCustom Filters for Applications\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create filter for Node.js applications\nsudo tee /etc/fail2ban/filter.d/nodejs-auth.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Definition]\nfailregex = ^.*Authentication failed for.*from \u0026lt;HOST\u0026gt;.*$\n            ^.*Invalid login attempt.*IP: \u0026lt;HOST\u0026gt;.*$\n            ^.*Failed login.*remote_addr: \u0026lt;HOST\u0026gt;.*$\nignoreregex =\nEOF\n\n# Create filter for Grafana\nsudo tee /etc/fail2ban/filter.d/grafana.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Definition]\nfailregex = ^.*logger=context.*error=\u0026quot;invalid username or password\u0026quot;.*remote_addr=\u0026lt;HOST\u0026gt;\n            ^.*logger=context.*error=\u0026quot;user not found\u0026quot;.*remote_addr=\u0026lt;HOST\u0026gt;\nignoreregex =\nEOF\n\n# Create filter for GitLab\nsudo tee /etc/fail2ban/filter.d/gitlab.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Definition]\nfailregex = ^.*Failed Login:.*IP: \u0026lt;HOST\u0026gt;.*$\n            ^.*Rack_Attack.*Throttle.*IP: \u0026lt;HOST\u0026gt;.*$\nignoreregex =\nEOF\n\n# Add application-specific jails\nsudo tee /etc/fail2ban/jail.d/applications.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[nodejs-auth]\nenabled = false\nfilter = nodejs-auth\nlogpath = /var/log/nodejs/app.log\nmaxretry = 5\nbantime = 1800\n\n[grafana]\nenabled = false\nfilter = grafana\nlogpath = /var/log/grafana/grafana.log\nmaxretry = 5\nbantime = 3600\n\n[gitlab]\nenabled = false\nfilter = gitlab\nlogpath = /var/log/gitlab/gitlab-rails/production.log\nmaxretry = 5\nbantime = 3600\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"monitoring-and-management\" class=\"mobile-header\"\u003eMonitoring and Management\u003c/h2\u003e\n\u003ch3 id=\"fail2ban-management-script\" class=\"mobile-header\"\u003eFail2Ban Management Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/fail2ban-manager.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\n\ncase \u0026quot;${1}\u0026quot; in\n    \u0026quot;status\u0026quot;)\n        echo \u0026quot;=== Fail2Ban Status ===\u0026quot;\n        sudo fail2ban-client status\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;=== Active Jails ===\u0026quot;\n        for jail in $(sudo fail2ban-client status | grep \u0026quot;Jail list:\u0026quot; | sed -e \u0026#039;s/.*Jail list://\u0026#039; -e \u0026#039;s/,/ /g\u0026#039;); do\n            echo \u0026quot;Jail: $jail\u0026quot;\n            sudo fail2ban-client status $jail\n            echo \u0026quot;\u0026quot;\n        done\n        ;;\n        \n    \u0026quot;unban\u0026quot;)\n        IP=\u0026quot;${2}\u0026quot;\n        if [ -z \u0026quot;$IP\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 unban \u0026lt;ip_address\u0026gt;\u0026quot;\n            exit 1\n        fi\n        \n        echo \u0026quot;Unbanning IP: $IP from all jails\u0026quot;\n        for jail in $(sudo fail2ban-client status | grep \u0026quot;Jail list:\u0026quot; | sed -e \u0026#039;s/.*Jail list://\u0026#039; -e \u0026#039;s/,/ /g\u0026#039;); do\n            sudo fail2ban-client set $jail unbanip $IP 2\u0026gt;/dev/null \u0026amp;\u0026amp; echo \u0026quot;  - Unbanned from $jail\u0026quot;\n        done\n        ;;\n        \n    \u0026quot;ban\u0026quot;)\n        IP=\u0026quot;${2}\u0026quot;\n        JAIL=\u0026quot;${3:-sshd}\u0026quot;\n        if [ -z \u0026quot;$IP\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 ban \u0026lt;ip_address\u0026gt; [jail_name]\u0026quot;\n            exit 1\n        fi\n        \n        echo \u0026quot;Banning IP: $IP in jail: $JAIL\u0026quot;\n        sudo fail2ban-client set $JAIL banip $IP\n        ;;\n        \n    \u0026quot;whitelist\u0026quot;)\n        IP=\u0026quot;${2}\u0026quot;\n        if [ -z \u0026quot;$IP\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 whitelist \u0026lt;ip_address\u0026gt;\u0026quot;\n            exit 1\n        fi\n        \n        echo \u0026quot;Adding $IP to whitelist\u0026quot;\n        sudo sed -i \u0026quot;s/ignoreip = .*/\u0026amp; $IP/\u0026quot; /etc/fail2ban/jail.local\n        sudo systemctl restart fail2ban\n        ;;\n        \n    \u0026quot;logs\u0026quot;)\n        JAIL=\u0026quot;${2:-sshd}\u0026quot;\n        echo \u0026quot;Recent bans for jail: $JAIL\u0026quot;\n        sudo grep \u0026quot;Ban\\|Unban\u0026quot; /var/log/fail2ban.log | grep \u0026quot;$JAIL\u0026quot; | tail -20\n        ;;\n        \n    \u0026quot;stats\u0026quot;)\n        echo \u0026quot;=== Fail2Ban Statistics ===\u0026quot;\n        echo \u0026quot;Total bans today: $(sudo grep \u0026quot;$(date +\u0026#039;%Y-%m-%d\u0026#039;)\u0026quot; /var/log/fail2ban.log | grep -c \u0026quot;Ban \u0026quot;)\u0026quot;\n        echo \u0026quot;Total unbans today: $(sudo grep \u0026quot;$(date +\u0026#039;%Y-%m-%d\u0026#039;)\u0026quot; /var/log/fail2ban.log | grep -c \u0026quot;Unban \u0026quot;)\u0026quot;\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Top banned IPs (last 1000 entries):\u0026quot;\n        sudo tail -1000 /var/log/fail2ban.log | grep \u0026quot;Ban \u0026quot; | awk \u0026#039;{print $(NF-1)}\u0026#039; | sort | uniq -c | sort -nr | head -10\n        ;;\n        \n    \u0026quot;test\u0026quot;)\n        JAIL=\u0026quot;${2:-sshd}\u0026quot;\n        LOG_FILE=\u0026quot;${3:-/var/log/auth.log}\u0026quot;\n        echo \u0026quot;Testing filter for jail: $JAIL\u0026quot;\n        echo \u0026quot;Log file: $LOG_FILE\u0026quot;\n        sudo fail2ban-regex $LOG_FILE /etc/fail2ban/filter.d/${JAIL}.conf\n        ;;\n        \n    \u0026quot;reload\u0026quot;)\n        echo \u0026quot;Reloading Fail2Ban configuration...\u0026quot;\n        sudo fail2ban-client reload\n        echo \u0026quot;Configuration reloaded\u0026quot;\n        ;;\n        \n    *)\n        echo \u0026quot;Fail2Ban Management Script\u0026quot;\n        echo \u0026quot;Usage: $0 {status|unban|ban|whitelist|logs|stats|test|reload}\u0026quot;\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Examples:\u0026quot;\n        echo \u0026quot;  $0 status                    # Show status of all jails\u0026quot;\n        echo \u0026quot;  $0 unban 192.168.1.100      # Unban IP from all jails\u0026quot;\n        echo \u0026quot;  $0 ban 10.0.0.1 sshd        # Ban IP in specific jail\u0026quot;\n        echo \u0026quot;  $0 whitelist 192.168.1.50   # Add IP to whitelist\u0026quot;\n        echo \u0026quot;  $0 logs sshd                # Show recent logs for jail\u0026quot;\n        echo \u0026quot;  $0 stats                    # Show ban statistics\u0026quot;\n        echo \u0026quot;  $0 test sshd                # Test jail filter\u0026quot;\n        echo \u0026quot;  $0 reload                   # Reload configuration\u0026quot;\n        exit 1\n        ;;\nesac\nEOF\n\nsudo chmod +x /usr/local/bin/fail2ban-manager.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"security-monitoring\" class=\"mobile-header\"\u003eSecurity Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create comprehensive monitoring script\nsudo tee /usr/local/bin/fail2ban-monitor.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nMONITOR_LOG=\u0026quot;/var/log/fail2ban-monitor.log\u0026quot;\n\nlog_message() {\n    echo \u0026quot;$(date \u0026#039;+%Y-%m-%d %H:%M:%S\u0026#039;) - $1\u0026quot; | tee -a ${MONITOR_LOG}\n}\n\n# Check Fail2Ban service\nif systemctl is-active fail2ban \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;✓ Fail2Ban service is running\u0026quot;\nelse\n    log_message \u0026quot;✗ Fail2Ban service is not running\u0026quot;\n    exit 1\nfi\n\n# Check jail status\nACTIVE_JAILS=$(sudo fail2ban-client status | grep \u0026quot;Jail list:\u0026quot; | sed -e \u0026#039;s/.*Jail list://\u0026#039; -e \u0026#039;s/,/ /g\u0026#039; | wc -w)\nlog_message \u0026quot;ℹ Active jails: ${ACTIVE_JAILS}\u0026quot;\n\n# Check today\u0026#039;s bans\nBANS_TODAY=$(sudo grep \u0026quot;$(date +\u0026#039;%Y-%m-%d\u0026#039;)\u0026quot; /var/log/fail2ban.log | grep -c \u0026quot;Ban \u0026quot; 2\u0026gt;/dev/null || echo \u0026quot;0\u0026quot;)\nUNBANS_TODAY=$(sudo grep \u0026quot;$(date +\u0026#039;%Y-%m-%d\u0026#039;)\u0026quot; /var/log/fail2ban.log | grep -c \u0026quot;Unban \u0026quot; 2\u0026gt;/dev/null || echo \u0026quot;0\u0026quot;)\nlog_message \u0026quot;ℹ Today\u0026#039;s activity: ${BANS_TODAY} bans, ${UNBANS_TODAY} unbans\u0026quot;\n\n# Check currently banned IPs\nTOTAL_BANNED=0\nfor jail in $(sudo fail2ban-client status | grep \u0026quot;Jail list:\u0026quot; | sed -e \u0026#039;s/.*Jail list://\u0026#039; -e \u0026#039;s/,/ /g\u0026#039;); do\n    JAIL_BANNED=$(sudo fail2ban-client status $jail | grep \u0026quot;Currently banned:\u0026quot; | awk \u0026#039;{print $3}\u0026#039;)\n    TOTAL_BANNED=$((TOTAL_BANNED + JAIL_BANNED))\ndone\n\nlog_message \u0026quot;ℹ Currently banned IPs: ${TOTAL_BANNED}\u0026quot;\n\n# Check for configuration errors\nif ! sudo fail2ban-client status \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;⚠ Fail2Ban configuration errors detected\u0026quot;\n    sudo fail2ban-client status 2\u0026gt;\u0026amp;1 | head -5 \u0026gt;\u0026gt; ${MONITOR_LOG}\nfi\n\n# Check log file accessibility\nfor jail in $(sudo fail2ban-client status | grep \u0026quot;Jail list:\u0026quot; | sed -e \u0026#039;s/.*Jail list://\u0026#039; -e \u0026#039;s/,/ /g\u0026#039;); do\n    LOG_PATH=$(sudo fail2ban-client get $jail logpath 2\u0026gt;/dev/null)\n    if [ -n \u0026quot;$LOG_PATH\u0026quot; ] \u0026amp;\u0026amp; [ ! -r \u0026quot;$LOG_PATH\u0026quot; ]; then\n        log_message \u0026quot;⚠ Cannot read log file for $jail: $LOG_PATH\u0026quot;\n    fi\ndone\n\nlog_message \u0026quot;Fail2Ban monitoring completed\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/fail2ban-monitor.sh\n\n# Schedule monitoring every 15 minutes\necho \u0026quot;*/15 * * * * root /usr/local/bin/fail2ban-monitor.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"geographic-blocking-integration\" class=\"mobile-header\"\u003eGeographic Blocking Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install GeoIP for country-based blocking\nsudo apt install -y geoip-database geoip-bin  # Ubuntu/Debian\nsudo yum install -y GeoIP GeoIP-data          # RHEL/CentOS\n\n# Create geographic blocking filter\nsudo tee /etc/fail2ban/filter.d/geoip-block.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Definition]\n# Block connections from specific countries\nfailregex = ^\u0026lt;HOST\u0026gt; -\nignoreregex =\n\n[Init]\n# Countries to block (ISO country codes)\ncountries = CN,RU,KP,IR\nEOF\n\n# Create action for geographic blocking\nsudo tee /etc/fail2ban/action.d/geoip-block.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Definition]\nactioncheck = \nactionstart = \nactionstop = \nactionban = COUNTRY=$(geoiplookup \u0026lt;ip\u0026gt; | awk -F: \u0026#039;{print $2}\u0026#039; | awk \u0026#039;{print $1}\u0026#039;); if echo \u0026quot;CN RU KP IR\u0026quot; | grep -q \u0026quot;$COUNTRY\u0026quot;; then iptables -A f2b-\u0026lt;name\u0026gt; -s \u0026lt;ip\u0026gt; -j DROP; fi\nactionunban = iptables -D f2b-\u0026lt;name\u0026gt; -s \u0026lt;ip\u0026gt; -j DROP 2\u0026gt;/dev/null || true\n\n[Init]\nname = geoip-block\nEOF\n\n# Add geographic blocking jail\nsudo tee /etc/fail2ban/jail.d/geoip.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[geoip-block]\nenabled = false  # Enable if needed\nfilter = geoip-block\naction = geoip-block\nlogpath = /var/log/nginx/access.log\nmaxretry = 1\nbantime = 86400\nfindtime = 60\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"integration-examples\" class=\"mobile-header\"\u003eIntegration Examples\u003c/h2\u003e\n\u003ch3 id=\"web-server-integration\" class=\"mobile-header\"\u003eWeb Server Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# NGINX: Enable logging for Fail2Ban\nsudo tee -a /etc/nginx/nginx.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n\nhttp {\n    # Log format for Fail2Ban\n    log_format fail2ban \u0026#039;\\$remote_addr - \\$remote_user [\\$time_local] \u0026#039;\n                       \u0026#039;\u0026quot;\\$request\u0026quot; \\$status \\$body_bytes_sent \u0026#039;\n                       \u0026#039;\u0026quot;\\$http_referer\u0026quot; \u0026quot;\\$http_user_agent\u0026quot;\u0026#039;;\n    \n    # Enable access and error logging\n    access_log /var/log/nginx/access.log fail2ban;\n    error_log /var/log/nginx/error.log warn;\n}\nEOF\n\nsudo nginx -t \u0026amp;\u0026amp; sudo systemctl reload nginx\n\n# Apache: Enable logging\nsudo tee -a /etc/apache2/apache2.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n\n# Enhanced logging for Fail2Ban\nLogFormat \u0026quot;%h %l %u %t \\\u0026quot;%r\\\u0026quot; %\u0026gt;s %O \\\u0026quot;%{Referer}i\\\u0026quot; \\\u0026quot;%{User-Agent}i\\\u0026quot;\u0026quot; fail2ban\nCustomLog \\${APACHE_LOG_DIR}/access.log fail2ban\nErrorLog \\${APACHE_LOG_DIR}/error.log\nLogLevel warn\nEOF\n\nsudo systemctl reload apache2\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-and-disaster-recovery\" class=\"mobile-header\"\u003eBackup and Disaster Recovery\u003c/h2\u003e\n\u003ch3 id=\"configuration-backup\" class=\"mobile-header\"\u003eConfiguration Backup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/fail2ban-backup.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nBACKUP_DIR=\u0026quot;/backup/fail2ban\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}\n\necho \u0026quot;Starting Fail2Ban backup...\u0026quot;\n\n# Backup configuration files\ntar -czf ${BACKUP_DIR}/fail2ban-config-${DATE}.tar.gz \\\n    /etc/fail2ban/ \\\n    /var/lib/fail2ban/\n\n# Export current ban list\nsudo fail2ban-client status | grep \u0026quot;Jail list:\u0026quot; | sed -e \u0026#039;s/.*Jail list://\u0026#039; -e \u0026#039;s/,/ /g\u0026#039; \u0026gt; /tmp/jails.txt\nwhile read jail; do\n    sudo fail2ban-client status $jail | grep \u0026quot;Banned IP list:\u0026quot; \u0026gt; ${BACKUP_DIR}/banned-ips-${jail}-${DATE}.txt\ndone \u0026lt; /tmp/jails.txt\n\n# Keep last 30 backups\nfind ${BACKUP_DIR} -name \u0026quot;fail2ban-*\u0026quot; -type f -mtime +30 -delete\n\necho \u0026quot;Fail2Ban backup completed: ${DATE}\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/fail2ban-backup.sh\n\n# Schedule weekly backups\necho \u0026quot;0 4 * * 0 root /usr/local/bin/fail2ban-backup.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting\" class=\"mobile-header\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues-and-solutions\" class=\"mobile-header\"\u003eCommon Issues and Solutions\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check Fail2Ban service status\nsudo systemctl status fail2ban\nsudo journalctl -u fail2ban -f\n\n# Check jail status\nsudo fail2ban-client status\nsudo fail2ban-client status sshd\n\n# Test filter patterns\nsudo fail2ban-regex /var/log/auth.log /etc/fail2ban/filter.d/sshd.conf\n\n# Check banned IPs\nsudo fail2ban-client status sshd\nsudo iptables -L -n | grep f2b\n\n# View Fail2Ban logs\nsudo tail -f /var/log/fail2ban.log\n\n# Unban IP address\nsudo fail2ban-client set sshd unbanip 192.168.1.100\n\n# Ban IP manually\nsudo fail2ban-client set sshd banip 10.0.0.1\n\n# Reload configuration\nsudo fail2ban-client reload\n\n# Test SSH jail\nsudo grep \u0026quot;Failed password\u0026quot; /var/log/auth.log | head -5\nsudo fail2ban-regex /var/log/auth.log /etc/fail2ban/filter.d/sshd.conf\n\n# Check iptables rules\nsudo iptables -L f2b-sshd -n\nsudo iptables -L INPUT -n | grep f2b\n\n# Debug mode\nsudo fail2ban-server -f -v\n\n# Configuration validation\nsudo fail2ban-client -t\n\n# Check log file permissions\nls -la /var/log/auth.log\nls -la /var/log/nginx/access.log\n\n# Monitor real-time bans\nsudo tail -f /var/log/fail2ban.log | grep \u0026quot;Ban\\|Unban\u0026quot;\n\n# Check jail configuration\nsudo fail2ban-client get sshd maxretry\nsudo fail2ban-client get sshd bantime\nsudo fail2ban-client get sshd findtime\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://fail2ban.readthedocs.io/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eFail2Ban Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://github.com/fail2ban/fail2ban\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eFail2Ban GitHub\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://fail2ban.readthedocs.io/en/stable/filters.html\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eFilter Configuration Guide\u003c/a\u003e\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection.\u003c/p\u003e","readTime":"12 min","wordCount":2249,"lastBuilt":"2025-09-15T18:14:36.840Z"},{"name":"keycloak","displayName":"Keycloak","slug":"keycloak","description":"Repo for keycloak","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/keycloak","updatedAt":"2025-09-08T03:10:05Z","createdAt":"2025-09-08T03:09:55Z","readmeRaw":"## 👋 Welcome to keycloak 🚀  \n\nkeycloak README  \n  \n  \n## Author  \n\n🤖 casjay: [Github](https://github.com/casjay) 🤖  \n","readmeHtml":"\u003ch2 id=\"welcome-to-keycloak\" class=\"mobile-header\"\u003e👋 Welcome to keycloak 🚀  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003ekeycloak README  \u003c/p\u003e\n\u003ch2 id=\"author\" class=\"mobile-header\"\u003eAuthor  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003e🤖 casjay: \u003ca href=\"https://github.com/casjay\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGithub\u003c/a\u003e 🤖  \u003c/p\u003e","readTime":"1 min","wordCount":15,"lastBuilt":"2025-09-15T18:14:52.260Z"},{"name":"openvpn","displayName":"Openvpn","slug":"openvpn","description":"Repo for openvpn","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/openvpn","updatedAt":"2025-09-08T03:13:07Z","createdAt":"2025-09-08T03:12:57Z","readmeRaw":"## 👋 Welcome to openvpn 🚀  \n\nopenvpn README  \n  \n  \n## Author  \n\n🤖 casjay: [Github](https://github.com/casjay) 🤖  \n","readmeHtml":"\u003ch2 id=\"welcome-to-openvpn\" class=\"mobile-header\"\u003e👋 Welcome to openvpn 🚀  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eopenvpn README  \u003c/p\u003e\n\u003ch2 id=\"author\" class=\"mobile-header\"\u003eAuthor  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003e🤖 casjay: \u003ca href=\"https://github.com/casjay\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGithub\u003c/a\u003e 🤖  \u003c/p\u003e","readTime":"1 min","wordCount":15,"lastBuilt":"2025-09-15T18:14:47.956Z"},{"name":"pihole","displayName":"Pi-hole","slug":"pihole","description":"Repo for pihole","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/pihole","updatedAt":"2025-09-14T01:30:48Z","createdAt":"2025-09-08T03:14:08Z","readmeRaw":"# Pi-hole Installation Guide\n\nNetwork-wide ad and tracker blocking DNS sinkhole that protects your entire network from unwanted content without requiring client-side software. Essential tool for privacy, security, and performance improvement.\n\n## Prerequisites\n\n- Linux system (any modern distribution)\n- Root or sudo access\n- 1GB RAM minimum, 2GB recommended\n- Static IP address for DNS server\n- Port 53 available for DNS service\n- Web server port (80/443) available for admin interface\n\n## Installation\n\n### One-Line Installation (Recommended)\n```bash\n# Download and run the automated installer\ncurl -sSL https://install.pi-hole.net | bash\n\n# Alternative: Download and review before running\nwget -O basic-install.sh https://install.pi-hole.net\nless basic-install.sh  # Review the script\nsudo bash basic-install.sh\n```\n\n### Ubuntu/Debian Manual Installation\n```bash\n# Update system packages\nsudo apt update \u0026\u0026 sudo apt upgrade -y\n\n# Install dependencies\nsudo apt install -y curl dnsutils net-tools\n\n# Create pihole user\nsudo useradd --system --shell /usr/sbin/nologin pihole\n\n# Download Pi-hole\ngit clone --depth 1 https://github.com/pi-hole/pi-hole.git Pi-hole\ncd Pi-hole\n\n# Run installer\nsudo bash automated\\ install/basic-install.sh\n\n# Verify installation\npihole status\ndig @localhost google.com\n```\n\n## Configuration\n\n### Enhanced Privacy Setup\n```bash\n# Configure maximum privacy\nsudo tee /etc/pihole/pihole-FTL.conf \u003e /dev/null \u003c\u003cEOF\nPRIVACYLEVEL=2\nMAXLOGAGE=24\nIGNORE_LOCALHOST=yes\nBLOCKINGMODE=IP-AAAA-NODATA\nCNAME_INSPECTION=yes\nEOF\n\nsudo systemctl restart pihole-FTL\n```\n\n### Custom Blocklists\n```bash\n# Add comprehensive blocklists\npihole -a -l https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts\npihole -a -l https://mirror1.malwaredomains.com/files/justdomains\npihole -a -l https://s3.amazonaws.com/lists.disconnect.me/simple_tracking.txt\n\n# Update blocklists\npihole -g\n```\n\n## Security and Monitoring\n\n### Security Hardening\n```bash\n# Secure web interface\nsudo tee /etc/lighttpd/conf-available/99-pihole-security.conf \u003e /dev/null \u003c\u003cEOF\nserver.modules += ( \"mod_setenv\" )\nsetenv.add-response-header = (\n    \"X-Frame-Options\" =\u003e \"DENY\",\n    \"X-Content-Type-Options\" =\u003e \"nosniff\",\n    \"Strict-Transport-Security\" =\u003e \"max-age=31536000\"\n)\nEOF\n\nsudo lighttpd-enable-mod pihole-security\nsudo systemctl restart lighttpd\n```\n\n### Monitoring Script\n```bash\nsudo tee /usr/local/bin/pihole-monitor.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nLOG=\"/var/log/pihole-monitor.log\"\n\nlog_message() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" | tee -a ${LOG}\n}\n\n# Check service\nif systemctl is-active pihole-FTL \u003e/dev/null; then\n    log_message \"✓ Pi-hole service running\"\nelse\n    log_message \"✗ Pi-hole service not running\"\nfi\n\n# Check DNS resolution\nif dig @localhost google.com +short \u003e/dev/null 2\u003e\u00261; then\n    log_message \"✓ DNS resolution working\"\nelse\n    log_message \"✗ DNS resolution failed\"\nfi\n\n# Check blocking\nif dig @localhost doubleclick.net +short | grep -q \"0.0.0.0\"; then\n    log_message \"✓ Ad blocking working\"\nelse\n    log_message \"⚠ Ad blocking issues\"\nfi\n\nlog_message \"Pi-hole monitoring completed\"\nEOF\n\nsudo chmod +x /usr/local/bin/pihole-monitor.sh\necho \"*/15 * * * * root /usr/local/bin/pihole-monitor.sh\" | sudo tee -a /etc/crontab\n```\n\n## Backup Strategy\n\n```bash\nsudo tee /usr/local/bin/pihole-backup.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nBACKUP_DIR=\"/backup/pihole\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}\n\n# Backup Pi-hole configuration\npihole -a -t \u003e ${BACKUP_DIR}/pihole-backup-${DATE}.tar.gz\n\n# Keep last 14 backups\nfind ${BACKUP_DIR} -name \"pihole-backup-*.tar.gz\" -mtime +14 -delete\n\necho \"Pi-hole backup completed: ${DATE}\"\nEOF\n\nsudo chmod +x /usr/local/bin/pihole-backup.sh\necho \"0 2 * * * root /usr/local/bin/pihole-backup.sh\" | sudo tee -a /etc/crontab\n```\n\n## Additional Resources\n\n- [Pi-hole Documentation](https://docs.pi-hole.net/)\n- [Pi-hole Community](https://discourse.pi-hole.net/)\n- [Blocklist Collections](https://github.com/hectorm/hmirror)\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection.","readmeHtml":"\u003ch1 id=\"pi-hole-installation-guide\" class=\"mobile-header\"\u003ePi-hole Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eNetwork-wide ad and tracker blocking DNS sinkhole that protects your entire network from unwanted content without requiring client-side software. Essential tool for privacy, security, and performance improvement.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux system (any modern distribution)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot or sudo access\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e1GB RAM minimum, 2GB recommended\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eStatic IP address for DNS server\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003ePort 53 available for DNS service\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eWeb server port (80/443) available for admin interface\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"one-line-installation-recommended\" class=\"mobile-header\"\u003eOne-Line Installation (Recommended)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Download and run the automated installer\ncurl -sSL https://install.pi-hole.net | bash\n\n# Alternative: Download and review before running\nwget -O basic-install.sh https://install.pi-hole.net\nless basic-install.sh  # Review the script\nsudo bash basic-install.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"ubuntudebian-manual-installation\" class=\"mobile-header\"\u003eUbuntu/Debian Manual Installation\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update system packages\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade -y\n\n# Install dependencies\nsudo apt install -y curl dnsutils net-tools\n\n# Create pihole user\nsudo useradd --system --shell /usr/sbin/nologin pihole\n\n# Download Pi-hole\ngit clone --depth 1 https://github.com/pi-hole/pi-hole.git Pi-hole\ncd Pi-hole\n\n# Run installer\nsudo bash automated\\ install/basic-install.sh\n\n# Verify installation\npihole status\ndig @localhost google.com\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"configuration\" class=\"mobile-header\"\u003eConfiguration\u003c/h2\u003e\n\u003ch3 id=\"enhanced-privacy-setup\" class=\"mobile-header\"\u003eEnhanced Privacy Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure maximum privacy\nsudo tee /etc/pihole/pihole-FTL.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\nPRIVACYLEVEL=2\nMAXLOGAGE=24\nIGNORE_LOCALHOST=yes\nBLOCKINGMODE=IP-AAAA-NODATA\nCNAME_INSPECTION=yes\nEOF\n\nsudo systemctl restart pihole-FTL\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"custom-blocklists\" class=\"mobile-header\"\u003eCustom Blocklists\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Add comprehensive blocklists\npihole -a -l https://raw.githubusercontent.com/StevenBlack/hosts/master/hosts\npihole -a -l https://mirror1.malwaredomains.com/files/justdomains\npihole -a -l https://s3.amazonaws.com/lists.disconnect.me/simple_tracking.txt\n\n# Update blocklists\npihole -g\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"security-and-monitoring\" class=\"mobile-header\"\u003eSecurity and Monitoring\u003c/h2\u003e\n\u003ch3 id=\"security-hardening\" class=\"mobile-header\"\u003eSecurity Hardening\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Secure web interface\nsudo tee /etc/lighttpd/conf-available/99-pihole-security.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\nserver.modules += ( \u0026quot;mod_setenv\u0026quot; )\nsetenv.add-response-header = (\n    \u0026quot;X-Frame-Options\u0026quot; =\u0026gt; \u0026quot;DENY\u0026quot;,\n    \u0026quot;X-Content-Type-Options\u0026quot; =\u0026gt; \u0026quot;nosniff\u0026quot;,\n    \u0026quot;Strict-Transport-Security\u0026quot; =\u0026gt; \u0026quot;max-age=31536000\u0026quot;\n)\nEOF\n\nsudo lighttpd-enable-mod pihole-security\nsudo systemctl restart lighttpd\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"monitoring-script\" class=\"mobile-header\"\u003eMonitoring Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/pihole-monitor.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nLOG=\u0026quot;/var/log/pihole-monitor.log\u0026quot;\n\nlog_message() {\n    echo \u0026quot;$(date \u0026#039;+%Y-%m-%d %H:%M:%S\u0026#039;) - $1\u0026quot; | tee -a ${LOG}\n}\n\n# Check service\nif systemctl is-active pihole-FTL \u0026gt;/dev/null; then\n    log_message \u0026quot;✓ Pi-hole service running\u0026quot;\nelse\n    log_message \u0026quot;✗ Pi-hole service not running\u0026quot;\nfi\n\n# Check DNS resolution\nif dig @localhost google.com +short \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;✓ DNS resolution working\u0026quot;\nelse\n    log_message \u0026quot;✗ DNS resolution failed\u0026quot;\nfi\n\n# Check blocking\nif dig @localhost doubleclick.net +short | grep -q \u0026quot;0.0.0.0\u0026quot;; then\n    log_message \u0026quot;✓ Ad blocking working\u0026quot;\nelse\n    log_message \u0026quot;⚠ Ad blocking issues\u0026quot;\nfi\n\nlog_message \u0026quot;Pi-hole monitoring completed\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/pihole-monitor.sh\necho \u0026quot;*/15 * * * * root /usr/local/bin/pihole-monitor.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-strategy\" class=\"mobile-header\"\u003eBackup Strategy\u003c/h2\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/pihole-backup.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nBACKUP_DIR=\u0026quot;/backup/pihole\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}\n\n# Backup Pi-hole configuration\npihole -a -t \u0026gt; ${BACKUP_DIR}/pihole-backup-${DATE}.tar.gz\n\n# Keep last 14 backups\nfind ${BACKUP_DIR} -name \u0026quot;pihole-backup-*.tar.gz\u0026quot; -mtime +14 -delete\n\necho \u0026quot;Pi-hole backup completed: ${DATE}\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/pihole-backup.sh\necho \u0026quot;0 2 * * * root /usr/local/bin/pihole-backup.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://docs.pi-hole.net/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ePi-hole Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://discourse.pi-hole.net/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003ePi-hole Community\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://github.com/hectorm/hmirror\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eBlocklist Collections\u003c/a\u003e\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection.\u003c/p\u003e","readTime":"3 min","wordCount":479,"lastBuilt":"2025-09-15T18:14:32.549Z"},{"name":"vault","displayName":"Vault","slug":"vault","description":"Repo for vault","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/vault","updatedAt":"2025-09-14T01:31:19Z","createdAt":"2025-09-08T03:17:55Z","readmeRaw":"# HashiCorp Vault Installation Guide\n\nEnterprise-grade secrets management platform for securely storing and accessing API keys, passwords, certificates, and other sensitive data. Industry standard for secrets management with advanced security features.\n\n## Prerequisites\n\n- Linux system (any modern distribution)\n- Root or sudo access\n- 4GB RAM minimum, 8GB+ recommended for production\n- Persistent storage for Vault data (encrypted disk recommended)\n- TLS certificates for production deployment\n- HSM (optional, for enterprise compliance)\n\n## Installation\n\n### Using Package Manager (Recommended)\n\n#### Ubuntu/Debian\n```bash\n# Add HashiCorp GPG key\nwget -O- https://apt.releases.hashicorp.com/gpg | sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg\n\n# Add HashiCorp repository\necho \"deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main\" | sudo tee /etc/apt/sources.list.d/hashicorp.list\n\n# Update and install Vault\nsudo apt update\nsudo apt install -y vault\n\n# Create vault user and directories\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\n```\n\n#### RHEL/CentOS/Rocky Linux/AlmaLinux\n```bash\n# Add HashiCorp repository\nsudo yum install -y yum-utils\nsudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo\n\n# Install Vault\nsudo yum install -y vault\n\n# Create vault user and directories\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\n```\n\n#### Fedora\n```bash\n# Add HashiCorp repository\nsudo dnf install -y dnf-plugins-core\nsudo dnf config-manager --add-repo https://rpm.releases.hashicorp.com/fedora/hashicorp.repo\n\n# Install Vault\nsudo dnf install -y vault\n\n# Setup directories and user\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\n```\n\n#### Arch Linux\n```bash\n# Install from AUR\nyay -S vault\n\n# Or from community repository\nsudo pacman -Syu vault\n\n# Setup vault user and directories\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\n```\n\n### Manual Binary Installation\n```bash\n# Download latest Vault\nVAULT_VERSION=\"1.15.2\"\ncd /tmp\nwget https://releases.hashicorp.com/vault/${VAULT_VERSION}/vault_${VAULT_VERSION}_linux_amd64.zip\n\n# Install unzip if needed\nsudo apt install -y unzip  # Ubuntu/Debian\nsudo yum install -y unzip  # RHEL/CentOS\nsudo pacman -S unzip       # Arch Linux\n\n# Extract and install\nunzip vault_${VAULT_VERSION}_linux_amd64.zip\nsudo mv vault /usr/local/bin/\nsudo chmod +x /usr/local/bin/vault\n\n# Create vault user\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\n\n# Create directories\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\n\n# Verify installation\nvault version\n\n# Clean up\nrm vault_${VAULT_VERSION}_linux_amd64.zip\n```\n\n### Using Docker\n```bash\n# Create directories for persistent data\nmkdir -p ~/vault/{data,config,logs,tls}\n\n# Generate TLS certificates for Docker\nopenssl req -x509 -nodes -newkey rsa:4096 -keyout ~/vault/tls/vault.key -out ~/vault/tls/vault.crt -days 365 -subj \"/C=US/ST=State/L=City/O=Organization/CN=vault.example.com\"\n\n# Create production-ready configuration\ncat \u003e ~/vault/config/vault.hcl \u003c\u003cEOF\nui = true\ndisable_mlock = false\n\n# Storage backend\nstorage \"file\" {\n  path = \"/vault/data\"\n}\n\n# HTTPS listener\nlistener \"tcp\" {\n  address       = \"0.0.0.0:8200\"\n  tls_cert_file = \"/vault/tls/vault.crt\"\n  tls_key_file  = \"/vault/tls/vault.key\"\n  tls_min_version = \"tls12\"\n}\n\n# Cluster configuration\napi_addr = \"https://vault.example.com:8200\"\ncluster_addr = \"https://vault.example.com:8201\"\n\n# Logging\nlog_level = \"Info\"\nlog_file  = \"/vault/logs/vault.log\"\nlog_rotate_duration = \"24h\"\nlog_rotate_max_files = 15\n\n# Telemetry\ntelemetry {\n  prometheus_retention_time = \"30s\"\n  disable_hostname = true\n}\n\n# Enterprise features (if using Vault Enterprise)\nlicense_path = \"/vault/license/vault.hclic\"\n\n# Performance replication (Enterprise)\nreplication {\n  resolver_discover_servers = false\n}\nEOF\n\n# Run Vault container with security settings\ndocker run -d \\\n  --name vault \\\n  --restart unless-stopped \\\n  --cap-add=IPC_LOCK \\\n  --ulimit memlock=-1:-1 \\\n  -p 8200:8200 \\\n  -v ~/vault/data:/vault/data \\\n  -v ~/vault/config:/vault/config \\\n  -v ~/vault/logs:/vault/logs \\\n  -v ~/vault/tls:/vault/tls \\\n  vault:latest server -config=/vault/config/vault.hcl\n```\n\n## Production Configuration\n\n### Enterprise Production Configuration\n```bash\n# Create comprehensive production configuration\nsudo tee /etc/vault.d/vault.hcl \u003e /dev/null \u003c\u003cEOF\n# Vault Enterprise Production Configuration\n\n# UI and basic settings\nui = true\ndisable_mlock = false\n\n# Storage backend - Consul (HA) or Integrated Storage (Raft)\nstorage \"raft\" {\n  path    = \"/opt/vault/data\"\n  node_id = \"vault-node-1\"\n\n  retry_join {\n    leader_api_addr = \"https://vault-node-2.example.com:8200\"\n  }\n  \n  retry_join {\n    leader_api_addr = \"https://vault-node-3.example.com:8200\"\n  }\n\n  # Enterprise: Performance replication\n  autopilot {\n    cleanup_dead_servers = true\n    last_contact_threshold = \"200ms\"\n    max_trailing_logs = 250\n    min_quorum = 3\n    server_stabilization_time = \"10s\"\n  }\n}\n\n# Alternative: Consul backend for HA\n# storage \"consul\" {\n#   address = \"127.0.0.1:8500\"\n#   path    = \"vault/\"\n#   service = \"vault\"\n#   check_timeout = \"5s\"\n#   disable_registration = false\n# }\n\n# HTTPS listener with modern TLS\nlistener \"tcp\" {\n  address       = \"0.0.0.0:8200\"\n  tls_cert_file = \"/opt/vault/tls/vault.crt\"\n  tls_key_file  = \"/opt/vault/tls/vault.key\"\n  tls_min_version = \"tls12\"\n  tls_cipher_suites = \"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\"\n  tls_require_and_verify_client_cert = false\n  tls_client_ca_file = \"/opt/vault/tls/ca.crt\"\n}\n\n# Cluster listener for HA\nlistener \"tcp\" {\n  address = \"0.0.0.0:8201\" \n  cluster_address = \"0.0.0.0:8201\"\n  tls_cert_file = \"/opt/vault/tls/vault.crt\"\n  tls_key_file  = \"/opt/vault/tls/vault.key\"\n}\n\n# API and cluster addresses\napi_addr = \"https://vault.example.com:8200\"\ncluster_addr = \"https://vault.example.com:8201\"\n\n# Enterprise license\nlicense_path = \"/opt/vault/license/vault.hclic\"\n\n# Logging configuration\nlog_level = \"Info\"\nlog_file  = \"/opt/vault/logs/vault.log\"\nlog_rotate_duration = \"24h\"\nlog_rotate_max_files = 30\n\n# Telemetry and monitoring\ntelemetry {\n  prometheus_retention_time = \"30s\"\n  disable_hostname = true\n  usage_gauge_period = \"5m\"\n}\n\n# Seal configuration - Auto-unseal with cloud KMS (Enterprise)\nseal \"awskms\" {\n  region     = \"us-west-2\"\n  kms_key_id = \"arn:aws:kms:us-west-2:123456789012:key/12345678-1234-1234-1234-123456789012\"\n}\n\n# Alternative: Azure Key Vault\n# seal \"azurekeyvault\" {\n#   tenant_id      = \"46646709-b63e-4747-be42-516edeaf1e14\"\n#   client_id      = \"03dc33fc-16d9-4b77-8152-3ec568f8af6e\"\n#   client_secret  = \"DUJDS3...\"\n#   vault_name     = \"hc-vault\"\n#   key_name       = \"vault_key\"\n# }\n\n# Alternative: Google Cloud KMS\n# seal \"gcpckms\" {\n#   project     = \"vault-project\"\n#   region      = \"us-central1\"\n#   key_ring    = \"vault-keyring\"\n#   crypto_key  = \"vault-key\"\n# }\n\n# Performance replication (Enterprise)\nreplication {\n  resolver_discover_servers = false\n}\n\n# HSM configuration (Enterprise with HSM)\n# seal \"pkcs11\" {\n#   lib            = \"/usr/lib/softhsm/libsofthsm2.so\"\n#   slot           = \"0\"\n#   pin            = \"1234\"\n#   key_label      = \"vault-hsm-key\"\n#   hmac_key_label = \"vault-hsm-hmac-key\"\n# }\nEOF\n\nsudo chown vault:vault /etc/vault.d/vault.hcl\nsudo chmod 640 /etc/vault.d/vault.hcl\n```\n\n### Advanced TLS Configuration\n```bash\n# Generate production-grade TLS certificates\nsudo mkdir -p /opt/vault/tls\n\n# Create CA certificate\nsudo openssl genrsa -out /opt/vault/tls/ca-key.pem 4096\nsudo openssl req -new -x509 -days 3650 -key /opt/vault/tls/ca-key.pem -out /opt/vault/tls/ca.crt -subj \"/C=US/ST=State/L=City/O=Organization/CN=Vault-CA\"\n\n# Create server certificate\nsudo openssl genrsa -out /opt/vault/tls/vault-key.pem 4096\nsudo openssl req -new -key /opt/vault/tls/vault-key.pem -out /opt/vault/tls/vault.csr -subj \"/C=US/ST=State/L=City/O=Organization/CN=vault.example.com\"\n\n# Create certificate with SAN extensions\nsudo tee /opt/vault/tls/vault.conf \u003e /dev/null \u003c\u003cEOF\n[req]\ndistinguished_name = req_distinguished_name\nreq_extensions = v3_req\n\n[req_distinguished_name]\n\n[v3_req]\nbasicConstraints = CA:FALSE\nkeyUsage = nonRepudiation, digitalSignature, keyEncipherment\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = vault.example.com\nDNS.2 = vault-node-1.example.com\nDNS.3 = vault-node-2.example.com\nDNS.4 = vault-node-3.example.com\nDNS.5 = localhost\nIP.1 = 127.0.0.1\nIP.2 = 10.0.1.10\nIP.3 = 10.0.1.11\nIP.4 = 10.0.1.12\nEOF\n\nsudo openssl x509 -req -days 365 -in /opt/vault/tls/vault.csr -CA /opt/vault/tls/ca.crt -CAkey /opt/vault/tls/ca-key.pem -CAcreateserial -out /opt/vault/tls/vault.crt -extensions v3_req -extfile /opt/vault/tls/vault.conf\n\n# Set secure permissions\nsudo chmod 600 /opt/vault/tls/*-key.pem\nsudo chmod 644 /opt/vault/tls/*.crt\nsudo chown -R vault:vault /opt/vault/tls\n\n# For Let's Encrypt certificates (production)\nsudo apt install -y certbot  # Ubuntu/Debian\nsudo yum install -y certbot  # RHEL/CentOS\n\nsudo certbot certonly --standalone -d vault.example.com\nsudo cp /etc/letsencrypt/live/vault.example.com/fullchain.pem /opt/vault/tls/vault.crt\nsudo cp /etc/letsencrypt/live/vault.example.com/privkey.pem /opt/vault/tls/vault-key.pem\nsudo chown vault:vault /opt/vault/tls/vault.*\n```\n\n### Enterprise SystemD Service with Security Hardening\n```bash\nsudo tee /etc/systemd/system/vault.service \u003e /dev/null \u003c\u003cEOF\n[Unit]\nDescription=HashiCorp Vault - A tool for managing secrets\nDocumentation=https://www.vaultproject.io/docs/\nRequires=network-online.target\nAfter=network-online.target\nConditionFileNotEmpty=/etc/vault.d/vault.hcl\nStartLimitIntervalSec=60\nStartLimitBurst=3\n\n[Service]\nType=notify\nUser=vault\nGroup=vault\nExecStart=/usr/local/bin/vault server -config=/etc/vault.d/vault.hcl\nExecReload=/bin/kill --signal HUP \\$MAINPID\nKillMode=process\nRestart=on-failure\nRestartSec=5\nTimeoutStopSec=30\nStartLimitInterval=60\nStartLimitBurst=3\n\n# File system isolation\nProtectSystem=full\nProtectHome=read-only\nPrivateTmp=yes\nPrivateDevices=yes\n\n# Secure computing\nNoNewPrivileges=yes\nSecureBits=keep-caps\nCapabilityBoundingSet=CAP_SYSLOG CAP_IPC_LOCK\n\n# Additional security features\nAmbientCapabilities=CAP_IPC_LOCK\nCapabilities=CAP_IPC_LOCK+ep\n\n# Resource limits\nLimitNOFILE=65536\nLimitMEMLOCK=infinity\nLimitCORE=0\n\n# Network isolation\nRestrictNamespaces=yes\nRestrictRealtime=yes\n\n# Read-only paths\nReadOnlyPaths=/etc /usr\n\n# Writable paths\nReadWritePaths=/opt/vault/data\nReadWritePaths=/opt/vault/logs\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsudo systemctl daemon-reload\n```\n\n### High Availability Cluster Setup\n```bash\n# Configure HA cluster with Integrated Storage (Raft)\n# Node 1 configuration\nsudo tee /etc/vault.d/vault.hcl \u003e /dev/null \u003c\u003cEOF\nui = true\ndisable_mlock = false\n\nstorage \"raft\" {\n  path    = \"/opt/vault/data\"\n  node_id = \"vault-node-1\"\n}\n\nlistener \"tcp\" {\n  address       = \"0.0.0.0:8200\"\n  tls_cert_file = \"/opt/vault/tls/vault.crt\"\n  tls_key_file  = \"/opt/vault/tls/vault-key.pem\"\n  tls_min_version = \"tls12\"\n}\n\nlistener \"tcp\" {\n  address       = \"0.0.0.0:8201\"\n  cluster_address = \"10.0.1.10:8201\"\n  tls_cert_file = \"/opt/vault/tls/vault.crt\"\n  tls_key_file  = \"/opt/vault/tls/vault-key.pem\"\n}\n\napi_addr = \"https://10.0.1.10:8200\"\ncluster_addr = \"https://10.0.1.10:8201\"\n\n# Enterprise features\nlicense_path = \"/opt/vault/license/vault.hclic\"\n\n# Auto-unseal with AWS KMS\nseal \"awskms\" {\n  region     = \"us-west-2\"\n  kms_key_id = \"arn:aws:kms:us-west-2:123456789012:key/vault-unseal-key\"\n}\n\n# Performance replication (Enterprise)\nreplication {\n  resolver_discover_servers = false\n}\nEOF\n\n# Initialize cluster on first node\nsudo systemctl start vault\nexport VAULT_ADDR='https://127.0.0.1:8200'\nexport VAULT_SKIP_VERIFY=true  # Only for self-signed certs\nvault operator init -recovery-shares=5 -recovery-threshold=3\n\n# Join additional nodes to cluster\n# Node 2 and 3: Add retry_join blocks to their vault.hcl\nsudo tee -a /etc/vault.d/vault.hcl \u003e /dev/null \u003c\u003cEOF\n\nstorage \"raft\" {\n  path    = \"/opt/vault/data\"\n  node_id = \"vault-node-2\"  # Change to node-3 for third node\n  \n  retry_join {\n    leader_api_addr = \"https://10.0.1.10:8200\"\n  }\n}\nEOF\n```\n\n## Security Hardening (2024 Best Practices)\n\n### System-Level Security\n```bash\n# Disable swap (critical for security)\nsudo swapoff -a\nsudo sed -i '/ swap / s/^\\(.*\\)$/#\\1/g' /etc/fstab\n\n# Disable core dumps\necho '* hard core 0' | sudo tee -a /etc/security/limits.conf\necho '* soft core 0' | sudo tee -a /etc/security/limits.conf\necho 'vault hard core 0' | sudo tee -a /etc/security/limits.conf\necho 'vault soft core 0' | sudo tee -a /etc/security/limits.conf\n\n# Configure kernel parameters for security\nsudo tee -a /etc/sysctl.conf \u003e /dev/null \u003c\u003cEOF\n# Vault security hardening\nkernel.dmesg_restrict = 1\nkernel.kptr_restrict = 2\nkernel.yama.ptrace_scope = 1\nfs.suid_dumpable = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nEOF\n\nsudo sysctl -p\n\n# SELinux configuration (RHEL/CentOS/Fedora)\nif command -v getenforce \u003e/dev/null 2\u003e\u00261; then\n    sudo setsebool -P authlogin_nsswitch_use_ldap 1\n    sudo setsebool -P allow_execheap 0\n    sudo setsebool -P allow_execmem 0\n    sudo setsebool -P allow_execmod 0\n    sudo setsebool -P allow_execstack 0\n    \n    # Custom SELinux policy for Vault\n    sudo tee vault.te \u003e /dev/null \u003c\u003cEOF\nmodule vault 1.0;\n\nrequire {\n    type unconfined_t;\n    type vault_t;\n    class capability { ipc_lock sys_admin };\n    class process { setrlimit };\n}\n\n#============= vault_t ==============\nallow vault_t self:capability { ipc_lock sys_admin };\nallow vault_t self:process setrlimit;\nEOF\n\n    checkmodule -M -m -o vault.mod vault.te\n    semodule_package -o vault.pp -m vault.mod\n    sudo semodule -i vault.pp\nfi\n\n# AppArmor configuration (Ubuntu/Debian)\nif command -v apparmor_status \u003e/dev/null 2\u003e\u00261; then\n    sudo tee /etc/apparmor.d/vault \u003e /dev/null \u003c\u003cEOF\n#include \u003ctunables/global\u003e\n\n/usr/local/bin/vault {\n  #include \u003cabstractions/base\u003e\n  #include \u003cabstractions/nameservice\u003e\n  #include \u003cabstractions/ssl_certs\u003e\n\n  capability ipc_lock,\n  capability setuid,\n  capability setgid,\n\n  /usr/local/bin/vault mr,\n  /etc/vault.d/** r,\n  /opt/vault/** rwk,\n  /proc/meminfo r,\n  /proc/sys/kernel/random/uuid r,\n  /sys/kernel/mm/transparent_hugepage/hpage_pmd_size r,\n\n  # Network access\n  network inet dgram,\n  network inet stream,\n\n  # Deny dangerous operations\n  deny /proc/kcore rwklx,\n  deny /proc/sysrq-trigger rwklx,\n  deny /proc/kmem rwklx,\n  deny /proc/mem rwklx,\n}\nEOF\n\n    sudo apparmor_parser -r /etc/apparmor.d/vault\nfi\n```\n\n### Firewall Configuration (Cross-Platform)\n```bash\n# UFW (Ubuntu/Debian)\nsudo ufw allow from 10.0.0.0/8 to any port 8200 comment 'Vault API - internal network only'\nsudo ufw allow from 10.0.0.0/8 to any port 8201 comment 'Vault cluster - internal network only'\nsudo ufw deny 8200 comment 'Block Vault API from public'\nsudo ufw deny 8201 comment 'Block Vault cluster from public'\nsudo ufw enable\n\n# Firewalld (RHEL/CentOS/Fedora)\nsudo firewall-cmd --permanent --new-zone=vault\nsudo firewall-cmd --permanent --zone=vault --add-source=10.0.0.0/8\nsudo firewall-cmd --permanent --zone=vault --add-port=8200/tcp\nsudo firewall-cmd --permanent --zone=vault --add-port=8201/tcp\nsudo firewall-cmd --reload\n\n# iptables (Universal)\nsudo iptables -A INPUT -p tcp -s 10.0.0.0/8 --dport 8200 -j ACCEPT\nsudo iptables -A INPUT -p tcp -s 10.0.0.0/8 --dport 8201 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 8200 -j DROP\nsudo iptables -A INPUT -p tcp --dport 8201 -j DROP\n\n# Save iptables rules\n# Ubuntu/Debian\nsudo apt install -y iptables-persistent\nsudo netfilter-persistent save\n\n# RHEL/CentOS\nsudo service iptables save\n```\n\n### Audit Logging and Monitoring\n```bash\n# Enable comprehensive audit logging\nexport VAULT_ADDR='https://127.0.0.1:8200'\nvault auth \u003croot-token\u003e\n\n# Enable file audit device\nvault audit enable file file_path=/opt/vault/logs/audit.log\n\n# Enable syslog audit device\nvault audit enable syslog tag=\"vault\" facility=\"LOCAL0\"\n\n# Configure log rotation for audit logs\nsudo tee /etc/logrotate.d/vault-audit \u003e /dev/null \u003c\u003cEOF\n/opt/vault/logs/audit.log {\n    daily\n    missingok\n    rotate 90\n    compress\n    delaycompress\n    notifempty\n    create 640 vault vault\n    postrotate\n        /bin/kill -HUP \\`cat /var/run/vault.pid 2\u003e/dev/null\\` 2\u003e/dev/null || true\n    endscript\n}\nEOF\n\n# Setup centralized logging (rsyslog configuration)\nsudo tee -a /etc/rsyslog.conf \u003e /dev/null \u003c\u003cEOF\n\n# Vault audit logging\nlocal0.*    /var/log/vault-audit.log\n\u0026 stop\nEOF\n\nsudo systemctl restart rsyslog\n\n# Prometheus monitoring configuration\nvault write sys/metrics/config enabled=true\n```\n\n## Authentication Methods and Policies\n\n### Enterprise Authentication Setup\n```bash\n# Enable and configure LDAP authentication\nvault auth enable ldap\n\nvault write auth/ldap/config \\\n    url=\"ldaps://ldap.example.com\" \\\n    userdn=\"ou=Users,dc=example,dc=com\" \\\n    userattr=\"sAMAccountName\" \\\n    groupdn=\"ou=Groups,dc=example,dc=com\" \\\n    groupfilter=\"(\u0026(objectClass=group)(member:1.2.840.113556.1.4.1941:={{.UserDN}}))\" \\\n    groupattr=\"cn\" \\\n    binddn=\"cn=vault,ou=Service Accounts,dc=example,dc=com\" \\\n    bindpass=\"ldap_service_password\" \\\n    starttls=true \\\n    insecure_tls=false \\\n    certificate=@/opt/vault/tls/ldap-ca.crt\n\n# Configure OIDC authentication (Azure AD example)\nvault auth enable oidc\n\nvault write auth/oidc/config \\\n    oidc_discovery_url=\"https://login.microsoftonline.com/your-tenant-id/v2.0\" \\\n    oidc_client_id=\"your-application-id\" \\\n    oidc_client_secret=\"your-client-secret\" \\\n    default_role=\"azure-ad-users\"\n\nvault write auth/oidc/role/azure-ad-users \\\n    bound_audiences=\"your-application-id\" \\\n    allowed_redirect_uris=\"https://vault.example.com:8200/ui/vault/auth/oidc/oidc/callback\" \\\n    user_claim=\"email\" \\\n    policies=\"azure-ad-policy\"\n\n# Enable GitHub authentication\nvault auth enable github\n\nvault write auth/github/config \\\n    organization=\"your-organization\" \\\n    base_url=\"https://github.com/\" \\\n    max_ttl=\"8h\" \\\n    ttl=\"1h\"\n\nvault write auth/github/map/teams/vault-admins value=admin-policy\nvault write auth/github/map/teams/developers value=developer-policy\n\n# AWS IAM authentication\nvault auth enable aws\n\nvault write auth/aws/config/client \\\n    secret_key=\"your-secret-key\" \\\n    access_key=\"your-access-key\"\n\nvault write auth/aws/role/ec2-role \\\n    auth_type=\"ec2\" \\\n    policies=\"ec2-policy\" \\\n    max_ttl=\"1h\" \\\n    bound_instances=\"i-1234567890abcdef0,i-0987654321fedcba0\"\n\n# Kubernetes authentication\nvault auth enable kubernetes\n\nvault write auth/kubernetes/config \\\n    token_reviewer_jwt=\"$(cat /var/run/secrets/kubernetes.io/serviceaccount/token)\" \\\n    kubernetes_host=\"https://kubernetes.example.com:6443\" \\\n    kubernetes_ca_cert=@/var/run/secrets/kubernetes.io/serviceaccount/ca.crt\n\nvault write auth/kubernetes/role/myapp \\\n    bound_service_account_names=\"vault-auth\" \\\n    bound_service_account_namespaces=\"default,production\" \\\n    policies=\"myapp-policy\" \\\n    ttl=\"1h\"\n```\n\n### Advanced Policy Management\n```bash\n# Create comprehensive policies with fine-grained access control\ncat \u003e admin-policy.hcl \u003c\u003cEOF\n# Admin policy with full access and audit capabilities\npath \"*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\", \"sudo\"]\n}\n\n# Audit log access for compliance\npath \"sys/audit/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\", \"sudo\"]\n}\n\n# Manage authentication methods\npath \"sys/auth/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\", \"sudo\"]\n}\n\n# Mount/unmount secrets engines\npath \"sys/mounts/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\", \"sudo\"]\n}\n\n# Configure and manage the audit devices\npath \"sys/audit\" {\n  capabilities = [\"read\", \"list\"]\n}\nEOF\n\ncat \u003e developer-policy.hcl \u003c\u003cEOF\n# Developer policy with limited access to application secrets\npath \"secret/data/applications/{{identity.entity.aliases.auth_github_*.name}}/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\n\npath \"secret/metadata/applications/{{identity.entity.aliases.auth_github_*.name}}/*\" {\n  capabilities = [\"list\"]\n}\n\n# Read-only access to shared secrets\npath \"secret/data/shared/*\" {\n  capabilities = [\"read\", \"list\"]\n}\n\n# Database credentials with time-bound access\npath \"database/creds/readonly\" {\n  capabilities = [\"read\"]\n}\n\n# PKI certificate generation for specific domains\npath \"pki/issue/developer-role\" {\n  capabilities = [\"create\", \"update\"]\n}\n\n# Self-service capabilities\npath \"auth/token/lookup-self\" {\n  capabilities = [\"read\"]\n}\n\npath \"auth/token/renew-self\" {\n  capabilities = [\"update\"]\n}\n\npath \"auth/token/revoke-self\" {\n  capabilities = [\"update\"]\n}\nEOF\n\ncat \u003e cicd-policy.hcl \u003c\u003cEOF\n# CI/CD policy for automated systems\npath \"secret/data/cicd/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\n\n# Database credentials for deployments\npath \"database/creds/application-user\" {\n  capabilities = [\"read\"]\n}\n\n# PKI for service certificates\npath \"pki/issue/service-role\" {\n  capabilities = [\"create\", \"update\"]\n}\n\n# Kubernetes service account tokens\npath \"kubernetes/creds/application-role\" {\n  capabilities = [\"read\"]\n}\n\n# AWS credentials for deployment\npath \"aws/creds/deployment-role\" {\n  capabilities = [\"read\"]\n}\nEOF\n\n# Apply policies\nvault policy write admin admin-policy.hcl\nvault policy write developer developer-policy.hcl\nvault policy write cicd cicd-policy.hcl\n\n# Create entity for identity management\nvault write identity/entity \\\n    name=\"john.doe\" \\\n    policies=\"developer\" \\\n    metadata=department=\"engineering\" \\\n    metadata=team=\"platform\"\n```\n\n## Advanced Secrets Engines\n\n### Database Secrets Engine\n```bash\n# Enable database secrets engine\nvault secrets enable database\n\n# Configure MySQL connection\nvault write database/config/mysql-prod \\\n    plugin_name=mysql-database-plugin \\\n    connection_url=\"{{username}}:{{password}}@tcp(mysql.example.com:3306)/\" \\\n    allowed_roles=\"mysql-admin,mysql-readonly,mysql-application\" \\\n    username=\"vault\" \\\n    password=\"vault-service-password\" \\\n    max_open_connections=5 \\\n    max_idle_connections=0 \\\n    max_connection_lifetime=\"10m\"\n\n# Create roles for different access levels\nvault write database/roles/mysql-admin \\\n    db_name=mysql-prod \\\n    creation_statements=\"CREATE USER '{{name}}'@'%' IDENTIFIED BY '{{password}}'; GRANT ALL ON *.* TO '{{name}}'@'%';\" \\\n    default_ttl=\"1h\" \\\n    max_ttl=\"24h\"\n\nvault write database/roles/mysql-readonly \\\n    db_name=mysql-prod \\\n    creation_statements=\"CREATE USER '{{name}}'@'%' IDENTIFIED BY '{{password}}'; GRANT SELECT ON *.* TO '{{name}}'@'%';\" \\\n    default_ttl=\"1h\" \\\n    max_ttl=\"8h\"\n\nvault write database/roles/mysql-application \\\n    db_name=mysql-prod \\\n    creation_statements=\"CREATE USER '{{name}}'@'%' IDENTIFIED BY '{{password}}'; GRANT SELECT, INSERT, UPDATE, DELETE ON app_db.* TO '{{name}}'@'%';\" \\\n    default_ttl=\"30m\" \\\n    max_ttl=\"2h\"\n\n# PostgreSQL configuration\nvault write database/config/postgres-prod \\\n    plugin_name=postgresql-database-plugin \\\n    connection_url=\"postgresql://{{username}}:{{password}}@postgres.example.com:5432/postgres?sslmode=require\" \\\n    allowed_roles=\"postgres-admin,postgres-readonly\" \\\n    username=\"vault\" \\\n    password=\"vault-postgres-password\"\n\nvault write database/roles/postgres-admin \\\n    db_name=postgres-prod \\\n    creation_statements=\"CREATE ROLE \\\"{{name}}\\\" WITH LOGIN PASSWORD '{{password}}' VALID UNTIL '{{expiration}}'; GRANT ALL PRIVILEGES ON DATABASE app_db TO \\\"{{name}}\\\";\" \\\n    default_ttl=\"1h\" \\\n    max_ttl=\"24h\"\n```\n\n### PKI Secrets Engine (Enterprise Certificate Management)\n```bash\n# Enable PKI secrets engine for internal CA\nvault secrets enable -path=pki pki\n\n# Configure CA\nvault secrets tune -max-lease-ttl=87600h pki\n\n# Generate internal CA certificate\nvault write -field=certificate pki/root/generate/internal \\\n    common_name=\"Internal CA\" \\\n    issuer_name=\"internal-ca\" \\\n    ttl=87600h \u003e /opt/vault/tls/internal-ca.crt\n\n# Configure certificate URLs\nvault write pki/config/urls \\\n    issuing_certificates=\"https://vault.example.com:8200/v1/pki/ca\" \\\n    crl_distribution_points=\"https://vault.example.com:8200/v1/pki/crl\"\n\n# Create intermediate CA\nvault secrets enable -path=pki_int pki\n\nvault secrets tune -max-lease-ttl=43800h pki_int\n\n# Generate intermediate CSR\nvault write -format=json pki_int/intermediate/generate/internal \\\n    common_name=\"Internal Intermediate CA\" \\\n    issuer_name=\"internal-intermediate-ca\" \\\n    | jq -r '.data.csr' \u003e pki_intermediate.csr\n\n# Sign intermediate certificate\nvault write -format=json pki/root/sign-intermediate \\\n    issuer_ref=\"internal-ca\" \\\n    csr=@pki_intermediate.csr \\\n    format=pem_bundle ttl=\"43800h\" \\\n    | jq -r '.data.certificate' \u003e intermediate.cert.pem\n\n# Import signed certificate\nvault write pki_int/intermediate/set-signed certificate=@intermediate.cert.pem\n\n# Create role for service certificates\nvault write pki_int/roles/service-role \\\n    issuer_ref=\"internal-intermediate-ca\" \\\n    allowed_domains=\"example.com,internal.example.com\" \\\n    allow_subdomains=true \\\n    max_ttl=\"72h\" \\\n    generate_lease=true\n\n# Create role for client certificates\nvault write pki_int/roles/client-role \\\n    issuer_ref=\"internal-intermediate-ca\" \\\n    allowed_domains=\"client.example.com\" \\\n    allow_subdomains=false \\\n    client_flag=true \\\n    max_ttl=\"24h\"\n\n# Generate certificate\nvault write pki_int/issue/service-role common_name=\"api.example.com\" ttl=\"24h\"\n```\n\n### Cloud Provider Integration\n\n#### AWS Secrets Engine\n```bash\n# Enable AWS secrets engine\nvault secrets enable aws\n\n# Configure AWS credentials\nvault write aws/config/root \\\n    access_key=\"vault-aws-access-key\" \\\n    secret_key=\"vault-aws-secret-key\" \\\n    region=\"us-west-2\"\n\n# Create AWS roles\nvault write aws/roles/ec2-admin \\\n    credential_type=\"iam_user\" \\\n    policy_document='-' \u003c\u003cEOF\n{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:*\",\n        \"vpc:*\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\nEOF\n\nvault write aws/roles/s3-readonly \\\n    credential_type=\"iam_user\" \\\n    policy_arns=\"arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess\" \\\n    default_sts_ttl=\"1h\" \\\n    max_sts_ttl=\"12h\"\n\n# Generate temporary AWS credentials\nvault read aws/creds/ec2-admin\n```\n\n#### Azure Secrets Engine\n```bash\n# Enable Azure secrets engine\nvault secrets enable azure\n\n# Configure Azure credentials\nvault write azure/config \\\n    subscription_id=\"your-subscription-id\" \\\n    tenant_id=\"your-tenant-id\" \\\n    client_id=\"vault-service-principal-id\" \\\n    client_secret=\"vault-service-principal-secret\"\n\n# Create Azure roles\nvault write azure/roles/contributor \\\n    azure_roles='-' \u003c\u003cEOF\n[\n    {\n        \"role_name\": \"Contributor\",\n        \"scope\":  \"/subscriptions/your-subscription-id\"\n    }\n]\nEOF\n\nvault write azure/roles/storage-admin \\\n    azure_roles='-' \u003c\u003cEOF\n[\n    {\n        \"role_name\": \"Storage Account Contributor\",\n        \"scope\":  \"/subscriptions/your-subscription-id/resourceGroups/production\"\n    }\n]\nEOF\n\n# Generate Azure credentials\nvault read azure/creds/contributor\n```\n\n## Enterprise Features\n\n### Performance Replication\n```bash\n# Configure performance replication (Enterprise)\n# On primary cluster\nvault write -f sys/replication/performance/primary/enable\n\n# Generate secondary token\nvault write sys/replication/performance/primary/secondary-token id=\"dr-secondary\"\n\n# On secondary cluster\nvault write sys/replication/performance/secondary/enable token=\"\u003csecondary-token\u003e\"\n\n# Monitor replication status\nvault read sys/replication/status\nvault read sys/replication/performance/status\n```\n\n### Disaster Recovery Replication\n```bash\n# Enable DR replication on primary\nvault write -f sys/replication/dr/primary/enable\n\n# Generate DR token\nvault write sys/replication/dr/primary/secondary-token id=\"dr-cluster\"\n\n# On DR cluster\nvault write sys/replication/dr/secondary/enable token=\"\u003cdr-token\u003e\"\n\n# Promote DR secondary (in disaster scenario)\nvault write -f sys/replication/dr/secondary/promote\n\n# Demote and revert\nvault write -f sys/replication/dr/secondary/reindex\nvault write sys/replication/dr/secondary/update-primary dr_operation_token=\"\u003coperation-token\u003e\"\n```\n\n### Namespaces (Enterprise)\n```bash\n# Create namespaces for multi-tenancy\nvault namespace create engineering\nvault namespace create finance\nvault namespace create operations\n\n# Work within specific namespace\nexport VAULT_NAMESPACE=engineering\n\n# Configure namespace-specific policies and auth methods\nvault policy write -namespace=engineering eng-admin - \u003c\u003cEOF\npath \"*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\nEOF\n\n# Enable auth method in namespace\nvault auth enable -namespace=engineering userpass\n\nvault write -namespace=engineering auth/userpass/users/alice \\\n    password=\"secure-password\" \\\n    policies=\"eng-admin\"\n```\n\n### Transform Secrets Engine (Enterprise)\n```bash\n# Enable transform secrets engine for data protection\nvault secrets enable transform\n\n# Create transformation for credit card numbers\nvault write transform/role/payments \\\n    transformations=credit-card-transformation\n\nvault write transform/transformation/credit-card-transformation \\\n    type=fpe \\\n    template=\"credit-card\" \\\n    tweak_source=supplied \\\n    allowed_roles=payments\n\nvault write transform/template/credit-card \\\n    type=regex \\\n    pattern='\\d{4}-\\d{4}-\\d{4}-(\\d{4})' \\\n    alphabet=numerics\n\n# Encode sensitive data\nvault write transform/encode/payments \\\n    transformation=credit-card-transformation \\\n    value=\"1234-5678-9012-3456\" \\\n    tweak=\"user-123\"\n\n# Decode when needed\nvault write transform/decode/payments \\\n    transformation=credit-card-transformation \\\n    value=\"encoded-value\" \\\n    tweak=\"user-123\"\n```\n\n## Backup and Disaster Recovery\n\n### Enterprise Backup Strategy\n```bash\n# Create comprehensive backup script\nsudo tee /usr/local/bin/vault-backup.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nBACKUP_DIR=\"/backup/vault\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}/{snapshots,configs,certificates}\n\n# Raft storage snapshot (Enterprise)\nvault operator raft snapshot save ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap\n\n# Backup configuration files\ntar -czf ${BACKUP_DIR}/configs/vault-config-${DATE}.tar.gz \\\n    /etc/vault.d/ \\\n    /etc/systemd/system/vault.service\n\n# Backup TLS certificates\ntar -czf ${BACKUP_DIR}/certificates/vault-tls-${DATE}.tar.gz \\\n    /opt/vault/tls/\n\n# Backup to cloud storage\n# AWS S3\naws s3 cp ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap s3://vault-backups/snapshots/\naws s3 cp ${BACKUP_DIR}/configs/vault-config-${DATE}.tar.gz s3://vault-backups/configs/\n\n# Azure Blob Storage\naz storage blob upload \\\n    --file ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap \\\n    --container-name vault-backups \\\n    --name snapshots/vault-snapshot-${DATE}.snap\n\n# Google Cloud Storage\ngsutil cp ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap gs://vault-backups/snapshots/\n\n# Verify snapshot integrity\nvault operator raft snapshot inspect ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap\n\n# Keep only last 30 backups locally\nfind ${BACKUP_DIR} -name \"vault-*\" -type f -mtime +30 -delete\n\n# Encrypt backup files\ngpg --symmetric --cipher-algo AES256 ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap\n\necho \"Vault backup completed: ${DATE}\"\nEOF\n\nsudo chmod +x /usr/local/bin/vault-backup.sh\n\n# Schedule automated backups\necho \"0 2 * * * root /usr/local/bin/vault-backup.sh\" | sudo tee -a /etc/crontab\n```\n\n### Disaster Recovery Testing\n```bash\n# Create DR testing script\nsudo tee /usr/local/bin/vault-dr-test.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nTEST_DIR=\"/tmp/vault-dr-test\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${TEST_DIR}\n\n# Test snapshot restore capability\nvault operator raft snapshot save ${TEST_DIR}/test-snapshot-${DATE}.snap\n\n# Verify snapshot\nvault operator raft snapshot inspect ${TEST_DIR}/test-snapshot-${DATE}.snap\n\n# Test unsealing process\nvault operator key-status\n\n# Test authentication methods\nvault auth list\n\n# Test secrets engines\nvault secrets list\n\n# Test policy enforcement\nvault policy list\n\n# Generate test report\ncat \u003e ${TEST_DIR}/dr-test-report-${DATE}.txt \u003c\u003cEOL\nVault DR Test Report - ${DATE}\n================================\n\nSnapshot Creation: $([ -f ${TEST_DIR}/test-snapshot-${DATE}.snap ] \u0026\u0026 echo \"PASS\" || echo \"FAIL\")\nVault Status: $(vault status -format=json | jq -r .sealed)\nActive Auth Methods: $(vault auth list -format=json | jq -r 'keys | length')\nActive Secrets Engines: $(vault secrets list -format=json | jq -r 'keys | length')\nPolicies Count: $(vault policy list | wc -l)\n\nTest completed at: $(date)\nEOL\n\necho \"DR test completed. Report: ${TEST_DIR}/dr-test-report-${DATE}.txt\"\nEOF\n\nsudo chmod +x /usr/local/bin/vault-dr-test.sh\n\n# Schedule monthly DR tests\necho \"0 2 1 * * root /usr/local/bin/vault-dr-test.sh\" | sudo tee -a /etc/crontab\n```\n\n## Application Integration Examples\n\n### Kubernetes Integration with Vault Agent\n```bash\n# Deploy Vault Agent as sidecar for Kubernetes workloads\ncat \u003e vault-agent-k8s.yaml \u003c\u003cEOF\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: vault-agent-config\ndata:\n  vault-agent.hcl: |\n    exit_after_auth = false\n    pid_file = \"/home/vault/pidfile\"\n\n    auto_auth {\n      method \"kubernetes\" {\n        mount_path = \"auth/kubernetes\"\n        config = {\n          role = \"myapp\"\n        }\n      }\n\n      sink \"file\" {\n        config = {\n          path = \"/home/vault/.vault-token\"\n        }\n      }\n    }\n\n    cache {\n      use_auto_auth_token = true\n    }\n\n    listener \"tcp\" {\n      address = \"127.0.0.1:8080\"\n      tls_disable = true\n    }\n\n    vault {\n      address = \"https://vault.example.com:8200\"\n    }\n\n    template {\n      source      = \"/vault/templates/database.conf.tpl\"\n      destination = \"/vault/secrets/database.conf\"\n      perms       = 0640\n      command     = \"pkill -SIGHUP myapp\"\n    }\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: myapp-with-vault\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: myapp\n  template:\n    metadata:\n      labels:\n        app: myapp\n    spec:\n      serviceAccountName: vault-auth\n      securityContext:\n        runAsNonRoot: true\n        runAsUser: 1000\n        fsGroup: 1000\n      containers:\n      - name: vault-agent\n        image: vault:latest\n        command: [\"vault\", \"agent\", \"-config=/vault/config/vault-agent.hcl\"]\n        volumeMounts:\n        - name: vault-config\n          mountPath: /vault/config\n        - name: vault-secrets\n          mountPath: /vault/secrets\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - ALL\n      - name: myapp\n        image: myapp:latest\n        volumeMounts:\n        - name: vault-secrets\n          mountPath: /app/config\n          readOnly: true\n        env:\n        - name: DB_CONFIG_FILE\n          value: \"/app/config/database.conf\"\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - ALL\n      volumes:\n      - name: vault-config\n        configMap:\n          name: vault-agent-config\n      - name: vault-secrets\n        emptyDir:\n          medium: Memory\nEOF\n\nkubectl apply -f vault-agent-k8s.yaml\n```\n\n### CI/CD Pipeline Integration\n```bash\n# GitHub Actions integration\ncat \u003e .github/workflows/vault-secrets.yml \u003c\u003cEOF\nname: Deploy with Vault Secrets\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    permissions:\n      id-token: write\n      contents: read\n    \n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v4\n    \n    - name: Configure Vault authentication\n      uses: hashicorp/vault-action@v2\n      with:\n        url: https://vault.example.com:8200\n        method: jwt\n        role: github-actions-role\n        secrets: |\n          secret/data/database username | DB_USER ;\n          secret/data/database password | DB_PASS ;\n          aws/creds/deployment-role access_key | AWS_ACCESS_KEY_ID ;\n          aws/creds/deployment-role secret_key | AWS_SECRET_ACCESS_KEY ;\n          pki_int/issue/service-role common_name=api.example.com ttl=1h | API_TLS_CERT\n    \n    - name: Deploy application\n      run: |\n        echo \"Deploying with secrets from Vault\"\n        echo \"Database user: \\${{ env.DB_USER }}\"\n        # Application deployment logic here\n      env:\n        DB_USER: \\${{ env.DB_USER }}\n        DB_PASS: \\${{ env.DB_PASS }}\n        AWS_ACCESS_KEY_ID: \\${{ env.AWS_ACCESS_KEY_ID }}\n        AWS_SECRET_ACCESS_KEY: \\${{ env.AWS_SECRET_ACCESS_KEY }}\nEOF\n\n# Configure GitHub Actions authentication in Vault\nvault auth enable jwt\n\nvault write auth/jwt/config \\\n    bound_issuer=\"https://token.actions.githubusercontent.com\" \\\n    oidc_discovery_url=\"https://token.actions.githubusercontent.com\"\n\nvault write auth/jwt/role/github-actions-role \\\n    bound_audiences=\"https://github.com/your-org\" \\\n    bound_subject=\"repo:your-org/your-repo:ref:refs/heads/main\" \\\n    user_claim=\"actor\" \\\n    role_type=\"jwt\" \\\n    policies=\"cicd-policy\" \\\n    ttl=\"10m\"\n```\n\n### Terraform Integration\n```bash\n# Vault provider for Terraform\ncat \u003e terraform-vault.tf \u003c\u003cEOF\nterraform {\n  required_providers {\n    vault = {\n      source  = \"hashicorp/vault\"\n      version = \"~\u003e 3.0\"\n    }\n  }\n}\n\nprovider \"vault\" {\n  address = \"https://vault.example.com:8200\"\n  token   = var.vault_token\n}\n\n# Read secrets from Vault\ndata \"vault_generic_secret\" \"database\" {\n  path = \"secret/database\"\n}\n\ndata \"vault_aws_access_credentials\" \"deployment\" {\n  backend = \"aws\"\n  role    = \"deployment-role\"\n}\n\n# Use secrets in resources\nresource \"aws_db_instance\" \"main\" {\n  identifier_prefix = var.project_name\n  \n  username = data.vault_generic_secret.database.data[\"username\"]\n  password = data.vault_generic_secret.database.data[\"password\"]\n  \n  # Other configuration...\n}\n\n# Store Terraform-generated secrets back in Vault\nresource \"vault_generic_secret\" \"terraform_outputs\" {\n  path = \"secret/terraform/outputs\"\n\n  data_json = jsonencode({\n    rds_endpoint = aws_db_instance.main.endpoint\n    vpc_id       = aws_vpc.main.id\n    subnet_ids   = aws_subnet.main[*].id\n  })\n}\nEOF\n```\n\n## Monitoring and Observability\n\n### Vault Metrics and Monitoring\n```bash\n# Enable Vault metrics collection\nvault write sys/metrics/config \\\n    enabled=true \\\n    enable_hostname_label=false \\\n    default_lease_duration=\"1h\" \\\n    max_lease_duration=\"24h\"\n\n# Prometheus monitoring configuration\ncat \u003e /etc/prometheus/vault-monitoring.yml \u003c\u003cEOF\nglobal:\n  scrape_interval: 15s\n\nscrape_configs:\n  - job_name: 'vault'\n    scheme: https\n    tls_config:\n      ca_file: /opt/vault/tls/ca.crt\n      cert_file: /opt/prometheus/tls/client.crt\n      key_file: /opt/prometheus/tls/client.key\n    static_configs:\n      - targets: \n        - 'vault-1.example.com:8200'\n        - 'vault-2.example.com:8200'\n        - 'vault-3.example.com:8200'\n    metrics_path: /v1/sys/metrics\n    params:\n      format: ['prometheus']\n    bearer_token: \"prometheus-vault-token\"\n\n  # Monitor Vault process metrics\n  - job_name: 'vault-node-exporter'\n    static_configs:\n      - targets:\n        - 'vault-1.example.com:9100'\n        - 'vault-2.example.com:9100'\n        - 'vault-3.example.com:9100'\nEOF\n\n# Create Grafana dashboards for Vault monitoring\ncurl -X POST http://admin:admin@grafana.example.com/api/dashboards/db \\\n  -H 'Content-Type: application/json' \\\n  -d @vault-dashboard.json\n```\n\n### Advanced Audit Analysis\n```bash\n# Create audit log analysis script\nsudo tee /usr/local/bin/vault-audit-analysis.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nAUDIT_LOG=\"/opt/vault/logs/audit.log\"\nANALYSIS_DIR=\"/var/log/vault-analysis\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${ANALYSIS_DIR}\n\n# Failed authentication attempts\necho \"Failed Authentication Analysis - ${DATE}\" \u003e ${ANALYSIS_DIR}/failed-auth-${DATE}.txt\njq -r 'select(.type==\"response\" and .error != null) | [.time, .request.remote_address, .error] | @tsv' ${AUDIT_LOG} | tail -100 \u003e\u003e ${ANALYSIS_DIR}/failed-auth-${DATE}.txt\n\n# Most active users\necho \"Most Active Users - ${DATE}\" \u003e ${ANALYSIS_DIR}/active-users-${DATE}.txt\njq -r 'select(.type==\"request\" and .auth != null) | .auth.display_name' ${AUDIT_LOG} | sort | uniq -c | sort -nr | head -20 \u003e\u003e ${ANALYSIS_DIR}/active-users-${DATE}.txt\n\n# Secret access patterns\necho \"Secret Access Patterns - ${DATE}\" \u003e ${ANALYSIS_DIR}/secret-access-${DATE}.txt\njq -r 'select(.type==\"request\" and .request.path | test(\"^secret/data/\")) | [.time, .auth.display_name, .request.path] | @tsv' ${AUDIT_LOG} | tail -100 \u003e\u003e ${ANALYSIS_DIR}/secret-access-${DATE}.txt\n\n# Policy violations\necho \"Policy Violations - ${DATE}\" \u003e ${ANALYSIS_DIR}/policy-violations-${DATE}.txt\njq -r 'select(.type==\"response\" and .error != null and (.error | test(\"permission denied\"))) | [.time, .auth.display_name, .request.path, .error] | @tsv' ${AUDIT_LOG} | tail -50 \u003e\u003e ${ANALYSIS_DIR}/policy-violations-${DATE}.txt\n\n# Generate summary report\ncat \u003e ${ANALYSIS_DIR}/audit-summary-${DATE}.txt \u003c\u003cEOL\nVault Audit Summary - ${DATE}\n==============================\n\nTotal Requests: $(jq -s 'length' ${AUDIT_LOG})\nFailed Authentications: $(jq -s 'map(select(.type==\"response\" and .error != null)) | length' ${AUDIT_LOG})\nPolicy Violations: $(jq -s 'map(select(.type==\"response\" and .error != null and (.error | test(\"permission denied\")))) | length' ${AUDIT_LOG})\nUnique Users: $(jq -r 'select(.type==\"request\" and .auth != null) | .auth.display_name' ${AUDIT_LOG} | sort -u | wc -l)\n\nTop 5 Accessed Paths:\n$(jq -r 'select(.type==\"request\") | .request.path' ${AUDIT_LOG} | sort | uniq -c | sort -nr | head -5)\n\nAnalysis completed at: $(date)\nEOL\n\necho \"Audit analysis completed. Reports in: ${ANALYSIS_DIR}/\"\nEOF\n\nsudo chmod +x /usr/local/bin/vault-audit-analysis.sh\n\n# Schedule weekly audit analysis\necho \"0 6 * * 1 root /usr/local/bin/vault-audit-analysis.sh\" | sudo tee -a /etc/crontab\n```\n\n## Verification and Testing\n\n### Comprehensive Health Checks\n```bash\n# Create Vault health monitoring script\nsudo tee /usr/local/bin/vault-health-check.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nVAULT_ADDR=\"https://vault.example.com:8200\"\nHEALTH_LOG=\"/var/log/vault-health.log\"\n\n# Function to log with timestamp\nlog_message() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" | tee -a ${HEALTH_LOG}\n}\n\n# Check Vault service status\nif systemctl is-active vault \u003e/dev/null 2\u003e\u00261; then\n    log_message \"✓ Vault service is running\"\nelse\n    log_message \"✗ Vault service is not running\"\n    exit 1\nfi\n\n# Check Vault HTTP health\nif curl -k -sf ${VAULT_ADDR}/v1/sys/health \u003e/dev/null 2\u003e\u00261; then\n    log_message \"✓ Vault HTTP endpoint is responding\"\nelse\n    log_message \"✗ Vault HTTP endpoint is not responding\"\n    exit 1\nfi\n\n# Check if Vault is sealed\nSEALED_STATUS=$(vault status -format=json | jq -r .sealed)\nif [ \"$SEALED_STATUS\" = \"false\" ]; then\n    log_message \"✓ Vault is unsealed\"\nelse\n    log_message \"✗ Vault is sealed\"\n    exit 1\nfi\n\n# Check cluster status (if HA)\nif vault status -format=json | jq -r .ha_enabled | grep -q \"true\"; then\n    CLUSTER_HEALTH=$(vault operator raft list-peers -format=json | jq '.data.config.servers | length')\n    log_message \"✓ Cluster has ${CLUSTER_HEALTH} nodes\"\nfi\n\n# Check replication status (Enterprise)\nREPLICATION_STATUS=$(vault read -format=json sys/replication/status 2\u003e/dev/null)\nif [ $? -eq 0 ]; then\n    DR_MODE=$(echo $REPLICATION_STATUS | jq -r .data.dr.mode)\n    PERF_MODE=$(echo $REPLICATION_STATUS | jq -r .data.performance.mode)\n    log_message \"✓ Replication status - DR: ${DR_MODE}, Performance: ${PERF_MODE}\"\nfi\n\n# Check auth methods\nAUTH_METHODS=$(vault auth list -format=json | jq -r 'keys | length')\nlog_message \"✓ ${AUTH_METHODS} authentication methods enabled\"\n\n# Check secrets engines\nSECRETS_ENGINES=$(vault secrets list -format=json | jq -r 'keys | length')\nlog_message \"✓ ${SECRETS_ENGINES} secrets engines enabled\"\n\n# Check policy count\nPOLICIES=$(vault policy list | wc -l)\nlog_message \"✓ ${POLICIES} policies configured\"\n\n# Test secret read/write\nTEST_SECRET=\"secret/health-check/test-$(date +%s)\"\nif vault kv put ${TEST_SECRET} test=true \u003e/dev/null 2\u003e\u00261; then\n    if vault kv get ${TEST_SECRET} \u003e/dev/null 2\u003e\u00261; then\n        log_message \"✓ Secret read/write test passed\"\n        vault kv delete ${TEST_SECRET} \u003e/dev/null 2\u003e\u00261\n    else\n        log_message \"✗ Secret read test failed\"\n    fi\nelse\n    log_message \"✗ Secret write test failed\"\nfi\n\n# Check audit devices\nAUDIT_DEVICES=$(vault audit list -format=json | jq -r 'keys | length')\nlog_message \"✓ ${AUDIT_DEVICES} audit devices enabled\"\n\nlog_message \"Vault health check completed successfully\"\nEOF\n\nsudo chmod +x /usr/local/bin/vault-health-check.sh\n\n# Schedule health checks every 15 minutes\necho \"*/15 * * * * root /usr/local/bin/vault-health-check.sh\" | sudo tee -a /etc/crontab\n```\n\n### Security Validation Testing\n```bash\n# Create security testing script\nsudo tee /usr/local/bin/vault-security-test.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nVAULT_ADDR=\"https://vault.example.com:8200\"\nTEST_RESULTS=\"/tmp/vault-security-test-$(date +%Y%m%d_%H%M%S).txt\"\n\necho \"Vault Security Validation Test\" \u003e ${TEST_RESULTS}\necho \"==============================\" \u003e\u003e ${TEST_RESULTS}\necho \"Date: $(date)\" \u003e\u003e ${TEST_RESULTS}\necho \"\" \u003e\u003e ${TEST_RESULTS}\n\n# Test 1: TLS Configuration\necho \"Testing TLS Configuration...\" \u003e\u003e ${TEST_RESULTS}\nTLS_VERSION=$(openssl s_client -connect vault.example.com:8200 -brief 2\u003e/dev/null | grep \"Protocol version\")\necho \"TLS Version: ${TLS_VERSION}\" \u003e\u003e ${TEST_RESULTS}\n\n# Test 2: Authentication requirements\necho \"Testing authentication requirements...\" \u003e\u003e ${TEST_RESULTS}\nUNAUTH_ACCESS=$(curl -k -s -w \"%{http_code}\" -o /dev/null ${VAULT_ADDR}/v1/secret/test)\nif [ \"$UNAUTH_ACCESS\" = \"403\" ]; then\n    echo \"✓ Unauthenticated access properly denied\" \u003e\u003e ${TEST_RESULTS}\nelse\n    echo \"✗ Unauthenticated access not properly restricted\" \u003e\u003e ${TEST_RESULTS}\nfi\n\n# Test 3: Seal status\necho \"Testing seal status...\" \u003e\u003e ${TEST_RESULTS}\nSEALED=$(vault status -format=json | jq -r .sealed)\nif [ \"$SEALED\" = \"false\" ]; then\n    echo \"✓ Vault is properly unsealed\" \u003e\u003e ${TEST_RESULTS}\nelse\n    echo \"✗ Vault is sealed\" \u003e\u003e ${TEST_RESULTS}\nfi\n\n# Test 4: Audit logging\necho \"Testing audit logging...\" \u003e\u003e ${TEST_RESULTS}\nAUDIT_COUNT=$(vault audit list -format=json | jq -r 'keys | length')\nif [ \"$AUDIT_COUNT\" -gt \"0\" ]; then\n    echo \"✓ ${AUDIT_COUNT} audit devices enabled\" \u003e\u003e ${TEST_RESULTS}\nelse\n    echo \"✗ No audit devices enabled\" \u003e\u003e ${TEST_RESULTS}\nfi\n\n# Test 5: Policy enforcement\necho \"Testing policy enforcement...\" \u003e\u003e ${TEST_RESULTS}\nvault token create -policy=developer -ttl=1m -format=json \u003e /tmp/test-token.json\nTEST_TOKEN=$(jq -r .auth.client_token /tmp/test-token.json)\n\n# Test with limited token\nVAULT_TOKEN=${TEST_TOKEN} vault auth -method=token ${TEST_TOKEN} \u003e/dev/null 2\u003e\u00261\nLIMITED_ACCESS=$(VAULT_TOKEN=${TEST_TOKEN} curl -k -s -w \"%{http_code}\" -o /dev/null -H \"X-Vault-Token: ${TEST_TOKEN}\" ${VAULT_ADDR}/v1/sys/auth)\nif [ \"$LIMITED_ACCESS\" = \"403\" ]; then\n    echo \"✓ Policy enforcement working correctly\" \u003e\u003e ${TEST_RESULTS}\nelse\n    echo \"✗ Policy enforcement may be misconfigured\" \u003e\u003e ${TEST_RESULTS}\nfi\n\n# Revoke test token\nvault token revoke ${TEST_TOKEN}\nrm /tmp/test-token.json\n\necho \"\" \u003e\u003e ${TEST_RESULTS}\necho \"Security test completed at: $(date)\" \u003e\u003e ${TEST_RESULTS}\n\necho \"Security test completed. Results: ${TEST_RESULTS}\"\nEOF\n\nsudo chmod +x /usr/local/bin/vault-security-test.sh\n\n# Run security tests weekly\necho \"0 8 * * 1 root /usr/local/bin/vault-security-test.sh\" | sudo tee -a /etc/crontab\n```\n\n## Troubleshooting (Cross-Platform)\n\n### Common Issues and Solutions\n```bash\n# Check Vault status and logs\nvault status\nsudo journalctl -u vault -f\n\n# Debug unsealing issues\nvault operator key-status\nvault status -format=json | jq .recovery_seal\n\n# Memory lock issues\ncat /proc/$(pgrep vault)/status | grep VmLck\nulimit -l\n\n# Permission issues\nsudo chown -R vault:vault /opt/vault\nsudo chmod 640 /etc/vault.d/vault.hcl\nls -laZ /opt/vault  # SELinux context\n\n# Network connectivity tests\ncurl -k https://vault.example.com:8200/v1/sys/health\nopenssl s_client -connect vault.example.com:8200\n\n# Storage backend issues\n# For Raft storage\nvault operator raft list-peers\nvault operator raft autopilot status\n\n# For Consul storage\nconsul members\nconsul kv get -recurse vault/\n\n# Certificate issues\nopenssl x509 -in /opt/vault/tls/vault.crt -text -noout\nvault auth -method=cert \\\n    -ca-cert=/opt/vault/tls/ca.crt \\\n    -client-cert=/opt/vault/tls/client.crt \\\n    -client-key=/opt/vault/tls/client.key\n\n# Performance troubleshooting\nvault read sys/metrics\nvault read sys/host-info\nvault read sys/pprof/profile  # Enterprise\n\n# Audit log analysis\ntail -f /opt/vault/logs/audit.log | jq .\ngrep \"error\" /opt/vault/logs/audit.log | jq .\n\n# Token debugging\nvault token lookup\nvault token capabilities secret/data/test\n\n# Seal/unseal debugging\nvault operator unseal -migrate  # For seal migration\nvault operator rekey  # For changing unseal keys\n\n# Cluster debugging\nvault operator raft snapshot save debug-snapshot.snap\nvault operator raft snapshot inspect debug-snapshot.snap\n```\n\n### Advanced Debugging\n```bash\n# Enable debug logging\nsudo systemctl edit vault.service\n# Add:\n[Service]\nExecStart=\nExecStart=/usr/local/bin/vault server -config=/etc/vault.d/vault.hcl -log-level=debug\n\nsudo systemctl daemon-reload\nsudo systemctl restart vault\n\n# Monitor real-time operations\ntail -f /opt/vault/logs/vault.log | grep -E \"(ERROR|WARN|DEBUG)\"\n\n# Database connection debugging\nvault read database/config/mysql-prod\n\n# PKI debugging\nvault read pki/cert/ca\nvault read pki/crl\n\n# Replication debugging (Enterprise)\nvault read sys/replication/performance/status\nvault read sys/replication/dr/status\n\n# HSM debugging (Enterprise)\nvault read sys/seal-status\nvault read sys/hsm/status\n\n# Memory and performance analysis\npmap -x $(pgrep vault)\nstrace -p $(pgrep vault) -e trace=file\n\n# Network debugging\nss -tulpn | grep vault\nnetstat -tulpn | grep vault\n```\n\n## Additional Resources\n\n- [Official Documentation](https://www.vaultproject.io/docs)\n- [API Documentation](https://www.vaultproject.io/api-docs)\n- [Production Hardening Guide](https://learn.hashicorp.com/tutorials/vault/production-hardening)\n- [Enterprise Features](https://www.hashicorp.com/products/vault/enterprise)\n- [Security Best Practices](https://learn.hashicorp.com/tutorials/vault/security-intro)\n- [Community Forum](https://discuss.hashicorp.com/c/vault)\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection.","readmeHtml":"\u003ch1 id=\"hashicorp-vault-installation-guide\" class=\"mobile-header\"\u003eHashiCorp Vault Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eEnterprise-grade secrets management platform for securely storing and accessing API keys, passwords, certificates, and other sensitive data. Industry standard for secrets management with advanced security features.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux system (any modern distribution)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot or sudo access\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e4GB RAM minimum, 8GB+ recommended for production\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003ePersistent storage for Vault data (encrypted disk recommended)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eTLS certificates for production deployment\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eHSM (optional, for enterprise compliance)\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"using-package-manager-recommended\" class=\"mobile-header\"\u003eUsing Package Manager (Recommended)\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### Ubuntu/Debian\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Add HashiCorp GPG key\nwget -O- https://apt.releases.hashicorp.com/gpg | sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg\n\n# Add HashiCorp repository\necho \u0026quot;deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(lsb_release -cs) main\u0026quot; | sudo tee /etc/apt/sources.list.d/hashicorp.list\n\n# Update and install Vault\nsudo apt update\nsudo apt install -y vault\n\n# Create vault user and directories\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### RHEL/CentOS/Rocky Linux/AlmaLinux\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Add HashiCorp repository\nsudo yum install -y yum-utils\nsudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo\n\n# Install Vault\nsudo yum install -y vault\n\n# Create vault user and directories\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### Fedora\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Add HashiCorp repository\nsudo dnf install -y dnf-plugins-core\nsudo dnf config-manager --add-repo https://rpm.releases.hashicorp.com/fedora/hashicorp.repo\n\n# Install Vault\nsudo dnf install -y vault\n\n# Setup directories and user\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### Arch Linux\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install from AUR\nyay -S vault\n\n# Or from community repository\nsudo pacman -Syu vault\n\n# Setup vault user and directories\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"manual-binary-installation\" class=\"mobile-header\"\u003eManual Binary Installation\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Download latest Vault\nVAULT_VERSION=\u0026quot;1.15.2\u0026quot;\ncd /tmp\nwget https://releases.hashicorp.com/vault/${VAULT_VERSION}/vault_${VAULT_VERSION}_linux_amd64.zip\n\n# Install unzip if needed\nsudo apt install -y unzip  # Ubuntu/Debian\nsudo yum install -y unzip  # RHEL/CentOS\nsudo pacman -S unzip       # Arch Linux\n\n# Extract and install\nunzip vault_${VAULT_VERSION}_linux_amd64.zip\nsudo mv vault /usr/local/bin/\nsudo chmod +x /usr/local/bin/vault\n\n# Create vault user\nsudo useradd --system --home /etc/vault.d --shell /bin/false vault\n\n# Create directories\nsudo mkdir -p /opt/vault/{data,logs,tls} /etc/vault.d\nsudo chown -R vault:vault /opt/vault /etc/vault.d\n\n# Verify installation\nvault version\n\n# Clean up\nrm vault_${VAULT_VERSION}_linux_amd64.zip\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"using-docker\" class=\"mobile-header\"\u003eUsing Docker\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create directories for persistent data\nmkdir -p ~/vault/{data,config,logs,tls}\n\n# Generate TLS certificates for Docker\nopenssl req -x509 -nodes -newkey rsa:4096 -keyout ~/vault/tls/vault.key -out ~/vault/tls/vault.crt -days 365 -subj \u0026quot;/C=US/ST=State/L=City/O=Organization/CN=vault.example.com\u0026quot;\n\n# Create production-ready configuration\ncat \u0026gt; ~/vault/config/vault.hcl \u0026lt;\u0026lt;EOF\nui = true\ndisable_mlock = false\n\n# Storage backend\nstorage \u0026quot;file\u0026quot; {\n  path = \u0026quot;/vault/data\u0026quot;\n}\n\n# HTTPS listener\nlistener \u0026quot;tcp\u0026quot; {\n  address       = \u0026quot;0.0.0.0:8200\u0026quot;\n  tls_cert_file = \u0026quot;/vault/tls/vault.crt\u0026quot;\n  tls_key_file  = \u0026quot;/vault/tls/vault.key\u0026quot;\n  tls_min_version = \u0026quot;tls12\u0026quot;\n}\n\n# Cluster configuration\napi_addr = \u0026quot;https://vault.example.com:8200\u0026quot;\ncluster_addr = \u0026quot;https://vault.example.com:8201\u0026quot;\n\n# Logging\nlog_level = \u0026quot;Info\u0026quot;\nlog_file  = \u0026quot;/vault/logs/vault.log\u0026quot;\nlog_rotate_duration = \u0026quot;24h\u0026quot;\nlog_rotate_max_files = 15\n\n# Telemetry\ntelemetry {\n  prometheus_retention_time = \u0026quot;30s\u0026quot;\n  disable_hostname = true\n}\n\n# Enterprise features (if using Vault Enterprise)\nlicense_path = \u0026quot;/vault/license/vault.hclic\u0026quot;\n\n# Performance replication (Enterprise)\nreplication {\n  resolver_discover_servers = false\n}\nEOF\n\n# Run Vault container with security settings\ndocker run -d \\\n  --name vault \\\n  --restart unless-stopped \\\n  --cap-add=IPC_LOCK \\\n  --ulimit memlock=-1:-1 \\\n  -p 8200:8200 \\\n  -v ~/vault/data:/vault/data \\\n  -v ~/vault/config:/vault/config \\\n  -v ~/vault/logs:/vault/logs \\\n  -v ~/vault/tls:/vault/tls \\\n  vault:latest server -config=/vault/config/vault.hcl\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"production-configuration\" class=\"mobile-header\"\u003eProduction Configuration\u003c/h2\u003e\n\u003ch3 id=\"enterprise-production-configuration\" class=\"mobile-header\"\u003eEnterprise Production Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create comprehensive production configuration\nsudo tee /etc/vault.d/vault.hcl \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n# Vault Enterprise Production Configuration\n\n# UI and basic settings\nui = true\ndisable_mlock = false\n\n# Storage backend - Consul (HA) or Integrated Storage (Raft)\nstorage \u0026quot;raft\u0026quot; {\n  path    = \u0026quot;/opt/vault/data\u0026quot;\n  node_id = \u0026quot;vault-node-1\u0026quot;\n\n  retry_join {\n    leader_api_addr = \u0026quot;https://vault-node-2.example.com:8200\u0026quot;\n  }\n  \n  retry_join {\n    leader_api_addr = \u0026quot;https://vault-node-3.example.com:8200\u0026quot;\n  }\n\n  # Enterprise: Performance replication\n  autopilot {\n    cleanup_dead_servers = true\n    last_contact_threshold = \u0026quot;200ms\u0026quot;\n    max_trailing_logs = 250\n    min_quorum = 3\n    server_stabilization_time = \u0026quot;10s\u0026quot;\n  }\n}\n\n# Alternative: Consul backend for HA\n# storage \u0026quot;consul\u0026quot; {\n#   address = \u0026quot;127.0.0.1:8500\u0026quot;\n#   path    = \u0026quot;vault/\u0026quot;\n#   service = \u0026quot;vault\u0026quot;\n#   check_timeout = \u0026quot;5s\u0026quot;\n#   disable_registration = false\n# }\n\n# HTTPS listener with modern TLS\nlistener \u0026quot;tcp\u0026quot; {\n  address       = \u0026quot;0.0.0.0:8200\u0026quot;\n  tls_cert_file = \u0026quot;/opt/vault/tls/vault.crt\u0026quot;\n  tls_key_file  = \u0026quot;/opt/vault/tls/vault.key\u0026quot;\n  tls_min_version = \u0026quot;tls12\u0026quot;\n  tls_cipher_suites = \u0026quot;TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\u0026quot;\n  tls_require_and_verify_client_cert = false\n  tls_client_ca_file = \u0026quot;/opt/vault/tls/ca.crt\u0026quot;\n}\n\n# Cluster listener for HA\nlistener \u0026quot;tcp\u0026quot; {\n  address = \u0026quot;0.0.0.0:8201\u0026quot; \n  cluster_address = \u0026quot;0.0.0.0:8201\u0026quot;\n  tls_cert_file = \u0026quot;/opt/vault/tls/vault.crt\u0026quot;\n  tls_key_file  = \u0026quot;/opt/vault/tls/vault.key\u0026quot;\n}\n\n# API and cluster addresses\napi_addr = \u0026quot;https://vault.example.com:8200\u0026quot;\ncluster_addr = \u0026quot;https://vault.example.com:8201\u0026quot;\n\n# Enterprise license\nlicense_path = \u0026quot;/opt/vault/license/vault.hclic\u0026quot;\n\n# Logging configuration\nlog_level = \u0026quot;Info\u0026quot;\nlog_file  = \u0026quot;/opt/vault/logs/vault.log\u0026quot;\nlog_rotate_duration = \u0026quot;24h\u0026quot;\nlog_rotate_max_files = 30\n\n# Telemetry and monitoring\ntelemetry {\n  prometheus_retention_time = \u0026quot;30s\u0026quot;\n  disable_hostname = true\n  usage_gauge_period = \u0026quot;5m\u0026quot;\n}\n\n# Seal configuration - Auto-unseal with cloud KMS (Enterprise)\nseal \u0026quot;awskms\u0026quot; {\n  region     = \u0026quot;us-west-2\u0026quot;\n  kms_key_id = \u0026quot;arn:aws:kms:us-west-2:123456789012:key/12345678-1234-1234-1234-123456789012\u0026quot;\n}\n\n# Alternative: Azure Key Vault\n# seal \u0026quot;azurekeyvault\u0026quot; {\n#   tenant_id      = \u0026quot;46646709-b63e-4747-be42-516edeaf1e14\u0026quot;\n#   client_id      = \u0026quot;03dc33fc-16d9-4b77-8152-3ec568f8af6e\u0026quot;\n#   client_secret  = \u0026quot;DUJDS3...\u0026quot;\n#   vault_name     = \u0026quot;hc-vault\u0026quot;\n#   key_name       = \u0026quot;vault_key\u0026quot;\n# }\n\n# Alternative: Google Cloud KMS\n# seal \u0026quot;gcpckms\u0026quot; {\n#   project     = \u0026quot;vault-project\u0026quot;\n#   region      = \u0026quot;us-central1\u0026quot;\n#   key_ring    = \u0026quot;vault-keyring\u0026quot;\n#   crypto_key  = \u0026quot;vault-key\u0026quot;\n# }\n\n# Performance replication (Enterprise)\nreplication {\n  resolver_discover_servers = false\n}\n\n# HSM configuration (Enterprise with HSM)\n# seal \u0026quot;pkcs11\u0026quot; {\n#   lib            = \u0026quot;/usr/lib/softhsm/libsofthsm2.so\u0026quot;\n#   slot           = \u0026quot;0\u0026quot;\n#   pin            = \u0026quot;1234\u0026quot;\n#   key_label      = \u0026quot;vault-hsm-key\u0026quot;\n#   hmac_key_label = \u0026quot;vault-hsm-hmac-key\u0026quot;\n# }\nEOF\n\nsudo chown vault:vault /etc/vault.d/vault.hcl\nsudo chmod 640 /etc/vault.d/vault.hcl\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-tls-configuration\" class=\"mobile-header\"\u003eAdvanced TLS Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Generate production-grade TLS certificates\nsudo mkdir -p /opt/vault/tls\n\n# Create CA certificate\nsudo openssl genrsa -out /opt/vault/tls/ca-key.pem 4096\nsudo openssl req -new -x509 -days 3650 -key /opt/vault/tls/ca-key.pem -out /opt/vault/tls/ca.crt -subj \u0026quot;/C=US/ST=State/L=City/O=Organization/CN=Vault-CA\u0026quot;\n\n# Create server certificate\nsudo openssl genrsa -out /opt/vault/tls/vault-key.pem 4096\nsudo openssl req -new -key /opt/vault/tls/vault-key.pem -out /opt/vault/tls/vault.csr -subj \u0026quot;/C=US/ST=State/L=City/O=Organization/CN=vault.example.com\u0026quot;\n\n# Create certificate with SAN extensions\nsudo tee /opt/vault/tls/vault.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[req]\ndistinguished_name = req_distinguished_name\nreq_extensions = v3_req\n\n[req_distinguished_name]\n\n[v3_req]\nbasicConstraints = CA:FALSE\nkeyUsage = nonRepudiation, digitalSignature, keyEncipherment\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = vault.example.com\nDNS.2 = vault-node-1.example.com\nDNS.3 = vault-node-2.example.com\nDNS.4 = vault-node-3.example.com\nDNS.5 = localhost\nIP.1 = 127.0.0.1\nIP.2 = 10.0.1.10\nIP.3 = 10.0.1.11\nIP.4 = 10.0.1.12\nEOF\n\nsudo openssl x509 -req -days 365 -in /opt/vault/tls/vault.csr -CA /opt/vault/tls/ca.crt -CAkey /opt/vault/tls/ca-key.pem -CAcreateserial -out /opt/vault/tls/vault.crt -extensions v3_req -extfile /opt/vault/tls/vault.conf\n\n# Set secure permissions\nsudo chmod 600 /opt/vault/tls/*-key.pem\nsudo chmod 644 /opt/vault/tls/*.crt\nsudo chown -R vault:vault /opt/vault/tls\n\n# For Let\u0026#039;s Encrypt certificates (production)\nsudo apt install -y certbot  # Ubuntu/Debian\nsudo yum install -y certbot  # RHEL/CentOS\n\nsudo certbot certonly --standalone -d vault.example.com\nsudo cp /etc/letsencrypt/live/vault.example.com/fullchain.pem /opt/vault/tls/vault.crt\nsudo cp /etc/letsencrypt/live/vault.example.com/privkey.pem /opt/vault/tls/vault-key.pem\nsudo chown vault:vault /opt/vault/tls/vault.*\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"enterprise-systemd-service-with-security-hardening\" class=\"mobile-header\"\u003eEnterprise SystemD Service with Security Hardening\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /etc/systemd/system/vault.service \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Unit]\nDescription=HashiCorp Vault - A tool for managing secrets\nDocumentation=https://www.vaultproject.io/docs/\nRequires=network-online.target\nAfter=network-online.target\nConditionFileNotEmpty=/etc/vault.d/vault.hcl\nStartLimitIntervalSec=60\nStartLimitBurst=3\n\n[Service]\nType=notify\nUser=vault\nGroup=vault\nExecStart=/usr/local/bin/vault server -config=/etc/vault.d/vault.hcl\nExecReload=/bin/kill --signal HUP \\$MAINPID\nKillMode=process\nRestart=on-failure\nRestartSec=5\nTimeoutStopSec=30\nStartLimitInterval=60\nStartLimitBurst=3\n\n# File system isolation\nProtectSystem=full\nProtectHome=read-only\nPrivateTmp=yes\nPrivateDevices=yes\n\n# Secure computing\nNoNewPrivileges=yes\nSecureBits=keep-caps\nCapabilityBoundingSet=CAP_SYSLOG CAP_IPC_LOCK\n\n# Additional security features\nAmbientCapabilities=CAP_IPC_LOCK\nCapabilities=CAP_IPC_LOCK+ep\n\n# Resource limits\nLimitNOFILE=65536\nLimitMEMLOCK=infinity\nLimitCORE=0\n\n# Network isolation\nRestrictNamespaces=yes\nRestrictRealtime=yes\n\n# Read-only paths\nReadOnlyPaths=/etc /usr\n\n# Writable paths\nReadWritePaths=/opt/vault/data\nReadWritePaths=/opt/vault/logs\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsudo systemctl daemon-reload\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"high-availability-cluster-setup\" class=\"mobile-header\"\u003eHigh Availability Cluster Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure HA cluster with Integrated Storage (Raft)\n# Node 1 configuration\nsudo tee /etc/vault.d/vault.hcl \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\nui = true\ndisable_mlock = false\n\nstorage \u0026quot;raft\u0026quot; {\n  path    = \u0026quot;/opt/vault/data\u0026quot;\n  node_id = \u0026quot;vault-node-1\u0026quot;\n}\n\nlistener \u0026quot;tcp\u0026quot; {\n  address       = \u0026quot;0.0.0.0:8200\u0026quot;\n  tls_cert_file = \u0026quot;/opt/vault/tls/vault.crt\u0026quot;\n  tls_key_file  = \u0026quot;/opt/vault/tls/vault-key.pem\u0026quot;\n  tls_min_version = \u0026quot;tls12\u0026quot;\n}\n\nlistener \u0026quot;tcp\u0026quot; {\n  address       = \u0026quot;0.0.0.0:8201\u0026quot;\n  cluster_address = \u0026quot;10.0.1.10:8201\u0026quot;\n  tls_cert_file = \u0026quot;/opt/vault/tls/vault.crt\u0026quot;\n  tls_key_file  = \u0026quot;/opt/vault/tls/vault-key.pem\u0026quot;\n}\n\napi_addr = \u0026quot;https://10.0.1.10:8200\u0026quot;\ncluster_addr = \u0026quot;https://10.0.1.10:8201\u0026quot;\n\n# Enterprise features\nlicense_path = \u0026quot;/opt/vault/license/vault.hclic\u0026quot;\n\n# Auto-unseal with AWS KMS\nseal \u0026quot;awskms\u0026quot; {\n  region     = \u0026quot;us-west-2\u0026quot;\n  kms_key_id = \u0026quot;arn:aws:kms:us-west-2:123456789012:key/vault-unseal-key\u0026quot;\n}\n\n# Performance replication (Enterprise)\nreplication {\n  resolver_discover_servers = false\n}\nEOF\n\n# Initialize cluster on first node\nsudo systemctl start vault\nexport VAULT_ADDR=\u0026#039;https://127.0.0.1:8200\u0026#039;\nexport VAULT_SKIP_VERIFY=true  # Only for self-signed certs\nvault operator init -recovery-shares=5 -recovery-threshold=3\n\n# Join additional nodes to cluster\n# Node 2 and 3: Add retry_join blocks to their vault.hcl\nsudo tee -a /etc/vault.d/vault.hcl \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n\nstorage \u0026quot;raft\u0026quot; {\n  path    = \u0026quot;/opt/vault/data\u0026quot;\n  node_id = \u0026quot;vault-node-2\u0026quot;  # Change to node-3 for third node\n  \n  retry_join {\n    leader_api_addr = \u0026quot;https://10.0.1.10:8200\u0026quot;\n  }\n}\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"security-hardening-2024-best-practices\" class=\"mobile-header\"\u003eSecurity Hardening (2024 Best Practices)\u003c/h2\u003e\n\u003ch3 id=\"system-level-security\" class=\"mobile-header\"\u003eSystem-Level Security\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Disable swap (critical for security)\nsudo swapoff -a\nsudo sed -i \u0026#039;/ swap / s/^\\(.*\\)$/#\\1/g\u0026#039; /etc/fstab\n\n# Disable core dumps\necho \u0026#039;* hard core 0\u0026#039; | sudo tee -a /etc/security/limits.conf\necho \u0026#039;* soft core 0\u0026#039; | sudo tee -a /etc/security/limits.conf\necho \u0026#039;vault hard core 0\u0026#039; | sudo tee -a /etc/security/limits.conf\necho \u0026#039;vault soft core 0\u0026#039; | sudo tee -a /etc/security/limits.conf\n\n# Configure kernel parameters for security\nsudo tee -a /etc/sysctl.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n# Vault security hardening\nkernel.dmesg_restrict = 1\nkernel.kptr_restrict = 2\nkernel.yama.ptrace_scope = 1\nfs.suid_dumpable = 0\nnet.ipv4.conf.all.send_redirects = 0\nnet.ipv4.conf.default.send_redirects = 0\nnet.ipv4.conf.all.accept_source_route = 0\nnet.ipv4.conf.default.accept_source_route = 0\nEOF\n\nsudo sysctl -p\n\n# SELinux configuration (RHEL/CentOS/Fedora)\nif command -v getenforce \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    sudo setsebool -P authlogin_nsswitch_use_ldap 1\n    sudo setsebool -P allow_execheap 0\n    sudo setsebool -P allow_execmem 0\n    sudo setsebool -P allow_execmod 0\n    sudo setsebool -P allow_execstack 0\n    \n    # Custom SELinux policy for Vault\n    sudo tee vault.te \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\nmodule vault 1.0;\n\nrequire {\n    type unconfined_t;\n    type vault_t;\n    class capability { ipc_lock sys_admin };\n    class process { setrlimit };\n}\n\n#============= vault_t ==============\nallow vault_t self:capability { ipc_lock sys_admin };\nallow vault_t self:process setrlimit;\nEOF\n\n    checkmodule -M -m -o vault.mod vault.te\n    semodule_package -o vault.pp -m vault.mod\n    sudo semodule -i vault.pp\nfi\n\n# AppArmor configuration (Ubuntu/Debian)\nif command -v apparmor_status \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    sudo tee /etc/apparmor.d/vault \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n#include \u0026lt;tunables/global\u0026gt;\n\n/usr/local/bin/vault {\n  #include \u0026lt;abstractions/base\u0026gt;\n  #include \u0026lt;abstractions/nameservice\u0026gt;\n  #include \u0026lt;abstractions/ssl_certs\u0026gt;\n\n  capability ipc_lock,\n  capability setuid,\n  capability setgid,\n\n  /usr/local/bin/vault mr,\n  /etc/vault.d/** r,\n  /opt/vault/** rwk,\n  /proc/meminfo r,\n  /proc/sys/kernel/random/uuid r,\n  /sys/kernel/mm/transparent_hugepage/hpage_pmd_size r,\n\n  # Network access\n  network inet dgram,\n  network inet stream,\n\n  # Deny dangerous operations\n  deny /proc/kcore rwklx,\n  deny /proc/sysrq-trigger rwklx,\n  deny /proc/kmem rwklx,\n  deny /proc/mem rwklx,\n}\nEOF\n\n    sudo apparmor_parser -r /etc/apparmor.d/vault\nfi\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"firewall-configuration-cross-platform\" class=\"mobile-header\"\u003eFirewall Configuration (Cross-Platform)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# UFW (Ubuntu/Debian)\nsudo ufw allow from 10.0.0.0/8 to any port 8200 comment \u0026#039;Vault API - internal network only\u0026#039;\nsudo ufw allow from 10.0.0.0/8 to any port 8201 comment \u0026#039;Vault cluster - internal network only\u0026#039;\nsudo ufw deny 8200 comment \u0026#039;Block Vault API from public\u0026#039;\nsudo ufw deny 8201 comment \u0026#039;Block Vault cluster from public\u0026#039;\nsudo ufw enable\n\n# Firewalld (RHEL/CentOS/Fedora)\nsudo firewall-cmd --permanent --new-zone=vault\nsudo firewall-cmd --permanent --zone=vault --add-source=10.0.0.0/8\nsudo firewall-cmd --permanent --zone=vault --add-port=8200/tcp\nsudo firewall-cmd --permanent --zone=vault --add-port=8201/tcp\nsudo firewall-cmd --reload\n\n# iptables (Universal)\nsudo iptables -A INPUT -p tcp -s 10.0.0.0/8 --dport 8200 -j ACCEPT\nsudo iptables -A INPUT -p tcp -s 10.0.0.0/8 --dport 8201 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 8200 -j DROP\nsudo iptables -A INPUT -p tcp --dport 8201 -j DROP\n\n# Save iptables rules\n# Ubuntu/Debian\nsudo apt install -y iptables-persistent\nsudo netfilter-persistent save\n\n# RHEL/CentOS\nsudo service iptables save\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"audit-logging-and-monitoring\" class=\"mobile-header\"\u003eAudit Logging and Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable comprehensive audit logging\nexport VAULT_ADDR=\u0026#039;https://127.0.0.1:8200\u0026#039;\nvault auth \u0026lt;root-token\u0026gt;\n\n# Enable file audit device\nvault audit enable file file_path=/opt/vault/logs/audit.log\n\n# Enable syslog audit device\nvault audit enable syslog tag=\u0026quot;vault\u0026quot; facility=\u0026quot;LOCAL0\u0026quot;\n\n# Configure log rotation for audit logs\nsudo tee /etc/logrotate.d/vault-audit \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n/opt/vault/logs/audit.log {\n    daily\n    missingok\n    rotate 90\n    compress\n    delaycompress\n    notifempty\n    create 640 vault vault\n    postrotate\n        /bin/kill -HUP \\`cat /var/run/vault.pid 2\u0026gt;/dev/null\\` 2\u0026gt;/dev/null || true\n    endscript\n}\nEOF\n\n# Setup centralized logging (rsyslog configuration)\nsudo tee -a /etc/rsyslog.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n\n# Vault audit logging\nlocal0.*    /var/log/vault-audit.log\n\u0026amp; stop\nEOF\n\nsudo systemctl restart rsyslog\n\n# Prometheus monitoring configuration\nvault write sys/metrics/config enabled=true\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"authentication-methods-and-policies\" class=\"mobile-header\"\u003eAuthentication Methods and Policies\u003c/h2\u003e\n\u003ch3 id=\"enterprise-authentication-setup\" class=\"mobile-header\"\u003eEnterprise Authentication Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable and configure LDAP authentication\nvault auth enable ldap\n\nvault write auth/ldap/config \\\n    url=\u0026quot;ldaps://ldap.example.com\u0026quot; \\\n    userdn=\u0026quot;ou=Users,dc=example,dc=com\u0026quot; \\\n    userattr=\u0026quot;sAMAccountName\u0026quot; \\\n    groupdn=\u0026quot;ou=Groups,dc=example,dc=com\u0026quot; \\\n    groupfilter=\u0026quot;(\u0026amp;(objectClass=group)(member:1.2.840.113556.1.4.1941:={{.UserDN}}))\u0026quot; \\\n    groupattr=\u0026quot;cn\u0026quot; \\\n    binddn=\u0026quot;cn=vault,ou=Service Accounts,dc=example,dc=com\u0026quot; \\\n    bindpass=\u0026quot;ldap_service_password\u0026quot; \\\n    starttls=true \\\n    insecure_tls=false \\\n    certificate=@/opt/vault/tls/ldap-ca.crt\n\n# Configure OIDC authentication (Azure AD example)\nvault auth enable oidc\n\nvault write auth/oidc/config \\\n    oidc_discovery_url=\u0026quot;https://login.microsoftonline.com/your-tenant-id/v2.0\u0026quot; \\\n    oidc_client_id=\u0026quot;your-application-id\u0026quot; \\\n    oidc_client_secret=\u0026quot;your-client-secret\u0026quot; \\\n    default_role=\u0026quot;azure-ad-users\u0026quot;\n\nvault write auth/oidc/role/azure-ad-users \\\n    bound_audiences=\u0026quot;your-application-id\u0026quot; \\\n    allowed_redirect_uris=\u0026quot;https://vault.example.com:8200/ui/vault/auth/oidc/oidc/callback\u0026quot; \\\n    user_claim=\u0026quot;email\u0026quot; \\\n    policies=\u0026quot;azure-ad-policy\u0026quot;\n\n# Enable GitHub authentication\nvault auth enable github\n\nvault write auth/github/config \\\n    organization=\u0026quot;your-organization\u0026quot; \\\n    base_url=\u0026quot;https://github.com/\u0026quot; \\\n    max_ttl=\u0026quot;8h\u0026quot; \\\n    ttl=\u0026quot;1h\u0026quot;\n\nvault write auth/github/map/teams/vault-admins value=admin-policy\nvault write auth/github/map/teams/developers value=developer-policy\n\n# AWS IAM authentication\nvault auth enable aws\n\nvault write auth/aws/config/client \\\n    secret_key=\u0026quot;your-secret-key\u0026quot; \\\n    access_key=\u0026quot;your-access-key\u0026quot;\n\nvault write auth/aws/role/ec2-role \\\n    auth_type=\u0026quot;ec2\u0026quot; \\\n    policies=\u0026quot;ec2-policy\u0026quot; \\\n    max_ttl=\u0026quot;1h\u0026quot; \\\n    bound_instances=\u0026quot;i-1234567890abcdef0,i-0987654321fedcba0\u0026quot;\n\n# Kubernetes authentication\nvault auth enable kubernetes\n\nvault write auth/kubernetes/config \\\n    token_reviewer_jwt=\u0026quot;$(cat /var/run/secrets/kubernetes.io/serviceaccount/token)\u0026quot; \\\n    kubernetes_host=\u0026quot;https://kubernetes.example.com:6443\u0026quot; \\\n    kubernetes_ca_cert=@/var/run/secrets/kubernetes.io/serviceaccount/ca.crt\n\nvault write auth/kubernetes/role/myapp \\\n    bound_service_account_names=\u0026quot;vault-auth\u0026quot; \\\n    bound_service_account_namespaces=\u0026quot;default,production\u0026quot; \\\n    policies=\u0026quot;myapp-policy\u0026quot; \\\n    ttl=\u0026quot;1h\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-policy-management\" class=\"mobile-header\"\u003eAdvanced Policy Management\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create comprehensive policies with fine-grained access control\ncat \u0026gt; admin-policy.hcl \u0026lt;\u0026lt;EOF\n# Admin policy with full access and audit capabilities\npath \u0026quot;*\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;read\u0026quot;, \u0026quot;update\u0026quot;, \u0026quot;delete\u0026quot;, \u0026quot;list\u0026quot;, \u0026quot;sudo\u0026quot;]\n}\n\n# Audit log access for compliance\npath \u0026quot;sys/audit/*\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;read\u0026quot;, \u0026quot;update\u0026quot;, \u0026quot;delete\u0026quot;, \u0026quot;list\u0026quot;, \u0026quot;sudo\u0026quot;]\n}\n\n# Manage authentication methods\npath \u0026quot;sys/auth/*\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;read\u0026quot;, \u0026quot;update\u0026quot;, \u0026quot;delete\u0026quot;, \u0026quot;list\u0026quot;, \u0026quot;sudo\u0026quot;]\n}\n\n# Mount/unmount secrets engines\npath \u0026quot;sys/mounts/*\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;read\u0026quot;, \u0026quot;update\u0026quot;, \u0026quot;delete\u0026quot;, \u0026quot;list\u0026quot;, \u0026quot;sudo\u0026quot;]\n}\n\n# Configure and manage the audit devices\npath \u0026quot;sys/audit\u0026quot; {\n  capabilities = [\u0026quot;read\u0026quot;, \u0026quot;list\u0026quot;]\n}\nEOF\n\ncat \u0026gt; developer-policy.hcl \u0026lt;\u0026lt;EOF\n# Developer policy with limited access to application secrets\npath \u0026quot;secret/data/applications/{{identity.entity.aliases.auth_github_*.name}}/*\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;read\u0026quot;, \u0026quot;update\u0026quot;, \u0026quot;delete\u0026quot;, \u0026quot;list\u0026quot;]\n}\n\npath \u0026quot;secret/metadata/applications/{{identity.entity.aliases.auth_github_*.name}}/*\u0026quot; {\n  capabilities = [\u0026quot;list\u0026quot;]\n}\n\n# Read-only access to shared secrets\npath \u0026quot;secret/data/shared/*\u0026quot; {\n  capabilities = [\u0026quot;read\u0026quot;, \u0026quot;list\u0026quot;]\n}\n\n# Database credentials with time-bound access\npath \u0026quot;database/creds/readonly\u0026quot; {\n  capabilities = [\u0026quot;read\u0026quot;]\n}\n\n# PKI certificate generation for specific domains\npath \u0026quot;pki/issue/developer-role\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;update\u0026quot;]\n}\n\n# Self-service capabilities\npath \u0026quot;auth/token/lookup-self\u0026quot; {\n  capabilities = [\u0026quot;read\u0026quot;]\n}\n\npath \u0026quot;auth/token/renew-self\u0026quot; {\n  capabilities = [\u0026quot;update\u0026quot;]\n}\n\npath \u0026quot;auth/token/revoke-self\u0026quot; {\n  capabilities = [\u0026quot;update\u0026quot;]\n}\nEOF\n\ncat \u0026gt; cicd-policy.hcl \u0026lt;\u0026lt;EOF\n# CI/CD policy for automated systems\npath \u0026quot;secret/data/cicd/*\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;read\u0026quot;, \u0026quot;update\u0026quot;, \u0026quot;delete\u0026quot;, \u0026quot;list\u0026quot;]\n}\n\n# Database credentials for deployments\npath \u0026quot;database/creds/application-user\u0026quot; {\n  capabilities = [\u0026quot;read\u0026quot;]\n}\n\n# PKI for service certificates\npath \u0026quot;pki/issue/service-role\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;update\u0026quot;]\n}\n\n# Kubernetes service account tokens\npath \u0026quot;kubernetes/creds/application-role\u0026quot; {\n  capabilities = [\u0026quot;read\u0026quot;]\n}\n\n# AWS credentials for deployment\npath \u0026quot;aws/creds/deployment-role\u0026quot; {\n  capabilities = [\u0026quot;read\u0026quot;]\n}\nEOF\n\n# Apply policies\nvault policy write admin admin-policy.hcl\nvault policy write developer developer-policy.hcl\nvault policy write cicd cicd-policy.hcl\n\n# Create entity for identity management\nvault write identity/entity \\\n    name=\u0026quot;john.doe\u0026quot; \\\n    policies=\u0026quot;developer\u0026quot; \\\n    metadata=department=\u0026quot;engineering\u0026quot; \\\n    metadata=team=\u0026quot;platform\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"advanced-secrets-engines\" class=\"mobile-header\"\u003eAdvanced Secrets Engines\u003c/h2\u003e\n\u003ch3 id=\"database-secrets-engine\" class=\"mobile-header\"\u003eDatabase Secrets Engine\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable database secrets engine\nvault secrets enable database\n\n# Configure MySQL connection\nvault write database/config/mysql-prod \\\n    plugin_name=mysql-database-plugin \\\n    connection_url=\u0026quot;{{username}}:{{password}}@tcp(mysql.example.com:3306)/\u0026quot; \\\n    allowed_roles=\u0026quot;mysql-admin,mysql-readonly,mysql-application\u0026quot; \\\n    username=\u0026quot;vault\u0026quot; \\\n    password=\u0026quot;vault-service-password\u0026quot; \\\n    max_open_connections=5 \\\n    max_idle_connections=0 \\\n    max_connection_lifetime=\u0026quot;10m\u0026quot;\n\n# Create roles for different access levels\nvault write database/roles/mysql-admin \\\n    db_name=mysql-prod \\\n    creation_statements=\u0026quot;CREATE USER \u0026#039;{{name}}\u0026#039;@\u0026#039;%\u0026#039; IDENTIFIED BY \u0026#039;{{password}}\u0026#039;; GRANT ALL ON *.* TO \u0026#039;{{name}}\u0026#039;@\u0026#039;%\u0026#039;;\u0026quot; \\\n    default_ttl=\u0026quot;1h\u0026quot; \\\n    max_ttl=\u0026quot;24h\u0026quot;\n\nvault write database/roles/mysql-readonly \\\n    db_name=mysql-prod \\\n    creation_statements=\u0026quot;CREATE USER \u0026#039;{{name}}\u0026#039;@\u0026#039;%\u0026#039; IDENTIFIED BY \u0026#039;{{password}}\u0026#039;; GRANT SELECT ON *.* TO \u0026#039;{{name}}\u0026#039;@\u0026#039;%\u0026#039;;\u0026quot; \\\n    default_ttl=\u0026quot;1h\u0026quot; \\\n    max_ttl=\u0026quot;8h\u0026quot;\n\nvault write database/roles/mysql-application \\\n    db_name=mysql-prod \\\n    creation_statements=\u0026quot;CREATE USER \u0026#039;{{name}}\u0026#039;@\u0026#039;%\u0026#039; IDENTIFIED BY \u0026#039;{{password}}\u0026#039;; GRANT SELECT, INSERT, UPDATE, DELETE ON app_db.* TO \u0026#039;{{name}}\u0026#039;@\u0026#039;%\u0026#039;;\u0026quot; \\\n    default_ttl=\u0026quot;30m\u0026quot; \\\n    max_ttl=\u0026quot;2h\u0026quot;\n\n# PostgreSQL configuration\nvault write database/config/postgres-prod \\\n    plugin_name=postgresql-database-plugin \\\n    connection_url=\u0026quot;postgresql://{{username}}:{{password}}@postgres.example.com:5432/postgres?sslmode=require\u0026quot; \\\n    allowed_roles=\u0026quot;postgres-admin,postgres-readonly\u0026quot; \\\n    username=\u0026quot;vault\u0026quot; \\\n    password=\u0026quot;vault-postgres-password\u0026quot;\n\nvault write database/roles/postgres-admin \\\n    db_name=postgres-prod \\\n    creation_statements=\u0026quot;CREATE ROLE \\\u0026quot;{{name}}\\\u0026quot; WITH LOGIN PASSWORD \u0026#039;{{password}}\u0026#039; VALID UNTIL \u0026#039;{{expiration}}\u0026#039;; GRANT ALL PRIVILEGES ON DATABASE app_db TO \\\u0026quot;{{name}}\\\u0026quot;;\u0026quot; \\\n    default_ttl=\u0026quot;1h\u0026quot; \\\n    max_ttl=\u0026quot;24h\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"pki-secrets-engine-enterprise-certificate-management\" class=\"mobile-header\"\u003ePKI Secrets Engine (Enterprise Certificate Management)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable PKI secrets engine for internal CA\nvault secrets enable -path=pki pki\n\n# Configure CA\nvault secrets tune -max-lease-ttl=87600h pki\n\n# Generate internal CA certificate\nvault write -field=certificate pki/root/generate/internal \\\n    common_name=\u0026quot;Internal CA\u0026quot; \\\n    issuer_name=\u0026quot;internal-ca\u0026quot; \\\n    ttl=87600h \u0026gt; /opt/vault/tls/internal-ca.crt\n\n# Configure certificate URLs\nvault write pki/config/urls \\\n    issuing_certificates=\u0026quot;https://vault.example.com:8200/v1/pki/ca\u0026quot; \\\n    crl_distribution_points=\u0026quot;https://vault.example.com:8200/v1/pki/crl\u0026quot;\n\n# Create intermediate CA\nvault secrets enable -path=pki_int pki\n\nvault secrets tune -max-lease-ttl=43800h pki_int\n\n# Generate intermediate CSR\nvault write -format=json pki_int/intermediate/generate/internal \\\n    common_name=\u0026quot;Internal Intermediate CA\u0026quot; \\\n    issuer_name=\u0026quot;internal-intermediate-ca\u0026quot; \\\n    | jq -r \u0026#039;.data.csr\u0026#039; \u0026gt; pki_intermediate.csr\n\n# Sign intermediate certificate\nvault write -format=json pki/root/sign-intermediate \\\n    issuer_ref=\u0026quot;internal-ca\u0026quot; \\\n    csr=@pki_intermediate.csr \\\n    format=pem_bundle ttl=\u0026quot;43800h\u0026quot; \\\n    | jq -r \u0026#039;.data.certificate\u0026#039; \u0026gt; intermediate.cert.pem\n\n# Import signed certificate\nvault write pki_int/intermediate/set-signed certificate=@intermediate.cert.pem\n\n# Create role for service certificates\nvault write pki_int/roles/service-role \\\n    issuer_ref=\u0026quot;internal-intermediate-ca\u0026quot; \\\n    allowed_domains=\u0026quot;example.com,internal.example.com\u0026quot; \\\n    allow_subdomains=true \\\n    max_ttl=\u0026quot;72h\u0026quot; \\\n    generate_lease=true\n\n# Create role for client certificates\nvault write pki_int/roles/client-role \\\n    issuer_ref=\u0026quot;internal-intermediate-ca\u0026quot; \\\n    allowed_domains=\u0026quot;client.example.com\u0026quot; \\\n    allow_subdomains=false \\\n    client_flag=true \\\n    max_ttl=\u0026quot;24h\u0026quot;\n\n# Generate certificate\nvault write pki_int/issue/service-role common_name=\u0026quot;api.example.com\u0026quot; ttl=\u0026quot;24h\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"cloud-provider-integration\" class=\"mobile-header\"\u003eCloud Provider Integration\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### AWS Secrets Engine\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable AWS secrets engine\nvault secrets enable aws\n\n# Configure AWS credentials\nvault write aws/config/root \\\n    access_key=\u0026quot;vault-aws-access-key\u0026quot; \\\n    secret_key=\u0026quot;vault-aws-secret-key\u0026quot; \\\n    region=\u0026quot;us-west-2\u0026quot;\n\n# Create AWS roles\nvault write aws/roles/ec2-admin \\\n    credential_type=\u0026quot;iam_user\u0026quot; \\\n    policy_document=\u0026#039;-\u0026#039; \u0026lt;\u0026lt;EOF\n{\n  \u0026quot;Version\u0026quot;: \u0026quot;2012-10-17\u0026quot;,\n  \u0026quot;Statement\u0026quot;: [\n    {\n      \u0026quot;Effect\u0026quot;: \u0026quot;Allow\u0026quot;,\n      \u0026quot;Action\u0026quot;: [\n        \u0026quot;ec2:*\u0026quot;,\n        \u0026quot;vpc:*\u0026quot;\n      ],\n      \u0026quot;Resource\u0026quot;: \u0026quot;*\u0026quot;\n    }\n  ]\n}\nEOF\n\nvault write aws/roles/s3-readonly \\\n    credential_type=\u0026quot;iam_user\u0026quot; \\\n    policy_arns=\u0026quot;arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess\u0026quot; \\\n    default_sts_ttl=\u0026quot;1h\u0026quot; \\\n    max_sts_ttl=\u0026quot;12h\u0026quot;\n\n# Generate temporary AWS credentials\nvault read aws/creds/ec2-admin\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e#### Azure Secrets Engine\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable Azure secrets engine\nvault secrets enable azure\n\n# Configure Azure credentials\nvault write azure/config \\\n    subscription_id=\u0026quot;your-subscription-id\u0026quot; \\\n    tenant_id=\u0026quot;your-tenant-id\u0026quot; \\\n    client_id=\u0026quot;vault-service-principal-id\u0026quot; \\\n    client_secret=\u0026quot;vault-service-principal-secret\u0026quot;\n\n# Create Azure roles\nvault write azure/roles/contributor \\\n    azure_roles=\u0026#039;-\u0026#039; \u0026lt;\u0026lt;EOF\n[\n    {\n        \u0026quot;role_name\u0026quot;: \u0026quot;Contributor\u0026quot;,\n        \u0026quot;scope\u0026quot;:  \u0026quot;/subscriptions/your-subscription-id\u0026quot;\n    }\n]\nEOF\n\nvault write azure/roles/storage-admin \\\n    azure_roles=\u0026#039;-\u0026#039; \u0026lt;\u0026lt;EOF\n[\n    {\n        \u0026quot;role_name\u0026quot;: \u0026quot;Storage Account Contributor\u0026quot;,\n        \u0026quot;scope\u0026quot;:  \u0026quot;/subscriptions/your-subscription-id/resourceGroups/production\u0026quot;\n    }\n]\nEOF\n\n# Generate Azure credentials\nvault read azure/creds/contributor\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"enterprise-features\" class=\"mobile-header\"\u003eEnterprise Features\u003c/h2\u003e\n\u003ch3 id=\"performance-replication\" class=\"mobile-header\"\u003ePerformance Replication\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure performance replication (Enterprise)\n# On primary cluster\nvault write -f sys/replication/performance/primary/enable\n\n# Generate secondary token\nvault write sys/replication/performance/primary/secondary-token id=\u0026quot;dr-secondary\u0026quot;\n\n# On secondary cluster\nvault write sys/replication/performance/secondary/enable token=\u0026quot;\u0026lt;secondary-token\u0026gt;\u0026quot;\n\n# Monitor replication status\nvault read sys/replication/status\nvault read sys/replication/performance/status\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"disaster-recovery-replication\" class=\"mobile-header\"\u003eDisaster Recovery Replication\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable DR replication on primary\nvault write -f sys/replication/dr/primary/enable\n\n# Generate DR token\nvault write sys/replication/dr/primary/secondary-token id=\u0026quot;dr-cluster\u0026quot;\n\n# On DR cluster\nvault write sys/replication/dr/secondary/enable token=\u0026quot;\u0026lt;dr-token\u0026gt;\u0026quot;\n\n# Promote DR secondary (in disaster scenario)\nvault write -f sys/replication/dr/secondary/promote\n\n# Demote and revert\nvault write -f sys/replication/dr/secondary/reindex\nvault write sys/replication/dr/secondary/update-primary dr_operation_token=\u0026quot;\u0026lt;operation-token\u0026gt;\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"namespaces-enterprise\" class=\"mobile-header\"\u003eNamespaces (Enterprise)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create namespaces for multi-tenancy\nvault namespace create engineering\nvault namespace create finance\nvault namespace create operations\n\n# Work within specific namespace\nexport VAULT_NAMESPACE=engineering\n\n# Configure namespace-specific policies and auth methods\nvault policy write -namespace=engineering eng-admin - \u0026lt;\u0026lt;EOF\npath \u0026quot;*\u0026quot; {\n  capabilities = [\u0026quot;create\u0026quot;, \u0026quot;read\u0026quot;, \u0026quot;update\u0026quot;, \u0026quot;delete\u0026quot;, \u0026quot;list\u0026quot;]\n}\nEOF\n\n# Enable auth method in namespace\nvault auth enable -namespace=engineering userpass\n\nvault write -namespace=engineering auth/userpass/users/alice \\\n    password=\u0026quot;secure-password\u0026quot; \\\n    policies=\u0026quot;eng-admin\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"transform-secrets-engine-enterprise\" class=\"mobile-header\"\u003eTransform Secrets Engine (Enterprise)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable transform secrets engine for data protection\nvault secrets enable transform\n\n# Create transformation for credit card numbers\nvault write transform/role/payments \\\n    transformations=credit-card-transformation\n\nvault write transform/transformation/credit-card-transformation \\\n    type=fpe \\\n    template=\u0026quot;credit-card\u0026quot; \\\n    tweak_source=supplied \\\n    allowed_roles=payments\n\nvault write transform/template/credit-card \\\n    type=regex \\\n    pattern=\u0026#039;\\d{4}-\\d{4}-\\d{4}-(\\d{4})\u0026#039; \\\n    alphabet=numerics\n\n# Encode sensitive data\nvault write transform/encode/payments \\\n    transformation=credit-card-transformation \\\n    value=\u0026quot;1234-5678-9012-3456\u0026quot; \\\n    tweak=\u0026quot;user-123\u0026quot;\n\n# Decode when needed\nvault write transform/decode/payments \\\n    transformation=credit-card-transformation \\\n    value=\u0026quot;encoded-value\u0026quot; \\\n    tweak=\u0026quot;user-123\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-and-disaster-recovery\" class=\"mobile-header\"\u003eBackup and Disaster Recovery\u003c/h2\u003e\n\u003ch3 id=\"enterprise-backup-strategy\" class=\"mobile-header\"\u003eEnterprise Backup Strategy\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create comprehensive backup script\nsudo tee /usr/local/bin/vault-backup.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nBACKUP_DIR=\u0026quot;/backup/vault\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}/{snapshots,configs,certificates}\n\n# Raft storage snapshot (Enterprise)\nvault operator raft snapshot save ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap\n\n# Backup configuration files\ntar -czf ${BACKUP_DIR}/configs/vault-config-${DATE}.tar.gz \\\n    /etc/vault.d/ \\\n    /etc/systemd/system/vault.service\n\n# Backup TLS certificates\ntar -czf ${BACKUP_DIR}/certificates/vault-tls-${DATE}.tar.gz \\\n    /opt/vault/tls/\n\n# Backup to cloud storage\n# AWS S3\naws s3 cp ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap s3://vault-backups/snapshots/\naws s3 cp ${BACKUP_DIR}/configs/vault-config-${DATE}.tar.gz s3://vault-backups/configs/\n\n# Azure Blob Storage\naz storage blob upload \\\n    --file ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap \\\n    --container-name vault-backups \\\n    --name snapshots/vault-snapshot-${DATE}.snap\n\n# Google Cloud Storage\ngsutil cp ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap gs://vault-backups/snapshots/\n\n# Verify snapshot integrity\nvault operator raft snapshot inspect ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap\n\n# Keep only last 30 backups locally\nfind ${BACKUP_DIR} -name \u0026quot;vault-*\u0026quot; -type f -mtime +30 -delete\n\n# Encrypt backup files\ngpg --symmetric --cipher-algo AES256 ${BACKUP_DIR}/snapshots/vault-snapshot-${DATE}.snap\n\necho \u0026quot;Vault backup completed: ${DATE}\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/vault-backup.sh\n\n# Schedule automated backups\necho \u0026quot;0 2 * * * root /usr/local/bin/vault-backup.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"disaster-recovery-testing\" class=\"mobile-header\"\u003eDisaster Recovery Testing\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create DR testing script\nsudo tee /usr/local/bin/vault-dr-test.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nTEST_DIR=\u0026quot;/tmp/vault-dr-test\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${TEST_DIR}\n\n# Test snapshot restore capability\nvault operator raft snapshot save ${TEST_DIR}/test-snapshot-${DATE}.snap\n\n# Verify snapshot\nvault operator raft snapshot inspect ${TEST_DIR}/test-snapshot-${DATE}.snap\n\n# Test unsealing process\nvault operator key-status\n\n# Test authentication methods\nvault auth list\n\n# Test secrets engines\nvault secrets list\n\n# Test policy enforcement\nvault policy list\n\n# Generate test report\ncat \u0026gt; ${TEST_DIR}/dr-test-report-${DATE}.txt \u0026lt;\u0026lt;EOL\nVault DR Test Report - ${DATE}\n================================\n\nSnapshot Creation: $([ -f ${TEST_DIR}/test-snapshot-${DATE}.snap ] \u0026amp;\u0026amp; echo \u0026quot;PASS\u0026quot; || echo \u0026quot;FAIL\u0026quot;)\nVault Status: $(vault status -format=json | jq -r .sealed)\nActive Auth Methods: $(vault auth list -format=json | jq -r \u0026#039;keys | length\u0026#039;)\nActive Secrets Engines: $(vault secrets list -format=json | jq -r \u0026#039;keys | length\u0026#039;)\nPolicies Count: $(vault policy list | wc -l)\n\nTest completed at: $(date)\nEOL\n\necho \u0026quot;DR test completed. Report: ${TEST_DIR}/dr-test-report-${DATE}.txt\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/vault-dr-test.sh\n\n# Schedule monthly DR tests\necho \u0026quot;0 2 1 * * root /usr/local/bin/vault-dr-test.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"application-integration-examples\" class=\"mobile-header\"\u003eApplication Integration Examples\u003c/h2\u003e\n\u003ch3 id=\"kubernetes-integration-with-vault-agent\" class=\"mobile-header\"\u003eKubernetes Integration with Vault Agent\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Deploy Vault Agent as sidecar for Kubernetes workloads\ncat \u0026gt; vault-agent-k8s.yaml \u0026lt;\u0026lt;EOF\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: vault-agent-config\ndata:\n  vault-agent.hcl: |\n    exit_after_auth = false\n    pid_file = \u0026quot;/home/vault/pidfile\u0026quot;\n\n    auto_auth {\n      method \u0026quot;kubernetes\u0026quot; {\n        mount_path = \u0026quot;auth/kubernetes\u0026quot;\n        config = {\n          role = \u0026quot;myapp\u0026quot;\n        }\n      }\n\n      sink \u0026quot;file\u0026quot; {\n        config = {\n          path = \u0026quot;/home/vault/.vault-token\u0026quot;\n        }\n      }\n    }\n\n    cache {\n      use_auto_auth_token = true\n    }\n\n    listener \u0026quot;tcp\u0026quot; {\n      address = \u0026quot;127.0.0.1:8080\u0026quot;\n      tls_disable = true\n    }\n\n    vault {\n      address = \u0026quot;https://vault.example.com:8200\u0026quot;\n    }\n\n    template {\n      source      = \u0026quot;/vault/templates/database.conf.tpl\u0026quot;\n      destination = \u0026quot;/vault/secrets/database.conf\u0026quot;\n      perms       = 0640\n      command     = \u0026quot;pkill -SIGHUP myapp\u0026quot;\n    }\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: myapp-with-vault\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: myapp\n  template:\n    metadata:\n      labels:\n        app: myapp\n    spec:\n      serviceAccountName: vault-auth\n      securityContext:\n        runAsNonRoot: true\n        runAsUser: 1000\n        fsGroup: 1000\n      containers:\n      - name: vault-agent\n        image: vault:latest\n        command: [\u0026quot;vault\u0026quot;, \u0026quot;agent\u0026quot;, \u0026quot;-config=/vault/config/vault-agent.hcl\u0026quot;]\n        volumeMounts:\n        - name: vault-config\n          mountPath: /vault/config\n        - name: vault-secrets\n          mountPath: /vault/secrets\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - ALL\n      - name: myapp\n        image: myapp:latest\n        volumeMounts:\n        - name: vault-secrets\n          mountPath: /app/config\n          readOnly: true\n        env:\n        - name: DB_CONFIG_FILE\n          value: \u0026quot;/app/config/database.conf\u0026quot;\n        securityContext:\n          allowPrivilegeEscalation: false\n          readOnlyRootFilesystem: true\n          capabilities:\n            drop:\n            - ALL\n      volumes:\n      - name: vault-config\n        configMap:\n          name: vault-agent-config\n      - name: vault-secrets\n        emptyDir:\n          medium: Memory\nEOF\n\nkubectl apply -f vault-agent-k8s.yaml\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"cicd-pipeline-integration\" class=\"mobile-header\"\u003eCI/CD Pipeline Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# GitHub Actions integration\ncat \u0026gt; .github/workflows/vault-secrets.yml \u0026lt;\u0026lt;EOF\nname: Deploy with Vault Secrets\n\non:\n  push:\n    branches: [main]\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    permissions:\n      id-token: write\n      contents: read\n    \n    steps:\n    - name: Checkout code\n      uses: actions/checkout@v4\n    \n    - name: Configure Vault authentication\n      uses: hashicorp/vault-action@v2\n      with:\n        url: https://vault.example.com:8200\n        method: jwt\n        role: github-actions-role\n        secrets: |\n          secret/data/database username | DB_USER ;\n          secret/data/database password | DB_PASS ;\n          aws/creds/deployment-role access_key | AWS_ACCESS_KEY_ID ;\n          aws/creds/deployment-role secret_key | AWS_SECRET_ACCESS_KEY ;\n          pki_int/issue/service-role common_name=api.example.com ttl=1h | API_TLS_CERT\n    \n    - name: Deploy application\n      run: |\n        echo \u0026quot;Deploying with secrets from Vault\u0026quot;\n        echo \u0026quot;Database user: \\${{ env.DB_USER }}\u0026quot;\n        # Application deployment logic here\n      env:\n        DB_USER: \\${{ env.DB_USER }}\n        DB_PASS: \\${{ env.DB_PASS }}\n        AWS_ACCESS_KEY_ID: \\${{ env.AWS_ACCESS_KEY_ID }}\n        AWS_SECRET_ACCESS_KEY: \\${{ env.AWS_SECRET_ACCESS_KEY }}\nEOF\n\n# Configure GitHub Actions authentication in Vault\nvault auth enable jwt\n\nvault write auth/jwt/config \\\n    bound_issuer=\u0026quot;https://token.actions.githubusercontent.com\u0026quot; \\\n    oidc_discovery_url=\u0026quot;https://token.actions.githubusercontent.com\u0026quot;\n\nvault write auth/jwt/role/github-actions-role \\\n    bound_audiences=\u0026quot;https://github.com/your-org\u0026quot; \\\n    bound_subject=\u0026quot;repo:your-org/your-repo:ref:refs/heads/main\u0026quot; \\\n    user_claim=\u0026quot;actor\u0026quot; \\\n    role_type=\u0026quot;jwt\u0026quot; \\\n    policies=\u0026quot;cicd-policy\u0026quot; \\\n    ttl=\u0026quot;10m\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"terraform-integration\" class=\"mobile-header\"\u003eTerraform Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Vault provider for Terraform\ncat \u0026gt; terraform-vault.tf \u0026lt;\u0026lt;EOF\nterraform {\n  required_providers {\n    vault = {\n      source  = \u0026quot;hashicorp/vault\u0026quot;\n      version = \u0026quot;~\u0026gt; 3.0\u0026quot;\n    }\n  }\n}\n\nprovider \u0026quot;vault\u0026quot; {\n  address = \u0026quot;https://vault.example.com:8200\u0026quot;\n  token   = var.vault_token\n}\n\n# Read secrets from Vault\ndata \u0026quot;vault_generic_secret\u0026quot; \u0026quot;database\u0026quot; {\n  path = \u0026quot;secret/database\u0026quot;\n}\n\ndata \u0026quot;vault_aws_access_credentials\u0026quot; \u0026quot;deployment\u0026quot; {\n  backend = \u0026quot;aws\u0026quot;\n  role    = \u0026quot;deployment-role\u0026quot;\n}\n\n# Use secrets in resources\nresource \u0026quot;aws_db_instance\u0026quot; \u0026quot;main\u0026quot; {\n  identifier_prefix = var.project_name\n  \n  username = data.vault_generic_secret.database.data[\u0026quot;username\u0026quot;]\n  password = data.vault_generic_secret.database.data[\u0026quot;password\u0026quot;]\n  \n  # Other configuration...\n}\n\n# Store Terraform-generated secrets back in Vault\nresource \u0026quot;vault_generic_secret\u0026quot; \u0026quot;terraform_outputs\u0026quot; {\n  path = \u0026quot;secret/terraform/outputs\u0026quot;\n\n  data_json = jsonencode({\n    rds_endpoint = aws_db_instance.main.endpoint\n    vpc_id       = aws_vpc.main.id\n    subnet_ids   = aws_subnet.main[*].id\n  })\n}\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"monitoring-and-observability\" class=\"mobile-header\"\u003eMonitoring and Observability\u003c/h2\u003e\n\u003ch3 id=\"vault-metrics-and-monitoring\" class=\"mobile-header\"\u003eVault Metrics and Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable Vault metrics collection\nvault write sys/metrics/config \\\n    enabled=true \\\n    enable_hostname_label=false \\\n    default_lease_duration=\u0026quot;1h\u0026quot; \\\n    max_lease_duration=\u0026quot;24h\u0026quot;\n\n# Prometheus monitoring configuration\ncat \u0026gt; /etc/prometheus/vault-monitoring.yml \u0026lt;\u0026lt;EOF\nglobal:\n  scrape_interval: 15s\n\nscrape_configs:\n  - job_name: \u0026#039;vault\u0026#039;\n    scheme: https\n    tls_config:\n      ca_file: /opt/vault/tls/ca.crt\n      cert_file: /opt/prometheus/tls/client.crt\n      key_file: /opt/prometheus/tls/client.key\n    static_configs:\n      - targets: \n        - \u0026#039;vault-1.example.com:8200\u0026#039;\n        - \u0026#039;vault-2.example.com:8200\u0026#039;\n        - \u0026#039;vault-3.example.com:8200\u0026#039;\n    metrics_path: /v1/sys/metrics\n    params:\n      format: [\u0026#039;prometheus\u0026#039;]\n    bearer_token: \u0026quot;prometheus-vault-token\u0026quot;\n\n  # Monitor Vault process metrics\n  - job_name: \u0026#039;vault-node-exporter\u0026#039;\n    static_configs:\n      - targets:\n        - \u0026#039;vault-1.example.com:9100\u0026#039;\n        - \u0026#039;vault-2.example.com:9100\u0026#039;\n        - \u0026#039;vault-3.example.com:9100\u0026#039;\nEOF\n\n# Create Grafana dashboards for Vault monitoring\ncurl -X POST http://admin:admin@grafana.example.com/api/dashboards/db \\\n  -H \u0026#039;Content-Type: application/json\u0026#039; \\\n  -d @vault-dashboard.json\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-audit-analysis\" class=\"mobile-header\"\u003eAdvanced Audit Analysis\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create audit log analysis script\nsudo tee /usr/local/bin/vault-audit-analysis.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nAUDIT_LOG=\u0026quot;/opt/vault/logs/audit.log\u0026quot;\nANALYSIS_DIR=\u0026quot;/var/log/vault-analysis\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${ANALYSIS_DIR}\n\n# Failed authentication attempts\necho \u0026quot;Failed Authentication Analysis - ${DATE}\u0026quot; \u0026gt; ${ANALYSIS_DIR}/failed-auth-${DATE}.txt\njq -r \u0026#039;select(.type==\u0026quot;response\u0026quot; and .error != null) | [.time, .request.remote_address, .error] | @tsv\u0026#039; ${AUDIT_LOG} | tail -100 \u0026gt;\u0026gt; ${ANALYSIS_DIR}/failed-auth-${DATE}.txt\n\n# Most active users\necho \u0026quot;Most Active Users - ${DATE}\u0026quot; \u0026gt; ${ANALYSIS_DIR}/active-users-${DATE}.txt\njq -r \u0026#039;select(.type==\u0026quot;request\u0026quot; and .auth != null) | .auth.display_name\u0026#039; ${AUDIT_LOG} | sort | uniq -c | sort -nr | head -20 \u0026gt;\u0026gt; ${ANALYSIS_DIR}/active-users-${DATE}.txt\n\n# Secret access patterns\necho \u0026quot;Secret Access Patterns - ${DATE}\u0026quot; \u0026gt; ${ANALYSIS_DIR}/secret-access-${DATE}.txt\njq -r \u0026#039;select(.type==\u0026quot;request\u0026quot; and .request.path | test(\u0026quot;^secret/data/\u0026quot;)) | [.time, .auth.display_name, .request.path] | @tsv\u0026#039; ${AUDIT_LOG} | tail -100 \u0026gt;\u0026gt; ${ANALYSIS_DIR}/secret-access-${DATE}.txt\n\n# Policy violations\necho \u0026quot;Policy Violations - ${DATE}\u0026quot; \u0026gt; ${ANALYSIS_DIR}/policy-violations-${DATE}.txt\njq -r \u0026#039;select(.type==\u0026quot;response\u0026quot; and .error != null and (.error | test(\u0026quot;permission denied\u0026quot;))) | [.time, .auth.display_name, .request.path, .error] | @tsv\u0026#039; ${AUDIT_LOG} | tail -50 \u0026gt;\u0026gt; ${ANALYSIS_DIR}/policy-violations-${DATE}.txt\n\n# Generate summary report\ncat \u0026gt; ${ANALYSIS_DIR}/audit-summary-${DATE}.txt \u0026lt;\u0026lt;EOL\nVault Audit Summary - ${DATE}\n==============================\n\nTotal Requests: $(jq -s \u0026#039;length\u0026#039; ${AUDIT_LOG})\nFailed Authentications: $(jq -s \u0026#039;map(select(.type==\u0026quot;response\u0026quot; and .error != null)) | length\u0026#039; ${AUDIT_LOG})\nPolicy Violations: $(jq -s \u0026#039;map(select(.type==\u0026quot;response\u0026quot; and .error != null and (.error | test(\u0026quot;permission denied\u0026quot;)))) | length\u0026#039; ${AUDIT_LOG})\nUnique Users: $(jq -r \u0026#039;select(.type==\u0026quot;request\u0026quot; and .auth != null) | .auth.display_name\u0026#039; ${AUDIT_LOG} | sort -u | wc -l)\n\nTop 5 Accessed Paths:\n$(jq -r \u0026#039;select(.type==\u0026quot;request\u0026quot;) | .request.path\u0026#039; ${AUDIT_LOG} | sort | uniq -c | sort -nr | head -5)\n\nAnalysis completed at: $(date)\nEOL\n\necho \u0026quot;Audit analysis completed. Reports in: ${ANALYSIS_DIR}/\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/vault-audit-analysis.sh\n\n# Schedule weekly audit analysis\necho \u0026quot;0 6 * * 1 root /usr/local/bin/vault-audit-analysis.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"verification-and-testing\" class=\"mobile-header\"\u003eVerification and Testing\u003c/h2\u003e\n\u003ch3 id=\"comprehensive-health-checks\" class=\"mobile-header\"\u003eComprehensive Health Checks\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create Vault health monitoring script\nsudo tee /usr/local/bin/vault-health-check.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nVAULT_ADDR=\u0026quot;https://vault.example.com:8200\u0026quot;\nHEALTH_LOG=\u0026quot;/var/log/vault-health.log\u0026quot;\n\n# Function to log with timestamp\nlog_message() {\n    echo \u0026quot;$(date \u0026#039;+%Y-%m-%d %H:%M:%S\u0026#039;) - $1\u0026quot; | tee -a ${HEALTH_LOG}\n}\n\n# Check Vault service status\nif systemctl is-active vault \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;✓ Vault service is running\u0026quot;\nelse\n    log_message \u0026quot;✗ Vault service is not running\u0026quot;\n    exit 1\nfi\n\n# Check Vault HTTP health\nif curl -k -sf ${VAULT_ADDR}/v1/sys/health \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;✓ Vault HTTP endpoint is responding\u0026quot;\nelse\n    log_message \u0026quot;✗ Vault HTTP endpoint is not responding\u0026quot;\n    exit 1\nfi\n\n# Check if Vault is sealed\nSEALED_STATUS=$(vault status -format=json | jq -r .sealed)\nif [ \u0026quot;$SEALED_STATUS\u0026quot; = \u0026quot;false\u0026quot; ]; then\n    log_message \u0026quot;✓ Vault is unsealed\u0026quot;\nelse\n    log_message \u0026quot;✗ Vault is sealed\u0026quot;\n    exit 1\nfi\n\n# Check cluster status (if HA)\nif vault status -format=json | jq -r .ha_enabled | grep -q \u0026quot;true\u0026quot;; then\n    CLUSTER_HEALTH=$(vault operator raft list-peers -format=json | jq \u0026#039;.data.config.servers | length\u0026#039;)\n    log_message \u0026quot;✓ Cluster has ${CLUSTER_HEALTH} nodes\u0026quot;\nfi\n\n# Check replication status (Enterprise)\nREPLICATION_STATUS=$(vault read -format=json sys/replication/status 2\u0026gt;/dev/null)\nif [ $? -eq 0 ]; then\n    DR_MODE=$(echo $REPLICATION_STATUS | jq -r .data.dr.mode)\n    PERF_MODE=$(echo $REPLICATION_STATUS | jq -r .data.performance.mode)\n    log_message \u0026quot;✓ Replication status - DR: ${DR_MODE}, Performance: ${PERF_MODE}\u0026quot;\nfi\n\n# Check auth methods\nAUTH_METHODS=$(vault auth list -format=json | jq -r \u0026#039;keys | length\u0026#039;)\nlog_message \u0026quot;✓ ${AUTH_METHODS} authentication methods enabled\u0026quot;\n\n# Check secrets engines\nSECRETS_ENGINES=$(vault secrets list -format=json | jq -r \u0026#039;keys | length\u0026#039;)\nlog_message \u0026quot;✓ ${SECRETS_ENGINES} secrets engines enabled\u0026quot;\n\n# Check policy count\nPOLICIES=$(vault policy list | wc -l)\nlog_message \u0026quot;✓ ${POLICIES} policies configured\u0026quot;\n\n# Test secret read/write\nTEST_SECRET=\u0026quot;secret/health-check/test-$(date +%s)\u0026quot;\nif vault kv put ${TEST_SECRET} test=true \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    if vault kv get ${TEST_SECRET} \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n        log_message \u0026quot;✓ Secret read/write test passed\u0026quot;\n        vault kv delete ${TEST_SECRET} \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\n    else\n        log_message \u0026quot;✗ Secret read test failed\u0026quot;\n    fi\nelse\n    log_message \u0026quot;✗ Secret write test failed\u0026quot;\nfi\n\n# Check audit devices\nAUDIT_DEVICES=$(vault audit list -format=json | jq -r \u0026#039;keys | length\u0026#039;)\nlog_message \u0026quot;✓ ${AUDIT_DEVICES} audit devices enabled\u0026quot;\n\nlog_message \u0026quot;Vault health check completed successfully\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/vault-health-check.sh\n\n# Schedule health checks every 15 minutes\necho \u0026quot;*/15 * * * * root /usr/local/bin/vault-health-check.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"security-validation-testing\" class=\"mobile-header\"\u003eSecurity Validation Testing\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create security testing script\nsudo tee /usr/local/bin/vault-security-test.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nVAULT_ADDR=\u0026quot;https://vault.example.com:8200\u0026quot;\nTEST_RESULTS=\u0026quot;/tmp/vault-security-test-$(date +%Y%m%d_%H%M%S).txt\u0026quot;\n\necho \u0026quot;Vault Security Validation Test\u0026quot; \u0026gt; ${TEST_RESULTS}\necho \u0026quot;==============================\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\necho \u0026quot;Date: $(date)\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\necho \u0026quot;\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\n\n# Test 1: TLS Configuration\necho \u0026quot;Testing TLS Configuration...\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nTLS_VERSION=$(openssl s_client -connect vault.example.com:8200 -brief 2\u0026gt;/dev/null | grep \u0026quot;Protocol version\u0026quot;)\necho \u0026quot;TLS Version: ${TLS_VERSION}\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\n\n# Test 2: Authentication requirements\necho \u0026quot;Testing authentication requirements...\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nUNAUTH_ACCESS=$(curl -k -s -w \u0026quot;%{http_code}\u0026quot; -o /dev/null ${VAULT_ADDR}/v1/secret/test)\nif [ \u0026quot;$UNAUTH_ACCESS\u0026quot; = \u0026quot;403\u0026quot; ]; then\n    echo \u0026quot;✓ Unauthenticated access properly denied\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nelse\n    echo \u0026quot;✗ Unauthenticated access not properly restricted\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nfi\n\n# Test 3: Seal status\necho \u0026quot;Testing seal status...\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nSEALED=$(vault status -format=json | jq -r .sealed)\nif [ \u0026quot;$SEALED\u0026quot; = \u0026quot;false\u0026quot; ]; then\n    echo \u0026quot;✓ Vault is properly unsealed\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nelse\n    echo \u0026quot;✗ Vault is sealed\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nfi\n\n# Test 4: Audit logging\necho \u0026quot;Testing audit logging...\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nAUDIT_COUNT=$(vault audit list -format=json | jq -r \u0026#039;keys | length\u0026#039;)\nif [ \u0026quot;$AUDIT_COUNT\u0026quot; -gt \u0026quot;0\u0026quot; ]; then\n    echo \u0026quot;✓ ${AUDIT_COUNT} audit devices enabled\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nelse\n    echo \u0026quot;✗ No audit devices enabled\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nfi\n\n# Test 5: Policy enforcement\necho \u0026quot;Testing policy enforcement...\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nvault token create -policy=developer -ttl=1m -format=json \u0026gt; /tmp/test-token.json\nTEST_TOKEN=$(jq -r .auth.client_token /tmp/test-token.json)\n\n# Test with limited token\nVAULT_TOKEN=${TEST_TOKEN} vault auth -method=token ${TEST_TOKEN} \u0026gt;/dev/null 2\u0026gt;\u0026amp;1\nLIMITED_ACCESS=$(VAULT_TOKEN=${TEST_TOKEN} curl -k -s -w \u0026quot;%{http_code}\u0026quot; -o /dev/null -H \u0026quot;X-Vault-Token: ${TEST_TOKEN}\u0026quot; ${VAULT_ADDR}/v1/sys/auth)\nif [ \u0026quot;$LIMITED_ACCESS\u0026quot; = \u0026quot;403\u0026quot; ]; then\n    echo \u0026quot;✓ Policy enforcement working correctly\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nelse\n    echo \u0026quot;✗ Policy enforcement may be misconfigured\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\nfi\n\n# Revoke test token\nvault token revoke ${TEST_TOKEN}\nrm /tmp/test-token.json\n\necho \u0026quot;\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\necho \u0026quot;Security test completed at: $(date)\u0026quot; \u0026gt;\u0026gt; ${TEST_RESULTS}\n\necho \u0026quot;Security test completed. Results: ${TEST_RESULTS}\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/vault-security-test.sh\n\n# Run security tests weekly\necho \u0026quot;0 8 * * 1 root /usr/local/bin/vault-security-test.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting-cross-platform\" class=\"mobile-header\"\u003eTroubleshooting (Cross-Platform)\u003c/h2\u003e\n\u003ch3 id=\"common-issues-and-solutions\" class=\"mobile-header\"\u003eCommon Issues and Solutions\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check Vault status and logs\nvault status\nsudo journalctl -u vault -f\n\n# Debug unsealing issues\nvault operator key-status\nvault status -format=json | jq .recovery_seal\n\n# Memory lock issues\ncat /proc/$(pgrep vault)/status | grep VmLck\nulimit -l\n\n# Permission issues\nsudo chown -R vault:vault /opt/vault\nsudo chmod 640 /etc/vault.d/vault.hcl\nls -laZ /opt/vault  # SELinux context\n\n# Network connectivity tests\ncurl -k https://vault.example.com:8200/v1/sys/health\nopenssl s_client -connect vault.example.com:8200\n\n# Storage backend issues\n# For Raft storage\nvault operator raft list-peers\nvault operator raft autopilot status\n\n# For Consul storage\nconsul members\nconsul kv get -recurse vault/\n\n# Certificate issues\nopenssl x509 -in /opt/vault/tls/vault.crt -text -noout\nvault auth -method=cert \\\n    -ca-cert=/opt/vault/tls/ca.crt \\\n    -client-cert=/opt/vault/tls/client.crt \\\n    -client-key=/opt/vault/tls/client.key\n\n# Performance troubleshooting\nvault read sys/metrics\nvault read sys/host-info\nvault read sys/pprof/profile  # Enterprise\n\n# Audit log analysis\ntail -f /opt/vault/logs/audit.log | jq .\ngrep \u0026quot;error\u0026quot; /opt/vault/logs/audit.log | jq .\n\n# Token debugging\nvault token lookup\nvault token capabilities secret/data/test\n\n# Seal/unseal debugging\nvault operator unseal -migrate  # For seal migration\nvault operator rekey  # For changing unseal keys\n\n# Cluster debugging\nvault operator raft snapshot save debug-snapshot.snap\nvault operator raft snapshot inspect debug-snapshot.snap\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-debugging\" class=\"mobile-header\"\u003eAdvanced Debugging\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable debug logging\nsudo systemctl edit vault.service\n# Add:\n[Service]\nExecStart=\nExecStart=/usr/local/bin/vault server -config=/etc/vault.d/vault.hcl -log-level=debug\n\nsudo systemctl daemon-reload\nsudo systemctl restart vault\n\n# Monitor real-time operations\ntail -f /opt/vault/logs/vault.log | grep -E \u0026quot;(ERROR|WARN|DEBUG)\u0026quot;\n\n# Database connection debugging\nvault read database/config/mysql-prod\n\n# PKI debugging\nvault read pki/cert/ca\nvault read pki/crl\n\n# Replication debugging (Enterprise)\nvault read sys/replication/performance/status\nvault read sys/replication/dr/status\n\n# HSM debugging (Enterprise)\nvault read sys/seal-status\nvault read sys/hsm/status\n\n# Memory and performance analysis\npmap -x $(pgrep vault)\nstrace -p $(pgrep vault) -e trace=file\n\n# Network debugging\nss -tulpn | grep vault\nnetstat -tulpn | grep vault\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.vaultproject.io/docs\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eOfficial Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.vaultproject.io/api-docs\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eAPI Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://learn.hashicorp.com/tutorials/vault/production-hardening\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eProduction Hardening Guide\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.hashicorp.com/products/vault/enterprise\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eEnterprise Features\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://learn.hashicorp.com/tutorials/vault/security-intro\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eSecurity Best Practices\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://discuss.hashicorp.com/c/vault\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eCommunity Forum\u003c/a\u003e\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection.\u003c/p\u003e","readTime":"27 min","wordCount":5390,"lastBuilt":"2025-09-15T18:14:30.469Z"},{"name":"wireguard","displayName":"Wireguard","slug":"wireguard","description":"Repo for wireguard","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/wireguard","updatedAt":"2025-09-14T01:31:22Z","createdAt":"2025-09-08T03:18:17Z","readmeRaw":"# WireGuard Installation Guide\n\nModern, fast, and secure VPN solution using state-of-the-art cryptography. Essential tool for secure remote access, site-to-site connectivity, and privacy protection with minimal configuration complexity.\n\n## Prerequisites\n\n- Linux system with kernel 3.10+ (any modern distribution)\n- Root or sudo access\n- Static IP address or dynamic DNS\n- UDP port 51820 available (default, configurable)\n- Basic understanding of networking concepts\n\n## Installation\n\n### Ubuntu/Debian\n```bash\n# Update system packages\nsudo apt update \u0026\u0026 sudo apt upgrade -y\n\n# Install WireGuard\nsudo apt install -y wireguard wireguard-tools\n\n# For older Ubuntu versions (18.04)\nsudo add-apt-repository ppa:wireguard/wireguard\nsudo apt update\nsudo apt install -y wireguard\n\n# Install additional tools\nsudo apt install -y qrencode resolvconf\n\n# Verify installation\nwg --version\nmodprobe wireguard \u0026\u0026 echo \"WireGuard module loaded successfully\"\n```\n\n### RHEL/CentOS/Rocky Linux/AlmaLinux\n```bash\n# Install EPEL repository\nsudo yum install -y epel-release\n\n# Install WireGuard\nsudo yum install -y wireguard-tools\n\n# For CentOS 7 (requires additional steps)\nsudo yum install -y yum-plugin-elrepo\nsudo yum install -y kmod-wireguard wireguard-tools\n\n# Install additional tools\nsudo yum install -y qrencode\n\n# Enable IP forwarding\necho 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.conf\necho 'net.ipv6.conf.all.forwarding = 1' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n```\n\n### Fedora\n```bash\n# Install WireGuard (included in kernel 5.6+)\nsudo dnf install -y wireguard-tools qrencode\n\n# Enable IP forwarding\necho 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n```\n\n### Arch Linux\n```bash\n# Install WireGuard\nsudo pacman -Syu wireguard-tools qrencode\n\n# Load WireGuard module\nsudo modprobe wireguard\n\n# Enable IP forwarding\necho 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n```\n\n## Server Configuration\n\n### Generate Keys and Create Server Config\n```bash\n# Create WireGuard directory\nsudo mkdir -p /etc/wireguard\nsudo chmod 700 /etc/wireguard\n\n# Generate server keys\ncd /etc/wireguard\nwg genkey | sudo tee server_private.key | wg pubkey | sudo tee server_public.key\nsudo chmod 600 server_private.key\n\n# Create server configuration\nsudo tee /etc/wireguard/wg0.conf \u003e /dev/null \u003c\u003cEOF\n[Interface]\n# Server configuration\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24, fd00::1/64\nListenPort = 51820\nSaveConfig = true\n\n# Network configuration\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE; ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE; ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n# DNS servers (optional)\nDNS = 1.1.1.1, 8.8.8.8\n\n# Client configurations will be added here automatically\n# [Peer] sections for each client\nEOF\n\nsudo chmod 600 /etc/wireguard/wg0.conf\n```\n\n### Advanced Server Configuration\n```bash\n# Create production server configuration with security\nsudo tee /etc/wireguard/wg0.conf \u003e /dev/null \u003c\u003cEOF\n[Interface]\n# Server identity\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24\nListenPort = 51820\nSaveConfig = false  # Disable for security in production\n\n# Network forwarding and NAT\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostUp = ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\nPostDown = ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n# Security: Block private networks (adjust as needed)\nPostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 192.168.1.0/24 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 172.16.0.0/12 -j DROP\n\n# DNS configuration\nDNS = 10.0.0.1  # Use Pi-hole or local DNS\n\n# Example client configurations\n[Peer]\n# Client 1 - Admin laptop\nPublicKey = client1_public_key_here\nAllowedIPs = 10.0.0.2/32\nPersistentKeepalive = 25\n\n[Peer]  \n# Client 2 - Mobile device\nPublicKey = client2_public_key_here\nAllowedIPs = 10.0.0.3/32\nPersistentKeepalive = 25\n\n[Peer]\n# Client 3 - Site-to-site (branch office)\nPublicKey = site_public_key_here\nAllowedIPs = 10.0.0.0/24, 192.168.100.0/24\nEndpoint = branch.example.com:51820\nPersistentKeepalive = 25\nEOF\n```\n\n## Client Configuration\n\n### Generate Client Configurations\n```bash\n# Create client configuration generator script\nsudo tee /usr/local/bin/wg-add-client.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nCLIENT_NAME=\"${1}\"\nSERVER_PUBLIC_IP=\"${2:-your-server-public-ip}\"\nSERVER_PUBLIC_KEY=\"$(sudo cat /etc/wireguard/server_public.key)\"\n\nif [ -z \"$CLIENT_NAME\" ]; then\n    echo \"Usage: $0 \u003cclient_name\u003e [server_public_ip]\"\n    echo \"Example: $0 laptop1 203.0.113.1\"\n    exit 1\nfi\n\n# Get next available IP\nLAST_IP=$(grep \"AllowedIPs\" /etc/wireguard/wg0.conf | grep -o \"10\\.0\\.0\\.[0-9]*\" | sort -t. -k4 -n | tail -1 | cut -d. -f4)\nNEXT_IP=$((LAST_IP + 1))\nCLIENT_IP=\"10.0.0.${NEXT_IP}/32\"\n\n# Generate client keys\nCLIENT_PRIVATE_KEY=$(wg genkey)\nCLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)\n\n# Add peer to server configuration\nsudo tee -a /etc/wireguard/wg0.conf \u003e /dev/null \u003c\u003cPEER\n\n[Peer]\n# ${CLIENT_NAME}\nPublicKey = ${CLIENT_PUBLIC_KEY}\nAllowedIPs = ${CLIENT_IP}\nPersistentKeepalive = 25\nPEER\n\n# Generate client configuration\ncat \u003e /tmp/${CLIENT_NAME}.conf \u003c\u003cCLIENT_CONFIG\n[Interface]\nPrivateKey = ${CLIENT_PRIVATE_KEY}\nAddress = ${CLIENT_IP}\nDNS = 10.0.0.1, 1.1.1.1\n\n[Peer]\nPublicKey = ${SERVER_PUBLIC_KEY}\nEndpoint = ${SERVER_PUBLIC_IP}:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nCLIENT_CONFIG\n\n# Generate QR code for mobile devices\nqrencode -t ansiutf8 \u003c /tmp/${CLIENT_NAME}.conf\n\necho \"Client configuration created: /tmp/${CLIENT_NAME}.conf\"\necho \"Add to server with: sudo wg addconf wg0 \u003c(echo '[Peer]'; echo 'PublicKey = ${CLIENT_PUBLIC_KEY}'; echo 'AllowedIPs = ${CLIENT_IP}')\"\nEOF\n\nsudo chmod +x /usr/local/bin/wg-add-client.sh\n\n# Example: Add a client\n# sudo /usr/local/bin/wg-add-client.sh laptop1 your-server-ip\n```\n\n### Client Examples\n```bash\n# Mobile device configuration\ncat \u003e mobile-client.conf \u003c\u003cEOF\n[Interface]\nPrivateKey = mobile_device_private_key\nAddress = 10.0.0.10/32\nDNS = 10.0.0.1\n\n[Peer]\nPublicKey = server_public_key_here\nEndpoint = vpn.example.com:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nEOF\n\n# Site-to-site configuration (branch office)\ncat \u003e branch-office.conf \u003c\u003cEOF\n[Interface]\nPrivateKey = branch_office_private_key\nAddress = 10.0.0.100/32\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n[Peer]\nPublicKey = server_public_key_here\nEndpoint = vpn.example.com:51820\nAllowedIPs = 10.0.0.0/24, 192.168.1.0/24\nPersistentKeepalive = 25\nEOF\n```\n\n## Service Management and Security\n\n### SystemD Service\n```bash\n# Enable WireGuard interface as systemd service\nsudo systemctl enable wg-quick@wg0\nsudo systemctl start wg-quick@wg0\n\n# Check status\nsudo systemctl status wg-quick@wg0\nsudo wg show\n\n# Alternative: Manual management\nsudo wg-quick up wg0\nsudo wg-quick down wg0\n```\n\n### Firewall Configuration\n```bash\n# Configure UFW for WireGuard\nsudo ufw allow 51820/udp comment 'WireGuard VPN'\nsudo ufw allow from 10.0.0.0/24 comment 'WireGuard clients'\n\n# For internal network access\nsudo ufw allow from 10.0.0.0/24 to 192.168.1.0/24\n\n# Firewalld configuration (RHEL/CentOS)\nsudo firewall-cmd --permanent --add-port=51820/udp\nsudo firewall-cmd --permanent --add-rich-rule='rule family=ipv4 source address=10.0.0.0/24 accept'\nsudo firewall-cmd --reload\n\n# Direct iptables rules\nsudo iptables -A INPUT -p udp --dport 51820 -j ACCEPT\nsudo iptables -A FORWARD -i wg0 -j ACCEPT\nsudo iptables -A FORWARD -o wg0 -j ACCEPT\nsudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n```\n\n### Security Hardening\n```bash\n# Configure advanced security features\nsudo tee /etc/wireguard/wg0.conf \u003e /dev/null \u003c\u003cEOF\n[Interface]\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24\nListenPort = 51820\n\n# Security: Change default port\n# ListenPort = 41194\n\n# DNS security\nDNS = 10.0.0.1  # Use Pi-hole for ad blocking\n\n# Advanced security rules\nPostUp = iptables -A FORWARD -i %i -j ACCEPT\nPostUp = iptables -A FORWARD -o %i -j ACCEPT\nPostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n\n# Block access to local network (security measure)\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.0/24 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 172.16.0.0/12 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 10.0.0.0/8 -j DROP\n\n# Allow specific services only\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.100 -p tcp --dport 22 -j ACCEPT    # SSH to server\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.101 -p tcp --dport 443 -j ACCEPT  # HTTPS to web services\n\nPostDown = iptables -D FORWARD -i %i -j ACCEPT\nPostDown = iptables -D FORWARD -o %i -j ACCEPT\nPostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\nEOF\n```\n\n## Management and Automation\n\n### WireGuard Management Script\n```bash\nsudo tee /usr/local/bin/wg-manager.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\n\nINTERFACE=\"wg0\"\nCONFIG_FILE=\"/etc/wireguard/${INTERFACE}.conf\"\nCLIENTS_DIR=\"/etc/wireguard/clients\"\nSERVER_PUBLIC_IP=\"${SERVER_PUBLIC_IP:-$(curl -s ipinfo.io/ip)}\"\nSERVER_PUBLIC_KEY=\"$(sudo cat /etc/wireguard/server_public.key)\"\n\nsudo mkdir -p ${CLIENTS_DIR}\n\ncase \"${1}\" in\n    \"add-client\")\n        CLIENT_NAME=\"${2}\"\n        if [ -z \"$CLIENT_NAME\" ]; then\n            echo \"Usage: $0 add-client \u003cclient_name\u003e\"\n            exit 1\n        fi\n        \n        # Generate client keys\n        CLIENT_PRIVATE_KEY=$(wg genkey)\n        CLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)\n        \n        # Get next available IP\n        LAST_IP=$(grep \"AllowedIPs\" ${CONFIG_FILE} | grep -o \"10\\.0\\.0\\.[0-9]*\" | sort -t. -k4 -n | tail -1 | cut -d. -f4)\n        NEXT_IP=$((LAST_IP + 1))\n        CLIENT_IP=\"10.0.0.${NEXT_IP}\"\n        \n        # Add peer to server\n        sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} allowed-ips ${CLIENT_IP}/32\n        \n        # Save to config\n        sudo tee -a ${CONFIG_FILE} \u003e /dev/null \u003c\u003cPEER\n\n[Peer]\n# ${CLIENT_NAME} - $(date)\nPublicKey = ${CLIENT_PUBLIC_KEY}\nAllowedIPs = ${CLIENT_IP}/32\nPersistentKeepalive = 25\nPEER\n        \n        # Generate client config\n        cat \u003e ${CLIENTS_DIR}/${CLIENT_NAME}.conf \u003c\u003cCLIENT_CONFIG\n[Interface]\nPrivateKey = ${CLIENT_PRIVATE_KEY}\nAddress = ${CLIENT_IP}/32\nDNS = 10.0.0.1\n\n[Peer]\nPublicKey = ${SERVER_PUBLIC_KEY}\nEndpoint = ${SERVER_PUBLIC_IP}:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nCLIENT_CONFIG\n        \n        # Generate QR code\n        echo \"Client ${CLIENT_NAME} configuration:\"\n        qrencode -t ansiutf8 \u003c ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n        echo \"Configuration file: ${CLIENTS_DIR}/${CLIENT_NAME}.conf\"\n        ;;\n        \n    \"remove-client\")\n        CLIENT_NAME=\"${2}\"\n        if [ -z \"$CLIENT_NAME\" ]; then\n            echo \"Usage: $0 remove-client \u003cclient_name\u003e\"\n            exit 1\n        fi\n        \n        CLIENT_PUBLIC_KEY=$(grep -A 3 \"# ${CLIENT_NAME}\" ${CONFIG_FILE} | grep \"PublicKey\" | cut -d' ' -f3)\n        if [ -n \"$CLIENT_PUBLIC_KEY\" ]; then\n            sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} remove\n            sudo sed -i \"/# ${CLIENT_NAME}/,+3d\" ${CONFIG_FILE}\n            rm -f ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n            echo \"Client ${CLIENT_NAME} removed\"\n        else\n            echo \"Client ${CLIENT_NAME} not found\"\n        fi\n        ;;\n        \n    \"list-clients\")\n        echo \"Connected clients:\"\n        sudo wg show ${INTERFACE}\n        echo \"\"\n        echo \"Configured clients:\"\n        grep \"^# \" ${CONFIG_FILE} | sed 's/# /- /'\n        ;;\n        \n    \"show-client\")\n        CLIENT_NAME=\"${2}\"\n        if [ -z \"$CLIENT_NAME\" ]; then\n            echo \"Usage: $0 show-client \u003cclient_name\u003e\"\n            exit 1\n        fi\n        \n        if [ -f \"${CLIENTS_DIR}/${CLIENT_NAME}.conf\" ]; then\n            echo \"Configuration for ${CLIENT_NAME}:\"\n            cat ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n            echo \"\"\n            echo \"QR Code:\"\n            qrencode -t ansiutf8 \u003c ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n        else\n            echo \"Client ${CLIENT_NAME} not found\"\n        fi\n        ;;\n        \n    \"status\")\n        echo \"WireGuard Status:\"\n        sudo systemctl status wg-quick@${INTERFACE}\n        echo \"\"\n        echo \"Interface Details:\"\n        sudo wg show ${INTERFACE}\n        echo \"\"\n        echo \"Interface Statistics:\"\n        sudo wg show ${INTERFACE} transfer\n        ;;\n        \n    \"restart\")\n        echo \"Restarting WireGuard...\"\n        sudo systemctl restart wg-quick@${INTERFACE}\n        echo \"WireGuard restarted\"\n        ;;\n        \n    *)\n        echo \"WireGuard Management Script\"\n        echo \"Usage: $0 {add-client|remove-client|list-clients|show-client|status|restart}\"\n        echo \"\"\n        echo \"Examples:\"\n        echo \"  $0 add-client laptop1\"\n        echo \"  $0 remove-client laptop1\"  \n        echo \"  $0 show-client laptop1\"\n        echo \"  $0 list-clients\"\n        echo \"  $0 status\"\n        echo \"  $0 restart\"\n        exit 1\n        ;;\nesac\nEOF\n\nsudo chmod +x /usr/local/bin/wg-manager.sh\n```\n\n### Web UI (WireGuard Easy)\n```bash\n# Install WireGuard Easy (web management interface)\nmkdir -p ~/wg-easy\ncd ~/wg-easy\n\ncat \u003e docker-compose.yml \u003c\u003cEOF\nversion: '3.8'\n\nservices:\n  wg-easy:\n    image: weejewel/wg-easy:latest\n    container_name: wg-easy\n    restart: unless-stopped\n    ports:\n      - \"51821:51821/udp\"  # WireGuard port\n      - \"127.0.0.1:51822:51822/tcp\"  # Web UI port\n    environment:\n      - WG_HOST=vpn.example.com\n      - PASSWORD=WebUISecurePassword2024!\n      - WG_PORT=51821\n      - WG_DEFAULT_ADDRESS=10.8.0.x\n      - WG_DEFAULT_DNS=1.1.1.1,8.8.8.8\n      - WG_MTU=1420\n      - WG_ALLOWED_IPS=0.0.0.0/0,::/0\n      - WG_PERSISTENT_KEEPALIVE=25\n    volumes:\n      - ./data:/etc/wireguard\n    cap_add:\n      - NET_ADMIN\n      - SYS_MODULE\n    sysctls:\n      - net.ipv4.ip_forward=1\n      - net.ipv4.conf.all.src_valid_mark=1\n    networks:\n      - wg-easy\n\nnetworks:\n  wg-easy:\n    driver: bridge\nEOF\n\n# Start WG-Easy\ndocker-compose up -d\n\n# Access web interface at http://localhost:51822\n```\n\n## Monitoring and Maintenance\n\n### Health Monitoring\n```bash\nsudo tee /usr/local/bin/wireguard-health.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nHEALTH_LOG=\"/var/log/wireguard-health.log\"\n\nlog_message() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" | tee -a ${HEALTH_LOG}\n}\n\n# Check WireGuard service\nif systemctl is-active wg-quick@wg0 \u003e/dev/null 2\u003e\u00261; then\n    log_message \"✓ WireGuard service is running\"\nelse\n    log_message \"✗ WireGuard service is not running\"\n    exit 1\nfi\n\n# Check interface status\nif ip link show wg0 \u003e/dev/null 2\u003e\u00261; then\n    log_message \"✓ WireGuard interface is up\"\nelse\n    log_message \"✗ WireGuard interface is down\"\nfi\n\n# Check connected peers\nCONNECTED_PEERS=$(sudo wg show wg0 peers | wc -l)\nACTIVE_PEERS=$(sudo wg show wg0 latest-handshakes | awk '$2 \u003e 0' | wc -l)\nlog_message \"ℹ Connected peers: ${ACTIVE_PEERS}/${CONNECTED_PEERS}\"\n\n# Check traffic statistics\nTRAFFIC_STATS=$(sudo wg show wg0 transfer)\nlog_message \"ℹ Traffic statistics available: $(echo \"$TRAFFIC_STATS\" | wc -l) peers\"\n\n# Check listening port\nif ss -ulpn | grep -q \":51820\"; then\n    log_message \"✓ WireGuard is listening on port 51820\"\nelse\n    log_message \"⚠ WireGuard not listening on expected port\"\nfi\n\n# Check IP forwarding\nIP_FORWARD=$(cat /proc/sys/net/ipv4/ip_forward)\nif [ \"$IP_FORWARD\" = \"1\" ]; then\n    log_message \"✓ IP forwarding is enabled\"\nelse\n    log_message \"✗ IP forwarding is disabled\"\nfi\n\nlog_message \"WireGuard health check completed\"\nEOF\n\nsudo chmod +x /usr/local/bin/wireguard-health.sh\n\n# Schedule health checks every 10 minutes\necho \"*/10 * * * * root /usr/local/bin/wireguard-health.sh\" | sudo tee -a /etc/crontab\n```\n\n### Backup and Configuration Management\n```bash\nsudo tee /usr/local/bin/wireguard-backup.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nBACKUP_DIR=\"/backup/wireguard\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}/{configs,clients}\n\necho \"Starting WireGuard backup...\"\n\n# Backup server configuration\ncp /etc/wireguard/wg0.conf ${BACKUP_DIR}/configs/wg0-${DATE}.conf\n\n# Backup client configurations\nif [ -d \"/etc/wireguard/clients\" ]; then\n    tar -czf ${BACKUP_DIR}/clients/clients-${DATE}.tar.gz -C /etc/wireguard clients/\nfi\n\n# Backup keys\ntar -czf ${BACKUP_DIR}/configs/keys-${DATE}.tar.gz -C /etc/wireguard *.key\n\n# Upload to cloud storage (encrypted)\ngpg --symmetric --cipher-algo AES256 --compress-algo 1 --s2k-mode 3 \\\n    --s2k-digest-algo SHA512 --s2k-count 65536 \\\n    --output ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg \\\n    --compress-level 9 \\\n    \u003c(tar -czf - -C ${BACKUP_DIR} .)\n\n# Upload encrypted backup\naws s3 cp ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg s3://wireguard-backups/\n\n# Keep only last 30 backups\nfind ${BACKUP_DIR} -name \"wireguard-*\" -type f -mtime +30 -delete\n\necho \"WireGuard backup completed: ${DATE}\"\nEOF\n\nsudo chmod +x /usr/local/bin/wireguard-backup.sh\n\n# Schedule daily backups\necho \"0 3 * * * root /usr/local/bin/wireguard-backup.sh\" | sudo tee -a /etc/crontab\n```\n\n## Advanced Features\n\n### Site-to-Site VPN\n```bash\n# Configure site-to-site VPN between offices\n# Office A (Main) - 192.168.1.0/24\n# Office B (Branch) - 192.168.2.0/24\n\n# Main office WireGuard config\nsudo tee /etc/wireguard/site-to-site.conf \u003e /dev/null \u003c\u003cEOF\n[Interface]\nPrivateKey = main_office_private_key\nAddress = 172.16.0.1/30\nListenPort = 51820\n\n# Route traffic between sites\nPostUp = ip route add 192.168.2.0/24 dev %i\nPostUp = iptables -A FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT\nPostUp = iptables -A FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT\n\nPostDown = ip route del 192.168.2.0/24 dev %i\nPostDown = iptables -D FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT\nPostDown = iptables -D FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT\n\n[Peer]\n# Branch Office\nPublicKey = branch_office_public_key\nEndpoint = branch.example.com:51820\nAllowedIPs = 172.16.0.2/32, 192.168.2.0/24\nPersistentKeepalive = 25\nEOF\n```\n\n### Load Balancing and Failover\n```bash\n# Configure multiple WireGuard servers for redundancy\n# Client configuration with multiple peers\ncat \u003e multi-server-client.conf \u003c\u003cEOF\n[Interface]\nPrivateKey = client_private_key\nAddress = 10.0.0.10/32\nDNS = 1.1.1.1, 8.8.8.8\n\n# Primary server\n[Peer]\nPublicKey = primary_server_public_key\nEndpoint = vpn1.example.com:51820\nAllowedIPs = 0.0.0.0/1, 128.0.0.0/1\nPersistentKeepalive = 25\n\n# Backup server (different IP range to avoid conflicts)\n[Peer]\nPublicKey = backup_server_public_key\nEndpoint = vpn2.example.com:51820\nAllowedIPs = 10.1.0.0/24\nPersistentKeepalive = 25\nEOF\n```\n\n## Troubleshooting\n\n### Common Issues and Solutions\n```bash\n# Check WireGuard status\nsudo systemctl status wg-quick@wg0\nsudo wg show\n\n# Check interface configuration\nip addr show wg0\nip route show table all | grep wg0\n\n# Test connectivity\nping -c 4 10.0.0.1  # Server IP from client\nping -c 4 10.0.0.2  # Client IP from server\n\n# Check firewall rules\nsudo iptables -L -n | grep -E \"(wg0|51820)\"\nsudo ufw status | grep -E \"(WireGuard|51820)\"\n\n# Check logs\nsudo journalctl -u wg-quick@wg0 -f\ndmesg | grep wireguard\n\n# Debug handshake issues\nsudo wg show wg0 latest-handshakes\nsudo wg show wg0 transfer\n\n# Check peer connectivity\nsudo wg show wg0 endpoints\nsudo wg show wg0 allowed-ips\n\n# Restart WireGuard interface\nsudo wg-quick down wg0\nsudo wg-quick up wg0\n\n# Check kernel module\nlsmod | grep wireguard\nmodinfo wireguard\n\n# Test DNS resolution through VPN\nnslookup google.com 10.0.0.1\n\n# Check MTU issues\nping -M do -s 1472 10.0.0.1  # Test MTU size\n\n# Performance testing\niperf3 -s -p 5201  # On server\niperf3 -c 10.0.0.1 -p 5201  # On client\n\n# Configuration validation\nsudo wg-quick up wg0 --dry-run\n\n# Check routing table\nip route show table all\nip rule show\n\n# Network troubleshooting\ntraceroute -I 8.8.8.8  # Test route through VPN\nss -tulpn | grep 51820\nnetstat -tulpn | grep 51820\n```\n\n### Advanced Debugging\n```bash\n# Enable debug logging\necho 'module wireguard +p' | sudo tee /sys/kernel/debug/dynamic_debug/control\n\n# Monitor kernel messages\nsudo dmesg -w | grep wireguard\n\n# Packet capture\nsudo tcpdump -i wg0 -n\nsudo tcpdump -i eth0 port 51820\n\n# Check system resources\nps aux | grep wg\ntop -p $(pgrep wg-quick)\n\n# Verify cryptographic setup\nsudo wg showconf wg0\n\n# Test with verbose output\nsudo wg-quick up wg0 2\u003e\u00261 | tee /tmp/wg-debug.log\n\n# Check peer handshake details\nsudo wg show wg0 dump\n```\n\n## Additional Resources\n\n- [WireGuard Official Documentation](https://www.wireguard.com/)\n- [WireGuard Quick Start](https://www.wireguard.com/quickstart/)\n- [WireGuard Protocol Whitepaper](https://www.wireguard.com/papers/wireguard.pdf)\n- [WireGuard Community](https://lists.zx2c4.com/mailman/listinfo/wireguard)\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection.","readmeHtml":"\u003ch1 id=\"wireguard-installation-guide\" class=\"mobile-header\"\u003eWireGuard Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eModern, fast, and secure VPN solution using state-of-the-art cryptography. Essential tool for secure remote access, site-to-site connectivity, and privacy protection with minimal configuration complexity.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux system with kernel 3.10+ (any modern distribution)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot or sudo access\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eStatic IP address or dynamic DNS\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eUDP port 51820 available (default, configurable)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eBasic understanding of networking concepts\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"ubuntudebian\" class=\"mobile-header\"\u003eUbuntu/Debian\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update system packages\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade -y\n\n# Install WireGuard\nsudo apt install -y wireguard wireguard-tools\n\n# For older Ubuntu versions (18.04)\nsudo add-apt-repository ppa:wireguard/wireguard\nsudo apt update\nsudo apt install -y wireguard\n\n# Install additional tools\nsudo apt install -y qrencode resolvconf\n\n# Verify installation\nwg --version\nmodprobe wireguard \u0026amp;\u0026amp; echo \u0026quot;WireGuard module loaded successfully\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"rhelcentosrocky-linuxalmalinux\" class=\"mobile-header\"\u003eRHEL/CentOS/Rocky Linux/AlmaLinux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install EPEL repository\nsudo yum install -y epel-release\n\n# Install WireGuard\nsudo yum install -y wireguard-tools\n\n# For CentOS 7 (requires additional steps)\nsudo yum install -y yum-plugin-elrepo\nsudo yum install -y kmod-wireguard wireguard-tools\n\n# Install additional tools\nsudo yum install -y qrencode\n\n# Enable IP forwarding\necho \u0026#039;net.ipv4.ip_forward = 1\u0026#039; | sudo tee -a /etc/sysctl.conf\necho \u0026#039;net.ipv6.conf.all.forwarding = 1\u0026#039; | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"fedora\" class=\"mobile-header\"\u003eFedora\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install WireGuard (included in kernel 5.6+)\nsudo dnf install -y wireguard-tools qrencode\n\n# Enable IP forwarding\necho \u0026#039;net.ipv4.ip_forward = 1\u0026#039; | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"arch-linux\" class=\"mobile-header\"\u003eArch Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install WireGuard\nsudo pacman -Syu wireguard-tools qrencode\n\n# Load WireGuard module\nsudo modprobe wireguard\n\n# Enable IP forwarding\necho \u0026#039;net.ipv4.ip_forward = 1\u0026#039; | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"server-configuration\" class=\"mobile-header\"\u003eServer Configuration\u003c/h2\u003e\n\u003ch3 id=\"generate-keys-and-create-server-config\" class=\"mobile-header\"\u003eGenerate Keys and Create Server Config\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create WireGuard directory\nsudo mkdir -p /etc/wireguard\nsudo chmod 700 /etc/wireguard\n\n# Generate server keys\ncd /etc/wireguard\nwg genkey | sudo tee server_private.key | wg pubkey | sudo tee server_public.key\nsudo chmod 600 server_private.key\n\n# Create server configuration\nsudo tee /etc/wireguard/wg0.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Interface]\n# Server configuration\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24, fd00::1/64\nListenPort = 51820\nSaveConfig = true\n\n# Network configuration\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE; ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE; ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n# DNS servers (optional)\nDNS = 1.1.1.1, 8.8.8.8\n\n# Client configurations will be added here automatically\n# [Peer] sections for each client\nEOF\n\nsudo chmod 600 /etc/wireguard/wg0.conf\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-server-configuration\" class=\"mobile-header\"\u003eAdvanced Server Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create production server configuration with security\nsudo tee /etc/wireguard/wg0.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Interface]\n# Server identity\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24\nListenPort = 51820\nSaveConfig = false  # Disable for security in production\n\n# Network forwarding and NAT\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostUp = ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\nPostDown = ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n# Security: Block private networks (adjust as needed)\nPostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 192.168.1.0/24 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 172.16.0.0/12 -j DROP\n\n# DNS configuration\nDNS = 10.0.0.1  # Use Pi-hole or local DNS\n\n# Example client configurations\n[Peer]\n# Client 1 - Admin laptop\nPublicKey = client1_public_key_here\nAllowedIPs = 10.0.0.2/32\nPersistentKeepalive = 25\n\n[Peer]  \n# Client 2 - Mobile device\nPublicKey = client2_public_key_here\nAllowedIPs = 10.0.0.3/32\nPersistentKeepalive = 25\n\n[Peer]\n# Client 3 - Site-to-site (branch office)\nPublicKey = site_public_key_here\nAllowedIPs = 10.0.0.0/24, 192.168.100.0/24\nEndpoint = branch.example.com:51820\nPersistentKeepalive = 25\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"client-configuration\" class=\"mobile-header\"\u003eClient Configuration\u003c/h2\u003e\n\u003ch3 id=\"generate-client-configurations\" class=\"mobile-header\"\u003eGenerate Client Configurations\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create client configuration generator script\nsudo tee /usr/local/bin/wg-add-client.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nCLIENT_NAME=\u0026quot;${1}\u0026quot;\nSERVER_PUBLIC_IP=\u0026quot;${2:-your-server-public-ip}\u0026quot;\nSERVER_PUBLIC_KEY=\u0026quot;$(sudo cat /etc/wireguard/server_public.key)\u0026quot;\n\nif [ -z \u0026quot;$CLIENT_NAME\u0026quot; ]; then\n    echo \u0026quot;Usage: $0 \u0026lt;client_name\u0026gt; [server_public_ip]\u0026quot;\n    echo \u0026quot;Example: $0 laptop1 203.0.113.1\u0026quot;\n    exit 1\nfi\n\n# Get next available IP\nLAST_IP=$(grep \u0026quot;AllowedIPs\u0026quot; /etc/wireguard/wg0.conf | grep -o \u0026quot;10\\.0\\.0\\.[0-9]*\u0026quot; | sort -t. -k4 -n | tail -1 | cut -d. -f4)\nNEXT_IP=$((LAST_IP + 1))\nCLIENT_IP=\u0026quot;10.0.0.${NEXT_IP}/32\u0026quot;\n\n# Generate client keys\nCLIENT_PRIVATE_KEY=$(wg genkey)\nCLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)\n\n# Add peer to server configuration\nsudo tee -a /etc/wireguard/wg0.conf \u0026gt; /dev/null \u0026lt;\u0026lt;PEER\n\n[Peer]\n# ${CLIENT_NAME}\nPublicKey = ${CLIENT_PUBLIC_KEY}\nAllowedIPs = ${CLIENT_IP}\nPersistentKeepalive = 25\nPEER\n\n# Generate client configuration\ncat \u0026gt; /tmp/${CLIENT_NAME}.conf \u0026lt;\u0026lt;CLIENT_CONFIG\n[Interface]\nPrivateKey = ${CLIENT_PRIVATE_KEY}\nAddress = ${CLIENT_IP}\nDNS = 10.0.0.1, 1.1.1.1\n\n[Peer]\nPublicKey = ${SERVER_PUBLIC_KEY}\nEndpoint = ${SERVER_PUBLIC_IP}:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nCLIENT_CONFIG\n\n# Generate QR code for mobile devices\nqrencode -t ansiutf8 \u0026lt; /tmp/${CLIENT_NAME}.conf\n\necho \u0026quot;Client configuration created: /tmp/${CLIENT_NAME}.conf\u0026quot;\necho \u0026quot;Add to server with: sudo wg addconf wg0 \u0026lt;(echo \u0026#039;[Peer]\u0026#039;; echo \u0026#039;PublicKey = ${CLIENT_PUBLIC_KEY}\u0026#039;; echo \u0026#039;AllowedIPs = ${CLIENT_IP}\u0026#039;)\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/wg-add-client.sh\n\n# Example: Add a client\n# sudo /usr/local/bin/wg-add-client.sh laptop1 your-server-ip\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"client-examples\" class=\"mobile-header\"\u003eClient Examples\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Mobile device configuration\ncat \u0026gt; mobile-client.conf \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = mobile_device_private_key\nAddress = 10.0.0.10/32\nDNS = 10.0.0.1\n\n[Peer]\nPublicKey = server_public_key_here\nEndpoint = vpn.example.com:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nEOF\n\n# Site-to-site configuration (branch office)\ncat \u0026gt; branch-office.conf \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = branch_office_private_key\nAddress = 10.0.0.100/32\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n[Peer]\nPublicKey = server_public_key_here\nEndpoint = vpn.example.com:51820\nAllowedIPs = 10.0.0.0/24, 192.168.1.0/24\nPersistentKeepalive = 25\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"service-management-and-security\" class=\"mobile-header\"\u003eService Management and Security\u003c/h2\u003e\n\u003ch3 id=\"systemd-service\" class=\"mobile-header\"\u003eSystemD Service\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable WireGuard interface as systemd service\nsudo systemctl enable wg-quick@wg0\nsudo systemctl start wg-quick@wg0\n\n# Check status\nsudo systemctl status wg-quick@wg0\nsudo wg show\n\n# Alternative: Manual management\nsudo wg-quick up wg0\nsudo wg-quick down wg0\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"firewall-configuration\" class=\"mobile-header\"\u003eFirewall Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure UFW for WireGuard\nsudo ufw allow 51820/udp comment \u0026#039;WireGuard VPN\u0026#039;\nsudo ufw allow from 10.0.0.0/24 comment \u0026#039;WireGuard clients\u0026#039;\n\n# For internal network access\nsudo ufw allow from 10.0.0.0/24 to 192.168.1.0/24\n\n# Firewalld configuration (RHEL/CentOS)\nsudo firewall-cmd --permanent --add-port=51820/udp\nsudo firewall-cmd --permanent --add-rich-rule=\u0026#039;rule family=ipv4 source address=10.0.0.0/24 accept\u0026#039;\nsudo firewall-cmd --reload\n\n# Direct iptables rules\nsudo iptables -A INPUT -p udp --dport 51820 -j ACCEPT\nsudo iptables -A FORWARD -i wg0 -j ACCEPT\nsudo iptables -A FORWARD -o wg0 -j ACCEPT\nsudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"security-hardening\" class=\"mobile-header\"\u003eSecurity Hardening\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure advanced security features\nsudo tee /etc/wireguard/wg0.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24\nListenPort = 51820\n\n# Security: Change default port\n# ListenPort = 41194\n\n# DNS security\nDNS = 10.0.0.1  # Use Pi-hole for ad blocking\n\n# Advanced security rules\nPostUp = iptables -A FORWARD -i %i -j ACCEPT\nPostUp = iptables -A FORWARD -o %i -j ACCEPT\nPostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n\n# Block access to local network (security measure)\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.0/24 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 172.16.0.0/12 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 10.0.0.0/8 -j DROP\n\n# Allow specific services only\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.100 -p tcp --dport 22 -j ACCEPT    # SSH to server\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.101 -p tcp --dport 443 -j ACCEPT  # HTTPS to web services\n\nPostDown = iptables -D FORWARD -i %i -j ACCEPT\nPostDown = iptables -D FORWARD -o %i -j ACCEPT\nPostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"management-and-automation\" class=\"mobile-header\"\u003eManagement and Automation\u003c/h2\u003e\n\u003ch3 id=\"wireguard-management-script\" class=\"mobile-header\"\u003eWireGuard Management Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/wg-manager.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\n\nINTERFACE=\u0026quot;wg0\u0026quot;\nCONFIG_FILE=\u0026quot;/etc/wireguard/${INTERFACE}.conf\u0026quot;\nCLIENTS_DIR=\u0026quot;/etc/wireguard/clients\u0026quot;\nSERVER_PUBLIC_IP=\u0026quot;${SERVER_PUBLIC_IP:-$(curl -s ipinfo.io/ip)}\u0026quot;\nSERVER_PUBLIC_KEY=\u0026quot;$(sudo cat /etc/wireguard/server_public.key)\u0026quot;\n\nsudo mkdir -p ${CLIENTS_DIR}\n\ncase \u0026quot;${1}\u0026quot; in\n    \u0026quot;add-client\u0026quot;)\n        CLIENT_NAME=\u0026quot;${2}\u0026quot;\n        if [ -z \u0026quot;$CLIENT_NAME\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 add-client \u0026lt;client_name\u0026gt;\u0026quot;\n            exit 1\n        fi\n        \n        # Generate client keys\n        CLIENT_PRIVATE_KEY=$(wg genkey)\n        CLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)\n        \n        # Get next available IP\n        LAST_IP=$(grep \u0026quot;AllowedIPs\u0026quot; ${CONFIG_FILE} | grep -o \u0026quot;10\\.0\\.0\\.[0-9]*\u0026quot; | sort -t. -k4 -n | tail -1 | cut -d. -f4)\n        NEXT_IP=$((LAST_IP + 1))\n        CLIENT_IP=\u0026quot;10.0.0.${NEXT_IP}\u0026quot;\n        \n        # Add peer to server\n        sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} allowed-ips ${CLIENT_IP}/32\n        \n        # Save to config\n        sudo tee -a ${CONFIG_FILE} \u0026gt; /dev/null \u0026lt;\u0026lt;PEER\n\n[Peer]\n# ${CLIENT_NAME} - $(date)\nPublicKey = ${CLIENT_PUBLIC_KEY}\nAllowedIPs = ${CLIENT_IP}/32\nPersistentKeepalive = 25\nPEER\n        \n        # Generate client config\n        cat \u0026gt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf \u0026lt;\u0026lt;CLIENT_CONFIG\n[Interface]\nPrivateKey = ${CLIENT_PRIVATE_KEY}\nAddress = ${CLIENT_IP}/32\nDNS = 10.0.0.1\n\n[Peer]\nPublicKey = ${SERVER_PUBLIC_KEY}\nEndpoint = ${SERVER_PUBLIC_IP}:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nCLIENT_CONFIG\n        \n        # Generate QR code\n        echo \u0026quot;Client ${CLIENT_NAME} configuration:\u0026quot;\n        qrencode -t ansiutf8 \u0026lt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n        echo \u0026quot;Configuration file: ${CLIENTS_DIR}/${CLIENT_NAME}.conf\u0026quot;\n        ;;\n        \n    \u0026quot;remove-client\u0026quot;)\n        CLIENT_NAME=\u0026quot;${2}\u0026quot;\n        if [ -z \u0026quot;$CLIENT_NAME\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 remove-client \u0026lt;client_name\u0026gt;\u0026quot;\n            exit 1\n        fi\n        \n        CLIENT_PUBLIC_KEY=$(grep -A 3 \u0026quot;# ${CLIENT_NAME}\u0026quot; ${CONFIG_FILE} | grep \u0026quot;PublicKey\u0026quot; | cut -d\u0026#039; \u0026#039; -f3)\n        if [ -n \u0026quot;$CLIENT_PUBLIC_KEY\u0026quot; ]; then\n            sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} remove\n            sudo sed -i \u0026quot;/# ${CLIENT_NAME}/,+3d\u0026quot; ${CONFIG_FILE}\n            rm -f ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n            echo \u0026quot;Client ${CLIENT_NAME} removed\u0026quot;\n        else\n            echo \u0026quot;Client ${CLIENT_NAME} not found\u0026quot;\n        fi\n        ;;\n        \n    \u0026quot;list-clients\u0026quot;)\n        echo \u0026quot;Connected clients:\u0026quot;\n        sudo wg show ${INTERFACE}\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Configured clients:\u0026quot;\n        grep \u0026quot;^# \u0026quot; ${CONFIG_FILE} | sed \u0026#039;s/# /- /\u0026#039;\n        ;;\n        \n    \u0026quot;show-client\u0026quot;)\n        CLIENT_NAME=\u0026quot;${2}\u0026quot;\n        if [ -z \u0026quot;$CLIENT_NAME\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 show-client \u0026lt;client_name\u0026gt;\u0026quot;\n            exit 1\n        fi\n        \n        if [ -f \u0026quot;${CLIENTS_DIR}/${CLIENT_NAME}.conf\u0026quot; ]; then\n            echo \u0026quot;Configuration for ${CLIENT_NAME}:\u0026quot;\n            cat ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n            echo \u0026quot;\u0026quot;\n            echo \u0026quot;QR Code:\u0026quot;\n            qrencode -t ansiutf8 \u0026lt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n        else\n            echo \u0026quot;Client ${CLIENT_NAME} not found\u0026quot;\n        fi\n        ;;\n        \n    \u0026quot;status\u0026quot;)\n        echo \u0026quot;WireGuard Status:\u0026quot;\n        sudo systemctl status wg-quick@${INTERFACE}\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Interface Details:\u0026quot;\n        sudo wg show ${INTERFACE}\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Interface Statistics:\u0026quot;\n        sudo wg show ${INTERFACE} transfer\n        ;;\n        \n    \u0026quot;restart\u0026quot;)\n        echo \u0026quot;Restarting WireGuard...\u0026quot;\n        sudo systemctl restart wg-quick@${INTERFACE}\n        echo \u0026quot;WireGuard restarted\u0026quot;\n        ;;\n        \n    *)\n        echo \u0026quot;WireGuard Management Script\u0026quot;\n        echo \u0026quot;Usage: $0 {add-client|remove-client|list-clients|show-client|status|restart}\u0026quot;\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Examples:\u0026quot;\n        echo \u0026quot;  $0 add-client laptop1\u0026quot;\n        echo \u0026quot;  $0 remove-client laptop1\u0026quot;  \n        echo \u0026quot;  $0 show-client laptop1\u0026quot;\n        echo \u0026quot;  $0 list-clients\u0026quot;\n        echo \u0026quot;  $0 status\u0026quot;\n        echo \u0026quot;  $0 restart\u0026quot;\n        exit 1\n        ;;\nesac\nEOF\n\nsudo chmod +x /usr/local/bin/wg-manager.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"web-ui-wireguard-easy\" class=\"mobile-header\"\u003eWeb UI (WireGuard Easy)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install WireGuard Easy (web management interface)\nmkdir -p ~/wg-easy\ncd ~/wg-easy\n\ncat \u0026gt; docker-compose.yml \u0026lt;\u0026lt;EOF\nversion: \u0026#039;3.8\u0026#039;\n\nservices:\n  wg-easy:\n    image: weejewel/wg-easy:latest\n    container_name: wg-easy\n    restart: unless-stopped\n    ports:\n      - \u0026quot;51821:51821/udp\u0026quot;  # WireGuard port\n      - \u0026quot;127.0.0.1:51822:51822/tcp\u0026quot;  # Web UI port\n    environment:\n      - WG_HOST=vpn.example.com\n      - PASSWORD=WebUISecurePassword2024!\n      - WG_PORT=51821\n      - WG_DEFAULT_ADDRESS=10.8.0.x\n      - WG_DEFAULT_DNS=1.1.1.1,8.8.8.8\n      - WG_MTU=1420\n      - WG_ALLOWED_IPS=0.0.0.0/0,::/0\n      - WG_PERSISTENT_KEEPALIVE=25\n    volumes:\n      - ./data:/etc/wireguard\n    cap_add:\n      - NET_ADMIN\n      - SYS_MODULE\n    sysctls:\n      - net.ipv4.ip_forward=1\n      - net.ipv4.conf.all.src_valid_mark=1\n    networks:\n      - wg-easy\n\nnetworks:\n  wg-easy:\n    driver: bridge\nEOF\n\n# Start WG-Easy\ndocker-compose up -d\n\n# Access web interface at http://localhost:51822\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"monitoring-and-maintenance\" class=\"mobile-header\"\u003eMonitoring and Maintenance\u003c/h2\u003e\n\u003ch3 id=\"health-monitoring\" class=\"mobile-header\"\u003eHealth Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/wireguard-health.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nHEALTH_LOG=\u0026quot;/var/log/wireguard-health.log\u0026quot;\n\nlog_message() {\n    echo \u0026quot;$(date \u0026#039;+%Y-%m-%d %H:%M:%S\u0026#039;) - $1\u0026quot; | tee -a ${HEALTH_LOG}\n}\n\n# Check WireGuard service\nif systemctl is-active wg-quick@wg0 \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;✓ WireGuard service is running\u0026quot;\nelse\n    log_message \u0026quot;✗ WireGuard service is not running\u0026quot;\n    exit 1\nfi\n\n# Check interface status\nif ip link show wg0 \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;✓ WireGuard interface is up\u0026quot;\nelse\n    log_message \u0026quot;✗ WireGuard interface is down\u0026quot;\nfi\n\n# Check connected peers\nCONNECTED_PEERS=$(sudo wg show wg0 peers | wc -l)\nACTIVE_PEERS=$(sudo wg show wg0 latest-handshakes | awk \u0026#039;$2 \u0026gt; 0\u0026#039; | wc -l)\nlog_message \u0026quot;ℹ Connected peers: ${ACTIVE_PEERS}/${CONNECTED_PEERS}\u0026quot;\n\n# Check traffic statistics\nTRAFFIC_STATS=$(sudo wg show wg0 transfer)\nlog_message \u0026quot;ℹ Traffic statistics available: $(echo \u0026quot;$TRAFFIC_STATS\u0026quot; | wc -l) peers\u0026quot;\n\n# Check listening port\nif ss -ulpn | grep -q \u0026quot;:51820\u0026quot;; then\n    log_message \u0026quot;✓ WireGuard is listening on port 51820\u0026quot;\nelse\n    log_message \u0026quot;⚠ WireGuard not listening on expected port\u0026quot;\nfi\n\n# Check IP forwarding\nIP_FORWARD=$(cat /proc/sys/net/ipv4/ip_forward)\nif [ \u0026quot;$IP_FORWARD\u0026quot; = \u0026quot;1\u0026quot; ]; then\n    log_message \u0026quot;✓ IP forwarding is enabled\u0026quot;\nelse\n    log_message \u0026quot;✗ IP forwarding is disabled\u0026quot;\nfi\n\nlog_message \u0026quot;WireGuard health check completed\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/wireguard-health.sh\n\n# Schedule health checks every 10 minutes\necho \u0026quot;*/10 * * * * root /usr/local/bin/wireguard-health.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"backup-and-configuration-management\" class=\"mobile-header\"\u003eBackup and Configuration Management\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/wireguard-backup.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nBACKUP_DIR=\u0026quot;/backup/wireguard\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}/{configs,clients}\n\necho \u0026quot;Starting WireGuard backup...\u0026quot;\n\n# Backup server configuration\ncp /etc/wireguard/wg0.conf ${BACKUP_DIR}/configs/wg0-${DATE}.conf\n\n# Backup client configurations\nif [ -d \u0026quot;/etc/wireguard/clients\u0026quot; ]; then\n    tar -czf ${BACKUP_DIR}/clients/clients-${DATE}.tar.gz -C /etc/wireguard clients/\nfi\n\n# Backup keys\ntar -czf ${BACKUP_DIR}/configs/keys-${DATE}.tar.gz -C /etc/wireguard *.key\n\n# Upload to cloud storage (encrypted)\ngpg --symmetric --cipher-algo AES256 --compress-algo 1 --s2k-mode 3 \\\n    --s2k-digest-algo SHA512 --s2k-count 65536 \\\n    --output ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg \\\n    --compress-level 9 \\\n    \u0026lt;(tar -czf - -C ${BACKUP_DIR} .)\n\n# Upload encrypted backup\naws s3 cp ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg s3://wireguard-backups/\n\n# Keep only last 30 backups\nfind ${BACKUP_DIR} -name \u0026quot;wireguard-*\u0026quot; -type f -mtime +30 -delete\n\necho \u0026quot;WireGuard backup completed: ${DATE}\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/wireguard-backup.sh\n\n# Schedule daily backups\necho \u0026quot;0 3 * * * root /usr/local/bin/wireguard-backup.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"advanced-features\" class=\"mobile-header\"\u003eAdvanced Features\u003c/h2\u003e\n\u003ch3 id=\"site-to-site-vpn\" class=\"mobile-header\"\u003eSite-to-Site VPN\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure site-to-site VPN between offices\n# Office A (Main) - 192.168.1.0/24\n# Office B (Branch) - 192.168.2.0/24\n\n# Main office WireGuard config\nsudo tee /etc/wireguard/site-to-site.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = main_office_private_key\nAddress = 172.16.0.1/30\nListenPort = 51820\n\n# Route traffic between sites\nPostUp = ip route add 192.168.2.0/24 dev %i\nPostUp = iptables -A FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT\nPostUp = iptables -A FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT\n\nPostDown = ip route del 192.168.2.0/24 dev %i\nPostDown = iptables -D FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT\nPostDown = iptables -D FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT\n\n[Peer]\n# Branch Office\nPublicKey = branch_office_public_key\nEndpoint = branch.example.com:51820\nAllowedIPs = 172.16.0.2/32, 192.168.2.0/24\nPersistentKeepalive = 25\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"load-balancing-and-failover\" class=\"mobile-header\"\u003eLoad Balancing and Failover\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure multiple WireGuard servers for redundancy\n# Client configuration with multiple peers\ncat \u0026gt; multi-server-client.conf \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = client_private_key\nAddress = 10.0.0.10/32\nDNS = 1.1.1.1, 8.8.8.8\n\n# Primary server\n[Peer]\nPublicKey = primary_server_public_key\nEndpoint = vpn1.example.com:51820\nAllowedIPs = 0.0.0.0/1, 128.0.0.0/1\nPersistentKeepalive = 25\n\n# Backup server (different IP range to avoid conflicts)\n[Peer]\nPublicKey = backup_server_public_key\nEndpoint = vpn2.example.com:51820\nAllowedIPs = 10.1.0.0/24\nPersistentKeepalive = 25\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting\" class=\"mobile-header\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues-and-solutions\" class=\"mobile-header\"\u003eCommon Issues and Solutions\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check WireGuard status\nsudo systemctl status wg-quick@wg0\nsudo wg show\n\n# Check interface configuration\nip addr show wg0\nip route show table all | grep wg0\n\n# Test connectivity\nping -c 4 10.0.0.1  # Server IP from client\nping -c 4 10.0.0.2  # Client IP from server\n\n# Check firewall rules\nsudo iptables -L -n | grep -E \u0026quot;(wg0|51820)\u0026quot;\nsudo ufw status | grep -E \u0026quot;(WireGuard|51820)\u0026quot;\n\n# Check logs\nsudo journalctl -u wg-quick@wg0 -f\ndmesg | grep wireguard\n\n# Debug handshake issues\nsudo wg show wg0 latest-handshakes\nsudo wg show wg0 transfer\n\n# Check peer connectivity\nsudo wg show wg0 endpoints\nsudo wg show wg0 allowed-ips\n\n# Restart WireGuard interface\nsudo wg-quick down wg0\nsudo wg-quick up wg0\n\n# Check kernel module\nlsmod | grep wireguard\nmodinfo wireguard\n\n# Test DNS resolution through VPN\nnslookup google.com 10.0.0.1\n\n# Check MTU issues\nping -M do -s 1472 10.0.0.1  # Test MTU size\n\n# Performance testing\niperf3 -s -p 5201  # On server\niperf3 -c 10.0.0.1 -p 5201  # On client\n\n# Configuration validation\nsudo wg-quick up wg0 --dry-run\n\n# Check routing table\nip route show table all\nip rule show\n\n# Network troubleshooting\ntraceroute -I 8.8.8.8  # Test route through VPN\nss -tulpn | grep 51820\nnetstat -tulpn | grep 51820\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-debugging\" class=\"mobile-header\"\u003eAdvanced Debugging\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003e📋\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable debug logging\necho \u0026#039;module wireguard +p\u0026#039; | sudo tee /sys/kernel/debug/dynamic_debug/control\n\n# Monitor kernel messages\nsudo dmesg -w | grep wireguard\n\n# Packet capture\nsudo tcpdump -i wg0 -n\nsudo tcpdump -i eth0 port 51820\n\n# Check system resources\nps aux | grep wg\ntop -p $(pgrep wg-quick)\n\n# Verify cryptographic setup\nsudo wg showconf wg0\n\n# Test with verbose output\nsudo wg-quick up wg0 2\u0026gt;\u0026amp;1 | tee /tmp/wg-debug.log\n\n# Check peer handshake details\nsudo wg show wg0 dump\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.wireguard.com/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eWireGuard Official Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.wireguard.com/quickstart/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eWireGuard Quick Start\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.wireguard.com/papers/wireguard.pdf\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eWireGuard Protocol Whitepaper\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://lists.zx2c4.com/mailman/listinfo/wireguard\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eWireGuard Community\u003c/a\u003e\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection.\u003c/p\u003e","readTime":"14 min","wordCount":2789,"lastBuilt":"2025-09-15T18:14:29.989Z"}]},"__N_SSG":true},"page":"/[category]","query":{"category":"security"},"buildId":"FWaJNz_CPEuOjXz3AhtJ8","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>
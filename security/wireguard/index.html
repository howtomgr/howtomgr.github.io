<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes"/><meta name="theme-color" content="#bd93f9"/><link rel="icon" href="/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="true"/><title class="jsx-f92e766e9414ef16">Wireguard Installation Guide - HowToMgr</title><meta name="description" content="Repo for wireguard" class="jsx-f92e766e9414ef16"/><meta name="keywords" content="installation guides, tutorials, linux, docker, kubernetes, mobile-first, responsive" class="jsx-f92e766e9414ef16"/><meta property="og:title" content="Wireguard Installation Guide - HowToMgr" class="jsx-f92e766e9414ef16"/><meta property="og:description" content="Repo for wireguard" class="jsx-f92e766e9414ef16"/><meta property="og:type" content="website" class="jsx-f92e766e9414ef16"/><meta property="og:url" content="https://howtomgr.github.io" class="jsx-f92e766e9414ef16"/><meta property="og:image" content="https://howtomgr.github.io/social-preview.png" class="jsx-f92e766e9414ef16"/><meta property="twitter:card" content="summary_large_image" class="jsx-f92e766e9414ef16"/><meta property="twitter:title" content="Wireguard Installation Guide - HowToMgr" class="jsx-f92e766e9414ef16"/><meta property="twitter:description" content="Repo for wireguard" class="jsx-f92e766e9414ef16"/><meta name="next-head-count" content="17"/><link rel="dns-prefetch" href="//api.github.com"/><link rel="dns-prefetch" href="//github.com"/><link rel="preload" href="/favicon.ico" as="image"/><meta name="application-name" content="HowToMgr"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="default"/><meta name="apple-mobile-web-app-title" content="HowToMgr"/><meta name="format-detection" content="telephone=no"/><meta name="mobile-web-app-capable" content="yes"/><noscript><style>
            .requires-js { display: none !important; }
            .no-js-message { display: block !important; }
          </style></noscript><link rel="preload" href="/_next/static/css/eec6c1c201affe77.css" as="style"/><link rel="stylesheet" href="/_next/static/css/eec6c1c201affe77.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-2b1f7a23d657eae4.js" defer=""></script><script src="/_next/static/chunks/main-6ec3f7584970eebe.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f7367f88af207b64.js" defer=""></script><script src="/_next/static/chunks/119-abfbe7c9e22798da.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bcategory%5D/%5Bguide%5D-ae7274cbb918ed8b.js" defer=""></script><script src="/_next/static/bhXTIONQ1NPHcD0brA-Bd/_buildManifest.js" defer=""></script><script src="/_next/static/bhXTIONQ1NPHcD0brA-Bd/_ssgManifest.js" defer=""></script><style id="__jsx-8a7f0cdcf94f52ce">.breadcrumb.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:var(--space-2);margin-bottom:var(--space-6);font-size:var(--font-sm);color:var(--text-secondary);overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch}.breadcrumb.jsx-8a7f0cdcf94f52ce a.jsx-8a7f0cdcf94f52ce{color:var(--accent-primary);text-decoration:none;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.breadcrumb.jsx-8a7f0cdcf94f52ce a.jsx-8a7f0cdcf94f52ce:hover{text-decoration:underline}.separator.jsx-8a7f0cdcf94f52ce{color:var(--text-muted);-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.current.jsx-8a7f0cdcf94f52ce{color:var(--text-primary);font-weight:500;white-space:nowrap;overflow:hidden;-o-text-overflow:ellipsis;text-overflow:ellipsis}.guide-header.jsx-8a7f0cdcf94f52ce{background:var(--bg-secondary);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg);padding:var(--space-6);margin-bottom:var(--space-8);border:1px solid var(--bg-surface)}.guide-title.jsx-8a7f0cdcf94f52ce{color:var(--accent-primary);font-size:var(--font-3xl);margin-bottom:var(--space-4);line-height:1.2;word-break:break-word}.guide-description.jsx-8a7f0cdcf94f52ce{color:var(--text-secondary);font-size:var(--font-lg);margin-bottom:var(--space-5);line-height:1.5}.guide-badges.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-3);margin-bottom:var(--space-5);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.guide-actions.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-3);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.guide-content.jsx-8a7f0cdcf94f52ce{background:var(--bg-secondary);-webkit-border-radius:var(--border-radius-lg);-moz-border-radius:var(--border-radius-lg);border-radius:var(--border-radius-lg);padding:var(--space-6);margin-bottom:var(--space-8);border:1px solid var(--bg-surface);overflow-x:hidden}.related-section.jsx-8a7f0cdcf94f52ce{margin-bottom:var(--space-8)}.section-title.jsx-8a7f0cdcf94f52ce{color:var(--accent-primary);font-size:var(--font-2xl);text-align:center;margin-bottom:var(--space-6)}.guide-navigation.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4);-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-bottom:var(--space-8)}.loading-container.jsx-8a7f0cdcf94f52ce,.error-container.jsx-8a7f0cdcf94f52ce{text-align:center;padding:var(--space-8)}.error-actions.jsx-8a7f0cdcf94f52ce{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4);-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:var(--space-6);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}@media(max-width:767px){.guide-header.jsx-8a7f0cdcf94f52ce{padding:var(--space-4);margin-bottom:var(--space-6)}.guide-title.jsx-8a7f0cdcf94f52ce{font-size:var(--font-2xl)}.guide-description.jsx-8a7f0cdcf94f52ce{font-size:var(--font-base)}.guide-content.jsx-8a7f0cdcf94f52ce{padding:var(--space-4);margin-bottom:var(--space-6)}.guide-badges.jsx-8a7f0cdcf94f52ce{gap:var(--space-2)}.guide-actions.jsx-8a7f0cdcf94f52ce{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.guide-navigation.jsx-8a7f0cdcf94f52ce{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.breadcrumb.jsx-8a7f0cdcf94f52ce{margin-bottom:var(--space-4)}}</style><style id="__jsx-f92e766e9414ef16">.app-container.jsx-f92e766e9414ef16{min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding-top:56px}.main-content.jsx-f92e766e9414ef16{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:var(--space-6)0}.mobile-footer.jsx-f92e766e9414ef16{background:var(--bg-secondary);border-top:1px solid var(--bg-surface);padding:var(--space-6)0;margin-top:auto}.footer-content.jsx-f92e766e9414ef16{text-align:center}.footer-links.jsx-f92e766e9414ef16{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;gap:var(--space-6);margin-bottom:var(--space-4);-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.footer-links.jsx-f92e766e9414ef16 a.jsx-f92e766e9414ef16{color:var(--accent-primary);text-decoration:none;font-size:var(--font-sm)}.footer-links.jsx-f92e766e9414ef16 a.jsx-f92e766e9414ef16:hover{color:var(--accent-secondary)}.footer-separator.jsx-f92e766e9414ef16{height:1px;background:var(--bg-surface);margin:var(--space-4)auto;width:200px}.footer-text.jsx-f92e766e9414ef16,.footer-tech.jsx-f92e766e9414ef16{color:var(--text-secondary);font-size:var(--font-sm);margin-bottom:var(--space-2)}.footer-disclaimer.jsx-f92e766e9414ef16{color:var(--text-muted);font-size:var(--font-xs)}.nav-links.jsx-f92e766e9414ef16{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:var(--space-4)}.nav-link.jsx-f92e766e9414ef16{color:var(--text-primary);text-decoration:none;padding:var(--space-2)var(--space-3);-webkit-border-radius:var(--border-radius);-moz-border-radius:var(--border-radius);border-radius:var(--border-radius);font-size:var(--font-sm);font-weight:500;-webkit-transition:var(--transition);-moz-transition:var(--transition);-o-transition:var(--transition);transition:var(--transition);min-height:36px;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center}.nav-link.jsx-f92e766e9414ef16:hover{background:var(--bg-surface);color:var(--accent-primary);text-decoration:none}[data-theme="light"].jsx-f92e766e9414ef16 .theme-icon-dark.jsx-f92e766e9414ef16{display:none}[data-theme="light"].jsx-f92e766e9414ef16 .theme-icon-light.jsx-f92e766e9414ef16{display:inline!important}@media(max-width:767px){.main-content.jsx-f92e766e9414ef16{padding:var(--space-4)0}.footer-links.jsx-f92e766e9414ef16{gap:var(--space-4)}}</style></head><body><noscript><div class="no-js-message" style="padding:1rem;background:#ff5555;color:#f8f8f2;text-align:center;font-size:0.9rem">This site requires JavaScript to function properly. Please enable JavaScript in your browser.</div></noscript><div id="__next"><div class="jsx-f92e766e9414ef16 app-container"><a href="#main-content" class="jsx-f92e766e9414ef16 skip-link">Skip to main content</a><nav class="jsx-f92e766e9414ef16 mobile-nav"><div class="jsx-f92e766e9414ef16 mobile-nav-content"><a class="mobile-brand" href="/"><span role="img" aria-label="Books" class="jsx-f92e766e9414ef16">üìö</span>HowToMgr</a><div class="jsx-f92e766e9414ef16 nav-links"><a class="nav-link" href="/all/">All</a><a class="nav-link" href="/search/">Search</a></div><button aria-label="Toggle theme" title="Switch theme" class="jsx-f92e766e9414ef16 mobile-theme-toggle touch-target"><span class="jsx-f92e766e9414ef16 theme-icon-dark">üåô</span><span style="display:none" class="jsx-f92e766e9414ef16 theme-icon-light">‚òÄÔ∏è</span></button></div></nav><main id="main-content" tabindex="-1" class="jsx-f92e766e9414ef16 main-content"><div class="jsx-f92e766e9414ef16 container"><nav aria-label="Breadcrumb" class="jsx-8a7f0cdcf94f52ce breadcrumb"><a href="/">Home</a><span class="jsx-8a7f0cdcf94f52ce separator">‚Üí</span><a href="/security/">Security</a><span class="jsx-8a7f0cdcf94f52ce separator">‚Üí</span><span class="jsx-8a7f0cdcf94f52ce current">Wireguard</span></nav><header class="jsx-8a7f0cdcf94f52ce guide-header"><div class="jsx-8a7f0cdcf94f52ce guide-meta-top"><h1 class="jsx-8a7f0cdcf94f52ce guide-title">Wireguard</h1><p class="jsx-8a7f0cdcf94f52ce guide-description">Repo for wireguard</p><div class="jsx-8a7f0cdcf94f52ce guide-badges"><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-primary">Security</span><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-info">14 min</span></div><div class="jsx-8a7f0cdcf94f52ce guide-actions"><a href="https://github.com/howtomgr/wireguard" target="_blank" rel="noopener" class="jsx-8a7f0cdcf94f52ce btn btn-secondary">View on GitHub</a></div></div></header><article class="jsx-8a7f0cdcf94f52ce guide-content"><div class="jsx-8a7f0cdcf94f52ce readme-content"><h1 id="wireguard-installation-guide" class="mobile-header">WireGuard Installation Guide</h1>
<p class="mobile-paragraph">Modern, fast, and secure VPN solution using state-of-the-art cryptography. Essential tool for secure remote access, site-to-site connectivity, and privacy protection with minimal configuration complexity.</p>
<h2 id="prerequisites" class="mobile-header">Prerequisites</h2>
<li class="mobile-list-item">Linux system with kernel 3.10+ (any modern distribution)</li>
<li class="mobile-list-item">Root or sudo access</li>
<li class="mobile-list-item">Static IP address or dynamic DNS</li>
<li class="mobile-list-item">UDP port 51820 available (default, configurable)</li>
<li class="mobile-list-item">Basic understanding of networking concepts</li>
<h2 id="installation" class="mobile-header">Installation</h2>
<h3 id="ubuntudebian" class="mobile-header">Ubuntu/Debian</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Update system packages
sudo apt update &amp;&amp; sudo apt upgrade -y

# Install WireGuard
sudo apt install -y wireguard wireguard-tools

# For older Ubuntu versions (18.04)
sudo add-apt-repository ppa:wireguard/wireguard
sudo apt update
sudo apt install -y wireguard

# Install additional tools
sudo apt install -y qrencode resolvconf

# Verify installation
wg --version
modprobe wireguard &amp;&amp; echo &quot;WireGuard module loaded successfully&quot;</code></pre>
      </div>
    </div>
<h3 id="rhelcentosrocky-linuxalmalinux" class="mobile-header">RHEL/CentOS/Rocky Linux/AlmaLinux</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install EPEL repository
sudo yum install -y epel-release

# Install WireGuard
sudo yum install -y wireguard-tools

# For CentOS 7 (requires additional steps)
sudo yum install -y yum-plugin-elrepo
sudo yum install -y kmod-wireguard wireguard-tools

# Install additional tools
sudo yum install -y qrencode

# Enable IP forwarding
echo &#039;net.ipv4.ip_forward = 1&#039; | sudo tee -a /etc/sysctl.conf
echo &#039;net.ipv6.conf.all.forwarding = 1&#039; | sudo tee -a /etc/sysctl.conf
sudo sysctl -p</code></pre>
      </div>
    </div>
<h3 id="fedora" class="mobile-header">Fedora</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install WireGuard (included in kernel 5.6+)
sudo dnf install -y wireguard-tools qrencode

# Enable IP forwarding
echo &#039;net.ipv4.ip_forward = 1&#039; | sudo tee -a /etc/sysctl.conf
sudo sysctl -p</code></pre>
      </div>
    </div>
<h3 id="arch-linux" class="mobile-header">Arch Linux</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install WireGuard
sudo pacman -Syu wireguard-tools qrencode

# Load WireGuard module
sudo modprobe wireguard

# Enable IP forwarding
echo &#039;net.ipv4.ip_forward = 1&#039; | sudo tee -a /etc/sysctl.conf
sudo sysctl -p</code></pre>
      </div>
    </div>
<h2 id="server-configuration" class="mobile-header">Server Configuration</h2>
<h3 id="generate-keys-and-create-server-config" class="mobile-header">Generate Keys and Create Server Config</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create WireGuard directory
sudo mkdir -p /etc/wireguard
sudo chmod 700 /etc/wireguard

# Generate server keys
cd /etc/wireguard
wg genkey | sudo tee server_private.key | wg pubkey | sudo tee server_public.key
sudo chmod 600 server_private.key

# Create server configuration
sudo tee /etc/wireguard/wg0.conf &gt; /dev/null &lt;&lt;EOF
[Interface]
# Server configuration
PrivateKey = $(sudo cat server_private.key)
Address = 10.0.0.1/24, fd00::1/64
ListenPort = 51820
SaveConfig = true

# Network configuration
PostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE; ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE; ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

# DNS servers (optional)
DNS = 1.1.1.1, 8.8.8.8

# Client configurations will be added here automatically
# [Peer] sections for each client
EOF

sudo chmod 600 /etc/wireguard/wg0.conf</code></pre>
      </div>
    </div>
<h3 id="advanced-server-configuration" class="mobile-header">Advanced Server Configuration</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create production server configuration with security
sudo tee /etc/wireguard/wg0.conf &gt; /dev/null &lt;&lt;EOF
[Interface]
# Server identity
PrivateKey = $(sudo cat server_private.key)
Address = 10.0.0.1/24
ListenPort = 51820
SaveConfig = false  # Disable for security in production

# Network forwarding and NAT
PostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostUp = ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE
PostDown = ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

# Security: Block private networks (adjust as needed)
PostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 192.168.1.0/24 -j DROP
PostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 172.16.0.0/12 -j DROP

# DNS configuration
DNS = 10.0.0.1  # Use Pi-hole or local DNS

# Example client configurations
[Peer]
# Client 1 - Admin laptop
PublicKey = client1_public_key_here
AllowedIPs = 10.0.0.2/32
PersistentKeepalive = 25

[Peer]  
# Client 2 - Mobile device
PublicKey = client2_public_key_here
AllowedIPs = 10.0.0.3/32
PersistentKeepalive = 25

[Peer]
# Client 3 - Site-to-site (branch office)
PublicKey = site_public_key_here
AllowedIPs = 10.0.0.0/24, 192.168.100.0/24
Endpoint = branch.example.com:51820
PersistentKeepalive = 25
EOF</code></pre>
      </div>
    </div>
<h2 id="client-configuration" class="mobile-header">Client Configuration</h2>
<h3 id="generate-client-configurations" class="mobile-header">Generate Client Configurations</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Create client configuration generator script
sudo tee /usr/local/bin/wg-add-client.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash
CLIENT_NAME=&quot;${1}&quot;
SERVER_PUBLIC_IP=&quot;${2:-your-server-public-ip}&quot;
SERVER_PUBLIC_KEY=&quot;$(sudo cat /etc/wireguard/server_public.key)&quot;

if [ -z &quot;$CLIENT_NAME&quot; ]; then
    echo &quot;Usage: $0 &lt;client_name&gt; [server_public_ip]&quot;
    echo &quot;Example: $0 laptop1 203.0.113.1&quot;
    exit 1
fi

# Get next available IP
LAST_IP=$(grep &quot;AllowedIPs&quot; /etc/wireguard/wg0.conf | grep -o &quot;10\.0\.0\.[0-9]*&quot; | sort -t. -k4 -n | tail -1 | cut -d. -f4)
NEXT_IP=$((LAST_IP + 1))
CLIENT_IP=&quot;10.0.0.${NEXT_IP}/32&quot;

# Generate client keys
CLIENT_PRIVATE_KEY=$(wg genkey)
CLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)

# Add peer to server configuration
sudo tee -a /etc/wireguard/wg0.conf &gt; /dev/null &lt;&lt;PEER

[Peer]
# ${CLIENT_NAME}
PublicKey = ${CLIENT_PUBLIC_KEY}
AllowedIPs = ${CLIENT_IP}
PersistentKeepalive = 25
PEER

# Generate client configuration
cat &gt; /tmp/${CLIENT_NAME}.conf &lt;&lt;CLIENT_CONFIG
[Interface]
PrivateKey = ${CLIENT_PRIVATE_KEY}
Address = ${CLIENT_IP}
DNS = 10.0.0.1, 1.1.1.1

[Peer]
PublicKey = ${SERVER_PUBLIC_KEY}
Endpoint = ${SERVER_PUBLIC_IP}:51820
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
CLIENT_CONFIG

# Generate QR code for mobile devices
qrencode -t ansiutf8 &lt; /tmp/${CLIENT_NAME}.conf

echo &quot;Client configuration created: /tmp/${CLIENT_NAME}.conf&quot;
echo &quot;Add to server with: sudo wg addconf wg0 &lt;(echo &#039;[Peer]&#039;; echo &#039;PublicKey = ${CLIENT_PUBLIC_KEY}&#039;; echo &#039;AllowedIPs = ${CLIENT_IP}&#039;)&quot;
EOF

sudo chmod +x /usr/local/bin/wg-add-client.sh

# Example: Add a client
# sudo /usr/local/bin/wg-add-client.sh laptop1 your-server-ip</code></pre>
      </div>
    </div>
<h3 id="client-examples" class="mobile-header">Client Examples</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Mobile device configuration
cat &gt; mobile-client.conf &lt;&lt;EOF
[Interface]
PrivateKey = mobile_device_private_key
Address = 10.0.0.10/32
DNS = 10.0.0.1

[Peer]
PublicKey = server_public_key_here
Endpoint = vpn.example.com:51820
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
EOF

# Site-to-site configuration (branch office)
cat &gt; branch-office.conf &lt;&lt;EOF
[Interface]
PrivateKey = branch_office_private_key
Address = 10.0.0.100/32
PostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
PostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE

[Peer]
PublicKey = server_public_key_here
Endpoint = vpn.example.com:51820
AllowedIPs = 10.0.0.0/24, 192.168.1.0/24
PersistentKeepalive = 25
EOF</code></pre>
      </div>
    </div>
<h2 id="service-management-and-security" class="mobile-header">Service Management and Security</h2>
<h3 id="systemd-service" class="mobile-header">SystemD Service</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Enable WireGuard interface as systemd service
sudo systemctl enable wg-quick@wg0
sudo systemctl start wg-quick@wg0

# Check status
sudo systemctl status wg-quick@wg0
sudo wg show

# Alternative: Manual management
sudo wg-quick up wg0
sudo wg-quick down wg0</code></pre>
      </div>
    </div>
<h3 id="firewall-configuration" class="mobile-header">Firewall Configuration</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Configure UFW for WireGuard
sudo ufw allow 51820/udp comment &#039;WireGuard VPN&#039;
sudo ufw allow from 10.0.0.0/24 comment &#039;WireGuard clients&#039;

# For internal network access
sudo ufw allow from 10.0.0.0/24 to 192.168.1.0/24

# Firewalld configuration (RHEL/CentOS)
sudo firewall-cmd --permanent --add-port=51820/udp
sudo firewall-cmd --permanent --add-rich-rule=&#039;rule family=ipv4 source address=10.0.0.0/24 accept&#039;
sudo firewall-cmd --reload

# Direct iptables rules
sudo iptables -A INPUT -p udp --dport 51820 -j ACCEPT
sudo iptables -A FORWARD -i wg0 -j ACCEPT
sudo iptables -A FORWARD -o wg0 -j ACCEPT
sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</code></pre>
      </div>
    </div>
<h3 id="security-hardening" class="mobile-header">Security Hardening</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Configure advanced security features
sudo tee /etc/wireguard/wg0.conf &gt; /dev/null &lt;&lt;EOF
[Interface]
PrivateKey = $(sudo cat server_private.key)
Address = 10.0.0.1/24
ListenPort = 51820

# Security: Change default port
# ListenPort = 41194

# DNS security
DNS = 10.0.0.1  # Use Pi-hole for ad blocking

# Advanced security rules
PostUp = iptables -A FORWARD -i %i -j ACCEPT
PostUp = iptables -A FORWARD -o %i -j ACCEPT
PostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

# Block access to local network (security measure)
PostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.0/24 -j DROP
PostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 172.16.0.0/12 -j DROP
PostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 10.0.0.0/8 -j DROP

# Allow specific services only
PostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.100 -p tcp --dport 22 -j ACCEPT    # SSH to server
PostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.101 -p tcp --dport 443 -j ACCEPT  # HTTPS to web services

PostDown = iptables -D FORWARD -i %i -j ACCEPT
PostDown = iptables -D FORWARD -o %i -j ACCEPT
PostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE
EOF</code></pre>
      </div>
    </div>
<h2 id="management-and-automation" class="mobile-header">Management and Automation</h2>
<h3 id="wireguard-management-script" class="mobile-header">WireGuard Management Script</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash">sudo tee /usr/local/bin/wg-manager.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash

INTERFACE=&quot;wg0&quot;
CONFIG_FILE=&quot;/etc/wireguard/${INTERFACE}.conf&quot;
CLIENTS_DIR=&quot;/etc/wireguard/clients&quot;
SERVER_PUBLIC_IP=&quot;${SERVER_PUBLIC_IP:-$(curl -s ipinfo.io/ip)}&quot;
SERVER_PUBLIC_KEY=&quot;$(sudo cat /etc/wireguard/server_public.key)&quot;

sudo mkdir -p ${CLIENTS_DIR}

case &quot;${1}&quot; in
    &quot;add-client&quot;)
        CLIENT_NAME=&quot;${2}&quot;
        if [ -z &quot;$CLIENT_NAME&quot; ]; then
            echo &quot;Usage: $0 add-client &lt;client_name&gt;&quot;
            exit 1
        fi
        
        # Generate client keys
        CLIENT_PRIVATE_KEY=$(wg genkey)
        CLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)
        
        # Get next available IP
        LAST_IP=$(grep &quot;AllowedIPs&quot; ${CONFIG_FILE} | grep -o &quot;10\.0\.0\.[0-9]*&quot; | sort -t. -k4 -n | tail -1 | cut -d. -f4)
        NEXT_IP=$((LAST_IP + 1))
        CLIENT_IP=&quot;10.0.0.${NEXT_IP}&quot;
        
        # Add peer to server
        sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} allowed-ips ${CLIENT_IP}/32
        
        # Save to config
        sudo tee -a ${CONFIG_FILE} &gt; /dev/null &lt;&lt;PEER

[Peer]
# ${CLIENT_NAME} - $(date)
PublicKey = ${CLIENT_PUBLIC_KEY}
AllowedIPs = ${CLIENT_IP}/32
PersistentKeepalive = 25
PEER
        
        # Generate client config
        cat &gt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf &lt;&lt;CLIENT_CONFIG
[Interface]
PrivateKey = ${CLIENT_PRIVATE_KEY}
Address = ${CLIENT_IP}/32
DNS = 10.0.0.1

[Peer]
PublicKey = ${SERVER_PUBLIC_KEY}
Endpoint = ${SERVER_PUBLIC_IP}:51820
AllowedIPs = 0.0.0.0/0, ::/0
PersistentKeepalive = 25
CLIENT_CONFIG
        
        # Generate QR code
        echo &quot;Client ${CLIENT_NAME} configuration:&quot;
        qrencode -t ansiutf8 &lt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf
        echo &quot;Configuration file: ${CLIENTS_DIR}/${CLIENT_NAME}.conf&quot;
        ;;
        
    &quot;remove-client&quot;)
        CLIENT_NAME=&quot;${2}&quot;
        if [ -z &quot;$CLIENT_NAME&quot; ]; then
            echo &quot;Usage: $0 remove-client &lt;client_name&gt;&quot;
            exit 1
        fi
        
        CLIENT_PUBLIC_KEY=$(grep -A 3 &quot;# ${CLIENT_NAME}&quot; ${CONFIG_FILE} | grep &quot;PublicKey&quot; | cut -d&#039; &#039; -f3)
        if [ -n &quot;$CLIENT_PUBLIC_KEY&quot; ]; then
            sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} remove
            sudo sed -i &quot;/# ${CLIENT_NAME}/,+3d&quot; ${CONFIG_FILE}
            rm -f ${CLIENTS_DIR}/${CLIENT_NAME}.conf
            echo &quot;Client ${CLIENT_NAME} removed&quot;
        else
            echo &quot;Client ${CLIENT_NAME} not found&quot;
        fi
        ;;
        
    &quot;list-clients&quot;)
        echo &quot;Connected clients:&quot;
        sudo wg show ${INTERFACE}
        echo &quot;&quot;
        echo &quot;Configured clients:&quot;
        grep &quot;^# &quot; ${CONFIG_FILE} | sed &#039;s/# /- /&#039;
        ;;
        
    &quot;show-client&quot;)
        CLIENT_NAME=&quot;${2}&quot;
        if [ -z &quot;$CLIENT_NAME&quot; ]; then
            echo &quot;Usage: $0 show-client &lt;client_name&gt;&quot;
            exit 1
        fi
        
        if [ -f &quot;${CLIENTS_DIR}/${CLIENT_NAME}.conf&quot; ]; then
            echo &quot;Configuration for ${CLIENT_NAME}:&quot;
            cat ${CLIENTS_DIR}/${CLIENT_NAME}.conf
            echo &quot;&quot;
            echo &quot;QR Code:&quot;
            qrencode -t ansiutf8 &lt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf
        else
            echo &quot;Client ${CLIENT_NAME} not found&quot;
        fi
        ;;
        
    &quot;status&quot;)
        echo &quot;WireGuard Status:&quot;
        sudo systemctl status wg-quick@${INTERFACE}
        echo &quot;&quot;
        echo &quot;Interface Details:&quot;
        sudo wg show ${INTERFACE}
        echo &quot;&quot;
        echo &quot;Interface Statistics:&quot;
        sudo wg show ${INTERFACE} transfer
        ;;
        
    &quot;restart&quot;)
        echo &quot;Restarting WireGuard...&quot;
        sudo systemctl restart wg-quick@${INTERFACE}
        echo &quot;WireGuard restarted&quot;
        ;;
        
    *)
        echo &quot;WireGuard Management Script&quot;
        echo &quot;Usage: $0 {add-client|remove-client|list-clients|show-client|status|restart}&quot;
        echo &quot;&quot;
        echo &quot;Examples:&quot;
        echo &quot;  $0 add-client laptop1&quot;
        echo &quot;  $0 remove-client laptop1&quot;  
        echo &quot;  $0 show-client laptop1&quot;
        echo &quot;  $0 list-clients&quot;
        echo &quot;  $0 status&quot;
        echo &quot;  $0 restart&quot;
        exit 1
        ;;
esac
EOF

sudo chmod +x /usr/local/bin/wg-manager.sh</code></pre>
      </div>
    </div>
<h3 id="web-ui-wireguard-easy" class="mobile-header">Web UI (WireGuard Easy)</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Install WireGuard Easy (web management interface)
mkdir -p ~/wg-easy
cd ~/wg-easy

cat &gt; docker-compose.yml &lt;&lt;EOF
version: &#039;3.8&#039;

services:
  wg-easy:
    image: weejewel/wg-easy:latest
    container_name: wg-easy
    restart: unless-stopped
    ports:
      - &quot;51821:51821/udp&quot;  # WireGuard port
      - &quot;127.0.0.1:51822:51822/tcp&quot;  # Web UI port
    environment:
      - WG_HOST=vpn.example.com
      - PASSWORD=WebUISecurePassword2024!
      - WG_PORT=51821
      - WG_DEFAULT_ADDRESS=10.8.0.x
      - WG_DEFAULT_DNS=1.1.1.1,8.8.8.8
      - WG_MTU=1420
      - WG_ALLOWED_IPS=0.0.0.0/0,::/0
      - WG_PERSISTENT_KEEPALIVE=25
    volumes:
      - ./data:/etc/wireguard
    cap_add:
      - NET_ADMIN
      - SYS_MODULE
    sysctls:
      - net.ipv4.ip_forward=1
      - net.ipv4.conf.all.src_valid_mark=1
    networks:
      - wg-easy

networks:
  wg-easy:
    driver: bridge
EOF

# Start WG-Easy
docker-compose up -d

# Access web interface at http://localhost:51822</code></pre>
      </div>
    </div>
<h2 id="monitoring-and-maintenance" class="mobile-header">Monitoring and Maintenance</h2>
<h3 id="health-monitoring" class="mobile-header">Health Monitoring</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash">sudo tee /usr/local/bin/wireguard-health.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash
HEALTH_LOG=&quot;/var/log/wireguard-health.log&quot;

log_message() {
    echo &quot;$(date &#039;+%Y-%m-%d %H:%M:%S&#039;) - $1&quot; | tee -a ${HEALTH_LOG}
}

# Check WireGuard service
if systemctl is-active wg-quick@wg0 &gt;/dev/null 2&gt;&amp;1; then
    log_message &quot;‚úì WireGuard service is running&quot;
else
    log_message &quot;‚úó WireGuard service is not running&quot;
    exit 1
fi

# Check interface status
if ip link show wg0 &gt;/dev/null 2&gt;&amp;1; then
    log_message &quot;‚úì WireGuard interface is up&quot;
else
    log_message &quot;‚úó WireGuard interface is down&quot;
fi

# Check connected peers
CONNECTED_PEERS=$(sudo wg show wg0 peers | wc -l)
ACTIVE_PEERS=$(sudo wg show wg0 latest-handshakes | awk &#039;$2 &gt; 0&#039; | wc -l)
log_message &quot;‚Ñπ Connected peers: ${ACTIVE_PEERS}/${CONNECTED_PEERS}&quot;

# Check traffic statistics
TRAFFIC_STATS=$(sudo wg show wg0 transfer)
log_message &quot;‚Ñπ Traffic statistics available: $(echo &quot;$TRAFFIC_STATS&quot; | wc -l) peers&quot;

# Check listening port
if ss -ulpn | grep -q &quot;:51820&quot;; then
    log_message &quot;‚úì WireGuard is listening on port 51820&quot;
else
    log_message &quot;‚ö† WireGuard not listening on expected port&quot;
fi

# Check IP forwarding
IP_FORWARD=$(cat /proc/sys/net/ipv4/ip_forward)
if [ &quot;$IP_FORWARD&quot; = &quot;1&quot; ]; then
    log_message &quot;‚úì IP forwarding is enabled&quot;
else
    log_message &quot;‚úó IP forwarding is disabled&quot;
fi

log_message &quot;WireGuard health check completed&quot;
EOF

sudo chmod +x /usr/local/bin/wireguard-health.sh

# Schedule health checks every 10 minutes
echo &quot;*/10 * * * * root /usr/local/bin/wireguard-health.sh&quot; | sudo tee -a /etc/crontab</code></pre>
      </div>
    </div>
<h3 id="backup-and-configuration-management" class="mobile-header">Backup and Configuration Management</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash">sudo tee /usr/local/bin/wireguard-backup.sh &gt; /dev/null &lt;&lt;&#039;EOF&#039;
#!/bin/bash
BACKUP_DIR=&quot;/backup/wireguard&quot;
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p ${BACKUP_DIR}/{configs,clients}

echo &quot;Starting WireGuard backup...&quot;

# Backup server configuration
cp /etc/wireguard/wg0.conf ${BACKUP_DIR}/configs/wg0-${DATE}.conf

# Backup client configurations
if [ -d &quot;/etc/wireguard/clients&quot; ]; then
    tar -czf ${BACKUP_DIR}/clients/clients-${DATE}.tar.gz -C /etc/wireguard clients/
fi

# Backup keys
tar -czf ${BACKUP_DIR}/configs/keys-${DATE}.tar.gz -C /etc/wireguard *.key

# Upload to cloud storage (encrypted)
gpg --symmetric --cipher-algo AES256 --compress-algo 1 --s2k-mode 3 \
    --s2k-digest-algo SHA512 --s2k-count 65536 \
    --output ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg \
    --compress-level 9 \
    &lt;(tar -czf - -C ${BACKUP_DIR} .)

# Upload encrypted backup
aws s3 cp ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg s3://wireguard-backups/

# Keep only last 30 backups
find ${BACKUP_DIR} -name &quot;wireguard-*&quot; -type f -mtime +30 -delete

echo &quot;WireGuard backup completed: ${DATE}&quot;
EOF

sudo chmod +x /usr/local/bin/wireguard-backup.sh

# Schedule daily backups
echo &quot;0 3 * * * root /usr/local/bin/wireguard-backup.sh&quot; | sudo tee -a /etc/crontab</code></pre>
      </div>
    </div>
<h2 id="advanced-features" class="mobile-header">Advanced Features</h2>
<h3 id="site-to-site-vpn" class="mobile-header">Site-to-Site VPN</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Configure site-to-site VPN between offices
# Office A (Main) - 192.168.1.0/24
# Office B (Branch) - 192.168.2.0/24

# Main office WireGuard config
sudo tee /etc/wireguard/site-to-site.conf &gt; /dev/null &lt;&lt;EOF
[Interface]
PrivateKey = main_office_private_key
Address = 172.16.0.1/30
ListenPort = 51820

# Route traffic between sites
PostUp = ip route add 192.168.2.0/24 dev %i
PostUp = iptables -A FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT
PostUp = iptables -A FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT

PostDown = ip route del 192.168.2.0/24 dev %i
PostDown = iptables -D FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT
PostDown = iptables -D FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT

[Peer]
# Branch Office
PublicKey = branch_office_public_key
Endpoint = branch.example.com:51820
AllowedIPs = 172.16.0.2/32, 192.168.2.0/24
PersistentKeepalive = 25
EOF</code></pre>
      </div>
    </div>
<h3 id="load-balancing-and-failover" class="mobile-header">Load Balancing and Failover</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Configure multiple WireGuard servers for redundancy
# Client configuration with multiple peers
cat &gt; multi-server-client.conf &lt;&lt;EOF
[Interface]
PrivateKey = client_private_key
Address = 10.0.0.10/32
DNS = 1.1.1.1, 8.8.8.8

# Primary server
[Peer]
PublicKey = primary_server_public_key
Endpoint = vpn1.example.com:51820
AllowedIPs = 0.0.0.0/1, 128.0.0.0/1
PersistentKeepalive = 25

# Backup server (different IP range to avoid conflicts)
[Peer]
PublicKey = backup_server_public_key
Endpoint = vpn2.example.com:51820
AllowedIPs = 10.1.0.0/24
PersistentKeepalive = 25
EOF</code></pre>
      </div>
    </div>
<h2 id="troubleshooting" class="mobile-header">Troubleshooting</h2>
<h3 id="common-issues-and-solutions" class="mobile-header">Common Issues and Solutions</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Check WireGuard status
sudo systemctl status wg-quick@wg0
sudo wg show

# Check interface configuration
ip addr show wg0
ip route show table all | grep wg0

# Test connectivity
ping -c 4 10.0.0.1  # Server IP from client
ping -c 4 10.0.0.2  # Client IP from server

# Check firewall rules
sudo iptables -L -n | grep -E &quot;(wg0|51820)&quot;
sudo ufw status | grep -E &quot;(WireGuard|51820)&quot;

# Check logs
sudo journalctl -u wg-quick@wg0 -f
dmesg | grep wireguard

# Debug handshake issues
sudo wg show wg0 latest-handshakes
sudo wg show wg0 transfer

# Check peer connectivity
sudo wg show wg0 endpoints
sudo wg show wg0 allowed-ips

# Restart WireGuard interface
sudo wg-quick down wg0
sudo wg-quick up wg0

# Check kernel module
lsmod | grep wireguard
modinfo wireguard

# Test DNS resolution through VPN
nslookup google.com 10.0.0.1

# Check MTU issues
ping -M do -s 1472 10.0.0.1  # Test MTU size

# Performance testing
iperf3 -s -p 5201  # On server
iperf3 -c 10.0.0.1 -p 5201  # On client

# Configuration validation
sudo wg-quick up wg0 --dry-run

# Check routing table
ip route show table all
ip rule show

# Network troubleshooting
traceroute -I 8.8.8.8  # Test route through VPN
ss -tulpn | grep 51820
netstat -tulpn | grep 51820</code></pre>
      </div>
    </div>
<h3 id="advanced-debugging" class="mobile-header">Advanced Debugging</h3>
<div class="mobile-code-block" data-language="bash">
      <div class="mobile-code-header">
        <span class="mobile-code-language">bash</span>
        <button class="mobile-copy-button" onclick="copyCode(this)" title="Copy code">
          <span class="copy-icon">üìã</span>
          <span class="copy-text">Copy</span>
        </button>
      </div>
      <div class="mobile-code-content">
        <pre><code class="language-bash"># Enable debug logging
echo &#039;module wireguard +p&#039; | sudo tee /sys/kernel/debug/dynamic_debug/control

# Monitor kernel messages
sudo dmesg -w | grep wireguard

# Packet capture
sudo tcpdump -i wg0 -n
sudo tcpdump -i eth0 port 51820

# Check system resources
ps aux | grep wg
top -p $(pgrep wg-quick)

# Verify cryptographic setup
sudo wg showconf wg0

# Test with verbose output
sudo wg-quick up wg0 2&gt;&amp;1 | tee /tmp/wg-debug.log

# Check peer handshake details
sudo wg show wg0 dump</code></pre>
      </div>
    </div>
<h2 id="additional-resources" class="mobile-header">Additional Resources</h2>
<li class="mobile-list-item"><a href="https://www.wireguard.com/" target="_blank" rel="noopener" class="mobile-link">WireGuard Official Documentation</a></li>
<li class="mobile-list-item"><a href="https://www.wireguard.com/quickstart/" target="_blank" rel="noopener" class="mobile-link">WireGuard Quick Start</a></li>
<li class="mobile-list-item"><a href="https://www.wireguard.com/papers/wireguard.pdf" target="_blank" rel="noopener" class="mobile-link">WireGuard Protocol Whitepaper</a></li>
<li class="mobile-list-item"><a href="https://lists.zx2c4.com/mailman/listinfo/wireguard" target="_blank" rel="noopener" class="mobile-link">WireGuard Community</a></li>
<p class="mobile-paragraph">---</p>
<p class="mobile-paragraph"><strong>Note:</strong> This guide is part of the <a href="https://howtomgr.github.io" target="_blank" rel="noopener" class="mobile-link">HowToMgr</a> collection.</p></div></article><section class="jsx-8a7f0cdcf94f52ce related-section"><h2 class="jsx-8a7f0cdcf94f52ce section-title">Related <!-- -->Security<!-- --> Guides</h2><div class="jsx-8a7f0cdcf94f52ce mobile-grid"><a class="mobile-card" href="/security/authelia/"><div class="jsx-8a7f0cdcf94f52ce mobile-card-header"><h3 class="jsx-8a7f0cdcf94f52ce mobile-card-title">Authelia</h3><p class="jsx-8a7f0cdcf94f52ce mobile-card-description">authelia is a free and open-source authentication and authorization server. Authelia provides 2FA and SSO for your applications via a web portal, serving as an open-source alternative to Auth0 or Okta</p></div><div class="jsx-8a7f0cdcf94f52ce mobile-card-meta"><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-info">6 min</span></div></a><a class="mobile-card" href="/security/fail2ban/"><div class="jsx-8a7f0cdcf94f52ce mobile-card-header"><h3 class="jsx-8a7f0cdcf94f52ce mobile-card-title">Fail2ban</h3><p class="jsx-8a7f0cdcf94f52ce mobile-card-description">Repo for fail2ban</p></div><div class="jsx-8a7f0cdcf94f52ce mobile-card-meta"><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-info">24 min</span></div></a><a class="mobile-card" href="/security/keycloak/"><div class="jsx-8a7f0cdcf94f52ce mobile-card-header"><h3 class="jsx-8a7f0cdcf94f52ce mobile-card-title">Keycloak</h3><p class="jsx-8a7f0cdcf94f52ce mobile-card-description">keycloak is a free and open-source open source identity and access management solution. Keycloak provides single sign-on (SSO) with identity brokering and social login, serving as a powerful FOSS alternative to Auth0, Okta, or Azure AD B2C</p></div><div class="jsx-8a7f0cdcf94f52ce mobile-card-meta"><span class="jsx-8a7f0cdcf94f52ce mobile-badge mobile-badge-info">1 min</span></div></a></div></section><nav class="jsx-8a7f0cdcf94f52ce guide-navigation"><a class="btn btn-secondary" href="/security/">‚Üê All <!-- -->Security</a><a class="btn btn-secondary" href="/">All Categories</a></nav></div></main><footer class="jsx-f92e766e9414ef16 mobile-footer"><div class="jsx-f92e766e9414ef16 container"><div class="jsx-f92e766e9414ef16 footer-content"><div class="jsx-f92e766e9414ef16 footer-links"><a href="/">Home</a><a href="https://github.com/howtomgr" target="_blank" rel="noopener" class="jsx-f92e766e9414ef16">GitHub</a><a href="https://github.com/howtomgr/howtomgr.github.io" target="_blank" rel="noopener" class="jsx-f92e766e9414ef16">Source</a></div><div class="jsx-f92e766e9414ef16 footer-separator"></div><p class="jsx-f92e766e9414ef16 footer-text">¬© <!-- -->2025<!-- --> HowToMgr Organization. Open source installation guides.</p><p class="jsx-f92e766e9414ef16 footer-tech">Built with ‚ù§Ô∏è using Next.js + GitHub Pages</p><p class="jsx-f92e766e9414ef16 footer-disclaimer"><small class="jsx-f92e766e9414ef16">All guides are provided as-is. Please review and test before production use.</small></p></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"guide":{"name":"wireguard","displayName":"Wireguard","slug":"wireguard","description":"Repo for wireguard","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/wireguard","updatedAt":"2025-09-14T01:31:22Z","createdAt":"2025-09-08T03:18:17Z","readmeRaw":"# WireGuard Installation Guide\n\nModern, fast, and secure VPN solution using state-of-the-art cryptography. Essential tool for secure remote access, site-to-site connectivity, and privacy protection with minimal configuration complexity.\n\n## Prerequisites\n\n- Linux system with kernel 3.10+ (any modern distribution)\n- Root or sudo access\n- Static IP address or dynamic DNS\n- UDP port 51820 available (default, configurable)\n- Basic understanding of networking concepts\n\n## Installation\n\n### Ubuntu/Debian\n```bash\n# Update system packages\nsudo apt update \u0026\u0026 sudo apt upgrade -y\n\n# Install WireGuard\nsudo apt install -y wireguard wireguard-tools\n\n# For older Ubuntu versions (18.04)\nsudo add-apt-repository ppa:wireguard/wireguard\nsudo apt update\nsudo apt install -y wireguard\n\n# Install additional tools\nsudo apt install -y qrencode resolvconf\n\n# Verify installation\nwg --version\nmodprobe wireguard \u0026\u0026 echo \"WireGuard module loaded successfully\"\n```\n\n### RHEL/CentOS/Rocky Linux/AlmaLinux\n```bash\n# Install EPEL repository\nsudo yum install -y epel-release\n\n# Install WireGuard\nsudo yum install -y wireguard-tools\n\n# For CentOS 7 (requires additional steps)\nsudo yum install -y yum-plugin-elrepo\nsudo yum install -y kmod-wireguard wireguard-tools\n\n# Install additional tools\nsudo yum install -y qrencode\n\n# Enable IP forwarding\necho 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.conf\necho 'net.ipv6.conf.all.forwarding = 1' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n```\n\n### Fedora\n```bash\n# Install WireGuard (included in kernel 5.6+)\nsudo dnf install -y wireguard-tools qrencode\n\n# Enable IP forwarding\necho 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n```\n\n### Arch Linux\n```bash\n# Install WireGuard\nsudo pacman -Syu wireguard-tools qrencode\n\n# Load WireGuard module\nsudo modprobe wireguard\n\n# Enable IP forwarding\necho 'net.ipv4.ip_forward = 1' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n```\n\n## Server Configuration\n\n### Generate Keys and Create Server Config\n```bash\n# Create WireGuard directory\nsudo mkdir -p /etc/wireguard\nsudo chmod 700 /etc/wireguard\n\n# Generate server keys\ncd /etc/wireguard\nwg genkey | sudo tee server_private.key | wg pubkey | sudo tee server_public.key\nsudo chmod 600 server_private.key\n\n# Create server configuration\nsudo tee /etc/wireguard/wg0.conf \u003e /dev/null \u003c\u003cEOF\n[Interface]\n# Server configuration\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24, fd00::1/64\nListenPort = 51820\nSaveConfig = true\n\n# Network configuration\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE; ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE; ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n# DNS servers (optional)\nDNS = 1.1.1.1, 8.8.8.8\n\n# Client configurations will be added here automatically\n# [Peer] sections for each client\nEOF\n\nsudo chmod 600 /etc/wireguard/wg0.conf\n```\n\n### Advanced Server Configuration\n```bash\n# Create production server configuration with security\nsudo tee /etc/wireguard/wg0.conf \u003e /dev/null \u003c\u003cEOF\n[Interface]\n# Server identity\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24\nListenPort = 51820\nSaveConfig = false  # Disable for security in production\n\n# Network forwarding and NAT\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostUp = ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\nPostDown = ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n# Security: Block private networks (adjust as needed)\nPostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 192.168.1.0/24 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 172.16.0.0/12 -j DROP\n\n# DNS configuration\nDNS = 10.0.0.1  # Use Pi-hole or local DNS\n\n# Example client configurations\n[Peer]\n# Client 1 - Admin laptop\nPublicKey = client1_public_key_here\nAllowedIPs = 10.0.0.2/32\nPersistentKeepalive = 25\n\n[Peer]  \n# Client 2 - Mobile device\nPublicKey = client2_public_key_here\nAllowedIPs = 10.0.0.3/32\nPersistentKeepalive = 25\n\n[Peer]\n# Client 3 - Site-to-site (branch office)\nPublicKey = site_public_key_here\nAllowedIPs = 10.0.0.0/24, 192.168.100.0/24\nEndpoint = branch.example.com:51820\nPersistentKeepalive = 25\nEOF\n```\n\n## Client Configuration\n\n### Generate Client Configurations\n```bash\n# Create client configuration generator script\nsudo tee /usr/local/bin/wg-add-client.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nCLIENT_NAME=\"${1}\"\nSERVER_PUBLIC_IP=\"${2:-your-server-public-ip}\"\nSERVER_PUBLIC_KEY=\"$(sudo cat /etc/wireguard/server_public.key)\"\n\nif [ -z \"$CLIENT_NAME\" ]; then\n    echo \"Usage: $0 \u003cclient_name\u003e [server_public_ip]\"\n    echo \"Example: $0 laptop1 203.0.113.1\"\n    exit 1\nfi\n\n# Get next available IP\nLAST_IP=$(grep \"AllowedIPs\" /etc/wireguard/wg0.conf | grep -o \"10\\.0\\.0\\.[0-9]*\" | sort -t. -k4 -n | tail -1 | cut -d. -f4)\nNEXT_IP=$((LAST_IP + 1))\nCLIENT_IP=\"10.0.0.${NEXT_IP}/32\"\n\n# Generate client keys\nCLIENT_PRIVATE_KEY=$(wg genkey)\nCLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)\n\n# Add peer to server configuration\nsudo tee -a /etc/wireguard/wg0.conf \u003e /dev/null \u003c\u003cPEER\n\n[Peer]\n# ${CLIENT_NAME}\nPublicKey = ${CLIENT_PUBLIC_KEY}\nAllowedIPs = ${CLIENT_IP}\nPersistentKeepalive = 25\nPEER\n\n# Generate client configuration\ncat \u003e /tmp/${CLIENT_NAME}.conf \u003c\u003cCLIENT_CONFIG\n[Interface]\nPrivateKey = ${CLIENT_PRIVATE_KEY}\nAddress = ${CLIENT_IP}\nDNS = 10.0.0.1, 1.1.1.1\n\n[Peer]\nPublicKey = ${SERVER_PUBLIC_KEY}\nEndpoint = ${SERVER_PUBLIC_IP}:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nCLIENT_CONFIG\n\n# Generate QR code for mobile devices\nqrencode -t ansiutf8 \u003c /tmp/${CLIENT_NAME}.conf\n\necho \"Client configuration created: /tmp/${CLIENT_NAME}.conf\"\necho \"Add to server with: sudo wg addconf wg0 \u003c(echo '[Peer]'; echo 'PublicKey = ${CLIENT_PUBLIC_KEY}'; echo 'AllowedIPs = ${CLIENT_IP}')\"\nEOF\n\nsudo chmod +x /usr/local/bin/wg-add-client.sh\n\n# Example: Add a client\n# sudo /usr/local/bin/wg-add-client.sh laptop1 your-server-ip\n```\n\n### Client Examples\n```bash\n# Mobile device configuration\ncat \u003e mobile-client.conf \u003c\u003cEOF\n[Interface]\nPrivateKey = mobile_device_private_key\nAddress = 10.0.0.10/32\nDNS = 10.0.0.1\n\n[Peer]\nPublicKey = server_public_key_here\nEndpoint = vpn.example.com:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nEOF\n\n# Site-to-site configuration (branch office)\ncat \u003e branch-office.conf \u003c\u003cEOF\n[Interface]\nPrivateKey = branch_office_private_key\nAddress = 10.0.0.100/32\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n[Peer]\nPublicKey = server_public_key_here\nEndpoint = vpn.example.com:51820\nAllowedIPs = 10.0.0.0/24, 192.168.1.0/24\nPersistentKeepalive = 25\nEOF\n```\n\n## Service Management and Security\n\n### SystemD Service\n```bash\n# Enable WireGuard interface as systemd service\nsudo systemctl enable wg-quick@wg0\nsudo systemctl start wg-quick@wg0\n\n# Check status\nsudo systemctl status wg-quick@wg0\nsudo wg show\n\n# Alternative: Manual management\nsudo wg-quick up wg0\nsudo wg-quick down wg0\n```\n\n### Firewall Configuration\n```bash\n# Configure UFW for WireGuard\nsudo ufw allow 51820/udp comment 'WireGuard VPN'\nsudo ufw allow from 10.0.0.0/24 comment 'WireGuard clients'\n\n# For internal network access\nsudo ufw allow from 10.0.0.0/24 to 192.168.1.0/24\n\n# Firewalld configuration (RHEL/CentOS)\nsudo firewall-cmd --permanent --add-port=51820/udp\nsudo firewall-cmd --permanent --add-rich-rule='rule family=ipv4 source address=10.0.0.0/24 accept'\nsudo firewall-cmd --reload\n\n# Direct iptables rules\nsudo iptables -A INPUT -p udp --dport 51820 -j ACCEPT\nsudo iptables -A FORWARD -i wg0 -j ACCEPT\nsudo iptables -A FORWARD -o wg0 -j ACCEPT\nsudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n```\n\n### Security Hardening\n```bash\n# Configure advanced security features\nsudo tee /etc/wireguard/wg0.conf \u003e /dev/null \u003c\u003cEOF\n[Interface]\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24\nListenPort = 51820\n\n# Security: Change default port\n# ListenPort = 41194\n\n# DNS security\nDNS = 10.0.0.1  # Use Pi-hole for ad blocking\n\n# Advanced security rules\nPostUp = iptables -A FORWARD -i %i -j ACCEPT\nPostUp = iptables -A FORWARD -o %i -j ACCEPT\nPostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n\n# Block access to local network (security measure)\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.0/24 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 172.16.0.0/12 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 10.0.0.0/8 -j DROP\n\n# Allow specific services only\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.100 -p tcp --dport 22 -j ACCEPT    # SSH to server\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.101 -p tcp --dport 443 -j ACCEPT  # HTTPS to web services\n\nPostDown = iptables -D FORWARD -i %i -j ACCEPT\nPostDown = iptables -D FORWARD -o %i -j ACCEPT\nPostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\nEOF\n```\n\n## Management and Automation\n\n### WireGuard Management Script\n```bash\nsudo tee /usr/local/bin/wg-manager.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\n\nINTERFACE=\"wg0\"\nCONFIG_FILE=\"/etc/wireguard/${INTERFACE}.conf\"\nCLIENTS_DIR=\"/etc/wireguard/clients\"\nSERVER_PUBLIC_IP=\"${SERVER_PUBLIC_IP:-$(curl -s ipinfo.io/ip)}\"\nSERVER_PUBLIC_KEY=\"$(sudo cat /etc/wireguard/server_public.key)\"\n\nsudo mkdir -p ${CLIENTS_DIR}\n\ncase \"${1}\" in\n    \"add-client\")\n        CLIENT_NAME=\"${2}\"\n        if [ -z \"$CLIENT_NAME\" ]; then\n            echo \"Usage: $0 add-client \u003cclient_name\u003e\"\n            exit 1\n        fi\n        \n        # Generate client keys\n        CLIENT_PRIVATE_KEY=$(wg genkey)\n        CLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)\n        \n        # Get next available IP\n        LAST_IP=$(grep \"AllowedIPs\" ${CONFIG_FILE} | grep -o \"10\\.0\\.0\\.[0-9]*\" | sort -t. -k4 -n | tail -1 | cut -d. -f4)\n        NEXT_IP=$((LAST_IP + 1))\n        CLIENT_IP=\"10.0.0.${NEXT_IP}\"\n        \n        # Add peer to server\n        sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} allowed-ips ${CLIENT_IP}/32\n        \n        # Save to config\n        sudo tee -a ${CONFIG_FILE} \u003e /dev/null \u003c\u003cPEER\n\n[Peer]\n# ${CLIENT_NAME} - $(date)\nPublicKey = ${CLIENT_PUBLIC_KEY}\nAllowedIPs = ${CLIENT_IP}/32\nPersistentKeepalive = 25\nPEER\n        \n        # Generate client config\n        cat \u003e ${CLIENTS_DIR}/${CLIENT_NAME}.conf \u003c\u003cCLIENT_CONFIG\n[Interface]\nPrivateKey = ${CLIENT_PRIVATE_KEY}\nAddress = ${CLIENT_IP}/32\nDNS = 10.0.0.1\n\n[Peer]\nPublicKey = ${SERVER_PUBLIC_KEY}\nEndpoint = ${SERVER_PUBLIC_IP}:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nCLIENT_CONFIG\n        \n        # Generate QR code\n        echo \"Client ${CLIENT_NAME} configuration:\"\n        qrencode -t ansiutf8 \u003c ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n        echo \"Configuration file: ${CLIENTS_DIR}/${CLIENT_NAME}.conf\"\n        ;;\n        \n    \"remove-client\")\n        CLIENT_NAME=\"${2}\"\n        if [ -z \"$CLIENT_NAME\" ]; then\n            echo \"Usage: $0 remove-client \u003cclient_name\u003e\"\n            exit 1\n        fi\n        \n        CLIENT_PUBLIC_KEY=$(grep -A 3 \"# ${CLIENT_NAME}\" ${CONFIG_FILE} | grep \"PublicKey\" | cut -d' ' -f3)\n        if [ -n \"$CLIENT_PUBLIC_KEY\" ]; then\n            sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} remove\n            sudo sed -i \"/# ${CLIENT_NAME}/,+3d\" ${CONFIG_FILE}\n            rm -f ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n            echo \"Client ${CLIENT_NAME} removed\"\n        else\n            echo \"Client ${CLIENT_NAME} not found\"\n        fi\n        ;;\n        \n    \"list-clients\")\n        echo \"Connected clients:\"\n        sudo wg show ${INTERFACE}\n        echo \"\"\n        echo \"Configured clients:\"\n        grep \"^# \" ${CONFIG_FILE} | sed 's/# /- /'\n        ;;\n        \n    \"show-client\")\n        CLIENT_NAME=\"${2}\"\n        if [ -z \"$CLIENT_NAME\" ]; then\n            echo \"Usage: $0 show-client \u003cclient_name\u003e\"\n            exit 1\n        fi\n        \n        if [ -f \"${CLIENTS_DIR}/${CLIENT_NAME}.conf\" ]; then\n            echo \"Configuration for ${CLIENT_NAME}:\"\n            cat ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n            echo \"\"\n            echo \"QR Code:\"\n            qrencode -t ansiutf8 \u003c ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n        else\n            echo \"Client ${CLIENT_NAME} not found\"\n        fi\n        ;;\n        \n    \"status\")\n        echo \"WireGuard Status:\"\n        sudo systemctl status wg-quick@${INTERFACE}\n        echo \"\"\n        echo \"Interface Details:\"\n        sudo wg show ${INTERFACE}\n        echo \"\"\n        echo \"Interface Statistics:\"\n        sudo wg show ${INTERFACE} transfer\n        ;;\n        \n    \"restart\")\n        echo \"Restarting WireGuard...\"\n        sudo systemctl restart wg-quick@${INTERFACE}\n        echo \"WireGuard restarted\"\n        ;;\n        \n    *)\n        echo \"WireGuard Management Script\"\n        echo \"Usage: $0 {add-client|remove-client|list-clients|show-client|status|restart}\"\n        echo \"\"\n        echo \"Examples:\"\n        echo \"  $0 add-client laptop1\"\n        echo \"  $0 remove-client laptop1\"  \n        echo \"  $0 show-client laptop1\"\n        echo \"  $0 list-clients\"\n        echo \"  $0 status\"\n        echo \"  $0 restart\"\n        exit 1\n        ;;\nesac\nEOF\n\nsudo chmod +x /usr/local/bin/wg-manager.sh\n```\n\n### Web UI (WireGuard Easy)\n```bash\n# Install WireGuard Easy (web management interface)\nmkdir -p ~/wg-easy\ncd ~/wg-easy\n\ncat \u003e docker-compose.yml \u003c\u003cEOF\nversion: '3.8'\n\nservices:\n  wg-easy:\n    image: weejewel/wg-easy:latest\n    container_name: wg-easy\n    restart: unless-stopped\n    ports:\n      - \"51821:51821/udp\"  # WireGuard port\n      - \"127.0.0.1:51822:51822/tcp\"  # Web UI port\n    environment:\n      - WG_HOST=vpn.example.com\n      - PASSWORD=WebUISecurePassword2024!\n      - WG_PORT=51821\n      - WG_DEFAULT_ADDRESS=10.8.0.x\n      - WG_DEFAULT_DNS=1.1.1.1,8.8.8.8\n      - WG_MTU=1420\n      - WG_ALLOWED_IPS=0.0.0.0/0,::/0\n      - WG_PERSISTENT_KEEPALIVE=25\n    volumes:\n      - ./data:/etc/wireguard\n    cap_add:\n      - NET_ADMIN\n      - SYS_MODULE\n    sysctls:\n      - net.ipv4.ip_forward=1\n      - net.ipv4.conf.all.src_valid_mark=1\n    networks:\n      - wg-easy\n\nnetworks:\n  wg-easy:\n    driver: bridge\nEOF\n\n# Start WG-Easy\ndocker-compose up -d\n\n# Access web interface at http://localhost:51822\n```\n\n## Monitoring and Maintenance\n\n### Health Monitoring\n```bash\nsudo tee /usr/local/bin/wireguard-health.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nHEALTH_LOG=\"/var/log/wireguard-health.log\"\n\nlog_message() {\n    echo \"$(date '+%Y-%m-%d %H:%M:%S') - $1\" | tee -a ${HEALTH_LOG}\n}\n\n# Check WireGuard service\nif systemctl is-active wg-quick@wg0 \u003e/dev/null 2\u003e\u00261; then\n    log_message \"‚úì WireGuard service is running\"\nelse\n    log_message \"‚úó WireGuard service is not running\"\n    exit 1\nfi\n\n# Check interface status\nif ip link show wg0 \u003e/dev/null 2\u003e\u00261; then\n    log_message \"‚úì WireGuard interface is up\"\nelse\n    log_message \"‚úó WireGuard interface is down\"\nfi\n\n# Check connected peers\nCONNECTED_PEERS=$(sudo wg show wg0 peers | wc -l)\nACTIVE_PEERS=$(sudo wg show wg0 latest-handshakes | awk '$2 \u003e 0' | wc -l)\nlog_message \"‚Ñπ Connected peers: ${ACTIVE_PEERS}/${CONNECTED_PEERS}\"\n\n# Check traffic statistics\nTRAFFIC_STATS=$(sudo wg show wg0 transfer)\nlog_message \"‚Ñπ Traffic statistics available: $(echo \"$TRAFFIC_STATS\" | wc -l) peers\"\n\n# Check listening port\nif ss -ulpn | grep -q \":51820\"; then\n    log_message \"‚úì WireGuard is listening on port 51820\"\nelse\n    log_message \"‚ö† WireGuard not listening on expected port\"\nfi\n\n# Check IP forwarding\nIP_FORWARD=$(cat /proc/sys/net/ipv4/ip_forward)\nif [ \"$IP_FORWARD\" = \"1\" ]; then\n    log_message \"‚úì IP forwarding is enabled\"\nelse\n    log_message \"‚úó IP forwarding is disabled\"\nfi\n\nlog_message \"WireGuard health check completed\"\nEOF\n\nsudo chmod +x /usr/local/bin/wireguard-health.sh\n\n# Schedule health checks every 10 minutes\necho \"*/10 * * * * root /usr/local/bin/wireguard-health.sh\" | sudo tee -a /etc/crontab\n```\n\n### Backup and Configuration Management\n```bash\nsudo tee /usr/local/bin/wireguard-backup.sh \u003e /dev/null \u003c\u003c'EOF'\n#!/bin/bash\nBACKUP_DIR=\"/backup/wireguard\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}/{configs,clients}\n\necho \"Starting WireGuard backup...\"\n\n# Backup server configuration\ncp /etc/wireguard/wg0.conf ${BACKUP_DIR}/configs/wg0-${DATE}.conf\n\n# Backup client configurations\nif [ -d \"/etc/wireguard/clients\" ]; then\n    tar -czf ${BACKUP_DIR}/clients/clients-${DATE}.tar.gz -C /etc/wireguard clients/\nfi\n\n# Backup keys\ntar -czf ${BACKUP_DIR}/configs/keys-${DATE}.tar.gz -C /etc/wireguard *.key\n\n# Upload to cloud storage (encrypted)\ngpg --symmetric --cipher-algo AES256 --compress-algo 1 --s2k-mode 3 \\\n    --s2k-digest-algo SHA512 --s2k-count 65536 \\\n    --output ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg \\\n    --compress-level 9 \\\n    \u003c(tar -czf - -C ${BACKUP_DIR} .)\n\n# Upload encrypted backup\naws s3 cp ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg s3://wireguard-backups/\n\n# Keep only last 30 backups\nfind ${BACKUP_DIR} -name \"wireguard-*\" -type f -mtime +30 -delete\n\necho \"WireGuard backup completed: ${DATE}\"\nEOF\n\nsudo chmod +x /usr/local/bin/wireguard-backup.sh\n\n# Schedule daily backups\necho \"0 3 * * * root /usr/local/bin/wireguard-backup.sh\" | sudo tee -a /etc/crontab\n```\n\n## Advanced Features\n\n### Site-to-Site VPN\n```bash\n# Configure site-to-site VPN between offices\n# Office A (Main) - 192.168.1.0/24\n# Office B (Branch) - 192.168.2.0/24\n\n# Main office WireGuard config\nsudo tee /etc/wireguard/site-to-site.conf \u003e /dev/null \u003c\u003cEOF\n[Interface]\nPrivateKey = main_office_private_key\nAddress = 172.16.0.1/30\nListenPort = 51820\n\n# Route traffic between sites\nPostUp = ip route add 192.168.2.0/24 dev %i\nPostUp = iptables -A FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT\nPostUp = iptables -A FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT\n\nPostDown = ip route del 192.168.2.0/24 dev %i\nPostDown = iptables -D FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT\nPostDown = iptables -D FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT\n\n[Peer]\n# Branch Office\nPublicKey = branch_office_public_key\nEndpoint = branch.example.com:51820\nAllowedIPs = 172.16.0.2/32, 192.168.2.0/24\nPersistentKeepalive = 25\nEOF\n```\n\n### Load Balancing and Failover\n```bash\n# Configure multiple WireGuard servers for redundancy\n# Client configuration with multiple peers\ncat \u003e multi-server-client.conf \u003c\u003cEOF\n[Interface]\nPrivateKey = client_private_key\nAddress = 10.0.0.10/32\nDNS = 1.1.1.1, 8.8.8.8\n\n# Primary server\n[Peer]\nPublicKey = primary_server_public_key\nEndpoint = vpn1.example.com:51820\nAllowedIPs = 0.0.0.0/1, 128.0.0.0/1\nPersistentKeepalive = 25\n\n# Backup server (different IP range to avoid conflicts)\n[Peer]\nPublicKey = backup_server_public_key\nEndpoint = vpn2.example.com:51820\nAllowedIPs = 10.1.0.0/24\nPersistentKeepalive = 25\nEOF\n```\n\n## Troubleshooting\n\n### Common Issues and Solutions\n```bash\n# Check WireGuard status\nsudo systemctl status wg-quick@wg0\nsudo wg show\n\n# Check interface configuration\nip addr show wg0\nip route show table all | grep wg0\n\n# Test connectivity\nping -c 4 10.0.0.1  # Server IP from client\nping -c 4 10.0.0.2  # Client IP from server\n\n# Check firewall rules\nsudo iptables -L -n | grep -E \"(wg0|51820)\"\nsudo ufw status | grep -E \"(WireGuard|51820)\"\n\n# Check logs\nsudo journalctl -u wg-quick@wg0 -f\ndmesg | grep wireguard\n\n# Debug handshake issues\nsudo wg show wg0 latest-handshakes\nsudo wg show wg0 transfer\n\n# Check peer connectivity\nsudo wg show wg0 endpoints\nsudo wg show wg0 allowed-ips\n\n# Restart WireGuard interface\nsudo wg-quick down wg0\nsudo wg-quick up wg0\n\n# Check kernel module\nlsmod | grep wireguard\nmodinfo wireguard\n\n# Test DNS resolution through VPN\nnslookup google.com 10.0.0.1\n\n# Check MTU issues\nping -M do -s 1472 10.0.0.1  # Test MTU size\n\n# Performance testing\niperf3 -s -p 5201  # On server\niperf3 -c 10.0.0.1 -p 5201  # On client\n\n# Configuration validation\nsudo wg-quick up wg0 --dry-run\n\n# Check routing table\nip route show table all\nip rule show\n\n# Network troubleshooting\ntraceroute -I 8.8.8.8  # Test route through VPN\nss -tulpn | grep 51820\nnetstat -tulpn | grep 51820\n```\n\n### Advanced Debugging\n```bash\n# Enable debug logging\necho 'module wireguard +p' | sudo tee /sys/kernel/debug/dynamic_debug/control\n\n# Monitor kernel messages\nsudo dmesg -w | grep wireguard\n\n# Packet capture\nsudo tcpdump -i wg0 -n\nsudo tcpdump -i eth0 port 51820\n\n# Check system resources\nps aux | grep wg\ntop -p $(pgrep wg-quick)\n\n# Verify cryptographic setup\nsudo wg showconf wg0\n\n# Test with verbose output\nsudo wg-quick up wg0 2\u003e\u00261 | tee /tmp/wg-debug.log\n\n# Check peer handshake details\nsudo wg show wg0 dump\n```\n\n## Additional Resources\n\n- [WireGuard Official Documentation](https://www.wireguard.com/)\n- [WireGuard Quick Start](https://www.wireguard.com/quickstart/)\n- [WireGuard Protocol Whitepaper](https://www.wireguard.com/papers/wireguard.pdf)\n- [WireGuard Community](https://lists.zx2c4.com/mailman/listinfo/wireguard)\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection.","readmeHtml":"\u003ch1 id=\"wireguard-installation-guide\" class=\"mobile-header\"\u003eWireGuard Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eModern, fast, and secure VPN solution using state-of-the-art cryptography. Essential tool for secure remote access, site-to-site connectivity, and privacy protection with minimal configuration complexity.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux system with kernel 3.10+ (any modern distribution)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot or sudo access\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eStatic IP address or dynamic DNS\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eUDP port 51820 available (default, configurable)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eBasic understanding of networking concepts\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"ubuntudebian\" class=\"mobile-header\"\u003eUbuntu/Debian\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update system packages\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade -y\n\n# Install WireGuard\nsudo apt install -y wireguard wireguard-tools\n\n# For older Ubuntu versions (18.04)\nsudo add-apt-repository ppa:wireguard/wireguard\nsudo apt update\nsudo apt install -y wireguard\n\n# Install additional tools\nsudo apt install -y qrencode resolvconf\n\n# Verify installation\nwg --version\nmodprobe wireguard \u0026amp;\u0026amp; echo \u0026quot;WireGuard module loaded successfully\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"rhelcentosrocky-linuxalmalinux\" class=\"mobile-header\"\u003eRHEL/CentOS/Rocky Linux/AlmaLinux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install EPEL repository\nsudo yum install -y epel-release\n\n# Install WireGuard\nsudo yum install -y wireguard-tools\n\n# For CentOS 7 (requires additional steps)\nsudo yum install -y yum-plugin-elrepo\nsudo yum install -y kmod-wireguard wireguard-tools\n\n# Install additional tools\nsudo yum install -y qrencode\n\n# Enable IP forwarding\necho \u0026#039;net.ipv4.ip_forward = 1\u0026#039; | sudo tee -a /etc/sysctl.conf\necho \u0026#039;net.ipv6.conf.all.forwarding = 1\u0026#039; | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"fedora\" class=\"mobile-header\"\u003eFedora\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install WireGuard (included in kernel 5.6+)\nsudo dnf install -y wireguard-tools qrencode\n\n# Enable IP forwarding\necho \u0026#039;net.ipv4.ip_forward = 1\u0026#039; | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"arch-linux\" class=\"mobile-header\"\u003eArch Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install WireGuard\nsudo pacman -Syu wireguard-tools qrencode\n\n# Load WireGuard module\nsudo modprobe wireguard\n\n# Enable IP forwarding\necho \u0026#039;net.ipv4.ip_forward = 1\u0026#039; | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"server-configuration\" class=\"mobile-header\"\u003eServer Configuration\u003c/h2\u003e\n\u003ch3 id=\"generate-keys-and-create-server-config\" class=\"mobile-header\"\u003eGenerate Keys and Create Server Config\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create WireGuard directory\nsudo mkdir -p /etc/wireguard\nsudo chmod 700 /etc/wireguard\n\n# Generate server keys\ncd /etc/wireguard\nwg genkey | sudo tee server_private.key | wg pubkey | sudo tee server_public.key\nsudo chmod 600 server_private.key\n\n# Create server configuration\nsudo tee /etc/wireguard/wg0.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Interface]\n# Server configuration\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24, fd00::1/64\nListenPort = 51820\nSaveConfig = true\n\n# Network configuration\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE; ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE; ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n# DNS servers (optional)\nDNS = 1.1.1.1, 8.8.8.8\n\n# Client configurations will be added here automatically\n# [Peer] sections for each client\nEOF\n\nsudo chmod 600 /etc/wireguard/wg0.conf\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-server-configuration\" class=\"mobile-header\"\u003eAdvanced Server Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create production server configuration with security\nsudo tee /etc/wireguard/wg0.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Interface]\n# Server identity\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24\nListenPort = 51820\nSaveConfig = false  # Disable for security in production\n\n# Network forwarding and NAT\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostUp = ip6tables -A FORWARD -i %i -j ACCEPT; ip6tables -A FORWARD -o %i -j ACCEPT; ip6tables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\nPostDown = ip6tables -D FORWARD -i %i -j ACCEPT; ip6tables -D FORWARD -o %i -j ACCEPT; ip6tables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n# Security: Block private networks (adjust as needed)\nPostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 192.168.1.0/24 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/8 -d 172.16.0.0/12 -j DROP\n\n# DNS configuration\nDNS = 10.0.0.1  # Use Pi-hole or local DNS\n\n# Example client configurations\n[Peer]\n# Client 1 - Admin laptop\nPublicKey = client1_public_key_here\nAllowedIPs = 10.0.0.2/32\nPersistentKeepalive = 25\n\n[Peer]  \n# Client 2 - Mobile device\nPublicKey = client2_public_key_here\nAllowedIPs = 10.0.0.3/32\nPersistentKeepalive = 25\n\n[Peer]\n# Client 3 - Site-to-site (branch office)\nPublicKey = site_public_key_here\nAllowedIPs = 10.0.0.0/24, 192.168.100.0/24\nEndpoint = branch.example.com:51820\nPersistentKeepalive = 25\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"client-configuration\" class=\"mobile-header\"\u003eClient Configuration\u003c/h2\u003e\n\u003ch3 id=\"generate-client-configurations\" class=\"mobile-header\"\u003eGenerate Client Configurations\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create client configuration generator script\nsudo tee /usr/local/bin/wg-add-client.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nCLIENT_NAME=\u0026quot;${1}\u0026quot;\nSERVER_PUBLIC_IP=\u0026quot;${2:-your-server-public-ip}\u0026quot;\nSERVER_PUBLIC_KEY=\u0026quot;$(sudo cat /etc/wireguard/server_public.key)\u0026quot;\n\nif [ -z \u0026quot;$CLIENT_NAME\u0026quot; ]; then\n    echo \u0026quot;Usage: $0 \u0026lt;client_name\u0026gt; [server_public_ip]\u0026quot;\n    echo \u0026quot;Example: $0 laptop1 203.0.113.1\u0026quot;\n    exit 1\nfi\n\n# Get next available IP\nLAST_IP=$(grep \u0026quot;AllowedIPs\u0026quot; /etc/wireguard/wg0.conf | grep -o \u0026quot;10\\.0\\.0\\.[0-9]*\u0026quot; | sort -t. -k4 -n | tail -1 | cut -d. -f4)\nNEXT_IP=$((LAST_IP + 1))\nCLIENT_IP=\u0026quot;10.0.0.${NEXT_IP}/32\u0026quot;\n\n# Generate client keys\nCLIENT_PRIVATE_KEY=$(wg genkey)\nCLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)\n\n# Add peer to server configuration\nsudo tee -a /etc/wireguard/wg0.conf \u0026gt; /dev/null \u0026lt;\u0026lt;PEER\n\n[Peer]\n# ${CLIENT_NAME}\nPublicKey = ${CLIENT_PUBLIC_KEY}\nAllowedIPs = ${CLIENT_IP}\nPersistentKeepalive = 25\nPEER\n\n# Generate client configuration\ncat \u0026gt; /tmp/${CLIENT_NAME}.conf \u0026lt;\u0026lt;CLIENT_CONFIG\n[Interface]\nPrivateKey = ${CLIENT_PRIVATE_KEY}\nAddress = ${CLIENT_IP}\nDNS = 10.0.0.1, 1.1.1.1\n\n[Peer]\nPublicKey = ${SERVER_PUBLIC_KEY}\nEndpoint = ${SERVER_PUBLIC_IP}:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nCLIENT_CONFIG\n\n# Generate QR code for mobile devices\nqrencode -t ansiutf8 \u0026lt; /tmp/${CLIENT_NAME}.conf\n\necho \u0026quot;Client configuration created: /tmp/${CLIENT_NAME}.conf\u0026quot;\necho \u0026quot;Add to server with: sudo wg addconf wg0 \u0026lt;(echo \u0026#039;[Peer]\u0026#039;; echo \u0026#039;PublicKey = ${CLIENT_PUBLIC_KEY}\u0026#039;; echo \u0026#039;AllowedIPs = ${CLIENT_IP}\u0026#039;)\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/wg-add-client.sh\n\n# Example: Add a client\n# sudo /usr/local/bin/wg-add-client.sh laptop1 your-server-ip\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"client-examples\" class=\"mobile-header\"\u003eClient Examples\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Mobile device configuration\ncat \u0026gt; mobile-client.conf \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = mobile_device_private_key\nAddress = 10.0.0.10/32\nDNS = 10.0.0.1\n\n[Peer]\nPublicKey = server_public_key_here\nEndpoint = vpn.example.com:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nEOF\n\n# Site-to-site configuration (branch office)\ncat \u0026gt; branch-office.conf \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = branch_office_private_key\nAddress = 10.0.0.100/32\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\n\n[Peer]\nPublicKey = server_public_key_here\nEndpoint = vpn.example.com:51820\nAllowedIPs = 10.0.0.0/24, 192.168.1.0/24\nPersistentKeepalive = 25\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"service-management-and-security\" class=\"mobile-header\"\u003eService Management and Security\u003c/h2\u003e\n\u003ch3 id=\"systemd-service\" class=\"mobile-header\"\u003eSystemD Service\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable WireGuard interface as systemd service\nsudo systemctl enable wg-quick@wg0\nsudo systemctl start wg-quick@wg0\n\n# Check status\nsudo systemctl status wg-quick@wg0\nsudo wg show\n\n# Alternative: Manual management\nsudo wg-quick up wg0\nsudo wg-quick down wg0\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"firewall-configuration\" class=\"mobile-header\"\u003eFirewall Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure UFW for WireGuard\nsudo ufw allow 51820/udp comment \u0026#039;WireGuard VPN\u0026#039;\nsudo ufw allow from 10.0.0.0/24 comment \u0026#039;WireGuard clients\u0026#039;\n\n# For internal network access\nsudo ufw allow from 10.0.0.0/24 to 192.168.1.0/24\n\n# Firewalld configuration (RHEL/CentOS)\nsudo firewall-cmd --permanent --add-port=51820/udp\nsudo firewall-cmd --permanent --add-rich-rule=\u0026#039;rule family=ipv4 source address=10.0.0.0/24 accept\u0026#039;\nsudo firewall-cmd --reload\n\n# Direct iptables rules\nsudo iptables -A INPUT -p udp --dport 51820 -j ACCEPT\nsudo iptables -A FORWARD -i wg0 -j ACCEPT\nsudo iptables -A FORWARD -o wg0 -j ACCEPT\nsudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"security-hardening\" class=\"mobile-header\"\u003eSecurity Hardening\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure advanced security features\nsudo tee /etc/wireguard/wg0.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = $(sudo cat server_private.key)\nAddress = 10.0.0.1/24\nListenPort = 51820\n\n# Security: Change default port\n# ListenPort = 41194\n\n# DNS security\nDNS = 10.0.0.1  # Use Pi-hole for ad blocking\n\n# Advanced security rules\nPostUp = iptables -A FORWARD -i %i -j ACCEPT\nPostUp = iptables -A FORWARD -o %i -j ACCEPT\nPostUp = iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE\n\n# Block access to local network (security measure)\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.0/24 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 172.16.0.0/12 -j DROP\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 10.0.0.0/8 -j DROP\n\n# Allow specific services only\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.100 -p tcp --dport 22 -j ACCEPT    # SSH to server\nPostUp = iptables -I FORWARD -s 10.0.0.0/24 -d 192.168.1.101 -p tcp --dport 443 -j ACCEPT  # HTTPS to web services\n\nPostDown = iptables -D FORWARD -i %i -j ACCEPT\nPostDown = iptables -D FORWARD -o %i -j ACCEPT\nPostDown = iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"management-and-automation\" class=\"mobile-header\"\u003eManagement and Automation\u003c/h2\u003e\n\u003ch3 id=\"wireguard-management-script\" class=\"mobile-header\"\u003eWireGuard Management Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/wg-manager.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\n\nINTERFACE=\u0026quot;wg0\u0026quot;\nCONFIG_FILE=\u0026quot;/etc/wireguard/${INTERFACE}.conf\u0026quot;\nCLIENTS_DIR=\u0026quot;/etc/wireguard/clients\u0026quot;\nSERVER_PUBLIC_IP=\u0026quot;${SERVER_PUBLIC_IP:-$(curl -s ipinfo.io/ip)}\u0026quot;\nSERVER_PUBLIC_KEY=\u0026quot;$(sudo cat /etc/wireguard/server_public.key)\u0026quot;\n\nsudo mkdir -p ${CLIENTS_DIR}\n\ncase \u0026quot;${1}\u0026quot; in\n    \u0026quot;add-client\u0026quot;)\n        CLIENT_NAME=\u0026quot;${2}\u0026quot;\n        if [ -z \u0026quot;$CLIENT_NAME\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 add-client \u0026lt;client_name\u0026gt;\u0026quot;\n            exit 1\n        fi\n        \n        # Generate client keys\n        CLIENT_PRIVATE_KEY=$(wg genkey)\n        CLIENT_PUBLIC_KEY=$(echo $CLIENT_PRIVATE_KEY | wg pubkey)\n        \n        # Get next available IP\n        LAST_IP=$(grep \u0026quot;AllowedIPs\u0026quot; ${CONFIG_FILE} | grep -o \u0026quot;10\\.0\\.0\\.[0-9]*\u0026quot; | sort -t. -k4 -n | tail -1 | cut -d. -f4)\n        NEXT_IP=$((LAST_IP + 1))\n        CLIENT_IP=\u0026quot;10.0.0.${NEXT_IP}\u0026quot;\n        \n        # Add peer to server\n        sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} allowed-ips ${CLIENT_IP}/32\n        \n        # Save to config\n        sudo tee -a ${CONFIG_FILE} \u0026gt; /dev/null \u0026lt;\u0026lt;PEER\n\n[Peer]\n# ${CLIENT_NAME} - $(date)\nPublicKey = ${CLIENT_PUBLIC_KEY}\nAllowedIPs = ${CLIENT_IP}/32\nPersistentKeepalive = 25\nPEER\n        \n        # Generate client config\n        cat \u0026gt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf \u0026lt;\u0026lt;CLIENT_CONFIG\n[Interface]\nPrivateKey = ${CLIENT_PRIVATE_KEY}\nAddress = ${CLIENT_IP}/32\nDNS = 10.0.0.1\n\n[Peer]\nPublicKey = ${SERVER_PUBLIC_KEY}\nEndpoint = ${SERVER_PUBLIC_IP}:51820\nAllowedIPs = 0.0.0.0/0, ::/0\nPersistentKeepalive = 25\nCLIENT_CONFIG\n        \n        # Generate QR code\n        echo \u0026quot;Client ${CLIENT_NAME} configuration:\u0026quot;\n        qrencode -t ansiutf8 \u0026lt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n        echo \u0026quot;Configuration file: ${CLIENTS_DIR}/${CLIENT_NAME}.conf\u0026quot;\n        ;;\n        \n    \u0026quot;remove-client\u0026quot;)\n        CLIENT_NAME=\u0026quot;${2}\u0026quot;\n        if [ -z \u0026quot;$CLIENT_NAME\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 remove-client \u0026lt;client_name\u0026gt;\u0026quot;\n            exit 1\n        fi\n        \n        CLIENT_PUBLIC_KEY=$(grep -A 3 \u0026quot;# ${CLIENT_NAME}\u0026quot; ${CONFIG_FILE} | grep \u0026quot;PublicKey\u0026quot; | cut -d\u0026#039; \u0026#039; -f3)\n        if [ -n \u0026quot;$CLIENT_PUBLIC_KEY\u0026quot; ]; then\n            sudo wg set ${INTERFACE} peer ${CLIENT_PUBLIC_KEY} remove\n            sudo sed -i \u0026quot;/# ${CLIENT_NAME}/,+3d\u0026quot; ${CONFIG_FILE}\n            rm -f ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n            echo \u0026quot;Client ${CLIENT_NAME} removed\u0026quot;\n        else\n            echo \u0026quot;Client ${CLIENT_NAME} not found\u0026quot;\n        fi\n        ;;\n        \n    \u0026quot;list-clients\u0026quot;)\n        echo \u0026quot;Connected clients:\u0026quot;\n        sudo wg show ${INTERFACE}\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Configured clients:\u0026quot;\n        grep \u0026quot;^# \u0026quot; ${CONFIG_FILE} | sed \u0026#039;s/# /- /\u0026#039;\n        ;;\n        \n    \u0026quot;show-client\u0026quot;)\n        CLIENT_NAME=\u0026quot;${2}\u0026quot;\n        if [ -z \u0026quot;$CLIENT_NAME\u0026quot; ]; then\n            echo \u0026quot;Usage: $0 show-client \u0026lt;client_name\u0026gt;\u0026quot;\n            exit 1\n        fi\n        \n        if [ -f \u0026quot;${CLIENTS_DIR}/${CLIENT_NAME}.conf\u0026quot; ]; then\n            echo \u0026quot;Configuration for ${CLIENT_NAME}:\u0026quot;\n            cat ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n            echo \u0026quot;\u0026quot;\n            echo \u0026quot;QR Code:\u0026quot;\n            qrencode -t ansiutf8 \u0026lt; ${CLIENTS_DIR}/${CLIENT_NAME}.conf\n        else\n            echo \u0026quot;Client ${CLIENT_NAME} not found\u0026quot;\n        fi\n        ;;\n        \n    \u0026quot;status\u0026quot;)\n        echo \u0026quot;WireGuard Status:\u0026quot;\n        sudo systemctl status wg-quick@${INTERFACE}\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Interface Details:\u0026quot;\n        sudo wg show ${INTERFACE}\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Interface Statistics:\u0026quot;\n        sudo wg show ${INTERFACE} transfer\n        ;;\n        \n    \u0026quot;restart\u0026quot;)\n        echo \u0026quot;Restarting WireGuard...\u0026quot;\n        sudo systemctl restart wg-quick@${INTERFACE}\n        echo \u0026quot;WireGuard restarted\u0026quot;\n        ;;\n        \n    *)\n        echo \u0026quot;WireGuard Management Script\u0026quot;\n        echo \u0026quot;Usage: $0 {add-client|remove-client|list-clients|show-client|status|restart}\u0026quot;\n        echo \u0026quot;\u0026quot;\n        echo \u0026quot;Examples:\u0026quot;\n        echo \u0026quot;  $0 add-client laptop1\u0026quot;\n        echo \u0026quot;  $0 remove-client laptop1\u0026quot;  \n        echo \u0026quot;  $0 show-client laptop1\u0026quot;\n        echo \u0026quot;  $0 list-clients\u0026quot;\n        echo \u0026quot;  $0 status\u0026quot;\n        echo \u0026quot;  $0 restart\u0026quot;\n        exit 1\n        ;;\nesac\nEOF\n\nsudo chmod +x /usr/local/bin/wg-manager.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"web-ui-wireguard-easy\" class=\"mobile-header\"\u003eWeb UI (WireGuard Easy)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install WireGuard Easy (web management interface)\nmkdir -p ~/wg-easy\ncd ~/wg-easy\n\ncat \u0026gt; docker-compose.yml \u0026lt;\u0026lt;EOF\nversion: \u0026#039;3.8\u0026#039;\n\nservices:\n  wg-easy:\n    image: weejewel/wg-easy:latest\n    container_name: wg-easy\n    restart: unless-stopped\n    ports:\n      - \u0026quot;51821:51821/udp\u0026quot;  # WireGuard port\n      - \u0026quot;127.0.0.1:51822:51822/tcp\u0026quot;  # Web UI port\n    environment:\n      - WG_HOST=vpn.example.com\n      - PASSWORD=WebUISecurePassword2024!\n      - WG_PORT=51821\n      - WG_DEFAULT_ADDRESS=10.8.0.x\n      - WG_DEFAULT_DNS=1.1.1.1,8.8.8.8\n      - WG_MTU=1420\n      - WG_ALLOWED_IPS=0.0.0.0/0,::/0\n      - WG_PERSISTENT_KEEPALIVE=25\n    volumes:\n      - ./data:/etc/wireguard\n    cap_add:\n      - NET_ADMIN\n      - SYS_MODULE\n    sysctls:\n      - net.ipv4.ip_forward=1\n      - net.ipv4.conf.all.src_valid_mark=1\n    networks:\n      - wg-easy\n\nnetworks:\n  wg-easy:\n    driver: bridge\nEOF\n\n# Start WG-Easy\ndocker-compose up -d\n\n# Access web interface at http://localhost:51822\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"monitoring-and-maintenance\" class=\"mobile-header\"\u003eMonitoring and Maintenance\u003c/h2\u003e\n\u003ch3 id=\"health-monitoring\" class=\"mobile-header\"\u003eHealth Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/wireguard-health.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nHEALTH_LOG=\u0026quot;/var/log/wireguard-health.log\u0026quot;\n\nlog_message() {\n    echo \u0026quot;$(date \u0026#039;+%Y-%m-%d %H:%M:%S\u0026#039;) - $1\u0026quot; | tee -a ${HEALTH_LOG}\n}\n\n# Check WireGuard service\nif systemctl is-active wg-quick@wg0 \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;‚úì WireGuard service is running\u0026quot;\nelse\n    log_message \u0026quot;‚úó WireGuard service is not running\u0026quot;\n    exit 1\nfi\n\n# Check interface status\nif ip link show wg0 \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n    log_message \u0026quot;‚úì WireGuard interface is up\u0026quot;\nelse\n    log_message \u0026quot;‚úó WireGuard interface is down\u0026quot;\nfi\n\n# Check connected peers\nCONNECTED_PEERS=$(sudo wg show wg0 peers | wc -l)\nACTIVE_PEERS=$(sudo wg show wg0 latest-handshakes | awk \u0026#039;$2 \u0026gt; 0\u0026#039; | wc -l)\nlog_message \u0026quot;‚Ñπ Connected peers: ${ACTIVE_PEERS}/${CONNECTED_PEERS}\u0026quot;\n\n# Check traffic statistics\nTRAFFIC_STATS=$(sudo wg show wg0 transfer)\nlog_message \u0026quot;‚Ñπ Traffic statistics available: $(echo \u0026quot;$TRAFFIC_STATS\u0026quot; | wc -l) peers\u0026quot;\n\n# Check listening port\nif ss -ulpn | grep -q \u0026quot;:51820\u0026quot;; then\n    log_message \u0026quot;‚úì WireGuard is listening on port 51820\u0026quot;\nelse\n    log_message \u0026quot;‚ö† WireGuard not listening on expected port\u0026quot;\nfi\n\n# Check IP forwarding\nIP_FORWARD=$(cat /proc/sys/net/ipv4/ip_forward)\nif [ \u0026quot;$IP_FORWARD\u0026quot; = \u0026quot;1\u0026quot; ]; then\n    log_message \u0026quot;‚úì IP forwarding is enabled\u0026quot;\nelse\n    log_message \u0026quot;‚úó IP forwarding is disabled\u0026quot;\nfi\n\nlog_message \u0026quot;WireGuard health check completed\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/wireguard-health.sh\n\n# Schedule health checks every 10 minutes\necho \u0026quot;*/10 * * * * root /usr/local/bin/wireguard-health.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"backup-and-configuration-management\" class=\"mobile-header\"\u003eBackup and Configuration Management\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003esudo tee /usr/local/bin/wireguard-backup.sh \u0026gt; /dev/null \u0026lt;\u0026lt;\u0026#039;EOF\u0026#039;\n#!/bin/bash\nBACKUP_DIR=\u0026quot;/backup/wireguard\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p ${BACKUP_DIR}/{configs,clients}\n\necho \u0026quot;Starting WireGuard backup...\u0026quot;\n\n# Backup server configuration\ncp /etc/wireguard/wg0.conf ${BACKUP_DIR}/configs/wg0-${DATE}.conf\n\n# Backup client configurations\nif [ -d \u0026quot;/etc/wireguard/clients\u0026quot; ]; then\n    tar -czf ${BACKUP_DIR}/clients/clients-${DATE}.tar.gz -C /etc/wireguard clients/\nfi\n\n# Backup keys\ntar -czf ${BACKUP_DIR}/configs/keys-${DATE}.tar.gz -C /etc/wireguard *.key\n\n# Upload to cloud storage (encrypted)\ngpg --symmetric --cipher-algo AES256 --compress-algo 1 --s2k-mode 3 \\\n    --s2k-digest-algo SHA512 --s2k-count 65536 \\\n    --output ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg \\\n    --compress-level 9 \\\n    \u0026lt;(tar -czf - -C ${BACKUP_DIR} .)\n\n# Upload encrypted backup\naws s3 cp ${BACKUP_DIR}/wireguard-backup-${DATE}.tar.gz.gpg s3://wireguard-backups/\n\n# Keep only last 30 backups\nfind ${BACKUP_DIR} -name \u0026quot;wireguard-*\u0026quot; -type f -mtime +30 -delete\n\necho \u0026quot;WireGuard backup completed: ${DATE}\u0026quot;\nEOF\n\nsudo chmod +x /usr/local/bin/wireguard-backup.sh\n\n# Schedule daily backups\necho \u0026quot;0 3 * * * root /usr/local/bin/wireguard-backup.sh\u0026quot; | sudo tee -a /etc/crontab\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"advanced-features\" class=\"mobile-header\"\u003eAdvanced Features\u003c/h2\u003e\n\u003ch3 id=\"site-to-site-vpn\" class=\"mobile-header\"\u003eSite-to-Site VPN\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure site-to-site VPN between offices\n# Office A (Main) - 192.168.1.0/24\n# Office B (Branch) - 192.168.2.0/24\n\n# Main office WireGuard config\nsudo tee /etc/wireguard/site-to-site.conf \u0026gt; /dev/null \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = main_office_private_key\nAddress = 172.16.0.1/30\nListenPort = 51820\n\n# Route traffic between sites\nPostUp = ip route add 192.168.2.0/24 dev %i\nPostUp = iptables -A FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT\nPostUp = iptables -A FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT\n\nPostDown = ip route del 192.168.2.0/24 dev %i\nPostDown = iptables -D FORWARD -i %i -o eth0 -s 192.168.2.0/24 -d 192.168.1.0/24 -j ACCEPT\nPostDown = iptables -D FORWARD -i eth0 -o %i -s 192.168.1.0/24 -d 192.168.2.0/24 -j ACCEPT\n\n[Peer]\n# Branch Office\nPublicKey = branch_office_public_key\nEndpoint = branch.example.com:51820\nAllowedIPs = 172.16.0.2/32, 192.168.2.0/24\nPersistentKeepalive = 25\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"load-balancing-and-failover\" class=\"mobile-header\"\u003eLoad Balancing and Failover\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Configure multiple WireGuard servers for redundancy\n# Client configuration with multiple peers\ncat \u0026gt; multi-server-client.conf \u0026lt;\u0026lt;EOF\n[Interface]\nPrivateKey = client_private_key\nAddress = 10.0.0.10/32\nDNS = 1.1.1.1, 8.8.8.8\n\n# Primary server\n[Peer]\nPublicKey = primary_server_public_key\nEndpoint = vpn1.example.com:51820\nAllowedIPs = 0.0.0.0/1, 128.0.0.0/1\nPersistentKeepalive = 25\n\n# Backup server (different IP range to avoid conflicts)\n[Peer]\nPublicKey = backup_server_public_key\nEndpoint = vpn2.example.com:51820\nAllowedIPs = 10.1.0.0/24\nPersistentKeepalive = 25\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting\" class=\"mobile-header\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues-and-solutions\" class=\"mobile-header\"\u003eCommon Issues and Solutions\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check WireGuard status\nsudo systemctl status wg-quick@wg0\nsudo wg show\n\n# Check interface configuration\nip addr show wg0\nip route show table all | grep wg0\n\n# Test connectivity\nping -c 4 10.0.0.1  # Server IP from client\nping -c 4 10.0.0.2  # Client IP from server\n\n# Check firewall rules\nsudo iptables -L -n | grep -E \u0026quot;(wg0|51820)\u0026quot;\nsudo ufw status | grep -E \u0026quot;(WireGuard|51820)\u0026quot;\n\n# Check logs\nsudo journalctl -u wg-quick@wg0 -f\ndmesg | grep wireguard\n\n# Debug handshake issues\nsudo wg show wg0 latest-handshakes\nsudo wg show wg0 transfer\n\n# Check peer connectivity\nsudo wg show wg0 endpoints\nsudo wg show wg0 allowed-ips\n\n# Restart WireGuard interface\nsudo wg-quick down wg0\nsudo wg-quick up wg0\n\n# Check kernel module\nlsmod | grep wireguard\nmodinfo wireguard\n\n# Test DNS resolution through VPN\nnslookup google.com 10.0.0.1\n\n# Check MTU issues\nping -M do -s 1472 10.0.0.1  # Test MTU size\n\n# Performance testing\niperf3 -s -p 5201  # On server\niperf3 -c 10.0.0.1 -p 5201  # On client\n\n# Configuration validation\nsudo wg-quick up wg0 --dry-run\n\n# Check routing table\nip route show table all\nip rule show\n\n# Network troubleshooting\ntraceroute -I 8.8.8.8  # Test route through VPN\nss -tulpn | grep 51820\nnetstat -tulpn | grep 51820\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"advanced-debugging\" class=\"mobile-header\"\u003eAdvanced Debugging\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable debug logging\necho \u0026#039;module wireguard +p\u0026#039; | sudo tee /sys/kernel/debug/dynamic_debug/control\n\n# Monitor kernel messages\nsudo dmesg -w | grep wireguard\n\n# Packet capture\nsudo tcpdump -i wg0 -n\nsudo tcpdump -i eth0 port 51820\n\n# Check system resources\nps aux | grep wg\ntop -p $(pgrep wg-quick)\n\n# Verify cryptographic setup\nsudo wg showconf wg0\n\n# Test with verbose output\nsudo wg-quick up wg0 2\u0026gt;\u0026amp;1 | tee /tmp/wg-debug.log\n\n# Check peer handshake details\nsudo wg show wg0 dump\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.wireguard.com/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eWireGuard Official Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.wireguard.com/quickstart/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eWireGuard Quick Start\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.wireguard.com/papers/wireguard.pdf\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eWireGuard Protocol Whitepaper\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://lists.zx2c4.com/mailman/listinfo/wireguard\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eWireGuard Community\u003c/a\u003e\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection.\u003c/p\u003e","readTime":"14 min","wordCount":2789,"lastBuilt":"2025-09-16T02:44:56.105Z"},"category":{"key":"security","name":"Security","description":"Security tools and authentication systems","icon":"üîí","color":"#ff5555","keywords":["vault","authelia","keycloak","pihole","fail2ban","wireguard","openvpn"]},"relatedGuides":[{"name":"authelia","displayName":"Authelia","slug":"authelia","description":"authelia is a free and open-source authentication and authorization server. Authelia provides 2FA and SSO for your applications via a web portal, serving as an open-source alternative to Auth0 or Okta","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/authelia","updatedAt":"2025-09-16T02:31:16Z","createdAt":"2025-09-16T02:19:55Z","readmeRaw":"# authelia Installation Guide\n\nauthelia is a free and open-source authentication and authorization server. Authelia provides 2FA and SSO for your applications via a web portal, serving as an open-source alternative to Auth0 or Okta\n\n## Prerequisites\n\n- **Hardware Requirements**:\n  - CPU: 1 core minimum\n  - RAM: 512MB minimum\n  - Storage: 100MB for installation\n  - Network: HTTPS for authentication\n- **Operating System**: \n  - Linux: Any modern distribution (RHEL, Debian, Ubuntu, CentOS, Fedora, Arch, Alpine, openSUSE)\n  - macOS: 10.14+ (Mojave or newer)\n  - Windows: Windows Server 2016+ or Windows 10\n  - FreeBSD: 11.0+\n- **Network Requirements**:\n  - Port 9091 (default authelia port)\n  - LDAP backend if used\n- **Dependencies**:\n  - See official documentation for specific requirements\n- **System Access**: root or sudo privileges required\n\n## Installation\n\n### RHEL/CentOS/Rocky Linux/AlmaLinux\n\n```bash\n# Install EPEL repository if needed\nsudo dnf install -y epel-release\n\n# Install authelia\nsudo dnf install -y authelia\n\n# Enable and start service\nsudo systemctl enable --now authelia\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=9091/tcp\nsudo firewall-cmd --reload\n\n# Verify installation\nauthelia --version\n```\n\n### Debian/Ubuntu\n\n```bash\n# Update package index\nsudo apt update\n\n# Install authelia\nsudo apt install -y authelia\n\n# Enable and start service\nsudo systemctl enable --now authelia\n\n# Configure firewall\nsudo ufw allow 9091\n\n# Verify installation\nauthelia --version\n```\n\n### Arch Linux\n\n```bash\n# Install authelia\nsudo pacman -S authelia\n\n# Enable and start service\nsudo systemctl enable --now authelia\n\n# Verify installation\nauthelia --version\n```\n\n### Alpine Linux\n\n```bash\n# Install authelia\napk add --no-cache authelia\n\n# Enable and start service\nrc-update add authelia default\nrc-service authelia start\n\n# Verify installation\nauthelia --version\n```\n\n### openSUSE/SLES\n\n```bash\n# Install authelia\nsudo zypper install -y authelia\n\n# Enable and start service\nsudo systemctl enable --now authelia\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=9091/tcp\nsudo firewall-cmd --reload\n\n# Verify installation\nauthelia --version\n```\n\n### macOS\n\n```bash\n# Using Homebrew\nbrew install authelia\n\n# Start service\nbrew services start authelia\n\n# Verify installation\nauthelia --version\n```\n\n### FreeBSD\n\n```bash\n# Using pkg\npkg install authelia\n\n# Enable in rc.conf\necho 'authelia_enable=\"YES\"' \u003e\u003e /etc/rc.conf\n\n# Start service\nservice authelia start\n\n# Verify installation\nauthelia --version\n```\n\n### Windows\n\n```bash\n# Using Chocolatey\nchoco install authelia\n\n# Or using Scoop\nscoop install authelia\n\n# Verify installation\nauthelia --version\n```\n\n## Initial Configuration\n\n### Basic Configuration\n\n```bash\n# Create configuration directory\nsudo mkdir -p /etc/authelia\n\n# Set up basic configuration\n# See official documentation for detailed configuration options\n\n# Test configuration\nauthelia --version\n```\n\n## Service Management\n\n### systemd (RHEL, Debian, Ubuntu, Arch, openSUSE)\n\n```bash\n# Enable service\nsudo systemctl enable authelia\n\n# Start service\nsudo systemctl start authelia\n\n# Stop service\nsudo systemctl stop authelia\n\n# Restart service\nsudo systemctl restart authelia\n\n# Check status\nsudo systemctl status authelia\n\n# View logs\nsudo journalctl -u authelia -f\n```\n\n### OpenRC (Alpine Linux)\n\n```bash\n# Enable service\nrc-update add authelia default\n\n# Start service\nrc-service authelia start\n\n# Stop service\nrc-service authelia stop\n\n# Restart service\nrc-service authelia restart\n\n# Check status\nrc-service authelia status\n```\n\n### rc.d (FreeBSD)\n\n```bash\n# Enable in /etc/rc.conf\necho 'authelia_enable=\"YES\"' \u003e\u003e /etc/rc.conf\n\n# Start service\nservice authelia start\n\n# Stop service\nservice authelia stop\n\n# Restart service\nservice authelia restart\n\n# Check status\nservice authelia status\n```\n\n### launchd (macOS)\n\n```bash\n# Using Homebrew services\nbrew services start authelia\nbrew services stop authelia\nbrew services restart authelia\n\n# Check status\nbrew services list | grep authelia\n```\n\n### Windows Service Manager\n\n```powershell\n# Start service\nnet start authelia\n\n# Stop service\nnet stop authelia\n\n# Using PowerShell\nStart-Service authelia\nStop-Service authelia\nRestart-Service authelia\n\n# Check status\nGet-Service authelia\n```\n\n## Advanced Configuration\n\nSee the official documentation for advanced configuration options.\n\n## Reverse Proxy Setup\n\n### nginx Configuration\n\n```nginx\nupstream authelia_backend {\n    server 127.0.0.1:9091;\n}\n\nserver {\n    listen 80;\n    server_name authelia.example.com;\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name authelia.example.com;\n\n    ssl_certificate /etc/ssl/certs/authelia.example.com.crt;\n    ssl_certificate_key /etc/ssl/private/authelia.example.com.key;\n\n    location / {\n        proxy_pass http://authelia_backend;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n```\n\n### Apache Configuration\n\n```apache\n\u003cVirtualHost *:80\u003e\n    ServerName authelia.example.com\n    Redirect permanent / https://authelia.example.com/\n\u003c/VirtualHost\u003e\n\n\u003cVirtualHost *:443\u003e\n    ServerName authelia.example.com\n    \n    SSLEngine on\n    SSLCertificateFile /etc/ssl/certs/authelia.example.com.crt\n    SSLCertificateKeyFile /etc/ssl/private/authelia.example.com.key\n    \n    ProxyRequests Off\n    ProxyPreserveHost On\n    \n    ProxyPass / http://127.0.0.1:9091/\n    ProxyPassReverse / http://127.0.0.1:9091/\n\u003c/VirtualHost\u003e\n```\n\n### HAProxy Configuration\n\n```haproxy\nfrontend authelia_frontend\n    bind *:80\n    bind *:443 ssl crt /etc/ssl/certs/authelia.pem\n    redirect scheme https if !{ ssl_fc }\n    default_backend authelia_backend\n\nbackend authelia_backend\n    balance roundrobin\n    server authelia1 127.0.0.1:9091 check\n```\n\n## Security Configuration\n\n### Basic Security Setup\n\n```bash\n# Set appropriate permissions\nsudo chown -R authelia:authelia /etc/authelia\nsudo chmod 750 /etc/authelia\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=9091/tcp\nsudo firewall-cmd --reload\n\n# Enable SELinux policies (if applicable)\nsudo setsebool -P httpd_can_network_connect on\n```\n\n## Database Setup\n\nSee official documentation for database configuration requirements.\n\n## Performance Optimization\n\n### System Tuning\n\n```bash\n# Basic system tuning\necho 'net.core.somaxconn = 65535' | sudo tee -a /etc/sysctl.conf\necho 'net.ipv4.tcp_max_syn_backlog = 65535' | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\n```\n\n## Monitoring\n\n### Basic Monitoring\n\n```bash\n# Check service status\nsudo systemctl status authelia\n\n# View logs\nsudo journalctl -u authelia -f\n\n# Monitor resource usage\ntop -p $(pgrep authelia)\n```\n\n## Backup and Restore\n\n### Backup Script\n\n```bash\n#!/bin/bash\n# Basic backup script\nBACKUP_DIR=\"/backup/authelia\"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p \"$BACKUP_DIR\"\ntar -czf \"$BACKUP_DIR/authelia-backup-$DATE.tar.gz\" /etc/authelia /var/lib/authelia\n\necho \"Backup completed: $BACKUP_DIR/authelia-backup-$DATE.tar.gz\"\n```\n\n### Restore Procedure\n\n```bash\n# Stop service\nsudo systemctl stop authelia\n\n# Restore from backup\ntar -xzf /backup/authelia/authelia-backup-*.tar.gz -C /\n\n# Start service\nsudo systemctl start authelia\n```\n\n## Troubleshooting\n\n### Common Issues\n\n1. **Service won't start**:\n```bash\n# Check logs\nsudo journalctl -u authelia -n 100\nsudo tail -f /var/log/authelia/authelia.log\n\n# Check configuration\nauthelia --version\n\n# Check permissions\nls -la /etc/authelia\n```\n\n2. **Connection issues**:\n```bash\n# Check if service is listening\nsudo ss -tlnp | grep 9091\n\n# Test connectivity\ntelnet localhost 9091\n\n# Check firewall\nsudo firewall-cmd --list-all\n```\n\n3. **Performance issues**:\n```bash\n# Check resource usage\ntop -p $(pgrep authelia)\n\n# Check disk I/O\niotop -p $(pgrep authelia)\n\n# Check connections\nss -an | grep 9091\n```\n\n## Integration Examples\n\n### Docker Compose Example\n\n```yaml\nversion: '3.8'\nservices:\n  authelia:\n    image: authelia:latest\n    ports:\n      - \"9091:9091\"\n    volumes:\n      - ./config:/etc/authelia\n      - ./data:/var/lib/authelia\n    restart: unless-stopped\n```\n\n## Maintenance\n\n### Update Procedures\n\n```bash\n# RHEL/CentOS/Rocky/AlmaLinux\nsudo dnf update authelia\n\n# Debian/Ubuntu\nsudo apt update \u0026\u0026 sudo apt upgrade authelia\n\n# Arch Linux\nsudo pacman -Syu authelia\n\n# Alpine Linux\napk update \u0026\u0026 apk upgrade authelia\n\n# openSUSE\nsudo zypper update authelia\n\n# FreeBSD\npkg update \u0026\u0026 pkg upgrade authelia\n\n# Always backup before updates\ntar -czf /backup/authelia-pre-update-$(date +%Y%m%d).tar.gz /etc/authelia\n\n# Restart after updates\nsudo systemctl restart authelia\n```\n\n### Regular Maintenance\n\n```bash\n# Log rotation\nsudo logrotate -f /etc/logrotate.d/authelia\n\n# Clean old logs\nfind /var/log/authelia -name \"*.log\" -mtime +30 -delete\n\n# Check disk usage\ndu -sh /var/lib/authelia\n```\n\n## Additional Resources\n\n- Official Documentation: https://docs.authelia.org/\n- GitHub Repository: https://github.com/authelia/authelia\n- Community Forum: https://forum.authelia.org/\n- Best Practices Guide: https://docs.authelia.org/best-practices\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection. Always refer to official documentation for the most up-to-date information.\n","readmeHtml":"\u003ch1 id=\"authelia-installation-guide\" class=\"mobile-header\"\u003eauthelia Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eauthelia is a free and open-source authentication and authorization server. Authelia provides 2FA and SSO for your applications via a web portal, serving as an open-source alternative to Auth0 or Okta\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eHardware Requirements\u003c/strong\u003e:\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eCPU: 1 core minimum\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRAM: 512MB minimum\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eStorage: 100MB for installation\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eNetwork: HTTPS for authentication\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOperating System\u003c/strong\u003e: \u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux: Any modern distribution (RHEL, Debian, Ubuntu, CentOS, Fedora, Arch, Alpine, openSUSE)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003emacOS: 10.14+ (Mojave or newer)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eWindows: Windows Server 2016+ or Windows 10\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFreeBSD: 11.0+\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork Requirements\u003c/strong\u003e:\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003ePort 9091 (default authelia port)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eLDAP backend if used\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDependencies\u003c/strong\u003e:\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eSee official documentation for specific requirements\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSystem Access\u003c/strong\u003e: root or sudo privileges required\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"rhelcentosrocky-linuxalmalinux\" class=\"mobile-header\"\u003eRHEL/CentOS/Rocky Linux/AlmaLinux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install EPEL repository if needed\nsudo dnf install -y epel-release\n\n# Install authelia\nsudo dnf install -y authelia\n\n# Enable and start service\nsudo systemctl enable --now authelia\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=9091/tcp\nsudo firewall-cmd --reload\n\n# Verify installation\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"debianubuntu\" class=\"mobile-header\"\u003eDebian/Ubuntu\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update package index\nsudo apt update\n\n# Install authelia\nsudo apt install -y authelia\n\n# Enable and start service\nsudo systemctl enable --now authelia\n\n# Configure firewall\nsudo ufw allow 9091\n\n# Verify installation\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"arch-linux\" class=\"mobile-header\"\u003eArch Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install authelia\nsudo pacman -S authelia\n\n# Enable and start service\nsudo systemctl enable --now authelia\n\n# Verify installation\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"alpine-linux\" class=\"mobile-header\"\u003eAlpine Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install authelia\napk add --no-cache authelia\n\n# Enable and start service\nrc-update add authelia default\nrc-service authelia start\n\n# Verify installation\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"opensusesles\" class=\"mobile-header\"\u003eopenSUSE/SLES\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install authelia\nsudo zypper install -y authelia\n\n# Enable and start service\nsudo systemctl enable --now authelia\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=9091/tcp\nsudo firewall-cmd --reload\n\n# Verify installation\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"macos\" class=\"mobile-header\"\u003emacOS\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Using Homebrew\nbrew install authelia\n\n# Start service\nbrew services start authelia\n\n# Verify installation\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"freebsd\" class=\"mobile-header\"\u003eFreeBSD\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Using pkg\npkg install authelia\n\n# Enable in rc.conf\necho \u0026#039;authelia_enable=\u0026quot;YES\u0026quot;\u0026#039; \u0026gt;\u0026gt; /etc/rc.conf\n\n# Start service\nservice authelia start\n\n# Verify installation\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"windows\" class=\"mobile-header\"\u003eWindows\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Using Chocolatey\nchoco install authelia\n\n# Or using Scoop\nscoop install authelia\n\n# Verify installation\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"initial-configuration\" class=\"mobile-header\"\u003eInitial Configuration\u003c/h2\u003e\n\u003ch3 id=\"basic-configuration\" class=\"mobile-header\"\u003eBasic Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create configuration directory\nsudo mkdir -p /etc/authelia\n\n# Set up basic configuration\n# See official documentation for detailed configuration options\n\n# Test configuration\nauthelia --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"service-management\" class=\"mobile-header\"\u003eService Management\u003c/h2\u003e\n\u003ch3 id=\"systemd-rhel-debian-ubuntu-arch-opensuse\" class=\"mobile-header\"\u003esystemd (RHEL, Debian, Ubuntu, Arch, openSUSE)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable service\nsudo systemctl enable authelia\n\n# Start service\nsudo systemctl start authelia\n\n# Stop service\nsudo systemctl stop authelia\n\n# Restart service\nsudo systemctl restart authelia\n\n# Check status\nsudo systemctl status authelia\n\n# View logs\nsudo journalctl -u authelia -f\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"openrc-alpine-linux\" class=\"mobile-header\"\u003eOpenRC (Alpine Linux)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable service\nrc-update add authelia default\n\n# Start service\nrc-service authelia start\n\n# Stop service\nrc-service authelia stop\n\n# Restart service\nrc-service authelia restart\n\n# Check status\nrc-service authelia status\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"rcd-freebsd\" class=\"mobile-header\"\u003erc.d (FreeBSD)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable in /etc/rc.conf\necho \u0026#039;authelia_enable=\u0026quot;YES\u0026quot;\u0026#039; \u0026gt;\u0026gt; /etc/rc.conf\n\n# Start service\nservice authelia start\n\n# Stop service\nservice authelia stop\n\n# Restart service\nservice authelia restart\n\n# Check status\nservice authelia status\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"launchd-macos\" class=\"mobile-header\"\u003elaunchd (macOS)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Using Homebrew services\nbrew services start authelia\nbrew services stop authelia\nbrew services restart authelia\n\n# Check status\nbrew services list | grep authelia\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"windows-service-manager\" class=\"mobile-header\"\u003eWindows Service Manager\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"powershell\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003epowershell\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-powershell\"\u003e# Start service\nnet start authelia\n\n# Stop service\nnet stop authelia\n\n# Using PowerShell\nStart-Service authelia\nStop-Service authelia\nRestart-Service authelia\n\n# Check status\nGet-Service authelia\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"advanced-configuration\" class=\"mobile-header\"\u003eAdvanced Configuration\u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eSee the official documentation for advanced configuration options.\u003c/p\u003e\n\u003ch2 id=\"reverse-proxy-setup\" class=\"mobile-header\"\u003eReverse Proxy Setup\u003c/h2\u003e\n\u003ch3 id=\"nginx-configuration\" class=\"mobile-header\"\u003enginx Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"nginx\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003enginx\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-nginx\"\u003eupstream authelia_backend {\n    server 127.0.0.1:9091;\n}\n\nserver {\n    listen 80;\n    server_name authelia.example.com;\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name authelia.example.com;\n\n    ssl_certificate /etc/ssl/certs/authelia.example.com.crt;\n    ssl_certificate_key /etc/ssl/private/authelia.example.com.key;\n\n    location / {\n        proxy_pass http://authelia_backend;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"apache-configuration\" class=\"mobile-header\"\u003eApache Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"apache\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eapache\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-apache\"\u003e\u0026lt;VirtualHost *:80\u0026gt;\n    ServerName authelia.example.com\n    Redirect permanent / https://authelia.example.com/\n\u0026lt;/VirtualHost\u0026gt;\n\n\u0026lt;VirtualHost *:443\u0026gt;\n    ServerName authelia.example.com\n    \n    SSLEngine on\n    SSLCertificateFile /etc/ssl/certs/authelia.example.com.crt\n    SSLCertificateKeyFile /etc/ssl/private/authelia.example.com.key\n    \n    ProxyRequests Off\n    ProxyPreserveHost On\n    \n    ProxyPass / http://127.0.0.1:9091/\n    ProxyPassReverse / http://127.0.0.1:9091/\n\u0026lt;/VirtualHost\u0026gt;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"haproxy-configuration\" class=\"mobile-header\"\u003eHAProxy Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"haproxy\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ehaproxy\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-haproxy\"\u003efrontend authelia_frontend\n    bind *:80\n    bind *:443 ssl crt /etc/ssl/certs/authelia.pem\n    redirect scheme https if !{ ssl_fc }\n    default_backend authelia_backend\n\nbackend authelia_backend\n    balance roundrobin\n    server authelia1 127.0.0.1:9091 check\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"security-configuration\" class=\"mobile-header\"\u003eSecurity Configuration\u003c/h2\u003e\n\u003ch3 id=\"basic-security-setup\" class=\"mobile-header\"\u003eBasic Security Setup\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Set appropriate permissions\nsudo chown -R authelia:authelia /etc/authelia\nsudo chmod 750 /etc/authelia\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-port=9091/tcp\nsudo firewall-cmd --reload\n\n# Enable SELinux policies (if applicable)\nsudo setsebool -P httpd_can_network_connect on\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"database-setup\" class=\"mobile-header\"\u003eDatabase Setup\u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eSee official documentation for database configuration requirements.\u003c/p\u003e\n\u003ch2 id=\"performance-optimization\" class=\"mobile-header\"\u003ePerformance Optimization\u003c/h2\u003e\n\u003ch3 id=\"system-tuning\" class=\"mobile-header\"\u003eSystem Tuning\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Basic system tuning\necho \u0026#039;net.core.somaxconn = 65535\u0026#039; | sudo tee -a /etc/sysctl.conf\necho \u0026#039;net.ipv4.tcp_max_syn_backlog = 65535\u0026#039; | sudo tee -a /etc/sysctl.conf\nsudo sysctl -p\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"monitoring\" class=\"mobile-header\"\u003eMonitoring\u003c/h2\u003e\n\u003ch3 id=\"basic-monitoring\" class=\"mobile-header\"\u003eBasic Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check service status\nsudo systemctl status authelia\n\n# View logs\nsudo journalctl -u authelia -f\n\n# Monitor resource usage\ntop -p $(pgrep authelia)\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-and-restore\" class=\"mobile-header\"\u003eBackup and Restore\u003c/h2\u003e\n\u003ch3 id=\"backup-script\" class=\"mobile-header\"\u003eBackup Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/bin/bash\n# Basic backup script\nBACKUP_DIR=\u0026quot;/backup/authelia\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p \u0026quot;$BACKUP_DIR\u0026quot;\ntar -czf \u0026quot;$BACKUP_DIR/authelia-backup-$DATE.tar.gz\u0026quot; /etc/authelia /var/lib/authelia\n\necho \u0026quot;Backup completed: $BACKUP_DIR/authelia-backup-$DATE.tar.gz\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"restore-procedure\" class=\"mobile-header\"\u003eRestore Procedure\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Stop service\nsudo systemctl stop authelia\n\n# Restore from backup\ntar -xzf /backup/authelia/authelia-backup-*.tar.gz -C /\n\n# Start service\nsudo systemctl start authelia\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting\" class=\"mobile-header\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues\" class=\"mobile-header\"\u003eCommon Issues\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e1. \u003cstrong\u003eService won't start\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check logs\nsudo journalctl -u authelia -n 100\nsudo tail -f /var/log/authelia/authelia.log\n\n# Check configuration\nauthelia --version\n\n# Check permissions\nls -la /etc/authelia\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e2. \u003cstrong\u003eConnection issues\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check if service is listening\nsudo ss -tlnp | grep 9091\n\n# Test connectivity\ntelnet localhost 9091\n\n# Check firewall\nsudo firewall-cmd --list-all\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e3. \u003cstrong\u003ePerformance issues\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check resource usage\ntop -p $(pgrep authelia)\n\n# Check disk I/O\niotop -p $(pgrep authelia)\n\n# Check connections\nss -an | grep 9091\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"integration-examples\" class=\"mobile-header\"\u003eIntegration Examples\u003c/h2\u003e\n\u003ch3 id=\"docker-compose-example\" class=\"mobile-header\"\u003eDocker Compose Example\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"yaml\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eyaml\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-yaml\"\u003eversion: \u0026#039;3.8\u0026#039;\nservices:\n  authelia:\n    image: authelia:latest\n    ports:\n      - \u0026quot;9091:9091\u0026quot;\n    volumes:\n      - ./config:/etc/authelia\n      - ./data:/var/lib/authelia\n    restart: unless-stopped\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"maintenance\" class=\"mobile-header\"\u003eMaintenance\u003c/h2\u003e\n\u003ch3 id=\"update-procedures\" class=\"mobile-header\"\u003eUpdate Procedures\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# RHEL/CentOS/Rocky/AlmaLinux\nsudo dnf update authelia\n\n# Debian/Ubuntu\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade authelia\n\n# Arch Linux\nsudo pacman -Syu authelia\n\n# Alpine Linux\napk update \u0026amp;\u0026amp; apk upgrade authelia\n\n# openSUSE\nsudo zypper update authelia\n\n# FreeBSD\npkg update \u0026amp;\u0026amp; pkg upgrade authelia\n\n# Always backup before updates\ntar -czf /backup/authelia-pre-update-$(date +%Y%m%d).tar.gz /etc/authelia\n\n# Restart after updates\nsudo systemctl restart authelia\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"regular-maintenance\" class=\"mobile-header\"\u003eRegular Maintenance\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Log rotation\nsudo logrotate -f /etc/logrotate.d/authelia\n\n# Clean old logs\nfind /var/log/authelia -name \u0026quot;*.log\u0026quot; -mtime +30 -delete\n\n# Check disk usage\ndu -sh /var/lib/authelia\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003eOfficial Documentation: https://docs.authelia.org/\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eGitHub Repository: https://github.com/authelia/authelia\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eCommunity Forum: https://forum.authelia.org/\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eBest Practices Guide: https://docs.authelia.org/best-practices\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection. Always refer to official documentation for the most up-to-date information.\u003c/p\u003e","readTime":"6 min","wordCount":1173,"lastBuilt":"2025-09-16T02:44:44.824Z"},{"name":"fail2ban","displayName":"Fail2ban","slug":"fail2ban","description":"Repo for fail2ban","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/fail2ban","updatedAt":"2025-09-16T02:36:26Z","createdAt":"2025-09-08T03:07:24Z","readmeRaw":"# Fail2ban Installation Guide\n\nFail2ban is a free and open-source intrusion prevention software framework that protects servers from brute-force attacks. Written in Python, it monitors log files and bans IP addresses that show malicious signs such as too many password failures or seeking exploits. It serves as a powerful FOSS alternative to commercial security solutions like Cloudflare Rate Limiting, AWS WAF, or proprietary IPS systems, providing enterprise-grade protection without licensing costs or vendor lock-in.\n\n## Prerequisites\n\n- **Hardware Requirements**:\n  - CPU: 1 core minimum (2+ cores recommended for high-traffic servers)\n  - RAM: 512MB minimum (1GB+ recommended)\n  - Storage: 100MB for installation, plus log storage\n  - Network: Stable connectivity for updates\n- **Operating System**: \n  - Linux: Any modern distribution with systemd or init\n  - macOS: 10.14+ (limited support)\n  - Windows: WSL2 with Linux distribution\n  - FreeBSD: 11.0+\n- **Network Requirements**:\n  - Firewall access (iptables, nftables, pf, or ipfw)\n  - Root access to modify firewall rules\n- **Dependencies**:\n  - Python 3.5+ (3.8+ recommended)\n  - iptables, nftables, or equivalent firewall\n  - systemd or init system\n  - Log files to monitor (sshd, nginx, apache, etc.)\n- **System Access**: root or sudo privileges required\n\n## Installation\n\n### RHEL/CentOS/Rocky Linux/AlmaLinux\n\n```bash\n# Install EPEL repository\nsudo dnf install -y epel-release\n\n# Install fail2ban\nsudo dnf install -y fail2ban fail2ban-systemd\n\n# Install additional dependencies\nsudo dnf install -y python3-systemd python3-pyinotify\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nfail2ban-client --version\nsudo systemctl status fail2ban\n```\n\n### Debian/Ubuntu\n\n```bash\n# Update package index\nsudo apt update\n\n# Install fail2ban\nsudo apt install -y fail2ban\n\n# Install additional tools\nsudo apt install -y python3-systemd python3-pyinotify iptables-persistent\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nfail2ban-client --version\nsudo systemctl status fail2ban\n```\n\n### Arch Linux\n\n```bash\n# Install fail2ban\nsudo pacman -S fail2ban\n\n# Install additional dependencies\nsudo pacman -S python-systemd python-pyinotify\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nfail2ban-client --version\n```\n\n### Alpine Linux\n\n```bash\n# Install fail2ban\napk add --no-cache fail2ban fail2ban-openrc\n\n# Install additional dependencies\napk add --no-cache py3-systemd iptables ip6tables\n\n# Enable and start service\nrc-update add fail2ban default\nrc-service fail2ban start\n\n# Verify installation\nfail2ban-client --version\n```\n\n### openSUSE/SLES\n\n```bash\n# openSUSE Leap/Tumbleweed\nsudo zypper install -y fail2ban python3-systemd\n\n# SLES 15\nsudo SUSEConnect -p sle-module-basesystem/15.5/x86_64\nsudo zypper install -y fail2ban\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-service=fail2ban\nsudo firewall-cmd --reload\n\n# Verify installation\nfail2ban-client --version\n```\n\n### macOS\n\n```bash\n# Using Homebrew\nbrew install fail2ban\n\n# Copy configuration files\nsudo cp /usr/local/etc/fail2ban/fail2ban.conf /usr/local/etc/fail2ban/fail2ban.local\nsudo cp /usr/local/etc/fail2ban/jail.conf /usr/local/etc/fail2ban/jail.local\n\n# Start service\nsudo brew services start fail2ban\n\n# Verify installation\nfail2ban-client --version\n```\n\n### FreeBSD\n\n```bash\n# Using pkg\npkg install py39-fail2ban\n\n# Enable in rc.conf\necho 'fail2ban_enable=\"YES\"' \u003e\u003e /etc/rc.conf\n\n# Copy configuration\ncp /usr/local/etc/fail2ban/fail2ban.conf /usr/local/etc/fail2ban/fail2ban.local\ncp /usr/local/etc/fail2ban/jail.conf /usr/local/etc/fail2ban/jail.local\n\n# Start service\nservice fail2ban start\n\n# Verify installation\nfail2ban-client --version\n```\n\n### Windows (WSL2)\n\n```powershell\n# Install WSL2 with Ubuntu\nwsl --install -d Ubuntu-22.04\n\n# Inside WSL2 Ubuntu\nsudo apt update\nsudo apt install -y fail2ban\n\n# Configure for Windows logs monitoring\n# Note: Limited functionality - primarily for learning/testing\n\n# Verify installation\nfail2ban-client --version\n```\n\n## Initial Configuration\n\n### Basic Configuration\n\n```bash\n# Create local configuration files (never edit .conf files directly)\nsudo cp /etc/fail2ban/fail2ban.conf /etc/fail2ban/fail2ban.local\nsudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local\n\n# Edit main configuration\nsudo tee /etc/fail2ban/fail2ban.local \u003c\u003cEOF\n[Definition]\nloglevel = INFO\nlogtarget = /var/log/fail2ban.log\nsyslogsocket = auto\nsocket = /var/run/fail2ban/fail2ban.sock\npidfile = /var/run/fail2ban/fail2ban.pid\ndbfile = /var/lib/fail2ban/fail2ban.sqlite3\ndbpurgeage = 1d\nEOF\n\n# Configure basic jail settings\nsudo tee /etc/fail2ban/jail.local \u003c\u003cEOF\n[DEFAULT]\n# Ban duration (in seconds)\nbantime = 3600\n# Time window for maxretry\nfindtime = 600\n# Number of failures before ban\nmaxretry = 5\n# Email notifications\ndestemail = admin@example.com\nsender = fail2ban@example.com\nmta = sendmail\n# Action to take\naction = %(action_mwl)s\n\n# Whitelist\nignoreip = 127.0.0.1/8 ::1 192.168.0.0/16\n\n[sshd]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 3600\n\n[nginx-http-auth]\nenabled = true\nfilter = nginx-http-auth\nport = http,https\nlogpath = /var/log/nginx/error.log\n\n[nginx-limit-req]\nenabled = true\nfilter = nginx-limit-req\nport = http,https\nlogpath = /var/log/nginx/error.log\nmaxretry = 10\nfindtime = 60\nbantime = 600\n\n[apache-auth]\nenabled = false\nport = http,https\nfilter = apache-auth\nlogpath = /var/log/apache*/*error.log\nmaxretry = 6\n\n[postfix]\nenabled = false\nport = smtp,465,submission\nfilter = postfix\nlogpath = /var/log/mail.log\nEOF\n\n# Restart fail2ban\nsudo systemctl restart fail2ban\n```\n\n### Custom Jail Configuration\n\n```bash\n# Create custom filter for application\nsudo tee /etc/fail2ban/filter.d/myapp.conf \u003c\u003cEOF\n[Definition]\nfailregex = ^\u003cHOST\u003e - - \\[.*\\] \"POST /login HTTP/.*\" 401\n            ^Failed login from \u003cHOST\u003e\n            ^Authentication failure for .* from \u003cHOST\u003e\nignoreregex =\nEOF\n\n# Create jail for custom application\nsudo tee -a /etc/fail2ban/jail.local \u003c\u003cEOF\n\n[myapp]\nenabled = true\nfilter = myapp\nport = 8080\nlogpath = /var/log/myapp/access.log\nmaxretry = 3\nbantime = 3600\nfindtime = 300\nEOF\n```\n\n## Service Management\n\n### systemd (RHEL, Debian, Ubuntu, Arch, openSUSE)\n\n```bash\n# Enable service\nsudo systemctl enable fail2ban\n\n# Start service\nsudo systemctl start fail2ban\n\n# Stop service\nsudo systemctl stop fail2ban\n\n# Restart service\nsudo systemctl restart fail2ban\n\n# Reload configuration\nsudo systemctl reload fail2ban\n\n# Check status\nsudo systemctl status fail2ban\n\n# View logs\nsudo journalctl -u fail2ban -f\n```\n\n### OpenRC (Alpine Linux)\n\n```bash\n# Enable service\nrc-update add fail2ban default\n\n# Start service\nrc-service fail2ban start\n\n# Stop service\nrc-service fail2ban stop\n\n# Restart service\nrc-service fail2ban restart\n\n# Check status\nrc-service fail2ban status\n\n# View logs\ntail -f /var/log/fail2ban.log\n```\n\n### rc.d (FreeBSD)\n\n```bash\n# Enable in rc.conf\necho 'fail2ban_enable=\"YES\"' \u003e\u003e /etc/rc.conf\n\n# Start service\nservice fail2ban start\n\n# Stop service\nservice fail2ban stop\n\n# Restart service\nservice fail2ban restart\n\n# Check status\nservice fail2ban status\n```\n\n### launchd (macOS)\n\n```bash\n# Using brew services\nbrew services start fail2ban\nbrew services stop fail2ban\nbrew services restart fail2ban\n\n# Check status\nbrew services list | grep fail2ban\n\n# Manual control\nsudo /usr/local/bin/fail2ban-client start\nsudo /usr/local/bin/fail2ban-client stop\n```\n\n## Advanced Configuration\n\n### Multi-Service Protection\n\n```bash\n# Comprehensive jail configuration\nsudo tee /etc/fail2ban/jail.d/multi-service.conf \u003c\u003cEOF\n# SSH Protection\n[sshd]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 3600\nfindtime = 600\n\n[sshd-ddos]\nenabled = true\nport = ssh\nfilter = sshd-ddos\nlogpath = /var/log/auth.log\nmaxretry = 10\nbantime = 600\nfindtime = 60\n\n# Web Server Protection\n[nginx-http-auth]\nenabled = true\nfilter = nginx-http-auth\nport = http,https\nlogpath = /var/log/nginx/error.log\nmaxretry = 3\n\n[nginx-noscript]\nenabled = true\nport = http,https\nfilter = nginx-noscript\nlogpath = /var/log/nginx/access.log\nmaxretry = 5\n\n[nginx-badbots]\nenabled = true\nport = http,https\nfilter = nginx-badbots\nlogpath = /var/log/nginx/access.log\nmaxretry = 2\nbantime = 86400\n\n[nginx-noproxy]\nenabled = true\nport = http,https\nfilter = nginx-noproxy\nlogpath = /var/log/nginx/access.log\nmaxretry = 2\n\n# Database Protection\n[mysqld-auth]\nenabled = true\nfilter = mysqld-auth\nport = 3306\nlogpath = /var/log/mysql/error.log\nmaxretry = 5\n\n[postgresql]\nenabled = true\nport = 5432\nfilter = postgresql\nlogpath = /var/log/postgresql/*.log\nmaxretry = 5\n\n# Mail Server Protection\n[postfix]\nenabled = true\nport = smtp,465,submission\nfilter = postfix\nlogpath = /var/log/mail.log\n\n[postfix-sasl]\nenabled = true\nport = smtp,465,submission,imap,imaps,pop3,pop3s\nfilter = postfix-sasl\nlogpath = /var/log/mail.log\n\n[dovecot]\nenabled = true\nport = pop3,pop3s,imap,imaps,submission,465,sieve\nfilter = dovecot\nlogpath = /var/log/mail.log\nEOF\n```\n\n### GeoIP Blocking\n\n```bash\n# Install GeoIP database\nsudo apt install geoip-database geoip-bin  # Debian/Ubuntu\nsudo dnf install GeoIP GeoIP-data         # RHEL/CentOS\n\n# Create GeoIP action\nsudo tee /etc/fail2ban/action.d/geoip-block.conf \u003c\u003cEOF\n[Definition]\nactionstart = \nactionstop = \nactioncheck = \nactionban = if [ \"\\$(geoiplookup \u003cip\u003e | grep -v 'US\\|CA\\|GB')\" ]; then iptables -I f2b-\u003cname\u003e 1 -s \u003cip\u003e -j DROP; fi\nactionunban = iptables -D f2b-\u003cname\u003e -s \u003cip\u003e -j DROP\nEOF\n\n# Use in jail\nsudo tee -a /etc/fail2ban/jail.local \u003c\u003cEOF\n\n[sshd-geoip]\nenabled = true\nfilter = sshd\naction = geoip-block[name=%(__name__)s]\nlogpath = /var/log/auth.log\nmaxretry = 3\nEOF\n```\n\n### Persistent Bans\n\n```bash\n# Create persistent ban action\nsudo tee /etc/fail2ban/action.d/iptables-persistent.conf \u003c\u003cEOF\n[Definition]\nactionstart = iptables -N f2b-\u003cname\u003e\n              iptables -A f2b-\u003cname\u003e -j RETURN\n              iptables -I \u003cchain\u003e -p \u003cprotocol\u003e --dport \u003cport\u003e -j f2b-\u003cname\u003e\n              # Load persistent bans\n              [ -f /etc/fail2ban/persistent/\u003cname\u003e.bans ] \u0026\u0026 while read ip; do iptables -I f2b-\u003cname\u003e 1 -s \\$ip -j DROP; done \u003c /etc/fail2ban/persistent/\u003cname\u003e.bans\n\nactionstop = iptables -D \u003cchain\u003e -p \u003cprotocol\u003e --dport \u003cport\u003e -j f2b-\u003cname\u003e\n             iptables -F f2b-\u003cname\u003e\n             iptables -X f2b-\u003cname\u003e\n\nactionban = iptables -I f2b-\u003cname\u003e 1 -s \u003cip\u003e -j DROP\n            echo '\u003cip\u003e' \u003e\u003e /etc/fail2ban/persistent/\u003cname\u003e.bans\n            sort -u /etc/fail2ban/persistent/\u003cname\u003e.bans -o /etc/fail2ban/persistent/\u003cname\u003e.bans\n\nactionunban = iptables -D f2b-\u003cname\u003e -s \u003cip\u003e -j DROP\n              sed -i '/\u003cip\u003e/d' /etc/fail2ban/persistent/\u003cname\u003e.bans\nEOF\n\n# Create directory for persistent bans\nsudo mkdir -p /etc/fail2ban/persistent\n```\n\n## Reverse Proxy Setup\n\n### nginx Reverse Proxy Configuration\n\n```nginx\n# /etc/nginx/conf.d/fail2ban.conf\n# Pass real IP to backend for fail2ban processing\n\nmap $remote_addr $proxy_forwarded_elem {\n    ~^[0-9.]+$          \"for=$remote_addr\";\n    ~^[0-9A-Fa-f:.]+$   \"for=\\\"[$remote_addr]\\\"\";\n    default             \"for=unknown\";\n}\n\nmap $http_forwarded $proxy_add_forwarded {\n    \"\"      \"$proxy_forwarded_elem\";\n    default \"$http_forwarded, $proxy_forwarded_elem\";\n}\n\nserver {\n    listen 80;\n    server_name app.example.com;\n\n    location / {\n        proxy_pass http://backend;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Forwarded $proxy_add_forwarded;\n        \n        # Rate limiting\n        limit_req zone=app_limit burst=10 nodelay;\n        limit_req_status 429;\n    }\n}\n\n# Define rate limit zone\nlimit_req_zone $binary_remote_addr zone=app_limit:10m rate=10r/s;\n```\n\n### HAProxy Configuration\n\n```haproxy\n# /etc/haproxy/haproxy.cfg\nglobal\n    log /dev/log local0\n    log /dev/log local1 notice\n\ndefaults\n    log global\n    option httplog\n    option forwardfor\n\nfrontend web_frontend\n    bind *:80\n    bind *:443 ssl crt /etc/ssl/certs/cert.pem\n    \n    # Track abusive behavior\n    stick-table type ip size 100k expire 30m store conn_rate(3s),conn_cur,http_req_rate(10s)\n    \n    # Block if connection rate exceeds limit\n    tcp-request connection reject if { src_conn_rate gt 20 }\n    tcp-request connection track-sc0 src\n    \n    # Block if HTTP request rate exceeds limit\n    http-request deny if { sc_http_req_rate(0) gt 20 }\n    \n    default_backend web_servers\n\nbackend web_servers\n    # Forward real IP for fail2ban\n    option forwardfor header X-Real-IP\n    server web1 192.168.1.10:80 check\n    server web2 192.168.1.11:80 check\n```\n\n### Apache Reverse Proxy\n\n```apache\n# /etc/apache2/sites-available/reverse-proxy.conf\n\u003cVirtualHost *:80\u003e\n    ServerName app.example.com\n    \n    # Enable required modules\n    # a2enmod proxy proxy_http remoteip\n    \n    # Trust proxy headers from load balancer\n    RemoteIPHeader X-Forwarded-For\n    RemoteIPTrustedProxy 10.0.0.0/8\n    \n    # Log real IP\n    LogFormat \"%a %l %u %t \\\"%r\\\" %\u003es %O \\\"%{Referer}i\\\" \\\"%{User-Agent}i\\\"\" proxy\n    CustomLog ${APACHE_LOG_DIR}/access.log proxy\n    \n    ProxyPass / http://backend/\n    ProxyPassReverse / http://backend/\n    \n    # Pass real IP to backend\n    ProxyPreserveHost On\n    RequestHeader set X-Real-IP \"%{REMOTE_ADDR}s\"\n    RequestHeader set X-Forwarded-For \"%{X-Forwarded-For}i\"\n\u003c/VirtualHost\u003e\n```\n\n## Security Configuration\n\n### Enhanced Security Rules\n\n```bash\n# Create comprehensive security configuration\nsudo tee /etc/fail2ban/jail.d/security-enhanced.conf \u003c\u003cEOF\n[DEFAULT]\n# Aggressive ban settings for security\nbantime = 86400    # 24 hours\nfindtime = 3600    # 1 hour window\nmaxretry = 3       # Low tolerance\nchain = INPUT      # iptables chain\nprotocol = tcp     # Default protocol\naction = %(action_mwl)s\n\n# Recidive jail for repeat offenders\n[recidive]\nenabled = true\nfilter = recidive\nlogpath = /var/log/fail2ban.log\nbantime = 604800   # 1 week\nfindtime = 86400   # 1 day\nmaxretry = 3\naction = iptables-allports[name=recidive, protocol=all]\n         sendmail-whois-lines[name=recidive, logpath=/var/log/fail2ban.log]\n\n# Port scanning detection\n[portscan]\nenabled = true\nfilter = portscan\nlogpath = /var/log/syslog\nmaxretry = 6\nbantime = 7200\naction = iptables-allports[name=portscan, protocol=all]\n\n# Block bad bots\n[apache-badbots]\nenabled = true\nport = http,https\nfilter = apache-badbots\nlogpath = /var/log/apache*/*access.log\nbantime = 172800   # 2 days\nmaxretry = 1\n\n# WordPress protection\n[wordpress]\nenabled = true\nfilter = wordpress\nport = http,https\nlogpath = /var/log/apache*/*access.log\nmaxretry = 3\nbantime = 3600\n\n# Aggressive SSH protection\n[sshd-aggressive]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 2\nbantime = 86400\nfindtime = 300\nEOF\n```\n\n### Custom Security Filters\n\n```bash\n# Create port scan detection filter\nsudo tee /etc/fail2ban/filter.d/portscan.conf \u003c\u003cEOF\n[Definition]\nfailregex = UFW BLOCK.* SRC=\u003cHOST\u003e\n            rejected connection: .* SRC=\u003cHOST\u003e\n            dropped: .* SRC=\u003cHOST\u003e\nignoreregex =\nEOF\n\n# Create WordPress attack filter\nsudo tee /etc/fail2ban/filter.d/wordpress.conf \u003c\u003cEOF\n[Definition]\nfailregex = ^\u003cHOST\u003e .* \"POST /wp-login.php\n            ^\u003cHOST\u003e .* \"POST /xmlrpc.php\n            ^\u003cHOST\u003e .* \"GET /wp-admin/ HTTP/[0-9.]+\" 403\n            ^\u003cHOST\u003e .* \"GET /wp-content/.*/.*\\.php HTTP/[0-9.]+\" \nignoreregex = ^\u003cHOST\u003e .* \"GET /wp-admin/admin-ajax.php\nEOF\n\n# Create bad bot filter\nsudo tee /etc/fail2ban/filter.d/badbots.conf \u003c\u003cEOF\n[Definition]\nbadbotscustom = EmailCollector|WebEMailExtrac|TrackBack/1\\.02|sogou music spider|(?:Mozilla/\\d+\\.0\\s+)$\nbadbots = Atomic_Email_Hunter/4\\.0|atSpider/1\\.0|autoemailspider|bwh3_user_agent|China Local Browse 2\\.6|ContactBot/0\\.2|ContentSmartz|DataCha0s/2\\.0|DBrowse 1\\.4b|DBrowse 1\\.4d|Demo Bot DOT 16b|Demo Bot Z 16b|DSurf15a 01|DSurf15a 71|DSurf15a 81|DSurf15a VA|EBrowse 1\\.4b|Educate Search VxB|EmailSiphon|EmailSpider|EmailWolf 1\\.00|ESurf15a 15|ExtractorPro|Franklin Locator 1\\.8|FSurf15a 01|Full Web Bot 0416B|Full Web Bot 0516B|Full Web Bot 2816B|Guestbook Auto Submitter|Industry Program 1\\.0\\.x|ISC Systems iRc Search 2\\.1|IUPUI Research Bot v 1\\.9a|LARBIN-EXPERIMENTAL \\(efp@gmx\\.net\\)|LetsCrawl\\.com/1\\.0 \\+http\\://letscrawl\\.com/|Lincoln State Web Browser|LMQueueBot/0\\.2|LWP\\:\\:Simple/5\\.803|Mac Finder 1\\.0\\.xx|MFC Foundation Class Library 4\\.0|Microsoft URL Control - 6\\.00\\.8xxx|Missauga Locate 1\\.0\\.0|Missigua Locator 1\\.9|Missouri College Browse|Mizzu Labs 2\\.2|Mo College 1\\.9|MVAClient|Mozilla/2\\.0 \\(compatible; NEWT ActiveX; Win32\\)|Mozilla/3\\.0 \\(compatible; Indy Library\\)|Mozilla/3\\.0 \\(compatible; scan4mail \\(advanced version\\) http\\://www\\.peterspages\\.net/?scan4mail\\)|Mozilla/4\\.0 \\(compatible; Advanced Email Extractor v2\\.xx\\)|Mozilla/4\\.0 \\(compatible; Iplexx Spider/1\\.0 http\\://www\\.iplexx\\.at\\)|Mozilla/4\\.0 \\(compatible; MSIE 5\\.0; Windows NT; DigExt; DTS Agent|Mozilla/4\\.0 efp@gmx\\.net|Mozilla/5\\.0 \\(Version\\: xxxx Type\\:xx\\)|NameOfAgent \\(CMS Spider\\)|NASA Search 1\\.0|Nsauditor/1\\.x|PBrowse 1\\.4b|PEval 1\\.4b|Poirot|Port Huron Labs|Production Bot 0116B|Production Bot 2016B|Production Bot DOT 3016B|Program Shareware 1\\.0\\.2|PSurf15a 11|PSurf15a 51|PSurf15a VA|psycheclone|RSurf15a 41|RSurf15a 51|RSurf15a 81|searchbot admin@google\\.com|ShablastBot 1\\.0|snap\\.com beta crawler v0|Snapbot/1\\.0|Snapbot/1\\.0 \\(Snap Shots\u0026#44; \\+http\\://www\\.snap\\.com\\)|sogou develop spider|Sogou Orion spider/3\\.0\\(\\+http\\://www\\.sogou\\.com/docs/help/webmasters\\.htm#07\\)|sogou spider|Sogou web spider/3\\.0\\(\\+http\\://www\\.sogou\\.com/docs/help/webmasters\\.htm#07\\)|sohu agent|SSurf15a 11 |TSurf15a 11|Under the Rainbow 2\\.2|User-Agent\\: Mozilla/4\\.0 \\(compatible; MSIE 6\\.0; Windows NT 5\\.1\\)|VadixBot|WebVulnCrawl\\.unknown/1\\.0 libwww-perl/5\\.803|Wells Search II|WEP Search 00\n\nfailregex = ^\u003cHOST\u003e -.*\"(GET|POST|HEAD).*HTTP.*\".*(?:%(badbots)s|%(badbotscustom)s).*\"$\nignoreregex =\nEOF\n```\n\n### Firewall Integration\n\n```bash\n# iptables integration\nsudo tee /etc/fail2ban/action.d/iptables-common.local \u003c\u003cEOF\n[Init]\n# Option: blocktype\n# Note: This is the default block type for all iptables actions\nblocktype = DROP\n\n# Option: iptables\n# Note: Path to iptables command\niptables = /sbin/iptables\n\n# Option: protocol\n# Note: Default protocol\nprotocol = tcp\n\n# Option: chain\n# Note: Default chain for filter table\nchain = INPUT\nEOF\n\n# nftables integration\nsudo tee /etc/fail2ban/action.d/nftables.local \u003c\u003cEOF\n[Definition]\nactionstart = nft add table inet fail2ban\n              nft add chain inet fail2ban f2b-\u003cname\u003e { type filter hook input priority 0 \\; }\n\nactionstop = nft delete chain inet fail2ban f2b-\u003cname\u003e\n\nactionban = nft add rule inet fail2ban f2b-\u003cname\u003e ip saddr \u003cip\u003e drop\n\nactionunban = nft delete rule inet fail2ban f2b-\u003cname\u003e handle \\$(nft -a list chain inet fail2ban f2b-\u003cname\u003e | grep \u003cip\u003e | awk '{print \\$NF}')\nEOF\n```\n\n## Database Setup\n\n### SQLite Database Configuration\n\n```bash\n# Default SQLite database location\nls -la /var/lib/fail2ban/fail2ban.sqlite3\n\n# Custom database configuration\nsudo tee -a /etc/fail2ban/fail2ban.local \u003c\u003cEOF\n\n[Definition]\n# Database configuration\ndbfile = /var/lib/fail2ban/fail2ban.sqlite3\ndbpurgeage = 7d\nEOF\n\n# View database content\nsudo sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \"SELECT * FROM bans;\"\nsudo sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \"SELECT jail, ip, COUNT(*) as count FROM bans GROUP BY jail, ip ORDER BY count DESC;\"\n```\n\n### MySQL Backend Configuration\n\n```bash\n# Install MySQL connector\nsudo apt install python3-pymysql  # Debian/Ubuntu\nsudo dnf install python3-PyMySQL   # RHEL/CentOS\n\n# Create database and user\nmysql -u root -p \u003c\u003cEOF\nCREATE DATABASE fail2ban;\nCREATE USER 'fail2ban'@'localhost' IDENTIFIED BY 'secure_password';\nGRANT ALL PRIVILEGES ON fail2ban.* TO 'fail2ban'@'localhost';\nFLUSH PRIVILEGES;\nEOF\n\n# Configure fail2ban for MySQL\nsudo tee /etc/fail2ban/fail2ban.d/mysql.conf \u003c\u003cEOF\n[Definition]\ndbdriver = mysql\ndbhost = localhost\ndbport = 3306\ndbuser = fail2ban\ndbpassword = secure_password\ndbname = fail2ban\nEOF\n```\n\n## Performance Optimization\n\n### System Tuning\n\n```bash\n# Optimize fail2ban performance\nsudo tee /etc/fail2ban/fail2ban.d/performance.conf \u003c\u003cEOF\n[Definition]\n# Use systemd journal instead of log files\nbackend = systemd\n\n# Use pyinotify for better performance\nbackend = pyinotify\n\n# Increase socket timeout\nsocket_timeout = 30\n\n# Database optimization\ndbmaxmatches = 100\ndbpurgeage = 1d\nEOF\n\n# Configure systemd limits\nsudo mkdir -p /etc/systemd/system/fail2ban.service.d\nsudo tee /etc/systemd/system/fail2ban.service.d/limits.conf \u003c\u003cEOF\n[Service]\n# Increase limits for better performance\nLimitNOFILE=65536\nLimitNPROC=4096\nMemoryLimit=512M\nCPUQuota=50%\nNice=-5\nEOF\n\nsudo systemctl daemon-reload\nsudo systemctl restart fail2ban\n```\n\n### Log Processing Optimization\n\n```bash\n# Use systemd journal backend for better performance\nsudo tee /etc/fail2ban/jail.d/systemd-backend.conf \u003c\u003cEOF\n[DEFAULT]\nbackend = systemd\n\n[sshd]\nenabled = true\nbackend = systemd\njournalmatch = _SYSTEMD_UNIT=ssh.service + _COMM=sshd\n\n[nginx]\nenabled = true\nbackend = systemd\njournalmatch = _SYSTEMD_UNIT=nginx.service\nEOF\n\n# Configure log rotation for fail2ban\nsudo tee /etc/logrotate.d/fail2ban \u003c\u003cEOF\n/var/log/fail2ban.log {\n    daily\n    rotate 7\n    compress\n    delaycompress\n    missingok\n    notifempty\n    create 640 root adm\n    sharedscripts\n    postrotate\n        fail2ban-client flushlogs 1\u003e/dev/null\n    endscript\n}\nEOF\n```\n\n## Monitoring\n\n### Built-in Monitoring\n\n```bash\n# Check fail2ban status\nsudo fail2ban-client status\n\n# Check specific jail status\nsudo fail2ban-client status sshd\n\n# Get banned IPs for all jails\nfor jail in $(sudo fail2ban-client status | grep \"Jail list\" | sed 's/.*://;s/,//g'); do\n    echo \"=== $jail ===\"\n    sudo fail2ban-client status $jail | grep \"Banned IP\"\ndone\n\n# Monitor fail2ban in real-time\nsudo tail -f /var/log/fail2ban.log\n\n# Show ban statistics\nsudo fail2ban-client banned\n```\n\n### Monitoring Script\n\n```bash\n#!/bin/bash\n# fail2ban-monitor.sh\n\nLOG_FILE=\"/var/log/fail2ban-monitor.log\"\nALERT_EMAIL=\"admin@example.com\"\n\nlog() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a \"$LOG_FILE\"\n}\n\n# Check fail2ban service status\ncheck_service() {\n    if ! systemctl is-active --quiet fail2ban; then\n        log \"ERROR: fail2ban service is not running!\"\n        echo \"fail2ban service down on $(hostname)\" | mail -s \"fail2ban Alert\" \"$ALERT_EMAIL\"\n        return 1\n    fi\n    log \"fail2ban service is running\"\n}\n\n# Monitor ban activity\nmonitor_bans() {\n    local jail_list=$(fail2ban-client status | grep \"Jail list\" | sed 's/.*://;s/,//g')\n    \n    for jail in $jail_list; do\n        local status=$(fail2ban-client status \"$jail\")\n        local banned_count=$(echo \"$status\" | grep \"Currently banned:\" | awk '{print $NF}')\n        local total_banned=$(echo \"$status\" | grep \"Total banned:\" | awk '{print $NF}')\n        \n        log \"Jail: $jail - Currently banned: $banned_count, Total banned: $total_banned\"\n        \n        # Alert if too many bans\n        if [ \"$banned_count\" -gt 50 ]; then\n            log \"WARNING: High number of banned IPs in $jail jail\"\n            echo \"High ban count in $jail: $banned_count IPs\" | mail -s \"fail2ban Warning\" \"$ALERT_EMAIL\"\n        fi\n    done\n}\n\n# Check for suspicious patterns\ncheck_patterns() {\n    local recent_bans=$(tail -n 1000 /var/log/fail2ban.log | grep \"Ban\" | wc -l)\n    \n    if [ \"$recent_bans\" -gt 100 ]; then\n        log \"WARNING: High ban rate detected: $recent_bans bans in recent logs\"\n    fi\n}\n\n# Generate report\ngenerate_report() {\n    local report_file=\"/tmp/fail2ban-report-$(date +%Y%m%d).txt\"\n    \n    {\n        echo \"Fail2ban Report - $(date)\"\n        echo \"=========================\"\n        echo\n        fail2ban-client status\n        echo\n        echo \"Ban Statistics by Jail:\"\n        echo \"-----------------------\"\n        \n        for jail in $(fail2ban-client status | grep \"Jail list\" | sed 's/.*://;s/,//g'); do\n            echo\n            echo \"[$jail]\"\n            fail2ban-client status \"$jail\"\n        done\n        \n        echo\n        echo \"Recent Activity:\"\n        echo \"----------------\"\n        tail -n 50 /var/log/fail2ban.log | grep -E \"(Ban|Unban|Found|Restore)\"\n    } \u003e \"$report_file\"\n    \n    log \"Report generated: $report_file\"\n    \n    # Email report\n    mail -s \"Fail2ban Daily Report - $(hostname)\" \"$ALERT_EMAIL\" \u003c \"$report_file\"\n}\n\n# Main monitoring loop\nmain() {\n    log \"Starting fail2ban monitoring...\"\n    \n    check_service || exit 1\n    monitor_bans\n    check_patterns\n    generate_report\n    \n    log \"Monitoring completed\"\n}\n\n# Run monitoring\nmain\n\n# Add to cron:\n# */15 * * * * /usr/local/bin/fail2ban-monitor.sh\n```\n\n### Prometheus Integration\n\n```bash\n# Install fail2ban exporter\nwget https://github.com/hectorjsmith/fail2ban-prometheus-exporter/releases/download/v0.10.0/fail2ban_exporter\nchmod +x fail2ban_exporter\nsudo mv fail2ban_exporter /usr/local/bin/\n\n# Create systemd service\nsudo tee /etc/systemd/system/fail2ban-exporter.service \u003c\u003cEOF\n[Unit]\nDescription=Fail2ban Prometheus Exporter\nAfter=network.target\n\n[Service]\nType=simple\nUser=prometheus\nExecStart=/usr/local/bin/fail2ban_exporter\nRestart=on-failure\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsudo systemctl enable --now fail2ban-exporter\n\n# Configure Prometheus\necho \"  - job_name: 'fail2ban'\n    static_configs:\n      - targets: ['localhost:9191']\" \u003e\u003e /etc/prometheus/prometheus.yml\n```\n\n## Backup and Restore\n\n### Backup Script\n\n```bash\n#!/bin/bash\n# fail2ban-backup.sh\n\nBACKUP_DIR=\"/backup/fail2ban\"\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_FILE=\"$BACKUP_DIR/fail2ban_backup_$DATE.tar.gz\"\n\n# Create backup directory\nmkdir -p \"$BACKUP_DIR\"\n\n# Stop fail2ban to ensure database consistency\nsystemctl stop fail2ban\n\n# Create backup\ntar -czf \"$BACKUP_FILE\" \\\n    /etc/fail2ban/ \\\n    /var/lib/fail2ban/ \\\n    /var/log/fail2ban.log* \\\n    2\u003e/dev/null\n\n# Start fail2ban\nsystemctl start fail2ban\n\n# Encrypt backup\ngpg --cipher-algo AES256 --symmetric \"$BACKUP_FILE\"\nrm \"$BACKUP_FILE\"\n\necho \"Backup created: $BACKUP_FILE.gpg\"\n\n# Clean old backups (keep 30 days)\nfind \"$BACKUP_DIR\" -name \"fail2ban_backup_*.gpg\" -mtime +30 -delete\n\n# Backup banned IPs list\nfail2ban-client banned \u003e \"$BACKUP_DIR/banned_ips_$DATE.txt\"\n```\n\n### Restore Script\n\n```bash\n#!/bin/bash\n# fail2ban-restore.sh\n\nBACKUP_FILE=\"$1\"\n\nif [ -z \"$BACKUP_FILE\" ]; then\n    echo \"Usage: $0 \u003cbackup-file.gpg\u003e\"\n    exit 1\nfi\n\n# Decrypt backup\ngpg --decrypt \"$BACKUP_FILE\" \u003e /tmp/fail2ban_restore.tar.gz\n\n# Stop fail2ban\nsystemctl stop fail2ban\n\n# Extract backup\ntar -xzf /tmp/fail2ban_restore.tar.gz -C /\n\n# Restore permissions\nchown -R root:root /etc/fail2ban\nchmod 644 /etc/fail2ban/*.conf\nchmod 644 /etc/fail2ban/*.local\n\n# Start fail2ban\nsystemctl start fail2ban\n\n# Clean up\nrm /tmp/fail2ban_restore.tar.gz\n\necho \"Restore completed\"\n\n# Reload jails\nfail2ban-client reload\n```\n\n## Troubleshooting\n\n### Common Issues\n\n1. **Service won't start**:\n```bash\n# Check for syntax errors\nfail2ban-client -t\n\n# Check logs\njournalctl -u fail2ban -n 100\ntail -f /var/log/fail2ban.log\n\n# Check permissions\nls -la /var/run/fail2ban/\nls -la /var/lib/fail2ban/\n\n# Start in foreground for debugging\nfail2ban-server -f -x -v\n```\n\n2. **IPs not getting banned**:\n```bash\n# Test regex patterns\nfail2ban-regex /var/log/auth.log /etc/fail2ban/filter.d/sshd.conf\n\n# Check jail configuration\nfail2ban-client get sshd logpath\nfail2ban-client get sshd findtime\nfail2ban-client get sshd maxretry\n\n# Test specific log line\necho 'Dec 10 12:34:56 server sshd[12345]: Failed password for invalid user admin from 192.168.1.100 port 12345 ssh2' | fail2ban-regex - /etc/fail2ban/filter.d/sshd.conf\n```\n\n3. **Performance issues**:\n```bash\n# Check database size\nls -lh /var/lib/fail2ban/fail2ban.sqlite3\n\n# Purge old entries\nfail2ban-client set dbpurgeage 1d\nsqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \"DELETE FROM bans WHERE timeofban \u003c strftime('%s', 'now', '-7 days');\"\n\n# Monitor CPU usage\ntop -p $(pgrep fail2ban-server)\n\n# Check number of monitored files\nlsof -p $(pgrep fail2ban-server) | grep -c log\n```\n\n### Debug Mode\n\n```bash\n# Enable debug logging\nsudo tee -a /etc/fail2ban/fail2ban.local \u003c\u003cEOF\n[Definition]\nloglevel = DEBUG\nEOF\n\nsudo systemctl restart fail2ban\n\n# Watch debug logs\ntail -f /var/log/fail2ban.log | grep -E \"(DEBUG|ERROR|WARNING)\"\n\n# Test jail processing\nfail2ban-client set sshd addlogpath /var/log/auth.log\nfail2ban-client set sshd banip 192.168.1.100\nfail2ban-client set sshd unbanip 192.168.1.100\n```\n\n## Integration Examples\n\n### Python Integration\n\n```python\n#!/usr/bin/env python3\n# fail2ban_api.py\n\nimport subprocess\nimport json\nimport socket\nfrom datetime import datetime\n\nclass Fail2banManager:\n    def __init__(self):\n        self.socket_path = \"/var/run/fail2ban/fail2ban.sock\"\n    \n    def execute_command(self, command):\n        \"\"\"Execute fail2ban-client command\"\"\"\n        try:\n            result = subprocess.run(\n                ['fail2ban-client'] + command.split(),\n                capture_output=True,\n                text=True,\n                check=True\n            )\n            return result.stdout.strip()\n        except subprocess.CalledProcessError as e:\n            return f\"Error: {e.stderr}\"\n    \n    def get_status(self):\n        \"\"\"Get overall status\"\"\"\n        return self.execute_command(\"status\")\n    \n    def get_jail_status(self, jail):\n        \"\"\"Get specific jail status\"\"\"\n        status = self.execute_command(f\"status {jail}\")\n        \n        # Parse status output\n        lines = status.split('\\n')\n        result = {\n            'filter': {},\n            'actions': {},\n            'currently_failed': 0,\n            'total_failed': 0,\n            'currently_banned': 0,\n            'total_banned': 0,\n            'banned_ips': []\n        }\n        \n        for line in lines:\n            if 'Currently failed:' in line:\n                result['currently_failed'] = int(line.split(':')[1].strip())\n            elif 'Total failed:' in line:\n                result['total_failed'] = int(line.split(':')[1].strip())\n            elif 'Currently banned:' in line:\n                result['currently_banned'] = int(line.split(':')[1].strip())\n            elif 'Total banned:' in line:\n                result['total_banned'] = int(line.split(':')[1].strip())\n            elif 'Banned IP list:' in line:\n                ips = line.split(':')[1].strip()\n                result['banned_ips'] = ips.split() if ips else []\n        \n        return result\n    \n    def ban_ip(self, jail, ip, duration=None):\n        \"\"\"Ban an IP address\"\"\"\n        if duration:\n            return self.execute_command(f\"set {jail} banip {ip} {duration}\")\n        else:\n            return self.execute_command(f\"set {jail} banip {ip}\")\n    \n    def unban_ip(self, jail, ip):\n        \"\"\"Unban an IP address\"\"\"\n        return self.execute_command(f\"set {jail} unbanip {ip}\")\n    \n    def get_banned_ips(self):\n        \"\"\"Get all banned IPs across all jails\"\"\"\n        banned = {}\n        jails = self.get_jail_list()\n        \n        for jail in jails:\n            status = self.get_jail_status(jail)\n            if status['banned_ips']:\n                banned[jail] = status['banned_ips']\n        \n        return banned\n    \n    def get_jail_list(self):\n        \"\"\"Get list of all jails\"\"\"\n        status = self.get_status()\n        for line in status.split('\\n'):\n            if 'Jail list:' in line:\n                jails = line.split(':')[1].strip()\n                return [j.strip() for j in jails.split(',')]\n        return []\n    \n    def add_jail(self, jail_config):\n        \"\"\"Add a new jail configuration\"\"\"\n        config_path = f\"/etc/fail2ban/jail.d/{jail_config['name']}.conf\"\n        \n        config_content = f\"\"\"[{jail_config['name']}]\nenabled = true\nport = {jail_config.get('port', 'http,https')}\nfilter = {jail_config.get('filter', jail_config['name'])}\nlogpath = {jail_config['logpath']}\nmaxretry = {jail_config.get('maxretry', 5)}\nbantime = {jail_config.get('bantime', 3600)}\nfindtime = {jail_config.get('findtime', 600)}\n\"\"\"\n        \n        with open(config_path, 'w') as f:\n            f.write(config_content)\n        \n        # Reload configuration\n        return self.execute_command(\"reload\")\n\n# Example usage\nif __name__ == '__main__':\n    f2b = Fail2banManager()\n    \n    # Get overall status\n    print(\"Fail2ban Status:\")\n    print(f2b.get_status())\n    print(\"\\n\" + \"=\"*50 + \"\\n\")\n    \n    # Get banned IPs\n    print(\"Banned IPs by Jail:\")\n    banned = f2b.get_banned_ips()\n    for jail, ips in banned.items():\n        print(f\"\\n{jail}: {', '.join(ips) if ips else 'None'}\")\n    \n    # Check specific jail\n    print(\"\\n\" + \"=\"*50 + \"\\n\")\n    print(\"SSH Jail Status:\")\n    ssh_status = f2b.get_jail_status('sshd')\n    print(json.dumps(ssh_status, indent=2))\n```\n\n### Web Dashboard\n\n```python\n#!/usr/bin/env python3\n# fail2ban_dashboard.py\n\nfrom flask import Flask, render_template, jsonify, request\nfrom fail2ban_api import Fail2banManager\nimport json\n\napp = Flask(__name__)\nf2b = Fail2banManager()\n\n@app.route('/')\ndef dashboard():\n    return render_template('dashboard.html')\n\n@app.route('/api/status')\ndef api_status():\n    jails = f2b.get_jail_list()\n    status = {\n        'jails': {},\n        'total_banned': 0,\n        'total_failed': 0\n    }\n    \n    for jail in jails:\n        jail_status = f2b.get_jail_status(jail)\n        status['jails'][jail] = jail_status\n        status['total_banned'] += jail_status['total_banned']\n        status['total_failed'] += jail_status['total_failed']\n    \n    return jsonify(status)\n\n@app.route('/api/ban', methods=['POST'])\ndef api_ban():\n    data = request.json\n    result = f2b.ban_ip(data['jail'], data['ip'], data.get('duration'))\n    return jsonify({'success': True, 'result': result})\n\n@app.route('/api/unban', methods=['POST'])\ndef api_unban():\n    data = request.json\n    result = f2b.unban_ip(data['jail'], data['ip'])\n    return jsonify({'success': True, 'result': result})\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=5000, debug=True)\n```\n\n### Shell Integration\n\n```bash\n#!/bin/bash\n# fail2ban-utils.sh - Fail2ban utility functions\n\n# Source this file in other scripts: source /usr/local/lib/fail2ban-utils.sh\n\n# Check if IP is banned\nis_ip_banned() {\n    local ip=\"$1\"\n    local jail=\"${2:-}\"\n    \n    if [ -z \"$jail\" ]; then\n        # Check all jails\n        for j in $(fail2ban-client status | grep \"Jail list\" | sed 's/.*://;s/,//g'); do\n            if fail2ban-client status \"$j\" | grep -q \"$ip\"; then\n                echo \"IP $ip is banned in jail: $j\"\n                return 0\n            fi\n        done\n    else\n        # Check specific jail\n        if fail2ban-client status \"$jail\" | grep -q \"$ip\"; then\n            return 0\n        fi\n    fi\n    \n    return 1\n}\n\n# Ban IP with reason logging\nban_ip_with_reason() {\n    local jail=\"$1\"\n    local ip=\"$2\"\n    local reason=\"$3\"\n    local duration=\"${4:-3600}\"\n    \n    echo \"[$(date)] Banning IP $ip in jail $jail for $duration seconds. Reason: $reason\" \u003e\u003e /var/log/fail2ban-manual-bans.log\n    fail2ban-client set \"$jail\" banip \"$ip\" \"$duration\"\n}\n\n# Get ban statistics\nget_ban_stats() {\n    local total_banned=0\n    local total_failed=0\n    \n    echo \"Fail2ban Statistics\"\n    echo \"==================\"\n    \n    for jail in $(fail2ban-client status | grep \"Jail list\" | sed 's/.*://;s/,//g'); do\n        local status=$(fail2ban-client status \"$jail\")\n        local banned=$(echo \"$status\" | grep \"Total banned:\" | awk '{print $NF}')\n        local failed=$(echo \"$status\" | grep \"Total failed:\" | awk '{print $NF}')\n        \n        echo \"[$jail]\"\n        echo \"  Failed: $failed\"\n        echo \"  Banned: $banned\"\n        \n        total_banned=$((total_banned + banned))\n        total_failed=$((total_failed + failed))\n    done\n    \n    echo\n    echo \"Totals:\"\n    echo \"  Failed: $total_failed\"\n    echo \"  Banned: $total_banned\"\n}\n\n# Whitelist management\nadd_to_whitelist() {\n    local ip=\"$1\"\n    \n    # Add to fail2ban whitelist\n    if grep -q \"ignoreip\" /etc/fail2ban/jail.local; then\n        sed -i \"/ignoreip/s/$/,$ip/\" /etc/fail2ban/jail.local\n    else\n        echo \"ignoreip = 127.0.0.1/8 ::1 $ip\" \u003e\u003e /etc/fail2ban/jail.local\n    fi\n    \n    # Reload configuration\n    fail2ban-client reload\n    \n    echo \"Added $ip to whitelist\"\n}\n\n# Export functions for use in other scripts\nexport -f is_ip_banned\nexport -f ban_ip_with_reason\nexport -f get_ban_stats\nexport -f add_to_whitelist\n```\n\n## Maintenance\n\n### Update Procedures\n\n```bash\n# RHEL/CentOS/Rocky/AlmaLinux\nsudo dnf update fail2ban\n\n# Debian/Ubuntu\nsudo apt update \u0026\u0026 sudo apt upgrade fail2ban\n\n# Arch Linux\nsudo pacman -Syu fail2ban\n\n# Alpine Linux\napk update \u0026\u0026 apk upgrade fail2ban\n\n# openSUSE\nsudo zypper update fail2ban\n\n# FreeBSD\npkg update \u0026\u0026 pkg upgrade py39-fail2ban\n\n# Always backup before updates\n/usr/local/bin/fail2ban-backup.sh\n\n# Restart after updates\nsudo systemctl restart fail2ban\n```\n\n### Regular Maintenance Tasks\n\n```bash\n#!/bin/bash\n# fail2ban-maintenance.sh\n\nLOG_FILE=\"/var/log/fail2ban-maintenance.log\"\n\nlog() {\n    echo \"[$(date '+%Y-%m-%d %H:%M:%S')] $1\" | tee -a \"$LOG_FILE\"\n}\n\n# Update filters from repository\nupdate_filters() {\n    log \"Updating fail2ban filters...\"\n    \n    cd /tmp\n    git clone https://github.com/fail2ban/fail2ban.git\n    \n    # Backup existing filters\n    cp -r /etc/fail2ban/filter.d /etc/fail2ban/filter.d.bak\n    \n    # Copy new filters\n    cp /tmp/fail2ban/config/filter.d/* /etc/fail2ban/filter.d/\n    \n    # Test configuration\n    if fail2ban-client -t; then\n        log \"Filter update successful\"\n    else\n        log \"ERROR: Filter update failed, restoring backup\"\n        rm -rf /etc/fail2ban/filter.d\n        mv /etc/fail2ban/filter.d.bak /etc/fail2ban/filter.d\n    fi\n    \n    rm -rf /tmp/fail2ban\n}\n\n# Clean old database entries\nclean_database() {\n    log \"Cleaning fail2ban database...\"\n    \n    # Get database size before\n    size_before=$(ls -lh /var/lib/fail2ban/fail2ban.sqlite3 | awk '{print $5}')\n    \n    # Clean entries older than 30 days\n    sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \"DELETE FROM bans WHERE timeofban \u003c strftime('%s', 'now', '-30 days');\"\n    sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \"VACUUM;\"\n    \n    # Get database size after\n    size_after=$(ls -lh /var/lib/fail2ban/fail2ban.sqlite3 | awk '{print $5}')\n    \n    log \"Database cleaned. Size: $size_before -\u003e $size_after\"\n}\n\n# Check and update GeoIP database\nupdate_geoip() {\n    log \"Updating GeoIP database...\"\n    \n    if command -v geoipupdate \u003e/dev/null 2\u003e\u00261; then\n        geoipupdate\n        log \"GeoIP database updated\"\n    else\n        log \"GeoIP update tool not installed\"\n    fi\n}\n\n# Generate monthly report\ngenerate_monthly_report() {\n    log \"Generating monthly report...\"\n    \n    report_file=\"/var/log/fail2ban-monthly-$(date +%Y%m).txt\"\n    \n    {\n        echo \"Fail2ban Monthly Report - $(date '+%B %Y')\"\n        echo \"========================================\"\n        echo\n        \n        # Get ban statistics from database\n        echo \"Top 10 Banned IPs:\"\n        sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \"SELECT ip, COUNT(*) as count FROM bans WHERE timeofban \u003e strftime('%s', 'now', '-30 days') GROUP BY ip ORDER BY count DESC LIMIT 10;\"\n        \n        echo\n        echo \"Bans by Jail:\"\n        sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \"SELECT jail, COUNT(*) as count FROM bans WHERE timeofban \u003e strftime('%s', 'now', '-30 days') GROUP BY jail ORDER BY count DESC;\"\n        \n        echo\n        echo \"Daily Ban Trend:\"\n        sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \"SELECT date(timeofban, 'unixepoch') as day, COUNT(*) as count FROM bans WHERE timeofban \u003e strftime('%s', 'now', '-30 days') GROUP BY day ORDER BY day;\"\n    } \u003e \"$report_file\"\n    \n    log \"Monthly report saved to: $report_file\"\n}\n\n# Main maintenance routine\nmain() {\n    log \"Starting fail2ban maintenance...\"\n    \n    update_filters\n    clean_database\n    update_geoip\n    generate_monthly_report\n    \n    # Reload fail2ban\n    fail2ban-client reload\n    \n    log \"Maintenance completed\"\n}\n\n# Run maintenance\nmain\n\n# Schedule in cron:\n# 0 2 1 * * /usr/local/bin/fail2ban-maintenance.sh\n```\n\n### Health Check Script\n\n```bash\n#!/bin/bash\n# fail2ban-health.sh\n\n# Check fail2ban health\ncheck_health() {\n    local status=0\n    \n    # Check service\n    if ! systemctl is-active --quiet fail2ban; then\n        echo \"CRITICAL: fail2ban service is not running\"\n        status=2\n    fi\n    \n    # Check database\n    if [ ! -f /var/lib/fail2ban/fail2ban.sqlite3 ]; then\n        echo \"WARNING: Database file missing\"\n        status=1\n    fi\n    \n    # Check socket\n    if [ ! -S /var/run/fail2ban/fail2ban.sock ]; then\n        echo \"WARNING: Socket file missing\"\n        status=1\n    fi\n    \n    # Check jails\n    active_jails=$(fail2ban-client status | grep \"Jail list\" | wc -w)\n    if [ \"$active_jails\" -lt 3 ]; then\n        echo \"WARNING: Only $active_jails jails active\"\n        status=1\n    fi\n    \n    if [ $status -eq 0 ]; then\n        echo \"OK: fail2ban is healthy\"\n    fi\n    \n    exit $status\n}\n\ncheck_health\n```\n\n## Additional Resources\n\n- [Official Fail2ban Documentation](https://www.fail2ban.org/)\n- [Fail2ban GitHub Repository](https://github.com/fail2ban/fail2ban)\n- [Fail2ban Wiki](https://github.com/fail2ban/fail2ban/wiki)\n- [Filter Development Guide](https://fail2ban.readthedocs.io/en/latest/filters.html)\n- [Action Development Guide](https://fail2ban.readthedocs.io/en/latest/actions.html)\n- [Community Filters](https://github.com/fail2ban/fail2ban/tree/master/config/filter.d)\n- [Best Practices Guide](https://www.fail2ban.org/wiki/index.php/Best_practices)\n- [Security Hardening Guide](https://www.fail2ban.org/wiki/index.php/Security)\n\n---\n\n**Note:** This guide is part of the [HowToMgr](https://howtomgr.github.io) collection. Always refer to official documentation for the most up-to-date information.","readmeHtml":"\u003ch1 id=\"fail2ban-installation-guide\" class=\"mobile-header\"\u003eFail2ban Installation Guide\u003c/h1\u003e\n\u003cp class=\"mobile-paragraph\"\u003eFail2ban is a free and open-source intrusion prevention software framework that protects servers from brute-force attacks. Written in Python, it monitors log files and bans IP addresses that show malicious signs such as too many password failures or seeking exploits. It serves as a powerful FOSS alternative to commercial security solutions like Cloudflare Rate Limiting, AWS WAF, or proprietary IPS systems, providing enterprise-grade protection without licensing costs or vendor lock-in.\u003c/p\u003e\n\u003ch2 id=\"prerequisites\" class=\"mobile-header\"\u003ePrerequisites\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eHardware Requirements\u003c/strong\u003e:\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eCPU: 1 core minimum (2+ cores recommended for high-traffic servers)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRAM: 512MB minimum (1GB+ recommended)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eStorage: 100MB for installation, plus log storage\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eNetwork: Stable connectivity for updates\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eOperating System\u003c/strong\u003e: \u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eLinux: Any modern distribution with systemd or init\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003emacOS: 10.14+ (limited support)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eWindows: WSL2 with Linux distribution\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFreeBSD: 11.0+\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eNetwork Requirements\u003c/strong\u003e:\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eFirewall access (iptables, nftables, pf, or ipfw)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eRoot access to modify firewall rules\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eDependencies\u003c/strong\u003e:\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003ePython 3.5+ (3.8+ recommended)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eiptables, nftables, or equivalent firewall\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003esystemd or init system\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003eLog files to monitor (sshd, nginx, apache, etc.)\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003cstrong\u003eSystem Access\u003c/strong\u003e: root or sudo privileges required\u003c/li\u003e\n\u003ch2 id=\"installation\" class=\"mobile-header\"\u003eInstallation\u003c/h2\u003e\n\u003ch3 id=\"rhelcentosrocky-linuxalmalinux\" class=\"mobile-header\"\u003eRHEL/CentOS/Rocky Linux/AlmaLinux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install EPEL repository\nsudo dnf install -y epel-release\n\n# Install fail2ban\nsudo dnf install -y fail2ban fail2ban-systemd\n\n# Install additional dependencies\nsudo dnf install -y python3-systemd python3-pyinotify\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nfail2ban-client --version\nsudo systemctl status fail2ban\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"debianubuntu\" class=\"mobile-header\"\u003eDebian/Ubuntu\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Update package index\nsudo apt update\n\n# Install fail2ban\nsudo apt install -y fail2ban\n\n# Install additional tools\nsudo apt install -y python3-systemd python3-pyinotify iptables-persistent\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nfail2ban-client --version\nsudo systemctl status fail2ban\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"arch-linux\" class=\"mobile-header\"\u003eArch Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install fail2ban\nsudo pacman -S fail2ban\n\n# Install additional dependencies\nsudo pacman -S python-systemd python-pyinotify\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Verify installation\nfail2ban-client --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"alpine-linux\" class=\"mobile-header\"\u003eAlpine Linux\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install fail2ban\napk add --no-cache fail2ban fail2ban-openrc\n\n# Install additional dependencies\napk add --no-cache py3-systemd iptables ip6tables\n\n# Enable and start service\nrc-update add fail2ban default\nrc-service fail2ban start\n\n# Verify installation\nfail2ban-client --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"opensusesles\" class=\"mobile-header\"\u003eopenSUSE/SLES\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# openSUSE Leap/Tumbleweed\nsudo zypper install -y fail2ban python3-systemd\n\n# SLES 15\nsudo SUSEConnect -p sle-module-basesystem/15.5/x86_64\nsudo zypper install -y fail2ban\n\n# Enable and start service\nsudo systemctl enable --now fail2ban\n\n# Configure firewall\nsudo firewall-cmd --permanent --add-service=fail2ban\nsudo firewall-cmd --reload\n\n# Verify installation\nfail2ban-client --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"macos\" class=\"mobile-header\"\u003emacOS\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Using Homebrew\nbrew install fail2ban\n\n# Copy configuration files\nsudo cp /usr/local/etc/fail2ban/fail2ban.conf /usr/local/etc/fail2ban/fail2ban.local\nsudo cp /usr/local/etc/fail2ban/jail.conf /usr/local/etc/fail2ban/jail.local\n\n# Start service\nsudo brew services start fail2ban\n\n# Verify installation\nfail2ban-client --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"freebsd\" class=\"mobile-header\"\u003eFreeBSD\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Using pkg\npkg install py39-fail2ban\n\n# Enable in rc.conf\necho \u0026#039;fail2ban_enable=\u0026quot;YES\u0026quot;\u0026#039; \u0026gt;\u0026gt; /etc/rc.conf\n\n# Copy configuration\ncp /usr/local/etc/fail2ban/fail2ban.conf /usr/local/etc/fail2ban/fail2ban.local\ncp /usr/local/etc/fail2ban/jail.conf /usr/local/etc/fail2ban/jail.local\n\n# Start service\nservice fail2ban start\n\n# Verify installation\nfail2ban-client --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"windows-wsl2\" class=\"mobile-header\"\u003eWindows (WSL2)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"powershell\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003epowershell\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-powershell\"\u003e# Install WSL2 with Ubuntu\nwsl --install -d Ubuntu-22.04\n\n# Inside WSL2 Ubuntu\nsudo apt update\nsudo apt install -y fail2ban\n\n# Configure for Windows logs monitoring\n# Note: Limited functionality - primarily for learning/testing\n\n# Verify installation\nfail2ban-client --version\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"initial-configuration\" class=\"mobile-header\"\u003eInitial Configuration\u003c/h2\u003e\n\u003ch3 id=\"basic-configuration\" class=\"mobile-header\"\u003eBasic Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create local configuration files (never edit .conf files directly)\nsudo cp /etc/fail2ban/fail2ban.conf /etc/fail2ban/fail2ban.local\nsudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local\n\n# Edit main configuration\nsudo tee /etc/fail2ban/fail2ban.local \u0026lt;\u0026lt;EOF\n[Definition]\nloglevel = INFO\nlogtarget = /var/log/fail2ban.log\nsyslogsocket = auto\nsocket = /var/run/fail2ban/fail2ban.sock\npidfile = /var/run/fail2ban/fail2ban.pid\ndbfile = /var/lib/fail2ban/fail2ban.sqlite3\ndbpurgeage = 1d\nEOF\n\n# Configure basic jail settings\nsudo tee /etc/fail2ban/jail.local \u0026lt;\u0026lt;EOF\n[DEFAULT]\n# Ban duration (in seconds)\nbantime = 3600\n# Time window for maxretry\nfindtime = 600\n# Number of failures before ban\nmaxretry = 5\n# Email notifications\ndestemail = admin@example.com\nsender = fail2ban@example.com\nmta = sendmail\n# Action to take\naction = %(action_mwl)s\n\n# Whitelist\nignoreip = 127.0.0.1/8 ::1 192.168.0.0/16\n\n[sshd]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 3600\n\n[nginx-http-auth]\nenabled = true\nfilter = nginx-http-auth\nport = http,https\nlogpath = /var/log/nginx/error.log\n\n[nginx-limit-req]\nenabled = true\nfilter = nginx-limit-req\nport = http,https\nlogpath = /var/log/nginx/error.log\nmaxretry = 10\nfindtime = 60\nbantime = 600\n\n[apache-auth]\nenabled = false\nport = http,https\nfilter = apache-auth\nlogpath = /var/log/apache*/*error.log\nmaxretry = 6\n\n[postfix]\nenabled = false\nport = smtp,465,submission\nfilter = postfix\nlogpath = /var/log/mail.log\nEOF\n\n# Restart fail2ban\nsudo systemctl restart fail2ban\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"custom-jail-configuration\" class=\"mobile-header\"\u003eCustom Jail Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create custom filter for application\nsudo tee /etc/fail2ban/filter.d/myapp.conf \u0026lt;\u0026lt;EOF\n[Definition]\nfailregex = ^\u0026lt;HOST\u0026gt; - - \\[.*\\] \u0026quot;POST /login HTTP/.*\u0026quot; 401\n            ^Failed login from \u0026lt;HOST\u0026gt;\n            ^Authentication failure for .* from \u0026lt;HOST\u0026gt;\nignoreregex =\nEOF\n\n# Create jail for custom application\nsudo tee -a /etc/fail2ban/jail.local \u0026lt;\u0026lt;EOF\n\n[myapp]\nenabled = true\nfilter = myapp\nport = 8080\nlogpath = /var/log/myapp/access.log\nmaxretry = 3\nbantime = 3600\nfindtime = 300\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"service-management\" class=\"mobile-header\"\u003eService Management\u003c/h2\u003e\n\u003ch3 id=\"systemd-rhel-debian-ubuntu-arch-opensuse\" class=\"mobile-header\"\u003esystemd (RHEL, Debian, Ubuntu, Arch, openSUSE)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable service\nsudo systemctl enable fail2ban\n\n# Start service\nsudo systemctl start fail2ban\n\n# Stop service\nsudo systemctl stop fail2ban\n\n# Restart service\nsudo systemctl restart fail2ban\n\n# Reload configuration\nsudo systemctl reload fail2ban\n\n# Check status\nsudo systemctl status fail2ban\n\n# View logs\nsudo journalctl -u fail2ban -f\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"openrc-alpine-linux\" class=\"mobile-header\"\u003eOpenRC (Alpine Linux)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable service\nrc-update add fail2ban default\n\n# Start service\nrc-service fail2ban start\n\n# Stop service\nrc-service fail2ban stop\n\n# Restart service\nrc-service fail2ban restart\n\n# Check status\nrc-service fail2ban status\n\n# View logs\ntail -f /var/log/fail2ban.log\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"rcd-freebsd\" class=\"mobile-header\"\u003erc.d (FreeBSD)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable in rc.conf\necho \u0026#039;fail2ban_enable=\u0026quot;YES\u0026quot;\u0026#039; \u0026gt;\u0026gt; /etc/rc.conf\n\n# Start service\nservice fail2ban start\n\n# Stop service\nservice fail2ban stop\n\n# Restart service\nservice fail2ban restart\n\n# Check status\nservice fail2ban status\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"launchd-macos\" class=\"mobile-header\"\u003elaunchd (macOS)\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Using brew services\nbrew services start fail2ban\nbrew services stop fail2ban\nbrew services restart fail2ban\n\n# Check status\nbrew services list | grep fail2ban\n\n# Manual control\nsudo /usr/local/bin/fail2ban-client start\nsudo /usr/local/bin/fail2ban-client stop\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"advanced-configuration\" class=\"mobile-header\"\u003eAdvanced Configuration\u003c/h2\u003e\n\u003ch3 id=\"multi-service-protection\" class=\"mobile-header\"\u003eMulti-Service Protection\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Comprehensive jail configuration\nsudo tee /etc/fail2ban/jail.d/multi-service.conf \u0026lt;\u0026lt;EOF\n# SSH Protection\n[sshd]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 3\nbantime = 3600\nfindtime = 600\n\n[sshd-ddos]\nenabled = true\nport = ssh\nfilter = sshd-ddos\nlogpath = /var/log/auth.log\nmaxretry = 10\nbantime = 600\nfindtime = 60\n\n# Web Server Protection\n[nginx-http-auth]\nenabled = true\nfilter = nginx-http-auth\nport = http,https\nlogpath = /var/log/nginx/error.log\nmaxretry = 3\n\n[nginx-noscript]\nenabled = true\nport = http,https\nfilter = nginx-noscript\nlogpath = /var/log/nginx/access.log\nmaxretry = 5\n\n[nginx-badbots]\nenabled = true\nport = http,https\nfilter = nginx-badbots\nlogpath = /var/log/nginx/access.log\nmaxretry = 2\nbantime = 86400\n\n[nginx-noproxy]\nenabled = true\nport = http,https\nfilter = nginx-noproxy\nlogpath = /var/log/nginx/access.log\nmaxretry = 2\n\n# Database Protection\n[mysqld-auth]\nenabled = true\nfilter = mysqld-auth\nport = 3306\nlogpath = /var/log/mysql/error.log\nmaxretry = 5\n\n[postgresql]\nenabled = true\nport = 5432\nfilter = postgresql\nlogpath = /var/log/postgresql/*.log\nmaxretry = 5\n\n# Mail Server Protection\n[postfix]\nenabled = true\nport = smtp,465,submission\nfilter = postfix\nlogpath = /var/log/mail.log\n\n[postfix-sasl]\nenabled = true\nport = smtp,465,submission,imap,imaps,pop3,pop3s\nfilter = postfix-sasl\nlogpath = /var/log/mail.log\n\n[dovecot]\nenabled = true\nport = pop3,pop3s,imap,imaps,submission,465,sieve\nfilter = dovecot\nlogpath = /var/log/mail.log\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"geoip-blocking\" class=\"mobile-header\"\u003eGeoIP Blocking\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install GeoIP database\nsudo apt install geoip-database geoip-bin  # Debian/Ubuntu\nsudo dnf install GeoIP GeoIP-data         # RHEL/CentOS\n\n# Create GeoIP action\nsudo tee /etc/fail2ban/action.d/geoip-block.conf \u0026lt;\u0026lt;EOF\n[Definition]\nactionstart = \nactionstop = \nactioncheck = \nactionban = if [ \u0026quot;\\$(geoiplookup \u0026lt;ip\u0026gt; | grep -v \u0026#039;US\\|CA\\|GB\u0026#039;)\u0026quot; ]; then iptables -I f2b-\u0026lt;name\u0026gt; 1 -s \u0026lt;ip\u0026gt; -j DROP; fi\nactionunban = iptables -D f2b-\u0026lt;name\u0026gt; -s \u0026lt;ip\u0026gt; -j DROP\nEOF\n\n# Use in jail\nsudo tee -a /etc/fail2ban/jail.local \u0026lt;\u0026lt;EOF\n\n[sshd-geoip]\nenabled = true\nfilter = sshd\naction = geoip-block[name=%(__name__)s]\nlogpath = /var/log/auth.log\nmaxretry = 3\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"persistent-bans\" class=\"mobile-header\"\u003ePersistent Bans\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create persistent ban action\nsudo tee /etc/fail2ban/action.d/iptables-persistent.conf \u0026lt;\u0026lt;EOF\n[Definition]\nactionstart = iptables -N f2b-\u0026lt;name\u0026gt;\n              iptables -A f2b-\u0026lt;name\u0026gt; -j RETURN\n              iptables -I \u0026lt;chain\u0026gt; -p \u0026lt;protocol\u0026gt; --dport \u0026lt;port\u0026gt; -j f2b-\u0026lt;name\u0026gt;\n              # Load persistent bans\n              [ -f /etc/fail2ban/persistent/\u0026lt;name\u0026gt;.bans ] \u0026amp;\u0026amp; while read ip; do iptables -I f2b-\u0026lt;name\u0026gt; 1 -s \\$ip -j DROP; done \u0026lt; /etc/fail2ban/persistent/\u0026lt;name\u0026gt;.bans\n\nactionstop = iptables -D \u0026lt;chain\u0026gt; -p \u0026lt;protocol\u0026gt; --dport \u0026lt;port\u0026gt; -j f2b-\u0026lt;name\u0026gt;\n             iptables -F f2b-\u0026lt;name\u0026gt;\n             iptables -X f2b-\u0026lt;name\u0026gt;\n\nactionban = iptables -I f2b-\u0026lt;name\u0026gt; 1 -s \u0026lt;ip\u0026gt; -j DROP\n            echo \u0026#039;\u0026lt;ip\u0026gt;\u0026#039; \u0026gt;\u0026gt; /etc/fail2ban/persistent/\u0026lt;name\u0026gt;.bans\n            sort -u /etc/fail2ban/persistent/\u0026lt;name\u0026gt;.bans -o /etc/fail2ban/persistent/\u0026lt;name\u0026gt;.bans\n\nactionunban = iptables -D f2b-\u0026lt;name\u0026gt; -s \u0026lt;ip\u0026gt; -j DROP\n              sed -i \u0026#039;/\u0026lt;ip\u0026gt;/d\u0026#039; /etc/fail2ban/persistent/\u0026lt;name\u0026gt;.bans\nEOF\n\n# Create directory for persistent bans\nsudo mkdir -p /etc/fail2ban/persistent\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"reverse-proxy-setup\" class=\"mobile-header\"\u003eReverse Proxy Setup\u003c/h2\u003e\n\u003ch3 id=\"nginx-reverse-proxy-configuration\" class=\"mobile-header\"\u003enginx Reverse Proxy Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"nginx\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003enginx\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-nginx\"\u003e# /etc/nginx/conf.d/fail2ban.conf\n# Pass real IP to backend for fail2ban processing\n\nmap $remote_addr $proxy_forwarded_elem {\n    ~^[0-9.]+$          \u0026quot;for=$remote_addr\u0026quot;;\n    ~^[0-9A-Fa-f:.]+$   \u0026quot;for=\\\u0026quot;[$remote_addr]\\\u0026quot;\u0026quot;;\n    default             \u0026quot;for=unknown\u0026quot;;\n}\n\nmap $http_forwarded $proxy_add_forwarded {\n    \u0026quot;\u0026quot;      \u0026quot;$proxy_forwarded_elem\u0026quot;;\n    default \u0026quot;$http_forwarded, $proxy_forwarded_elem\u0026quot;;\n}\n\nserver {\n    listen 80;\n    server_name app.example.com;\n\n    location / {\n        proxy_pass http://backend;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_set_header Forwarded $proxy_add_forwarded;\n        \n        # Rate limiting\n        limit_req zone=app_limit burst=10 nodelay;\n        limit_req_status 429;\n    }\n}\n\n# Define rate limit zone\nlimit_req_zone $binary_remote_addr zone=app_limit:10m rate=10r/s;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"haproxy-configuration\" class=\"mobile-header\"\u003eHAProxy Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"haproxy\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ehaproxy\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-haproxy\"\u003e# /etc/haproxy/haproxy.cfg\nglobal\n    log /dev/log local0\n    log /dev/log local1 notice\n\ndefaults\n    log global\n    option httplog\n    option forwardfor\n\nfrontend web_frontend\n    bind *:80\n    bind *:443 ssl crt /etc/ssl/certs/cert.pem\n    \n    # Track abusive behavior\n    stick-table type ip size 100k expire 30m store conn_rate(3s),conn_cur,http_req_rate(10s)\n    \n    # Block if connection rate exceeds limit\n    tcp-request connection reject if { src_conn_rate gt 20 }\n    tcp-request connection track-sc0 src\n    \n    # Block if HTTP request rate exceeds limit\n    http-request deny if { sc_http_req_rate(0) gt 20 }\n    \n    default_backend web_servers\n\nbackend web_servers\n    # Forward real IP for fail2ban\n    option forwardfor header X-Real-IP\n    server web1 192.168.1.10:80 check\n    server web2 192.168.1.11:80 check\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"apache-reverse-proxy\" class=\"mobile-header\"\u003eApache Reverse Proxy\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"apache\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003eapache\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-apache\"\u003e# /etc/apache2/sites-available/reverse-proxy.conf\n\u0026lt;VirtualHost *:80\u0026gt;\n    ServerName app.example.com\n    \n    # Enable required modules\n    # a2enmod proxy proxy_http remoteip\n    \n    # Trust proxy headers from load balancer\n    RemoteIPHeader X-Forwarded-For\n    RemoteIPTrustedProxy 10.0.0.0/8\n    \n    # Log real IP\n    LogFormat \u0026quot;%a %l %u %t \\\u0026quot;%r\\\u0026quot; %\u0026gt;s %O \\\u0026quot;%{Referer}i\\\u0026quot; \\\u0026quot;%{User-Agent}i\\\u0026quot;\u0026quot; proxy\n    CustomLog ${APACHE_LOG_DIR}/access.log proxy\n    \n    ProxyPass / http://backend/\n    ProxyPassReverse / http://backend/\n    \n    # Pass real IP to backend\n    ProxyPreserveHost On\n    RequestHeader set X-Real-IP \u0026quot;%{REMOTE_ADDR}s\u0026quot;\n    RequestHeader set X-Forwarded-For \u0026quot;%{X-Forwarded-For}i\u0026quot;\n\u0026lt;/VirtualHost\u0026gt;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"security-configuration\" class=\"mobile-header\"\u003eSecurity Configuration\u003c/h2\u003e\n\u003ch3 id=\"enhanced-security-rules\" class=\"mobile-header\"\u003eEnhanced Security Rules\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create comprehensive security configuration\nsudo tee /etc/fail2ban/jail.d/security-enhanced.conf \u0026lt;\u0026lt;EOF\n[DEFAULT]\n# Aggressive ban settings for security\nbantime = 86400    # 24 hours\nfindtime = 3600    # 1 hour window\nmaxretry = 3       # Low tolerance\nchain = INPUT      # iptables chain\nprotocol = tcp     # Default protocol\naction = %(action_mwl)s\n\n# Recidive jail for repeat offenders\n[recidive]\nenabled = true\nfilter = recidive\nlogpath = /var/log/fail2ban.log\nbantime = 604800   # 1 week\nfindtime = 86400   # 1 day\nmaxretry = 3\naction = iptables-allports[name=recidive, protocol=all]\n         sendmail-whois-lines[name=recidive, logpath=/var/log/fail2ban.log]\n\n# Port scanning detection\n[portscan]\nenabled = true\nfilter = portscan\nlogpath = /var/log/syslog\nmaxretry = 6\nbantime = 7200\naction = iptables-allports[name=portscan, protocol=all]\n\n# Block bad bots\n[apache-badbots]\nenabled = true\nport = http,https\nfilter = apache-badbots\nlogpath = /var/log/apache*/*access.log\nbantime = 172800   # 2 days\nmaxretry = 1\n\n# WordPress protection\n[wordpress]\nenabled = true\nfilter = wordpress\nport = http,https\nlogpath = /var/log/apache*/*access.log\nmaxretry = 3\nbantime = 3600\n\n# Aggressive SSH protection\n[sshd-aggressive]\nenabled = true\nport = ssh\nfilter = sshd\nlogpath = /var/log/auth.log\nmaxretry = 2\nbantime = 86400\nfindtime = 300\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"custom-security-filters\" class=\"mobile-header\"\u003eCustom Security Filters\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Create port scan detection filter\nsudo tee /etc/fail2ban/filter.d/portscan.conf \u0026lt;\u0026lt;EOF\n[Definition]\nfailregex = UFW BLOCK.* SRC=\u0026lt;HOST\u0026gt;\n            rejected connection: .* SRC=\u0026lt;HOST\u0026gt;\n            dropped: .* SRC=\u0026lt;HOST\u0026gt;\nignoreregex =\nEOF\n\n# Create WordPress attack filter\nsudo tee /etc/fail2ban/filter.d/wordpress.conf \u0026lt;\u0026lt;EOF\n[Definition]\nfailregex = ^\u0026lt;HOST\u0026gt; .* \u0026quot;POST /wp-login.php\n            ^\u0026lt;HOST\u0026gt; .* \u0026quot;POST /xmlrpc.php\n            ^\u0026lt;HOST\u0026gt; .* \u0026quot;GET /wp-admin/ HTTP/[0-9.]+\u0026quot; 403\n            ^\u0026lt;HOST\u0026gt; .* \u0026quot;GET /wp-content/.*/.*\\.php HTTP/[0-9.]+\u0026quot; \nignoreregex = ^\u0026lt;HOST\u0026gt; .* \u0026quot;GET /wp-admin/admin-ajax.php\nEOF\n\n# Create bad bot filter\nsudo tee /etc/fail2ban/filter.d/badbots.conf \u0026lt;\u0026lt;EOF\n[Definition]\nbadbotscustom = EmailCollector|WebEMailExtrac|TrackBack/1\\.02|sogou music spider|(?:Mozilla/\\d+\\.0\\s+)$\nbadbots = Atomic_Email_Hunter/4\\.0|atSpider/1\\.0|autoemailspider|bwh3_user_agent|China Local Browse 2\\.6|ContactBot/0\\.2|ContentSmartz|DataCha0s/2\\.0|DBrowse 1\\.4b|DBrowse 1\\.4d|Demo Bot DOT 16b|Demo Bot Z 16b|DSurf15a 01|DSurf15a 71|DSurf15a 81|DSurf15a VA|EBrowse 1\\.4b|Educate Search VxB|EmailSiphon|EmailSpider|EmailWolf 1\\.00|ESurf15a 15|ExtractorPro|Franklin Locator 1\\.8|FSurf15a 01|Full Web Bot 0416B|Full Web Bot 0516B|Full Web Bot 2816B|Guestbook Auto Submitter|Industry Program 1\\.0\\.x|ISC Systems iRc Search 2\\.1|IUPUI Research Bot v 1\\.9a|LARBIN-EXPERIMENTAL \\(efp@gmx\\.net\\)|LetsCrawl\\.com/1\\.0 \\+http\\://letscrawl\\.com/|Lincoln State Web Browser|LMQueueBot/0\\.2|LWP\\:\\:Simple/5\\.803|Mac Finder 1\\.0\\.xx|MFC Foundation Class Library 4\\.0|Microsoft URL Control - 6\\.00\\.8xxx|Missauga Locate 1\\.0\\.0|Missigua Locator 1\\.9|Missouri College Browse|Mizzu Labs 2\\.2|Mo College 1\\.9|MVAClient|Mozilla/2\\.0 \\(compatible; NEWT ActiveX; Win32\\)|Mozilla/3\\.0 \\(compatible; Indy Library\\)|Mozilla/3\\.0 \\(compatible; scan4mail \\(advanced version\\) http\\://www\\.peterspages\\.net/?scan4mail\\)|Mozilla/4\\.0 \\(compatible; Advanced Email Extractor v2\\.xx\\)|Mozilla/4\\.0 \\(compatible; Iplexx Spider/1\\.0 http\\://www\\.iplexx\\.at\\)|Mozilla/4\\.0 \\(compatible; MSIE 5\\.0; Windows NT; DigExt; DTS Agent|Mozilla/4\\.0 efp@gmx\\.net|Mozilla/5\\.0 \\(Version\\: xxxx Type\\:xx\\)|NameOfAgent \\(CMS Spider\\)|NASA Search 1\\.0|Nsauditor/1\\.x|PBrowse 1\\.4b|PEval 1\\.4b|Poirot|Port Huron Labs|Production Bot 0116B|Production Bot 2016B|Production Bot DOT 3016B|Program Shareware 1\\.0\\.2|PSurf15a 11|PSurf15a 51|PSurf15a VA|psycheclone|RSurf15a 41|RSurf15a 51|RSurf15a 81|searchbot admin@google\\.com|ShablastBot 1\\.0|snap\\.com beta crawler v0|Snapbot/1\\.0|Snapbot/1\\.0 \\(Snap Shots\u0026amp;#44; \\+http\\://www\\.snap\\.com\\)|sogou develop spider|Sogou Orion spider/3\\.0\\(\\+http\\://www\\.sogou\\.com/docs/help/webmasters\\.htm#07\\)|sogou spider|Sogou web spider/3\\.0\\(\\+http\\://www\\.sogou\\.com/docs/help/webmasters\\.htm#07\\)|sohu agent|SSurf15a 11 |TSurf15a 11|Under the Rainbow 2\\.2|User-Agent\\: Mozilla/4\\.0 \\(compatible; MSIE 6\\.0; Windows NT 5\\.1\\)|VadixBot|WebVulnCrawl\\.unknown/1\\.0 libwww-perl/5\\.803|Wells Search II|WEP Search 00\n\nfailregex = ^\u0026lt;HOST\u0026gt; -.*\u0026quot;(GET|POST|HEAD).*HTTP.*\u0026quot;.*(?:%(badbots)s|%(badbotscustom)s).*\u0026quot;$\nignoreregex =\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"firewall-integration\" class=\"mobile-header\"\u003eFirewall Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# iptables integration\nsudo tee /etc/fail2ban/action.d/iptables-common.local \u0026lt;\u0026lt;EOF\n[Init]\n# Option: blocktype\n# Note: This is the default block type for all iptables actions\nblocktype = DROP\n\n# Option: iptables\n# Note: Path to iptables command\niptables = /sbin/iptables\n\n# Option: protocol\n# Note: Default protocol\nprotocol = tcp\n\n# Option: chain\n# Note: Default chain for filter table\nchain = INPUT\nEOF\n\n# nftables integration\nsudo tee /etc/fail2ban/action.d/nftables.local \u0026lt;\u0026lt;EOF\n[Definition]\nactionstart = nft add table inet fail2ban\n              nft add chain inet fail2ban f2b-\u0026lt;name\u0026gt; { type filter hook input priority 0 \\; }\n\nactionstop = nft delete chain inet fail2ban f2b-\u0026lt;name\u0026gt;\n\nactionban = nft add rule inet fail2ban f2b-\u0026lt;name\u0026gt; ip saddr \u0026lt;ip\u0026gt; drop\n\nactionunban = nft delete rule inet fail2ban f2b-\u0026lt;name\u0026gt; handle \\$(nft -a list chain inet fail2ban f2b-\u0026lt;name\u0026gt; | grep \u0026lt;ip\u0026gt; | awk \u0026#039;{print \\$NF}\u0026#039;)\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"database-setup\" class=\"mobile-header\"\u003eDatabase Setup\u003c/h2\u003e\n\u003ch3 id=\"sqlite-database-configuration\" class=\"mobile-header\"\u003eSQLite Database Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Default SQLite database location\nls -la /var/lib/fail2ban/fail2ban.sqlite3\n\n# Custom database configuration\nsudo tee -a /etc/fail2ban/fail2ban.local \u0026lt;\u0026lt;EOF\n\n[Definition]\n# Database configuration\ndbfile = /var/lib/fail2ban/fail2ban.sqlite3\ndbpurgeage = 7d\nEOF\n\n# View database content\nsudo sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \u0026quot;SELECT * FROM bans;\u0026quot;\nsudo sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \u0026quot;SELECT jail, ip, COUNT(*) as count FROM bans GROUP BY jail, ip ORDER BY count DESC;\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"mysql-backend-configuration\" class=\"mobile-header\"\u003eMySQL Backend Configuration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install MySQL connector\nsudo apt install python3-pymysql  # Debian/Ubuntu\nsudo dnf install python3-PyMySQL   # RHEL/CentOS\n\n# Create database and user\nmysql -u root -p \u0026lt;\u0026lt;EOF\nCREATE DATABASE fail2ban;\nCREATE USER \u0026#039;fail2ban\u0026#039;@\u0026#039;localhost\u0026#039; IDENTIFIED BY \u0026#039;secure_password\u0026#039;;\nGRANT ALL PRIVILEGES ON fail2ban.* TO \u0026#039;fail2ban\u0026#039;@\u0026#039;localhost\u0026#039;;\nFLUSH PRIVILEGES;\nEOF\n\n# Configure fail2ban for MySQL\nsudo tee /etc/fail2ban/fail2ban.d/mysql.conf \u0026lt;\u0026lt;EOF\n[Definition]\ndbdriver = mysql\ndbhost = localhost\ndbport = 3306\ndbuser = fail2ban\ndbpassword = secure_password\ndbname = fail2ban\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"performance-optimization\" class=\"mobile-header\"\u003ePerformance Optimization\u003c/h2\u003e\n\u003ch3 id=\"system-tuning\" class=\"mobile-header\"\u003eSystem Tuning\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Optimize fail2ban performance\nsudo tee /etc/fail2ban/fail2ban.d/performance.conf \u0026lt;\u0026lt;EOF\n[Definition]\n# Use systemd journal instead of log files\nbackend = systemd\n\n# Use pyinotify for better performance\nbackend = pyinotify\n\n# Increase socket timeout\nsocket_timeout = 30\n\n# Database optimization\ndbmaxmatches = 100\ndbpurgeage = 1d\nEOF\n\n# Configure systemd limits\nsudo mkdir -p /etc/systemd/system/fail2ban.service.d\nsudo tee /etc/systemd/system/fail2ban.service.d/limits.conf \u0026lt;\u0026lt;EOF\n[Service]\n# Increase limits for better performance\nLimitNOFILE=65536\nLimitNPROC=4096\nMemoryLimit=512M\nCPUQuota=50%\nNice=-5\nEOF\n\nsudo systemctl daemon-reload\nsudo systemctl restart fail2ban\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"log-processing-optimization\" class=\"mobile-header\"\u003eLog Processing Optimization\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Use systemd journal backend for better performance\nsudo tee /etc/fail2ban/jail.d/systemd-backend.conf \u0026lt;\u0026lt;EOF\n[DEFAULT]\nbackend = systemd\n\n[sshd]\nenabled = true\nbackend = systemd\njournalmatch = _SYSTEMD_UNIT=ssh.service + _COMM=sshd\n\n[nginx]\nenabled = true\nbackend = systemd\njournalmatch = _SYSTEMD_UNIT=nginx.service\nEOF\n\n# Configure log rotation for fail2ban\nsudo tee /etc/logrotate.d/fail2ban \u0026lt;\u0026lt;EOF\n/var/log/fail2ban.log {\n    daily\n    rotate 7\n    compress\n    delaycompress\n    missingok\n    notifempty\n    create 640 root adm\n    sharedscripts\n    postrotate\n        fail2ban-client flushlogs 1\u0026gt;/dev/null\n    endscript\n}\nEOF\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"monitoring\" class=\"mobile-header\"\u003eMonitoring\u003c/h2\u003e\n\u003ch3 id=\"built-in-monitoring\" class=\"mobile-header\"\u003eBuilt-in Monitoring\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check fail2ban status\nsudo fail2ban-client status\n\n# Check specific jail status\nsudo fail2ban-client status sshd\n\n# Get banned IPs for all jails\nfor jail in $(sudo fail2ban-client status | grep \u0026quot;Jail list\u0026quot; | sed \u0026#039;s/.*://;s/,//g\u0026#039;); do\n    echo \u0026quot;=== $jail ===\u0026quot;\n    sudo fail2ban-client status $jail | grep \u0026quot;Banned IP\u0026quot;\ndone\n\n# Monitor fail2ban in real-time\nsudo tail -f /var/log/fail2ban.log\n\n# Show ban statistics\nsudo fail2ban-client banned\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"monitoring-script\" class=\"mobile-header\"\u003eMonitoring Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/bin/bash\n# fail2ban-monitor.sh\n\nLOG_FILE=\u0026quot;/var/log/fail2ban-monitor.log\u0026quot;\nALERT_EMAIL=\u0026quot;admin@example.com\u0026quot;\n\nlog() {\n    echo \u0026quot;[$(date \u0026#039;+%Y-%m-%d %H:%M:%S\u0026#039;)] $1\u0026quot; | tee -a \u0026quot;$LOG_FILE\u0026quot;\n}\n\n# Check fail2ban service status\ncheck_service() {\n    if ! systemctl is-active --quiet fail2ban; then\n        log \u0026quot;ERROR: fail2ban service is not running!\u0026quot;\n        echo \u0026quot;fail2ban service down on $(hostname)\u0026quot; | mail -s \u0026quot;fail2ban Alert\u0026quot; \u0026quot;$ALERT_EMAIL\u0026quot;\n        return 1\n    fi\n    log \u0026quot;fail2ban service is running\u0026quot;\n}\n\n# Monitor ban activity\nmonitor_bans() {\n    local jail_list=$(fail2ban-client status | grep \u0026quot;Jail list\u0026quot; | sed \u0026#039;s/.*://;s/,//g\u0026#039;)\n    \n    for jail in $jail_list; do\n        local status=$(fail2ban-client status \u0026quot;$jail\u0026quot;)\n        local banned_count=$(echo \u0026quot;$status\u0026quot; | grep \u0026quot;Currently banned:\u0026quot; | awk \u0026#039;{print $NF}\u0026#039;)\n        local total_banned=$(echo \u0026quot;$status\u0026quot; | grep \u0026quot;Total banned:\u0026quot; | awk \u0026#039;{print $NF}\u0026#039;)\n        \n        log \u0026quot;Jail: $jail - Currently banned: $banned_count, Total banned: $total_banned\u0026quot;\n        \n        # Alert if too many bans\n        if [ \u0026quot;$banned_count\u0026quot; -gt 50 ]; then\n            log \u0026quot;WARNING: High number of banned IPs in $jail jail\u0026quot;\n            echo \u0026quot;High ban count in $jail: $banned_count IPs\u0026quot; | mail -s \u0026quot;fail2ban Warning\u0026quot; \u0026quot;$ALERT_EMAIL\u0026quot;\n        fi\n    done\n}\n\n# Check for suspicious patterns\ncheck_patterns() {\n    local recent_bans=$(tail -n 1000 /var/log/fail2ban.log | grep \u0026quot;Ban\u0026quot; | wc -l)\n    \n    if [ \u0026quot;$recent_bans\u0026quot; -gt 100 ]; then\n        log \u0026quot;WARNING: High ban rate detected: $recent_bans bans in recent logs\u0026quot;\n    fi\n}\n\n# Generate report\ngenerate_report() {\n    local report_file=\u0026quot;/tmp/fail2ban-report-$(date +%Y%m%d).txt\u0026quot;\n    \n    {\n        echo \u0026quot;Fail2ban Report - $(date)\u0026quot;\n        echo \u0026quot;=========================\u0026quot;\n        echo\n        fail2ban-client status\n        echo\n        echo \u0026quot;Ban Statistics by Jail:\u0026quot;\n        echo \u0026quot;-----------------------\u0026quot;\n        \n        for jail in $(fail2ban-client status | grep \u0026quot;Jail list\u0026quot; | sed \u0026#039;s/.*://;s/,//g\u0026#039;); do\n            echo\n            echo \u0026quot;[$jail]\u0026quot;\n            fail2ban-client status \u0026quot;$jail\u0026quot;\n        done\n        \n        echo\n        echo \u0026quot;Recent Activity:\u0026quot;\n        echo \u0026quot;----------------\u0026quot;\n        tail -n 50 /var/log/fail2ban.log | grep -E \u0026quot;(Ban|Unban|Found|Restore)\u0026quot;\n    } \u0026gt; \u0026quot;$report_file\u0026quot;\n    \n    log \u0026quot;Report generated: $report_file\u0026quot;\n    \n    # Email report\n    mail -s \u0026quot;Fail2ban Daily Report - $(hostname)\u0026quot; \u0026quot;$ALERT_EMAIL\u0026quot; \u0026lt; \u0026quot;$report_file\u0026quot;\n}\n\n# Main monitoring loop\nmain() {\n    log \u0026quot;Starting fail2ban monitoring...\u0026quot;\n    \n    check_service || exit 1\n    monitor_bans\n    check_patterns\n    generate_report\n    \n    log \u0026quot;Monitoring completed\u0026quot;\n}\n\n# Run monitoring\nmain\n\n# Add to cron:\n# */15 * * * * /usr/local/bin/fail2ban-monitor.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"prometheus-integration\" class=\"mobile-header\"\u003ePrometheus Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Install fail2ban exporter\nwget https://github.com/hectorjsmith/fail2ban-prometheus-exporter/releases/download/v0.10.0/fail2ban_exporter\nchmod +x fail2ban_exporter\nsudo mv fail2ban_exporter /usr/local/bin/\n\n# Create systemd service\nsudo tee /etc/systemd/system/fail2ban-exporter.service \u0026lt;\u0026lt;EOF\n[Unit]\nDescription=Fail2ban Prometheus Exporter\nAfter=network.target\n\n[Service]\nType=simple\nUser=prometheus\nExecStart=/usr/local/bin/fail2ban_exporter\nRestart=on-failure\n\n[Install]\nWantedBy=multi-user.target\nEOF\n\nsudo systemctl enable --now fail2ban-exporter\n\n# Configure Prometheus\necho \u0026quot;  - job_name: \u0026#039;fail2ban\u0026#039;\n    static_configs:\n      - targets: [\u0026#039;localhost:9191\u0026#039;]\u0026quot; \u0026gt;\u0026gt; /etc/prometheus/prometheus.yml\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"backup-and-restore\" class=\"mobile-header\"\u003eBackup and Restore\u003c/h2\u003e\n\u003ch3 id=\"backup-script\" class=\"mobile-header\"\u003eBackup Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/bin/bash\n# fail2ban-backup.sh\n\nBACKUP_DIR=\u0026quot;/backup/fail2ban\u0026quot;\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_FILE=\u0026quot;$BACKUP_DIR/fail2ban_backup_$DATE.tar.gz\u0026quot;\n\n# Create backup directory\nmkdir -p \u0026quot;$BACKUP_DIR\u0026quot;\n\n# Stop fail2ban to ensure database consistency\nsystemctl stop fail2ban\n\n# Create backup\ntar -czf \u0026quot;$BACKUP_FILE\u0026quot; \\\n    /etc/fail2ban/ \\\n    /var/lib/fail2ban/ \\\n    /var/log/fail2ban.log* \\\n    2\u0026gt;/dev/null\n\n# Start fail2ban\nsystemctl start fail2ban\n\n# Encrypt backup\ngpg --cipher-algo AES256 --symmetric \u0026quot;$BACKUP_FILE\u0026quot;\nrm \u0026quot;$BACKUP_FILE\u0026quot;\n\necho \u0026quot;Backup created: $BACKUP_FILE.gpg\u0026quot;\n\n# Clean old backups (keep 30 days)\nfind \u0026quot;$BACKUP_DIR\u0026quot; -name \u0026quot;fail2ban_backup_*.gpg\u0026quot; -mtime +30 -delete\n\n# Backup banned IPs list\nfail2ban-client banned \u0026gt; \u0026quot;$BACKUP_DIR/banned_ips_$DATE.txt\u0026quot;\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"restore-script\" class=\"mobile-header\"\u003eRestore Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/bin/bash\n# fail2ban-restore.sh\n\nBACKUP_FILE=\u0026quot;$1\u0026quot;\n\nif [ -z \u0026quot;$BACKUP_FILE\u0026quot; ]; then\n    echo \u0026quot;Usage: $0 \u0026lt;backup-file.gpg\u0026gt;\u0026quot;\n    exit 1\nfi\n\n# Decrypt backup\ngpg --decrypt \u0026quot;$BACKUP_FILE\u0026quot; \u0026gt; /tmp/fail2ban_restore.tar.gz\n\n# Stop fail2ban\nsystemctl stop fail2ban\n\n# Extract backup\ntar -xzf /tmp/fail2ban_restore.tar.gz -C /\n\n# Restore permissions\nchown -R root:root /etc/fail2ban\nchmod 644 /etc/fail2ban/*.conf\nchmod 644 /etc/fail2ban/*.local\n\n# Start fail2ban\nsystemctl start fail2ban\n\n# Clean up\nrm /tmp/fail2ban_restore.tar.gz\n\necho \u0026quot;Restore completed\u0026quot;\n\n# Reload jails\nfail2ban-client reload\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"troubleshooting\" class=\"mobile-header\"\u003eTroubleshooting\u003c/h2\u003e\n\u003ch3 id=\"common-issues\" class=\"mobile-header\"\u003eCommon Issues\u003c/h3\u003e\n\u003cp class=\"mobile-paragraph\"\u003e1. \u003cstrong\u003eService won't start\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check for syntax errors\nfail2ban-client -t\n\n# Check logs\njournalctl -u fail2ban -n 100\ntail -f /var/log/fail2ban.log\n\n# Check permissions\nls -la /var/run/fail2ban/\nls -la /var/lib/fail2ban/\n\n# Start in foreground for debugging\nfail2ban-server -f -x -v\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e2. \u003cstrong\u003eIPs not getting banned\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Test regex patterns\nfail2ban-regex /var/log/auth.log /etc/fail2ban/filter.d/sshd.conf\n\n# Check jail configuration\nfail2ban-client get sshd logpath\nfail2ban-client get sshd findtime\nfail2ban-client get sshd maxretry\n\n# Test specific log line\necho \u0026#039;Dec 10 12:34:56 server sshd[12345]: Failed password for invalid user admin from 192.168.1.100 port 12345 ssh2\u0026#039; | fail2ban-regex - /etc/fail2ban/filter.d/sshd.conf\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003cp class=\"mobile-paragraph\"\u003e3. \u003cstrong\u003ePerformance issues\u003c/strong\u003e:\u003c/p\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Check database size\nls -lh /var/lib/fail2ban/fail2ban.sqlite3\n\n# Purge old entries\nfail2ban-client set dbpurgeage 1d\nsqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \u0026quot;DELETE FROM bans WHERE timeofban \u0026lt; strftime(\u0026#039;%s\u0026#039;, \u0026#039;now\u0026#039;, \u0026#039;-7 days\u0026#039;);\u0026quot;\n\n# Monitor CPU usage\ntop -p $(pgrep fail2ban-server)\n\n# Check number of monitored files\nlsof -p $(pgrep fail2ban-server) | grep -c log\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"debug-mode\" class=\"mobile-header\"\u003eDebug Mode\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# Enable debug logging\nsudo tee -a /etc/fail2ban/fail2ban.local \u0026lt;\u0026lt;EOF\n[Definition]\nloglevel = DEBUG\nEOF\n\nsudo systemctl restart fail2ban\n\n# Watch debug logs\ntail -f /var/log/fail2ban.log | grep -E \u0026quot;(DEBUG|ERROR|WARNING)\u0026quot;\n\n# Test jail processing\nfail2ban-client set sshd addlogpath /var/log/auth.log\nfail2ban-client set sshd banip 192.168.1.100\nfail2ban-client set sshd unbanip 192.168.1.100\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"integration-examples\" class=\"mobile-header\"\u003eIntegration Examples\u003c/h2\u003e\n\u003ch3 id=\"python-integration\" class=\"mobile-header\"\u003ePython Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"python\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003epython\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-python\"\u003e#!/usr/bin/env python3\n# fail2ban_api.py\n\nimport subprocess\nimport json\nimport socket\nfrom datetime import datetime\n\nclass Fail2banManager:\n    def __init__(self):\n        self.socket_path = \u0026quot;/var/run/fail2ban/fail2ban.sock\u0026quot;\n    \n    def execute_command(self, command):\n        \u0026quot;\u0026quot;\u0026quot;Execute fail2ban-client command\u0026quot;\u0026quot;\u0026quot;\n        try:\n            result = subprocess.run(\n                [\u0026#039;fail2ban-client\u0026#039;] + command.split(),\n                capture_output=True,\n                text=True,\n                check=True\n            )\n            return result.stdout.strip()\n        except subprocess.CalledProcessError as e:\n            return f\u0026quot;Error: {e.stderr}\u0026quot;\n    \n    def get_status(self):\n        \u0026quot;\u0026quot;\u0026quot;Get overall status\u0026quot;\u0026quot;\u0026quot;\n        return self.execute_command(\u0026quot;status\u0026quot;)\n    \n    def get_jail_status(self, jail):\n        \u0026quot;\u0026quot;\u0026quot;Get specific jail status\u0026quot;\u0026quot;\u0026quot;\n        status = self.execute_command(f\u0026quot;status {jail}\u0026quot;)\n        \n        # Parse status output\n        lines = status.split(\u0026#039;\\n\u0026#039;)\n        result = {\n            \u0026#039;filter\u0026#039;: {},\n            \u0026#039;actions\u0026#039;: {},\n            \u0026#039;currently_failed\u0026#039;: 0,\n            \u0026#039;total_failed\u0026#039;: 0,\n            \u0026#039;currently_banned\u0026#039;: 0,\n            \u0026#039;total_banned\u0026#039;: 0,\n            \u0026#039;banned_ips\u0026#039;: []\n        }\n        \n        for line in lines:\n            if \u0026#039;Currently failed:\u0026#039; in line:\n                result[\u0026#039;currently_failed\u0026#039;] = int(line.split(\u0026#039;:\u0026#039;)[1].strip())\n            elif \u0026#039;Total failed:\u0026#039; in line:\n                result[\u0026#039;total_failed\u0026#039;] = int(line.split(\u0026#039;:\u0026#039;)[1].strip())\n            elif \u0026#039;Currently banned:\u0026#039; in line:\n                result[\u0026#039;currently_banned\u0026#039;] = int(line.split(\u0026#039;:\u0026#039;)[1].strip())\n            elif \u0026#039;Total banned:\u0026#039; in line:\n                result[\u0026#039;total_banned\u0026#039;] = int(line.split(\u0026#039;:\u0026#039;)[1].strip())\n            elif \u0026#039;Banned IP list:\u0026#039; in line:\n                ips = line.split(\u0026#039;:\u0026#039;)[1].strip()\n                result[\u0026#039;banned_ips\u0026#039;] = ips.split() if ips else []\n        \n        return result\n    \n    def ban_ip(self, jail, ip, duration=None):\n        \u0026quot;\u0026quot;\u0026quot;Ban an IP address\u0026quot;\u0026quot;\u0026quot;\n        if duration:\n            return self.execute_command(f\u0026quot;set {jail} banip {ip} {duration}\u0026quot;)\n        else:\n            return self.execute_command(f\u0026quot;set {jail} banip {ip}\u0026quot;)\n    \n    def unban_ip(self, jail, ip):\n        \u0026quot;\u0026quot;\u0026quot;Unban an IP address\u0026quot;\u0026quot;\u0026quot;\n        return self.execute_command(f\u0026quot;set {jail} unbanip {ip}\u0026quot;)\n    \n    def get_banned_ips(self):\n        \u0026quot;\u0026quot;\u0026quot;Get all banned IPs across all jails\u0026quot;\u0026quot;\u0026quot;\n        banned = {}\n        jails = self.get_jail_list()\n        \n        for jail in jails:\n            status = self.get_jail_status(jail)\n            if status[\u0026#039;banned_ips\u0026#039;]:\n                banned[jail] = status[\u0026#039;banned_ips\u0026#039;]\n        \n        return banned\n    \n    def get_jail_list(self):\n        \u0026quot;\u0026quot;\u0026quot;Get list of all jails\u0026quot;\u0026quot;\u0026quot;\n        status = self.get_status()\n        for line in status.split(\u0026#039;\\n\u0026#039;):\n            if \u0026#039;Jail list:\u0026#039; in line:\n                jails = line.split(\u0026#039;:\u0026#039;)[1].strip()\n                return [j.strip() for j in jails.split(\u0026#039;,\u0026#039;)]\n        return []\n    \n    def add_jail(self, jail_config):\n        \u0026quot;\u0026quot;\u0026quot;Add a new jail configuration\u0026quot;\u0026quot;\u0026quot;\n        config_path = f\u0026quot;/etc/fail2ban/jail.d/{jail_config[\u0026#039;name\u0026#039;]}.conf\u0026quot;\n        \n        config_content = f\u0026quot;\u0026quot;\u0026quot;[{jail_config[\u0026#039;name\u0026#039;]}]\nenabled = true\nport = {jail_config.get(\u0026#039;port\u0026#039;, \u0026#039;http,https\u0026#039;)}\nfilter = {jail_config.get(\u0026#039;filter\u0026#039;, jail_config[\u0026#039;name\u0026#039;])}\nlogpath = {jail_config[\u0026#039;logpath\u0026#039;]}\nmaxretry = {jail_config.get(\u0026#039;maxretry\u0026#039;, 5)}\nbantime = {jail_config.get(\u0026#039;bantime\u0026#039;, 3600)}\nfindtime = {jail_config.get(\u0026#039;findtime\u0026#039;, 600)}\n\u0026quot;\u0026quot;\u0026quot;\n        \n        with open(config_path, \u0026#039;w\u0026#039;) as f:\n            f.write(config_content)\n        \n        # Reload configuration\n        return self.execute_command(\u0026quot;reload\u0026quot;)\n\n# Example usage\nif __name__ == \u0026#039;__main__\u0026#039;:\n    f2b = Fail2banManager()\n    \n    # Get overall status\n    print(\u0026quot;Fail2ban Status:\u0026quot;)\n    print(f2b.get_status())\n    print(\u0026quot;\\n\u0026quot; + \u0026quot;=\u0026quot;*50 + \u0026quot;\\n\u0026quot;)\n    \n    # Get banned IPs\n    print(\u0026quot;Banned IPs by Jail:\u0026quot;)\n    banned = f2b.get_banned_ips()\n    for jail, ips in banned.items():\n        print(f\u0026quot;\\n{jail}: {\u0026#039;, \u0026#039;.join(ips) if ips else \u0026#039;None\u0026#039;}\u0026quot;)\n    \n    # Check specific jail\n    print(\u0026quot;\\n\u0026quot; + \u0026quot;=\u0026quot;*50 + \u0026quot;\\n\u0026quot;)\n    print(\u0026quot;SSH Jail Status:\u0026quot;)\n    ssh_status = f2b.get_jail_status(\u0026#039;sshd\u0026#039;)\n    print(json.dumps(ssh_status, indent=2))\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"web-dashboard\" class=\"mobile-header\"\u003eWeb Dashboard\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"python\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003epython\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-python\"\u003e#!/usr/bin/env python3\n# fail2ban_dashboard.py\n\nfrom flask import Flask, render_template, jsonify, request\nfrom fail2ban_api import Fail2banManager\nimport json\n\napp = Flask(__name__)\nf2b = Fail2banManager()\n\n@app.route(\u0026#039;/\u0026#039;)\ndef dashboard():\n    return render_template(\u0026#039;dashboard.html\u0026#039;)\n\n@app.route(\u0026#039;/api/status\u0026#039;)\ndef api_status():\n    jails = f2b.get_jail_list()\n    status = {\n        \u0026#039;jails\u0026#039;: {},\n        \u0026#039;total_banned\u0026#039;: 0,\n        \u0026#039;total_failed\u0026#039;: 0\n    }\n    \n    for jail in jails:\n        jail_status = f2b.get_jail_status(jail)\n        status[\u0026#039;jails\u0026#039;][jail] = jail_status\n        status[\u0026#039;total_banned\u0026#039;] += jail_status[\u0026#039;total_banned\u0026#039;]\n        status[\u0026#039;total_failed\u0026#039;] += jail_status[\u0026#039;total_failed\u0026#039;]\n    \n    return jsonify(status)\n\n@app.route(\u0026#039;/api/ban\u0026#039;, methods=[\u0026#039;POST\u0026#039;])\ndef api_ban():\n    data = request.json\n    result = f2b.ban_ip(data[\u0026#039;jail\u0026#039;], data[\u0026#039;ip\u0026#039;], data.get(\u0026#039;duration\u0026#039;))\n    return jsonify({\u0026#039;success\u0026#039;: True, \u0026#039;result\u0026#039;: result})\n\n@app.route(\u0026#039;/api/unban\u0026#039;, methods=[\u0026#039;POST\u0026#039;])\ndef api_unban():\n    data = request.json\n    result = f2b.unban_ip(data[\u0026#039;jail\u0026#039;], data[\u0026#039;ip\u0026#039;])\n    return jsonify({\u0026#039;success\u0026#039;: True, \u0026#039;result\u0026#039;: result})\n\nif __name__ == \u0026#039;__main__\u0026#039;:\n    app.run(host=\u0026#039;0.0.0.0\u0026#039;, port=5000, debug=True)\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"shell-integration\" class=\"mobile-header\"\u003eShell Integration\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/bin/bash\n# fail2ban-utils.sh - Fail2ban utility functions\n\n# Source this file in other scripts: source /usr/local/lib/fail2ban-utils.sh\n\n# Check if IP is banned\nis_ip_banned() {\n    local ip=\u0026quot;$1\u0026quot;\n    local jail=\u0026quot;${2:-}\u0026quot;\n    \n    if [ -z \u0026quot;$jail\u0026quot; ]; then\n        # Check all jails\n        for j in $(fail2ban-client status | grep \u0026quot;Jail list\u0026quot; | sed \u0026#039;s/.*://;s/,//g\u0026#039;); do\n            if fail2ban-client status \u0026quot;$j\u0026quot; | grep -q \u0026quot;$ip\u0026quot;; then\n                echo \u0026quot;IP $ip is banned in jail: $j\u0026quot;\n                return 0\n            fi\n        done\n    else\n        # Check specific jail\n        if fail2ban-client status \u0026quot;$jail\u0026quot; | grep -q \u0026quot;$ip\u0026quot;; then\n            return 0\n        fi\n    fi\n    \n    return 1\n}\n\n# Ban IP with reason logging\nban_ip_with_reason() {\n    local jail=\u0026quot;$1\u0026quot;\n    local ip=\u0026quot;$2\u0026quot;\n    local reason=\u0026quot;$3\u0026quot;\n    local duration=\u0026quot;${4:-3600}\u0026quot;\n    \n    echo \u0026quot;[$(date)] Banning IP $ip in jail $jail for $duration seconds. Reason: $reason\u0026quot; \u0026gt;\u0026gt; /var/log/fail2ban-manual-bans.log\n    fail2ban-client set \u0026quot;$jail\u0026quot; banip \u0026quot;$ip\u0026quot; \u0026quot;$duration\u0026quot;\n}\n\n# Get ban statistics\nget_ban_stats() {\n    local total_banned=0\n    local total_failed=0\n    \n    echo \u0026quot;Fail2ban Statistics\u0026quot;\n    echo \u0026quot;==================\u0026quot;\n    \n    for jail in $(fail2ban-client status | grep \u0026quot;Jail list\u0026quot; | sed \u0026#039;s/.*://;s/,//g\u0026#039;); do\n        local status=$(fail2ban-client status \u0026quot;$jail\u0026quot;)\n        local banned=$(echo \u0026quot;$status\u0026quot; | grep \u0026quot;Total banned:\u0026quot; | awk \u0026#039;{print $NF}\u0026#039;)\n        local failed=$(echo \u0026quot;$status\u0026quot; | grep \u0026quot;Total failed:\u0026quot; | awk \u0026#039;{print $NF}\u0026#039;)\n        \n        echo \u0026quot;[$jail]\u0026quot;\n        echo \u0026quot;  Failed: $failed\u0026quot;\n        echo \u0026quot;  Banned: $banned\u0026quot;\n        \n        total_banned=$((total_banned + banned))\n        total_failed=$((total_failed + failed))\n    done\n    \n    echo\n    echo \u0026quot;Totals:\u0026quot;\n    echo \u0026quot;  Failed: $total_failed\u0026quot;\n    echo \u0026quot;  Banned: $total_banned\u0026quot;\n}\n\n# Whitelist management\nadd_to_whitelist() {\n    local ip=\u0026quot;$1\u0026quot;\n    \n    # Add to fail2ban whitelist\n    if grep -q \u0026quot;ignoreip\u0026quot; /etc/fail2ban/jail.local; then\n        sed -i \u0026quot;/ignoreip/s/$/,$ip/\u0026quot; /etc/fail2ban/jail.local\n    else\n        echo \u0026quot;ignoreip = 127.0.0.1/8 ::1 $ip\u0026quot; \u0026gt;\u0026gt; /etc/fail2ban/jail.local\n    fi\n    \n    # Reload configuration\n    fail2ban-client reload\n    \n    echo \u0026quot;Added $ip to whitelist\u0026quot;\n}\n\n# Export functions for use in other scripts\nexport -f is_ip_banned\nexport -f ban_ip_with_reason\nexport -f get_ban_stats\nexport -f add_to_whitelist\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"maintenance\" class=\"mobile-header\"\u003eMaintenance\u003c/h2\u003e\n\u003ch3 id=\"update-procedures\" class=\"mobile-header\"\u003eUpdate Procedures\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e# RHEL/CentOS/Rocky/AlmaLinux\nsudo dnf update fail2ban\n\n# Debian/Ubuntu\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade fail2ban\n\n# Arch Linux\nsudo pacman -Syu fail2ban\n\n# Alpine Linux\napk update \u0026amp;\u0026amp; apk upgrade fail2ban\n\n# openSUSE\nsudo zypper update fail2ban\n\n# FreeBSD\npkg update \u0026amp;\u0026amp; pkg upgrade py39-fail2ban\n\n# Always backup before updates\n/usr/local/bin/fail2ban-backup.sh\n\n# Restart after updates\nsudo systemctl restart fail2ban\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"regular-maintenance-tasks\" class=\"mobile-header\"\u003eRegular Maintenance Tasks\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/bin/bash\n# fail2ban-maintenance.sh\n\nLOG_FILE=\u0026quot;/var/log/fail2ban-maintenance.log\u0026quot;\n\nlog() {\n    echo \u0026quot;[$(date \u0026#039;+%Y-%m-%d %H:%M:%S\u0026#039;)] $1\u0026quot; | tee -a \u0026quot;$LOG_FILE\u0026quot;\n}\n\n# Update filters from repository\nupdate_filters() {\n    log \u0026quot;Updating fail2ban filters...\u0026quot;\n    \n    cd /tmp\n    git clone https://github.com/fail2ban/fail2ban.git\n    \n    # Backup existing filters\n    cp -r /etc/fail2ban/filter.d /etc/fail2ban/filter.d.bak\n    \n    # Copy new filters\n    cp /tmp/fail2ban/config/filter.d/* /etc/fail2ban/filter.d/\n    \n    # Test configuration\n    if fail2ban-client -t; then\n        log \u0026quot;Filter update successful\u0026quot;\n    else\n        log \u0026quot;ERROR: Filter update failed, restoring backup\u0026quot;\n        rm -rf /etc/fail2ban/filter.d\n        mv /etc/fail2ban/filter.d.bak /etc/fail2ban/filter.d\n    fi\n    \n    rm -rf /tmp/fail2ban\n}\n\n# Clean old database entries\nclean_database() {\n    log \u0026quot;Cleaning fail2ban database...\u0026quot;\n    \n    # Get database size before\n    size_before=$(ls -lh /var/lib/fail2ban/fail2ban.sqlite3 | awk \u0026#039;{print $5}\u0026#039;)\n    \n    # Clean entries older than 30 days\n    sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \u0026quot;DELETE FROM bans WHERE timeofban \u0026lt; strftime(\u0026#039;%s\u0026#039;, \u0026#039;now\u0026#039;, \u0026#039;-30 days\u0026#039;);\u0026quot;\n    sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \u0026quot;VACUUM;\u0026quot;\n    \n    # Get database size after\n    size_after=$(ls -lh /var/lib/fail2ban/fail2ban.sqlite3 | awk \u0026#039;{print $5}\u0026#039;)\n    \n    log \u0026quot;Database cleaned. Size: $size_before -\u0026gt; $size_after\u0026quot;\n}\n\n# Check and update GeoIP database\nupdate_geoip() {\n    log \u0026quot;Updating GeoIP database...\u0026quot;\n    \n    if command -v geoipupdate \u0026gt;/dev/null 2\u0026gt;\u0026amp;1; then\n        geoipupdate\n        log \u0026quot;GeoIP database updated\u0026quot;\n    else\n        log \u0026quot;GeoIP update tool not installed\u0026quot;\n    fi\n}\n\n# Generate monthly report\ngenerate_monthly_report() {\n    log \u0026quot;Generating monthly report...\u0026quot;\n    \n    report_file=\u0026quot;/var/log/fail2ban-monthly-$(date +%Y%m).txt\u0026quot;\n    \n    {\n        echo \u0026quot;Fail2ban Monthly Report - $(date \u0026#039;+%B %Y\u0026#039;)\u0026quot;\n        echo \u0026quot;========================================\u0026quot;\n        echo\n        \n        # Get ban statistics from database\n        echo \u0026quot;Top 10 Banned IPs:\u0026quot;\n        sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \u0026quot;SELECT ip, COUNT(*) as count FROM bans WHERE timeofban \u0026gt; strftime(\u0026#039;%s\u0026#039;, \u0026#039;now\u0026#039;, \u0026#039;-30 days\u0026#039;) GROUP BY ip ORDER BY count DESC LIMIT 10;\u0026quot;\n        \n        echo\n        echo \u0026quot;Bans by Jail:\u0026quot;\n        sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \u0026quot;SELECT jail, COUNT(*) as count FROM bans WHERE timeofban \u0026gt; strftime(\u0026#039;%s\u0026#039;, \u0026#039;now\u0026#039;, \u0026#039;-30 days\u0026#039;) GROUP BY jail ORDER BY count DESC;\u0026quot;\n        \n        echo\n        echo \u0026quot;Daily Ban Trend:\u0026quot;\n        sqlite3 /var/lib/fail2ban/fail2ban.sqlite3 \u0026quot;SELECT date(timeofban, \u0026#039;unixepoch\u0026#039;) as day, COUNT(*) as count FROM bans WHERE timeofban \u0026gt; strftime(\u0026#039;%s\u0026#039;, \u0026#039;now\u0026#039;, \u0026#039;-30 days\u0026#039;) GROUP BY day ORDER BY day;\u0026quot;\n    } \u0026gt; \u0026quot;$report_file\u0026quot;\n    \n    log \u0026quot;Monthly report saved to: $report_file\u0026quot;\n}\n\n# Main maintenance routine\nmain() {\n    log \u0026quot;Starting fail2ban maintenance...\u0026quot;\n    \n    update_filters\n    clean_database\n    update_geoip\n    generate_monthly_report\n    \n    # Reload fail2ban\n    fail2ban-client reload\n    \n    log \u0026quot;Maintenance completed\u0026quot;\n}\n\n# Run maintenance\nmain\n\n# Schedule in cron:\n# 0 2 1 * * /usr/local/bin/fail2ban-maintenance.sh\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch3 id=\"health-check-script\" class=\"mobile-header\"\u003eHealth Check Script\u003c/h3\u003e\n\u003cdiv class=\"mobile-code-block\" data-language=\"bash\"\u003e\n      \u003cdiv class=\"mobile-code-header\"\u003e\n        \u003cspan class=\"mobile-code-language\"\u003ebash\u003c/span\u003e\n        \u003cbutton class=\"mobile-copy-button\" onclick=\"copyCode(this)\" title=\"Copy code\"\u003e\n          \u003cspan class=\"copy-icon\"\u003eüìã\u003c/span\u003e\n          \u003cspan class=\"copy-text\"\u003eCopy\u003c/span\u003e\n        \u003c/button\u003e\n      \u003c/div\u003e\n      \u003cdiv class=\"mobile-code-content\"\u003e\n        \u003cpre\u003e\u003ccode class=\"language-bash\"\u003e#!/bin/bash\n# fail2ban-health.sh\n\n# Check fail2ban health\ncheck_health() {\n    local status=0\n    \n    # Check service\n    if ! systemctl is-active --quiet fail2ban; then\n        echo \u0026quot;CRITICAL: fail2ban service is not running\u0026quot;\n        status=2\n    fi\n    \n    # Check database\n    if [ ! -f /var/lib/fail2ban/fail2ban.sqlite3 ]; then\n        echo \u0026quot;WARNING: Database file missing\u0026quot;\n        status=1\n    fi\n    \n    # Check socket\n    if [ ! -S /var/run/fail2ban/fail2ban.sock ]; then\n        echo \u0026quot;WARNING: Socket file missing\u0026quot;\n        status=1\n    fi\n    \n    # Check jails\n    active_jails=$(fail2ban-client status | grep \u0026quot;Jail list\u0026quot; | wc -w)\n    if [ \u0026quot;$active_jails\u0026quot; -lt 3 ]; then\n        echo \u0026quot;WARNING: Only $active_jails jails active\u0026quot;\n        status=1\n    fi\n    \n    if [ $status -eq 0 ]; then\n        echo \u0026quot;OK: fail2ban is healthy\u0026quot;\n    fi\n    \n    exit $status\n}\n\ncheck_health\u003c/code\u003e\u003c/pre\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\u003ch2 id=\"additional-resources\" class=\"mobile-header\"\u003eAdditional Resources\u003c/h2\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.fail2ban.org/\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eOfficial Fail2ban Documentation\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://github.com/fail2ban/fail2ban\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eFail2ban GitHub Repository\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://github.com/fail2ban/fail2ban/wiki\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eFail2ban Wiki\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://fail2ban.readthedocs.io/en/latest/filters.html\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eFilter Development Guide\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://fail2ban.readthedocs.io/en/latest/actions.html\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eAction Development Guide\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://github.com/fail2ban/fail2ban/tree/master/config/filter.d\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eCommunity Filters\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.fail2ban.org/wiki/index.php/Best_practices\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eBest Practices Guide\u003c/a\u003e\u003c/li\u003e\n\u003cli class=\"mobile-list-item\"\u003e\u003ca href=\"https://www.fail2ban.org/wiki/index.php/Security\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eSecurity Hardening Guide\u003c/a\u003e\u003c/li\u003e\n\u003cp class=\"mobile-paragraph\"\u003e---\u003c/p\u003e\n\u003cp class=\"mobile-paragraph\"\u003e\u003cstrong\u003eNote:\u003c/strong\u003e This guide is part of the \u003ca href=\"https://howtomgr.github.io\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eHowToMgr\u003c/a\u003e collection. Always refer to official documentation for the most up-to-date information.\u003c/p\u003e","readTime":"24 min","wordCount":4745,"lastBuilt":"2025-09-16T02:44:19.420Z"},{"name":"keycloak","displayName":"Keycloak","slug":"keycloak","description":"keycloak is a free and open-source open source identity and access management solution. Keycloak provides single sign-on (SSO) with identity brokering and social login, serving as a powerful FOSS alternative to Auth0, Okta, or Azure AD B2C","category":"security","language":null,"stars":0,"forks":0,"topics":[],"githubUrl":"https://github.com/howtomgr/keycloak","updatedAt":"2025-09-16T02:38:08Z","createdAt":"2025-09-08T03:09:55Z","readmeRaw":"## üëã Welcome to keycloak üöÄ  \n\nkeycloak README  \n  \n  \n## Author  \n\nü§ñ casjay: [Github](https://github.com/casjay) ü§ñ  \n","readmeHtml":"\u003ch2 id=\"welcome-to-keycloak\" class=\"mobile-header\"\u003eüëã Welcome to keycloak üöÄ  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003ekeycloak README  \u003c/p\u003e\n\u003ch2 id=\"author\" class=\"mobile-header\"\u003eAuthor  \u003c/h2\u003e\n\u003cp class=\"mobile-paragraph\"\u003eü§ñ casjay: \u003ca href=\"https://github.com/casjay\" target=\"_blank\" rel=\"noopener\" class=\"mobile-link\"\u003eGithub\u003c/a\u003e ü§ñ  \u003c/p\u003e","readTime":"1 min","wordCount":15,"lastBuilt":"2025-09-16T02:44:06.122Z"}]},"__N_SSG":true},"page":"/[category]/[guide]","query":{"category":"security","guide":"wireguard"},"buildId":"bhXTIONQ1NPHcD0brA-Bd","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>